hello and welcom to week nine .
thi is the begin of the second week cover the excit topic of imag and video compress .
imag and video compress repres on of the major topic in imag and video process .
compress is on of the enabl technolog behind the multimedia revolut we ar experienc .
last week , we talk about lossless compress , and thi week we will see how it is us in loss recompress .
as i mention last week , what distinguish lossi and lossless compress , is not the exploit of the correl of the data , sinc it's share by both approach .
but the remov of the perceptu relev inform .
thi is done through quantiz .
thi is the topic of thi week's first two segment .
it's actual requant sinc the data is alreadi in digit form .
we will then cover predict qualiti , more specif , dpcm .
fractal encod , transform encod , and also the well known imag compress standard jpeg and sub band encod .
we will see that each and everi imag and video lossi compress system consist of three build block .
the first on to perform redund remov .
follow by on to reduc entropi .
and final on to perform entropi code .
what therefor , differenti lossi and lossless compress , is the middl block .
while , what differenti the valu lossi compress techniqu we just mention abov , is the first block of redund remov via predict or self similar or decorrel .
while , the other two block remain the same .
we will cover both scalar and vector quantiz .
both techniqu ar part of ani logic oper system or thei can be implement on their own right as compress techniqu .
in thi fir segment we will discuss scalar quantiz .
we discuss uniform quantiz but also a pdf optim non uniform quantiz also refer to as the max loyd quantiz .
we will also talk about the principl of compound base on which non uniform quantiz implement util a uniform quantiz .
so let us start with thi excit topic .
in the lossi data compress system , be it the speech , audio , still imag , or video compress system , and we'll be start the last two dure thi and next week , consist of the three build block shown here .
accord to the first on , the redund in the data is remov .
as we mention earlier , the exist of redund in the data is on of the two reason data is compress .
the second build block is the reduct of the entropi of the data .
there is onli on to take thi step is that accord to the shannon code theorem we cover last week , the smaller the entropi of the sourc the fewer the number of bit we need to encod such as sourc .
thi is the step that reduc the bit rate in repres the symbol of the sourc .
the final build block is the further reduct of the bit in repres the sourc symbol , by us a lossless code scheme which ideal will achiev entropi .
more specif , two import mechan to remov redund is predict and , transform , we talk about linear predict last week .
the main idea is to util the correl in the data , in perform predict of a pixel base on the valu of it either special or tempor or special tempor neighbor .
the idea behind the us of a transform is to decorrel the data .
then , it's easier to tell which transfer coeffici ar more import than other , and in the next step , try to keep the import on in pristin shape while discard or heavili quantiz the less import on .
entropi reduct is achiev through quantiz , the process that turn the continu valu of a discret signal into discret valu , or requant when discret valu ar further restrict into a smaller set of discret valu .
in design such quantiz the properti of the visual system ar taken into account , so as to remov the percept irrelev inform .
the second usual mention earlier for the data be compress .
final , in perform lossless encod , of the , either quantiz predict error or the transfer coeffici , ani of the lossless techniqu we cover dure last week , such as huffman , lzw , and arithmet code and then variant can be util .
thi center block of quantiz , distinguish lossless and loss encod .
in other word , if it's not present , the system is lossless , like for exampl , lossless jpeg that we cover last week .
with that , if you recal , a predictor wa us out of a set of predictor for redund remov .
and arithmet code for the lossless represent of the sourc symbol repres predict error .
we will cover quantiz in thi lectur .
it's an irrevers process , and contribut the most toward the reduct of the b trait .
so , in summari a loss compress scheme , we will cover in these two week .
and the other on that is not cover in thi class consist of these three build block shown here .
thi week , we ar go to cover the follow topic we will talk about quantiz , both scalar and vector .
we will then describ some approach which ar call basic approach , such as subsampl and puls code modul .
we will revisit differenti or predict encod , and more specif you will deriv the express for differenti pcm .
we will talk about fractal encod , a veri interest approach in it own right , continu with transform code and it applic to the well known standard of jpeg .
and final , we will discuss sub band code .
there ar other topic that we'll not have time to cover here , such as wavelength base code , which relat to sub band code .
so how doe a quantiz look like ?
here is an eight level uniform midris quantiz .
so , it's a midris becaus it rise here in the middl , as oppos to a midstop or on with a dead zone .
on the horizont axi , you see the input intens valu of an imag or the amplitud valu of a signal in gener .
thei can be continu number or discret number .
accord to the map defin by thi function all the input valu sai between delta and two delta ar map into thi valu three delta over two .
if thi valu , input valu continu , then we have infinit mani valu between delta and <num> delta .
that thei're all map into thi on valu <num> delta over <num> .
if on the other hand , thei're discret .
then a finit number of them ar map into thi on valu .
so , for exampl , if delta equal <num> .
then the valu here between <num> and <num> we close the interv on thi side and keep it open on thi side ar all map into thi valu which is go to be equal to <num> .
it's clearli an irrevers process .
if we know the number <num> , we cannot tell which of the ten valu in thi <num> to the 19th rang wa quantiz to the valu <num> .
it is a uniform quantiz , becaus the step , these ar the step .
except of these on at the end here and here ar all the same .
thei have a , exactli the same valu and the output ha onli a discret valu the quantiz level .
so to defin thi quantiz we need to know that the decis boundari , these ar the decis boundari , as well as the quantiz level .
of cours in thi case that we have a uniform quantiz as far as the decis boundari go all we need to know is the step of the quantiz denot by delta .
and clearli , if the rang of valu of the input is finit , let's sai between <num> and <num> , then we can make all these step exactli equal .
here's anoth view of the uniform quantiz .
the quantiz level here ar denot by r of i .
and the decis boundari ar shown here , thei're typic close on on side .
and open on the other so the interpret is that all the valu insid thi interv here ar map to r of i .
now suppos we know the distribut of the intens valu of the input imag by comput for exampl the histogram of the imag .
so assum that thi distribut look like thi , so we have mani more valu concentr in thi region than in these region over here .
when we design a quantiz we fix the number of quantiz level .
and we want the error we ar in carri , the quantiz error to be as small as possibl .
so then how shall we design a quantiz in thi case .
shall we make the quantiz step size the same as befor .
shall we design in other word a uniform quantiz .
or , can we do better than thi ?
what doe our intuit tell us about it ?
if we think for a second , we have mani more valu around here than in these region .
and we would like for these valu the quantiz error to be as small as possibl .
sinc we have mani of them and the overal quantiz error is the sum of the quantiz error per region in the quantiz or per bean as it is call .
for the valu that ar in here , again , we want a small quantiz error while we .
with the valu out here , we can allow larger quantiz error .
now , how can we have a small quantiz error ?
we can do that by us a smaller step size , or in other word by do finer .
quantiz here in the middl , where most of the valu ar concentr .
and do coarser quantiz , larger step size , in the region out here .
our intuit is actual correct , becaus as you'll see , the quantiz that give us thi wallac quantiz error , is a non unioni quantiz .
as shown here against small quantiz step size here in the center and larger step size , in , the region where thi probe densiti function ha small volum .
and thi can be mathemat deriv as we'll show right awai .
and again , it confirm our intuit .
but first let's defin the quantiz problem a bit more rigor .
here's the definit of the quantiz q of x .
x is the input to the quantiz a continu number repres the amplitud or intens valu of a sampl or a pixel .
accord to it the valu of x between .
b i minu <num> and b of i , the decis boundari ar repres by the quantiz or reconstruct level y of it .
assum we want to design an m level quantiz .
the varianc of the quantiz error is equal to thi .
insid two consecut boundari , bi minu <num> and b of i which ar refer to as a bin , b i n , the varianc of the error is equal to the error squar .
x , all the valu x ar repres by y over i .
so thi is the error squar , time the probabl that's the function of the random variabl x .
thi is just the definit of the varianc .
sinc i have m level for the quantiz or m bean .
the varianc of the total quantiz error is the sum of the individu bean error varianc sinc the quantiz for bean is done independ .
in the quantiz process , we ar interest in count bean , or in other word , in encod the quantiz level y of i .
these ar the symbol of the sourc , the problem we cover last week .
the bit rate associ with thi quantiz is given by thi express , so l of i is the length of the code word which is us to encod the level y of i .
and thi is multipli with the area under the probabl densiti function curv insid thi beam .
from bi minu on b of i .
so thi is sum over all beam here m and therefor give us the averag code word length .
so formal the optim quantis result from the minim of the varianc of the quantiz error with respect to the decis boundari , the reconstruct level , as well as the binari code , subject to a rate constraint .
or we can deal with the dual problem , which is the dual formul which is the minim of the rate , with request to decis boundari reconstruct level , and binari code , subject to constrain on the allow quantiz error .
we show here again a scalar quantiz with f repres the input signal with continu amplitud valu or intens valu and r of i repres the construct level .
while d of i , r minu on d of i ar the decis boundari .
we will deriv next the solut of the optim quantiz , assum the fix code ar us to repres the construct level .
in other word , we're not optim over the bit rate for repres the quantiz or reconstruct level .
we ar solv therefor a simplifi version of the gener problem we describ in the previou slide .
the problem now it's unconstrain .
so assum that we us fix code to repres the construct level .
we want to design an l level quantiz , so , in other word , we're go to find the d of i's and r of i's so that the varianc of the quantiz error is minim .
so thi is the statement of the design problem of the optim quantiz .
here is the express of the varianc of the quantiz error p of f is the probabl densiti function of the input intens and again , we have l bean or l level and thi is an express we saw earlier .
we want to find the minimum of thi express , thei ar now constrain again now sinc we us fix code to repres the reconstruct level .
the necessari condit for obtain a minimum ar but the partial deriv of thi varianc of the quantiz error with respect to the reconstruct level ar of k is equal to zero , and we have capit l such reconstruct level .
and also , the partial deriv with respect to the decis boundari ar also equal to zero .
we have m plu <num> decis boundari .
howev , the first and last decis boundari ar known and therefor we onli have l minu <num> unknown .
we will find next what these partial deriv ar equal to .
let us first look at the partial deriv of the varianc of the quantiz error with respect to the construct level r of k .
if we look at the express of d , is the sum of those integr .
r of k appear onli in thi integr from dk minu <num> to d of k becaus when f is insid thi interv , then all these valu ar map to r of k .
the differenti oper come insid the integr and then i have r of k minu f squar .
so , the deriv is two time the term , r of k , minu f time the deriv of r of k minu f , which is equal to on , and therefor , i end up with thi express .
so , now if i split the integr into two , that's how thi form look like r of k , clearli is a constant with respect to the integr , which is done with respect to them d of f .
therefor , if i solv for r of k , i end up with thi express .
what thi express is tell me is that the reconstruct level is the centroid of the probabl mass in thi quantiz interv .
we want now to evalu the partial deriv of the varianc of the quantiz error with respect to the decis boundari .
thing becom a bit more complic , simpli becaus the decis bounder appear as the limit of integr .
we need , therefor , a formula to let us know how to carri out thi different and thi formula is due to leibritz .
so , the deriv with respect to a of thi express here , equal the integr here of the partial deriv of the integrand with respect to a , plu the integrand evalu at the upper limit of integr time the deriv of the upper limit with respect to a , minu the integrand evalu at the lower limit of integr time the deriv of , of the lower limit .
we will appli thi formula to find again the partial of the varianc of the quantiz error that i show a few slide earlier .
if we look at that formula we see that there ar two term that depend on d of k .
thi first on where d of k is the upper limit of integr and the next on where d of k is the lower limit of integr .
for valu of f between d of k minu <num> and d of k , thei ar all map or quantiz into r of k .
while when f is between d of k and d k plu on , all of the valu of f ar quantiz into r of k plu on .
if we appli leibnitz's formula to carri out the partial of these two term , what we obtain is thi .
let's work through the first partial deriv here , here's the integr .
if i take the deriv of thi , the partial with respect to d of k , is equal to zero sinc there's no depend d of k so thi first term is go to be zero .
then , i have the integr evalu at d of k , so instead of f here , i would put d of k .
instead of f here , i would put d of k , time the deriv of d of k with respect to d of k right ?
it's a bit of an unfortun notat here .
too mani ds with , you might sai .
minu the integr evalu at dk minu <num> time the deriv of dk minu <num> with respect to dfk which is equal to <num> .
so the deriv of the first term give rise to just on term here .
and similarli , the vari of the second term would give rise to thi second term .
and you can go through the step here in a rather straightforward wai .
we see that p of d of k is a common factor , it's constant , and clearli these deriv ar equal to on and therefor what i'm left with is thi express here .
if i appli the ident a minu b squar equal a minu b time a plu b .
then i obtain is thi express d of k is cancel out , therefor thi is a constant doe not depend on d of k and from the second term i obtain that d of k equal to thi and thi is just the midpoint of two neighbor reconstruct level .
we see now that if the intens of input imag follow a uniform distribut , or in other word , p of f is a constant , then if we us the formula .
that give us the reconstruct level , it's veri straight forward to see that r of k is the midpoint of the two consecut decis level .
and sinc we have that for ani distribut , d of k is the midpoint of the reconstruct level .
we see that , in thi case , the result quantiz is a uniform quantiz .
so thi is a interest result that the optim quantiz , when the pdf is uniform , is the uniform quantiz .
uniform quantiz ar us wide becaus thei're veri easi and straight forward to us .
when we cover the enhanc we call the that it ha a uniform pdf of intens .
an imag with equal histogram , and therefor when we do quantiz , if we given an imag and we perform histogram equal then .
we know that the uniform quantiz we can appli to such an imag is the best possibl on in term of minim the varianc of the quantiz error .
so , here is anoth potenti us of the histogram quantiz techniqu that we cover when we talk about imag enhanc .
if we were to appli uniform quantiz in quantiz sourc with differ distribut , we can obtain the optimum step size by minim the varianc of the quantiz error , with respect to delta , the quantiz step size .
so the step ar shown here , in thi tabl , for differ alphabet size .
that is when the number of quantiz level ar equal to <num> , <num> , <num> , and <num> .
the sigma to nois ratio is shown as well for all these three distribut .
for a uniform distribut of amplitud , a close form express can be obtain for the snr , in term of the quantiz level .
more specif , the snr equal <num> . <num> n , where n is the number of bit to repres the quantiz level .
so here i have m equal <num> to the 1st , equal <num> squar , equal <num> to the 4th .
so see that for m , here , equal <num> i have <num> b , for n equal <num> , i have <num> time <num> .
m equal <num> , m equal <num> .
for the snr , for the gaussian and laplacian distribut , thei ar obtain base on experi .
we see that the best perform is achiev when a uniform quantiz is us for the uniform distribut of the input data , becaus as we saw , a few slide earlier , thi is the optim quantiz .
we show thi tabl , the valu of the decis boundari .
d of i and the construct level r of i for two differ distribut of input data , gaussian and laplacian , as a function of the number of the construct level , four , six , eight .
these result were obtain by us iter the two relationship for the optim max lloyd quantiz that we deriv a few slide ago .
the distribut that have , heavier tail , that is the laplasian have larger outer step size .
if compar thi step size to thi , thi on is larger .
while the same quantiz have smaller inner step size .
so thi on is smaller than thi becaus thei're more heavili pick .
the s and l valu ar also shown .
compar thi sil valu to the tabl in the previou slide where pdf optim uniform quantiz were shown , we'll see that these ar center valu ar consider improv .
thi is to be expect becaus these ar the optim quantiz for these two distribut while the uniform quantiz wa not optim for the gaussian and the laplacian while wa optim for the uniform distribut .
we show here the effect of uniform quantiz on thi eight bit per pixel origin imag .
when an on bit per pixel quantiz is us , here is the result imag .
thi particular quantiz ha thi shape .
the input valu rang from zero to <num> , sinc again , it's an eight bit per pixel imag .
and then , the , valu between <num> and <num> , ar map onto the mid point of thi region , which is equal to <num> .
while the valu from <num> to <num> ar map into the midpoint of thi region , which is equal to <num> .
when two bit per pixel ar us , here is the result quantiz imag .
three bit per pixel and four bit per pixel ar shown here .
clearli , in thi case , we see thi artifici contur effect .
thei're not as visibl when three bit per pixel ar us while for thi four bit per pixel imag it look quit similar to the origin on .
therefor thi uniform requant is a simpl , naiv mayb , mean to .
activ compress in thi last case the compress factor is equal to <num> sinc we go from make bit per pixel to four bit per pixel .
we see demel , the problem i discuss earlier in the cours wa us in gener these result .
we're still go to deriv the optim quantiz , but the step size is small .
we ar perform fine quantiz in the region where the input li with high probabl .
in other word , the probabl densiti function ha larg valu .
instead of do thi , we can make the interv what the input li with high probabl larg .
thi is the idea behind compound quantiz as shown in the globe diagram here .
the idea of the compressor is to stretch the high probabl region close to the origin , and correspondedli compress the low probabl region awai from the origin .
so , thi region here is stretch while thi region here , is compress .
therefor , region close to the origin in the input of the compressor occupi a greater fraction of the total region cover by the compressor .
the output of the compressor is quantiz us the uniform quantiz and the quantiz valu is transform with the us of an expand .
so the overal effect is the same as us a non uniform quantiz .
we clearli encount thi compressor expand map when we cover imag enhanc .
two compand characterist the co , wide us todai ar the so call mu law compand and a law compand .
the compressor and expand function have specif form in thi case .
the mu law is us in north america and japan , and the rest of the world is us the a law characterist .
welcom back .
we discuss last week that we can design more effici code by look at longer block of the data so that we're abl to uncov the structur in the data .
a similar statement can be made when we discuss quantiz .
if the data correl , for exampl .
as we'll see in the motiv exampl when we're quantiz the data repres the height and weight of an individu .
we benefit if we do not quantiz the height and the weight separ , but instead treat the two element as a two dimension vector .
we can therefor , adopt the quantiz to the distribut of the data .
there is no need for exampl to have a reconstruct level for peopl that ar seven feet tall and weigh <num> pound , simpli becaus such peopl do not appear veri often .
we discuss a procedur for design the vector quantiz , similar to the max lloyd procedur we cover in the last segment .
thi is actual refer to as gener lloyd procedur , or lbg , after be the procedur .
vector quantiz have form compress algorithm on their own , but also thei can be us as the middl block of ani compress scheme .
so let us proce with thi interest topic .
we saw earlier when we discuss loss less compress that a lot can be gain in compress data when you consid block of data onc , sinc thi allow us to reveal the structur of the data .
we can do the same with quantiz .
the vector quantiz procedur is shown in thi block diagram .
it is a rather straight forward procedur .
given a on dimension or a two dimension signal , such as an imag , a number of sampl or pixel in a small block ar consid at onc and thei ar group into a vector .
so when we deal with imag we get consid for exampl of two by two or an eight by eight block in which case we have a four by on vector in the first case and a <num> by on vector in the second case .
by the wai in differ context thi two dimension sub block ar also refer to as patch .
then , dure encod a codebook is us , abl to repres well , vector that we encount in imag .
or mayb in ani imag belong to a specif class of imag .
the distanc of the vector to be quantiz to all the vector in the codebook is found .
us for exampl where you creat distanc metric and the on vector in the code book that is closest to the vector to be quantiz is us as the reconstruct valu of the vector .
each vector in the code book ha an index .
and it thi index that is us for decod thi vector , or thi is the index that is sent to the decod .
so if thi is let sai that chosen vector , thi will be the index that will be sent over to the decod .
the code is actual veri straight forward sinc it consist of a look up tabl .
we look for the vector correspond to thi index .
so thi is the index that wa sent over , and therefor thi is the vector that will be pull out to reconstruct the encod vector .
when i deal with imag block , then we need to turn the vector into a block .
and thi repres by thi unblock oper .
clearli the decod ha the ident codebook as the encod for thi to work .
what ar the paramet defin the effici quantiz or the vq .
it is the length of the vector to be quantiz .
as well as the length of the codebook .
how mani entri doe the codebook have .
so for exampl , if we consid patch or block let sai of size n by n and each pixel here is repres by b bit , and if we assum that the length of the code book here is capit l and let's sai capit l is two to the l .
thi mean i need l bit to repres all the entri in the code book , then the effici or the perform of the compress ratio of thi v cube , is simpli n by time n time b , divid by l .
thi could be call the rate also .
so , let us now further motiv the benefit of util vector as a scale for quantiz and then discuss how to design such a codebook .
in motiv the us of a vector quantiz .
suppos we're quantiz a sourc that gener the height and weight of individu .
suppos that the weight vari uniformli between <num> and <num> pound and similarli the height vari uniformli between <num> and <num> inch .
suppos we have six base to repres each pair of volum .
we could us three bit to quantiz the height and three bit to quantiz the weight .
so , the weight is divid into eight equal interv , each of which <num> .
and similarli the height is divid into eight equal interv of width five .
when we look at the present of height and weight separ , as is shown here , thi approach seem to make perfect sens .
but now let's look at thi represent in two dimens .
noth here's chang .
the height still quantiz to the same eight valu and so ar the weight .
howev , we have desol thi space uniformli .
we have quantiz valu for a person who is <num> inch up here and weigh <num> pound .
so thi a six feet eight inch person that weigh <num> pound and similarli .
a person who's <num> inch tall and weight more than <num> pound the person up here .
obvious these output will never be us as is the case for mani other output .
so a more sensibl approach is con , to consid the quantiz that is shown in the next slide .
so here's a view of the vector quantiz .
thi quantiz ha the same number of output point as the quantiz in the previou slide .
howev , the output point across there in the area occupi by the input .
us thi quantiz , we can no longer quantiz the height and weight .
separ we have to consid them as the coordin of a point in two dimens in order to find the closest quantiz autopoint .
so clearli , thi method provid a much finer quantiz of the input .
we see with thi exampl that the structur that wa uncov in the data is that thei ar correl .
howev , the vector quantiz is more effici than the scalar quantiz when the sourc output valu ar not correl .
the reason is that when we look at longer and longer sequenc of sourc output , we have more flexibl in term of design .
we can now match the design of the quantiz to the sourc characterist .
let us look at the toi vq exampl .
here is the codebook that we have design .
it ha four entri and each entri is a two dimension vector .
i is the index correspond to the correspond y of i vector .
here's the signal we would like to quantiz us thi codebook , sinc the vector to the codebook ar two dimension , we ar go to group two sampl of the signal togeth .
so with respect to the first vector <num> , <num> we find it distanc from all four y1 to y4 vector so .
the distanc <num> , <num> from the first vector is <num> minu <num> squar plu <num> minu <num> squar equal to <num> .
the distanc , let's sai from the fourth vector is <num> minu <num> squar plu four minu on squar , on plu nine equal ten .
so if we find the four distanc , we see that the distanc to , vector y1 is the smallest on and therefor thi vector , zero on is go to be repres by , the index on .
we do the same for the second vector to three , and we find that it's closest to the vector y three in the code book , therefor we transmit index three and for the last vector to zero .
we find that it closest to vector y2 , therefor , we'll transmit it index which is equal to <num> .
so now , at decod , we're go to reconstruct the input signal by the vector correspond to indic <num> , <num> , and <num> , or in other word , thi is the decod signal .
and if i find the differ between the origin and decod , thi is the quantiz error .
so , thi is the simpl oper of a vector quantiz .
assum of cours that the codebook ha been design appropri .
and thi is now the topic look into how to effici design an appropri codebook .
the stori when design a vector quantiz , which realli mean design the codebook .
is veri similar to the case of scalar quantiz .
we saw when we start scalar quantiz that we can design a uniform quantiz , but the optim quantiz in term of minim the varianc of the quantiz error is a non uniform quantiz but match the pdf of the data .
that is , we perform fine , fine quantiz for the highli probabl valu of the intens input valu , and forc quantiz for the less probabl on .
when we deriv the max lloyd optim scalar quantiz , we were abl to exactli solv for the decis boundari and the construct level .
now let's look at thi concept when we deal with vq .
let's look at the two dimension vqk sinc it's easier to describ and visual .
we can alwai build the two dimension uniform vq as shown here .
the data have intens valu howev , ha an underli distribut .
we're show the height weight exampl that the data a lie along the diagon , that is the correl .
so in gener we're go to tessel the two dimension plane , non uniformli , as shown here .
actual , we ar not interest in find exactli the boundari here of which partit of which region , but in stead we ar interest in find a repres vector thi on of thi whole region and thi is inde the centroid of thi region .
so dure encod , if y is the centroid of thi region .
and we're given a vector x that would like to quantiz , we simpli find the distanc from thi vector x from all the centroid .
in the end is in the code book and we assign x to the closest ce , centroid .
so , in thi particular case , the construct valu of x is go to be y of i .
so , let us now see how can partit the space , as shown here .
or more specif , how we can find the centroid of these region .
we'll discuss now a vq design techniqu that carri the name of gener lloyd or lbg algorithm , linda buso grai .
we'll start with a set of train imag and also with an initi codebook .
base on thi initi code book we partit the space into cluster .
r of i us thi nearest neighbor condit .
that is all the vector close to y of i , which is on of entri of the code book , form the cluster of r of i .
then , for these form cluster , we find the centroid of these partit .
we then , check and see if the energi with respect to the previou step the energi of the initi distort , the distort ha been reduc below a threshold we stop otherwis we go back to step two .
so at converg we ar go to have a code book of size n thi is a paramet we set ahead of time .
and , we ar go to have thi centroid which will be the entri to thi code book of size n .
some gener comment here is that clearli the imag to be encod should not be in the train set , otherwis we ar cheat a bit .
the natur of the vq is sensit to the initi codebook and the imag be encod .
and then in gener , thi algorithm will result in a local minimum .
and by and larg , there's no global , global ultima codebook design techniqu .
we demonstr here the step of the codebook design algorithm we discuss in the previou slide .
here ar the train sampl , each of these squar repres a two dimension train vector .
we're interest in design four level vector quantiz .
we start with the initi codebook vector .
there four of those .
and we appli the nearest neighbor condit .
so we find the train vector that ar closest to each of the initi codebook vector .
base on that , we obtain thi partit of the space .
so , for each of these partit , let sai thi partit here we ar now go to find the centroid of thi region .
by the wai , if the underlin distribut is uniform then the centroid is just the averag of the vector belong to a partit .
if the pdf is known , then it's taken into account in find the centroid .
so , again , these ar the train vector .
and these ar the new centroid for these four region .
we appli again the nearest neighbor condit .
and we obtain thi partit of the space .
so the initi codebook vector move accord to these vector .
for each of these partit again , such as thi on , we ar go to find the centroid and these ar the four new centroid .
and appli again the nearest neighbor condit .
thi is the result tessel of the space .
these ar the result partit and the initi codebook vector have move accord to the vector indic here .
so we proce take these step until converg .
until the differ of the destruct error rather is below a threshold .
let us look at some simpl vq exampl .
here ar two case , the size of the patch is two by two therefor it's a four by on vector quantiz and the size of the codebook it <num> is case a and <num> in case b .
if you look at the compress ratio for case b , we have again <num> by <num> patch time eight bit per a pixel and i need four bit to repres the <num> differ entri in thi particular case , therefor i have a compress ratio eight to on .
here ar four case where the size of the patch now is four by four , therefor it's a <num> by on vector quantiz .
the size of the codebook vari from <num> down to <num> .
it goe without sai that .
why the size of the patch is constant if the size of the dictionari decreas , the qualiti decreas as well .
so what is the compress ratio for k's f here ?
i have four by four pixel in each vector , time eight bit per pixel , and .
i need five bit to repres the <num> differ entri of the codebook .
so thi is approxim <num> to <num> , the compress ratio .
and final we have two case here where the size of the patch ha , increas .
is an <num> by <num> patch or <num> by <num> vector and the two size of the codebook's ar <num> and <num> vector .
so the compress for case h here is eight by eight the size of the patch time eight bit per pixel and i need seven bit to repres the increas to two to seventh equal <num> .
and therefor thi greater than <num> to on .
so we see that in case h we have actual the largest compress ratio for all case consid and but the qualiti is clearli the last on we see thi annoi block artifact sinc we don't have enough patch to , i'm sorri enough code vector in the code book to describ all possibl variat show in the patch .
hello .
we cover in thi segment some of the simpler imag compress techniqu .
although , on their own , thei do not achiev competit result , as compar to the state of the antagon of standard , such as jpeg , on on hand , thei demonstr mean of achiev compress , but thei're also typic part .
of other compress scheme .
we will spend a bit more time on predict code and , more specif , with the so call dpcm , differenti puls code modul .
we talk about predict last week .
in that case , howev , the predict order wa encod , error free or losslessli .
while now it's best quantifi and then entropi encod .
we will also look at the detail of how , to obtain the predict coeffici , when linear predict ar form .
we will deriv the so call normal equat , that relat the predict coeffici to valu .
of the autocorrel function of the imag , a concept that we introduc when we talk about so , let's proce with thi materi .
subsampl can be consid as a compress techniqu .
by itself it's not competit .
for exampl when compar to transfer base techniqu such as jpeg that we will be cover later thi week .
it is howev an , intermedi step in compress standard , also us for achiev special scalar build .
the idea is rather straightforward .
an imag is subsampl by a factor of two in each dimens , as shown here .
now , we cover subsampl or decim earlier in the cours .
we know that in order to avoid alieci , thei imag should first below filter .
no low pass filter wa appli in thi particular exampl .
so in thi case , if the origin imag is .
m by n .
the result imag is m over <num> by n over <num> , therefor a <num> , to <num> compress ratio is achiev .
there ar , variou wai to perform upsampl sinc we want to , visual the imag at the origin , resolut .
the simplest possibl on is zero order hold or pixel duplic .
us thi , we obtain the , imag shown here .
we perform the same experi , with a factor of four in it's dimens , and here is the result .
in thi case , the compress ratio is <num> to <num> .
after , zero order hold upsampl , we obtain thi imag .
here the , annoi , blot artefact , ar present in thi case .
pcm or puls code modul is a method to digit repres sampl , analog signal , here it's us in , requant the intens valu of an imag .
so , for thi imag , if we appli a <num> bit per pixel uniform quantiz , here is the result we obtain .
thi is actual a result that thei show earlier in , the cours , dure thi week .
now , at low rate .
in order to make the compress artefact less objection , uniform nois , is ad to the data befor the , uniform quantiz .
and thi is refer to , as dither .
so thi is the result , of thi , big uniform quantiz , after , nois wa ad to the imag .
now , sinc the nois is determinist that thi edit by us intention and therefor it's known , it can be subtract after , pcm and here is , the result imag .
the result imag is , multi level not by level as thi , <num> bit imag .
and therefor give a more pleas , appear , an appear , closer in some sens to , the origin imag .
we talk about predict code last week , when we cover lossless compress .
we , revisit the topic here , under the histor name of differenti puls code modul .
dpcm .
the guid principl behind predict code and , dpcm have as follow .
most , us signal ar , highli predict , which mean we can estim futur valu of the signal from , past valu .
and thi past , can be spatial past valu or , spatial tempor past valu .
thi is , possibl becaus the data correl , and therefor thi predict , and more specif the linear predict we'll be discuss here , ha to do someth with the autocorrel of the signal .
someth that we cover earlier in , the cours for exampl when we cover window filter .
the basic principl of dpcm or predict code is that , anyth that can be predict from past valu , can be done so both at the , encod and decod , and therefor what we need to send to the decod is the , unpredict part of the signal , which is just the predict error .
as we will see , .
the predict coeffici , denot by a , will be the result of the solut of thi set of , equat , so call normal equat , that , relat autocorrel valu again to the , the near predict coeffici .
so , let's see the structur of the predictor and , encod decod .
and also , deriv these so call normal equat .
we show here the broad diagram of a dpcm , encod .
x of n is the signal to be , encod is shown here as a on dimension signal .
x cut of n is the predict , valu of the signal at the same , time instanc or the same spatial occas .
the predict is perform by , the predictor here that we'll util past valu of the signal that i'll store in memori .
if we subtract the predict from the , actual valu of the signal we obtain here , the predict error .
if thi were a , lossless compress .
scheme we would send thi predict error to the decod , after entropi encod .
sinc we ar take care about loss compress , thi predict error is quantiz , us a scalar or a vector quantiz , and delta x' n therefor is the quantiz predict error .
thi quantiz predict , error is ad to the predict .
and their sum , form the , reconstruct , valu of the signal .
so these , past reconstruct valu would be store in memori , to be us by the predictor , to obtain the futur , predict valu of the signal .
an interest question here of cours , is why .
should we us the , reconstruct valu of the signal in carri out the predict , and not the , origin valu of the signal , which ar clearli avail at the encod ?
the reason for do so , is that we want both encod and decod to , oper on the same data in carri out the predict .
the decod clearli doe not have , origin data avail , but doe have .
the reconstruct signal avail .
if thi were not the case , like , encod , decod , get out predict , oper on differ amount of data , differ , type of data , origin versu reconstruct .
then , we would have the so call , error drift .
so , we see here , that , the decod is part of the encod , actual the , decod is thi part down here .
and thi is the case , in all , predict encod scheme .
so , what we send to the decod , ar the code quantiz predict .
valu , predict valu .
and here we can us , ani of the variabl length code that we cover last week , such as half on and , arithmet .
in addit , the decod , ha to have , the , predictor inform , or , have the , linear predict coeffici avail .
we can send these coeffici onc , let's sai for the whole imag if a static , predict is perform , or updat thi predict coeffici as we move through the differ part of the imag we try to encod .
we will thi , broad diagram of the , predictor of the , encod when we also talk about video encod .
the predict there would be done in the tempor direct us .
the motion vector .
so , make sure that , the basic concept here is , clear to you , sinc it's a veri , us and import , concept .
here's the , dpcm decod for complet .
we show the decod is part of the .
encod .
so the , binari code word arriv to the the decod , their , variabl length decod , so the code word ar , convert to symbol , so thi is the , predict error .
the , decod ha alreadi construct past valu that ar , store in memori .
and thei're us , by the predictor .
we assum here that , the predictor ha , alreadi obtain the predict , coeffici by the , encod .
so the predict and thi is the , predict signal .
so , predict plu correct here will give rise to the next , reconstruct valu of the signal .
we deriv here the , equat , the so call , normal equat , that allow us that solv for the predict coeffici of a linear predict model .
so let us , x of i denot the origin signal .
our object is to build a predictor f , that would util all past valu of the signal to predict the valu of the signal at , time or locat n , and do it , denot thi predict by p of n .
in , find such a predictor , we , want the , varianc of the predict error to minim .
so x of n is the actual valu , p of n to predict expect valu squar , denot the varianc .
the solut to thi problem in gener , is .
thi , condit expect of x of n given all past valu .
we want to look at the special type of predictor , we want to look at the linear predictor of order n .
so , the predict valu of n is simpli the weight sum .
of , n plu valu of the signal , and the weight here a of i ar the , predict coeffici .
so in find the predictor we have to find the valu of these predict coeffici .
and we find thi predict coeffici by , minim again the , varianc of the predict error which take thi , specif form here .
we just substitut p of n by , the , express of thi linear predictor .
the necessari condit for obtain the minimum , ar that the partial of the varianc of the predict error with respect to the predict coeffici ar equal to <num> .
i show here again , the variant of the predict error for thi , nth step linear predictor .
so , in find the , partial deriv of thi express here , the deriv come insid the expect so , the deriv of thi express squar is <num> time , thi express , time the deriv of , what's insid the parenthesi .
the term , a i prime x of n minu i prime , appear onli onc .
in thi express insid the bracket and the deriv of thi with respect to a i prime is , minu we have a minu here , x of n minu i prime .
so thi is what is shown here .
now if we , cross multipli the term , thi express take thi form .
so you have expect of x of n , time a shift version of x of n , over here and , over here and we recogn thi that thi is the , express the definit of the autocorrel .
function of the signal x .
if the field is , stationari , then the valu of autocorrel is simpli the distanc of the , signal and the shift invent .
so thi on here is the , autocorrel , r of xx , and the distanc between thi and thi version is i minu , i prime .
so , set thi express equal to <num> .
we , obtain , the , express for the normal equat .
we have , capit n equat , and capit n unknown , the predict coeffici .
here's the matrix vector form , of the normal equat .
thi is a n , by n matrix .
thi is , n by <num> vector of the , predict coeffici .
and , clearli thi is also , a n by <num> vector .
so , we see that .
the , diagon ar the same , so along the main diagon is , r of xx at <num> .
thi , subdiagon , thi subdiagnon here r of x , x <num> , and so on .
so there's a symmetr matrix .
and it's a full rum matrix so , i have r of a equal p and r is invert therefor i can solv for the , predict coeffici by invert thi matrix r .
now , question is how can on find the valu .
of , r of xx at differ shift .
clearli , we can us avail data and calcul these valu .
altern , we can assum that , r of xx ha a specif , model shape .
i could us a model for the , autocorrel function .
that he ha set in paramet and i fit the model to the data by estim these paramet , and base on thi model , i can pull out the valu of , the autocorrel at differ shift .
we show here an exampl of the applic of dpcm encod to , the imag shown here .
thi is the form of the , predictor , so the intens valu at thi locat is a linear combin of intens valu at these neighbor locat .
thi particular mask allow for encas compat , if a raster scan is follow .
so , dure encod and decod , the current predict valu .
is found util the reconstruct valu of these three , neighbor path , pixel belong to the path .
in find the valu of these , three predict coeffici , we util the , result we just present .
the normal equat need to be solv , the , autocorrel matrix of the imag need to .
befor .
here is a normal , autocorrel matrix slightli differ than the on i show earlier , it's normal by the varianc of the imag so here is r of <num> , which is equal to the varianc , therefor divid by the varianc is equal to on .
the method to , the eul walker method is us to , obtain the predict coeffici .
here ar the valu , of the result predict coeffici .
so util these , predict coeffici , predict is carri out , and here is how the predict error , look like .
the predict error , ha dynam rang from , minu <num> to <num> .
the origin imag .
is an <num> bit imag , and therefor for displai purpos is map linearli into the <num> to do rang .
so , the grei valu of <num> , repres <num> , then , white repres , error equal to <num> plu <num> and , black pixel .
as expect , the , predictor is do the , nice job in the flat , region of the imag , where the error is <num> .
it's a great valu .
howev , it fail becaus a larg error at the edg of the imag .
thi predict error , is quantiz us max lloyd quantiz , assum laplacian distribut of the error .
<num> , bit , per pixel ar us to , encod the , reconstruct level of the quantiz .
a fix length code , of <num> bit is us for thi reconstruct level .
if we find the entropi .
of the construct level , then it's equal to <num> bit per pixel .
so in principl , if a variabl x code is us then , the result grade could be close to <num> bit per pixel .
so , us thi coeffici to , get a predict , correct the predict by , thi predict error .
we obtain , thi encod imag .
so thi encod imag at <num> bit per pixel , our compress ratio <num> to <num> .
we see that in thi particular case , it look , veri similar to , the origin on .
it mean to , find the qualiti of the encod imag is either to find the mean squar error .
the signal to nois ratio or the peak , signal to nois ratio .
well , in the numer we have , the maximum valu of the imag <num> squar .
thi is a matrix that is us in most case in the , compress , literatur to evalu the qualiti , of the compress imag .
and by and larg a psnr .
around , <num> db and higher is , consid to , repres the , a good qualiti encod imag .
we have seen that there ar predict approach to directli capit on the correl in the spacial domain , and we will also talk about transform which decorrel the data first and the encod the import coeffici .
in thi segment we cover fractal encod which is yet anoth wai to captur the self similar in an imag .
it's actual a mathemat intrigu concept .
we captur the self similar through contract or non expans oper .
then , all we have to send to the decod ar these transform captur thi self similar .
decod consist of an iter reconstruct algorithm , which is not the most desir form of decod .
we will also compar fraction code to vector quantiz , we'll would see that with fraction code eventu code book is us which is not need to be sent to the decod .
so let proce again with thi excit topic .
we will discuss in thi segment the basic idea behind fractal imag compress thei repres inde intrigu idea consider differ from predict encod that we alreadi cover and transfer base encod and subban that we will cover next .
thei're relat to the fractal comput graphic algorithm .
howev , whenev we talk about comput graphic we have thi abstract imag in our head that we try to creat through graphic algorithm .
while when we talk about compress we have the actual data the actual imag base on the .
each we want to pull out the transform as we will see that describ thi fractal compress .
the basic idea is that there ar self similar insid the imag that if exploit appropri , and the similar will be express throught transform as we will see these transform will repres the encod imag .
fractal imag compress relat to vector quantiz , but unlik vq where , a codebook need to be transmit to the decod with fractal encod thi codebook is a virtual on .
thi is the advantag you might sai of fractal over vq , howev , the disadvantag is that .
with fractal decod , an iter algorithm thi would be implement , while for vq , it just a look up tabl .
and iter algorithm by and larg ar computation expens .
so let us look now at the specif detail of fractal encod .
we see here the encod and decod of a fractal codec encod decod structur .
x is the imag we want to encod , the object dure the encod is to uncov thi transform team .
he ha x as it fix point and x is the whole imag or is typic a patch of the imag .
so , if thi patch is process by t , is go to give us back the same patch .
so if thi transform is contract , it mean that he ha a uniqu fix point and thi fix point is the imag .
so , the transform , actual transform suppli to each patch of the imag and cover thi .
self similar , and it is these transform that repres the code of the imag and then send over to the decod .
the decod , after receiv thi transform , perform thi iter reconstruct .
it start from an arbitrari initi condit , and then gener the first estim of the imag as t appli to x zero , the second estim , the second iter that these .
t appli to x1 , which is t appli to t x0 , so it's t squar , x0 .
so again , thi be a contract oper , in the limit of the infinit mani iter , a larg number of iter .
it's converg to the origin imag that we had encod .
so it's realli an intrigu idea but the imag can be repres by thi transform .
but again captur the self similar of the imag and thi transform be contract allow then for the .
iter reconstruct of the imag at the decod .
so , it's a differ concept again , then predict or transfer base compress .
at some point it wa thought that thi would be the approach that would replac all other .
compress approach it's been veri success becaus it ha not led howev to ani specif imag corpor standard .
so , as alreadi mention fractal import or fractal map is base on the assumpt that the redund in the imag can be .
be effici exploit through these self transform .
these tran , self transform ar perform , by the wai , on a block wide basi .
and then thi give rise to thi iter construct of imag .
so given an imag .
we will look at each and everi block in thi imag , block d of i the domain block , and then out of a set of possibl transform we'll find the most appropri t of i transform for thi particular block .
d of i that will make d of i as close as possibl , as similar as possibl to anoth block r of i .
so i see that thi transform , which go to be a concaten of transform will also shift the d of i to anoth locat where r of i is .
and thi also go to sub sampl , decim d of i to obtain r of i .
so the gener idea is given .
the block d of i , we're allow to appli four differ type of transform , and find the most appropri on from these four class .
we're go to result in an r of i as close as possibl to d of i .
and the concaten of thi four class of oper will give rise to t of i .
the overal transform appli to d of i .
now these transform , x of i is a contract oper .
and to see exampl of such consa , contract oper .
i of i is isometri oper .
d of i is the decim oper i just mention .
and p of i is the put oper that would perform the shift of d of i to the locat of r of i .
so , we see exampl of contract oper .
we have a set of them to select from .
isometri , these ar known expans oper .
we'll see exampl of those .
and again the idea is out of the set of x of i's and i of i's .
pick the most appropri on .
and then fi , find p of i , assum we have fix d of i here , that will allow us to find an r of i which is as similar as possibl to d of i .
so thi is the whole idea and therefor the imag is just encod through these t of i oper on the block basi .
let us look at some exampl of contract oper .
befor we do so actual let's defin a contract oper .
so t is contract if tx <num> minu tx <num> the distanc of the norm .
is less equal than alpha that distanc between x1 and x2 .
where alpha is strictli less than <num> . so what thi tell us is that if we have two point , x1 and x2 , two imag , two patch , and these ar transform .
by the same oper t .
so thi is tx1 and thi is tx2 .
the distanc now of the transform imag ha contract .
so tx1 minu tx2 .
so thi distanc here is smaller than the distanc of the origin point .
so with thi definit it's straight forward to confirm that the exampl i've describ here inde repres contract oper .
so , the first exampl is the absorpt of a certain grai level .
so given a pixel x i j is set equal to c .
a specif grai level .
it's absorb by thi grai level .
similarli , the lumin shift is the pixel intens x i j is shift by c .
contrast scale , so x i j is multipli by c .
and color revers .
we encount thi when we talk about enhanc .
it's input , output relat , shape of such transform is describ by a like thi .
so if you recal , it's the neg of , of an imag where black becom white and white becom black .
so we have a set of such transform to select from .
and these ar combin with the other , the isometri , and the shift and the s , downsampl , and select the appropri on we try to map a domain block d of i into a r or i so that the .
differ is as small as possibl .
now instead of try all possibl avail transform for each and everi block , we can classifi the block into , for exampl , three class here , shade block , midrang , and edg block , and then for each class .
onli make avail the most appropri oper out of possibl oper .
let us look at exampl of isometri now .
first of all a , a map t is an isometri when the distanc between tx1 and tx2 .
is less equal than the distanc between x <num> minu x <num> .
so the distanc could decreas after the map .
howev , it could remain the same .
we're not guarante to contract it by a certain factor alpha as in the case of contract map .
i should mention here that both the contract .
and isometri properti depend on the specif norm we ar us .
so , what ar some exampl of isometri .
the first on is the ident .
t's ident , it's do absolut noth on the specif patch .
reflect about the mid vertic axi .
so given a patch like thi , here is the med , mid vertic axi and therefor thi pixel switch place with thi on , thi pixel switch place with thi on .
reflect about the mid horizont axi .
it's easi to see .
reflect about the 1st diagon .
so if thi is the patch , or the block , here is the first diagon , and therefor thi pixel switch place with thi on .
thi switch place with thi on .
thi remain the same .
thi remain the same .
reflect about the 2nd diagon in a similar manner .
rotat around center of block through <num> degre .
so here's the block again and .
here's the center .
so here's <num> degre .
so , we rotat the whole block by <num> degre .
rotat around center through <num> and through minu <num> .
sinc , the rotat here ar .
integ multipl of <num> , we do not need to perform an interpol where i just keep the same pixel as befor thei simpli chang locat .
so here the avail , an exampl of avail isometri and again the idea is .
to combin isometri with contract map out of the list we have avail and find the appropri on so d of i will be map and r of i with the smallest possibl error .
let's now look at similar and differ between vq and fractal encod that we have alreadi allud to .
with vq a specif codebook is util while refract thi codebook is virtual .
in design the codebook in vq , we need to us a set of train imag .
while under the fractal code it just the origin imag you're encod that is util .
and as i alreadi mention , with vq the codebook need to be transmit .
the decod need to have the ident codebook in order to be abl to decod the imag , while under fractal encod thi is not necessari .
so base on thi consider , fractal encod ha an advantag you might sai over vq .
howev , when it come to decod , decod under vq is quit straightforward .
you just us a lookup tabl .
howev , under fractal decod , an iter algorithm need to be util and .
such algorithm ar computation demand and by and larg a , a converg criteria need to be satisfi befor it is termin .
as far as the code book itself goe , under vq , we sent the least of address or indic as we explain that tell us .
which particular code vector wa util for a particular block .
while on the fractal code , we send thi list of transform that would appli to each domain block .
i should mention here that the concaten of a contract , nonexpans map result in a contract map , which is what .
we ar after there to guarante that there's a uniqu fix point when we do a iter reconstruct .
we show here an exampl of fractal encod us thi demo again .
actual the program give you choic of the mean and max size of the rang block .
and then also , a choic of the threshold base on which the rang block is split into addit block .
then , a fix number of bead is us for the shift .
three bead ar us for the isometri .
and as far as the contract map go , the number of bit can be select , but onli , a scale , and offset , i util as , contract map .
and final , the number of iter can be set .
so , we have quit a few choic here and you ar encourag again to us the softwar packag and see these result on your own .
so , the result after the first iter is shown here .
we also see the psmr , <num> db .
what you observ here is that the flat region ar reconstruct first .
and the edg inform is that will appear at later iter , after two iter , here is how the decod imag look like .
so you start see some of the edg inform also come aliv .
and the increas .
after three iter , thi is the decod imag , and after four iter , we see a rather high signal to nois ratio , almost <num> db .
and the imag look veri similar to the origin on .
we do not show here the origin on , but you've seen it multipl time alreadi .
it is inde quit intrigu to think about the fact that we have start with a random imag , mayb a constant black imag or a constant white imag it doe not realli matter what is the initi estim of the decod imag .
it's simpli that all the inform about the origin imag is encod into thi transform and again sinc thi transform .
the concaten of them form a contract map with a uniqu fix point .
and the fix point is the origin imag .
then , we ar guarante to a construct .
of cours the point of the construct is a function of the paramet i alreadi mention .
and of cours of the number of beat that we ar allow to alloc to the valu transform .
welcom back , on wai to acknowledg that there is correl of the data , is to perform a transform which you will decorrel them .
the then transfer coeffici ar uncorrel , and each of them convei uniqu inform about the imag .
some of them convei signific amount of inform as measur for exampl , by their variant or their contribut to the data energi of the imag , while other have contribut close to zero .
the larger on can therefor be ignor , or heavili quantiz when compress is perform .
thi is the topic of the segment .
we first discuss that decomposit of ani imag us an orthonorm base .
thi is a straightforward extens of strateg composit , when we deal with vector .
now , if we place the requir that the result coeffici of thi decomposit ar uncorrel , then we end up with the karhunen rev transform .
thi is the optim transform for our purpos .
but it ha the major disadvantag that it basi ar not fix , but thei ar function of the auto correl of the imag .
that is the differ for each imag where encod , these make the k l transform impract .
and instead the transform of choic is the cosin transform or dct .
which over the simpl experi , the us of the correl transform such as the dct , in decid which part of the data to keep , and which , we discard .
so , let us proce with thi , interest materi .
we cover in thi segment , transform base code , thi is a us and popular approach .
which ha been adopt by most , if not all , imag and video compress standard .
we show here the three build block of ani encod .
as mention multipl time , data ar compress becaus thei're correl .
with predict approach , such as dcpm , thi correl is taken into account directli .
for exampl , we ar solv for the linear predict coeffici , by util valu of the autocorrel function of an imag .
with transform base code , we take the transform of the data , of an imag or an imag block .
the object is , to obtain transform coeffici which ideal ar statist independ .
so , the contribut of each coeffici toward the origin imag isn't depend from the contribut of the remain coeffici .
we then look at the rel import or contribut of these coeffici toward the origin imag .
for those coeffici that contribut more , we treat them gentli , we quantiz them with a fine quantiz .
and for those coeffici that contribut consider less , thei ar quantiz coars or thei're discard .
so , thi is the purpos of the quantiz here , we sai that the quantiz ha a spectral shape .
it's uniform , but the step vari depend on the frequenc of each coeffici .
the quantiz transfer coeffici here , ar entropi encod us ani of the techniqu we cover last week such as huff man and arithmet code .
it is therefor thi bitstream that you send to the decod .
now , the decod is undo the step of the encod , so the binari bitstream is entropi decod , and here the symbol , which ar the quantiz transfer coeffici , ar invers quantiz .
thi is actual a misnom becaus quantiz is an irrevers process .
what it's refer to is to the fact that when quantiz is perform , we divid the number , the valu of the coeffici by the step of the uniform quantiz .
and what descent to the decod there is the caution of thi divis .
therefor , invers quantiz or dequant , refresh of the fact that thi quotient is multipli back by the step of the uniform quantiz , to obtain the actual valu of the coeffici .
and then final , we perform invers transform to obtain the reconstruct imag block .
so , let's look first at the characterist of such transform .
so what ar some of the import characterist of such transform ?
thei should decorrel the date , so in principl the transfer coeffici should be statist independ .
at the same time , thei should perform energi compact which mean the small number of such coeffici should repres the major of the energi in an imag .
the basi that form such transform should be independ of the imag we try to encod .
otherwis , thi basi should , need to be transmit to the decod , to perform the decod .
and final as alwai mayb , we would like to have fast implement of such transform , sinc thei ar clearli part of the coder and the decod .
we show here a comparison of such site sourc format .
what is shown here is the log varianc of each coeffici in the vertic axi and the coeffici number in the horizont axi .
so , the imag broken into sub imag , and then for each sub imag the transform is found .
so , therefor , we have as a result anoth imag with the same number of sub imag .
so , then we'll take the sai , <num> coeffici from each block , and find it's varianc .
we'll take next the coeffici next to it , the same coeffici locat or block , find it's varianc and so on .
then , we order the coeffici , from largest varianc here to smallest varianc , as is clear from thi plot .
the idea is that the coeffici with the larger varianc will contribut more toward the total energi of the imag .
so , a transform that decai faster is a more desir on in the sens that fewer coeffici repres a larger percentag , of the imag .
so , we compar here the so call k l or the karhunen loev transform , which result in statist independ coeffici .
howev , the base in thi case ar function of the imag , more specif of autocorrel function of the imag .
we also show here the perform of the dct , the discret cosin transform , the fourier transform , and the haddernard transform .
in compar the fourier and the transform of the discret cosin transform , a clear distinguish factor is that the fourier transform coeffici ar complex number .
while the dct coeffici ar real number , and we much prefer work with real number than complex on .
so , the dct ha thi , thi distinct advantag of the fulli transform , but more than that the dct is a transform of choic , is us in mani of the imag and video compress standard .
summar what i alreadi said in the previou slide , the kl transform result in statist independ transform coeffici .
howev , the main disadvantag is that the basi function , so klt as a function of the imag that need to be encod .
the dct is the transform of choic , it's close to klt for typic imag and actual the theoret result that show that for a specif model for the imag thi dct and klt coincid .
the basi function , function of cosin , of independ of the imag , therefor do not need to be transmit to the decod .
sinc it's wide us in standard such as jpeg , the famili of h . <num> standard with the compress standard , and the famili of mpeg standard .
thei're also effici implement of the dct .
embed implement ar even dedic chip to perform the discret cosin transform .
befor we proce , let's establish some notat .
assum we have two n by n matric , and here for the segment that denot it like thi , so it the matrix phi , and the matrix gamma .
so , the inner product is form by multipli the correspond element on by on .
so , i'll multipli thi time thi element , and then thi time thi , and then thi time thi and i will add them up .
so , the dot or inner product is clearli a scalar .
sinc in gener i deal with complex matric then , here i take the complex conjug of each and everi element of thi second matrix .
then if i have a famili of matric , thei're parametr by u and v here , these matric , thei're orthonorm if when i take the inner product , it's equal to <num> when u is differ than r , and v is differ than s .
and it's equal to <num> , when u equal r and v equal s .
so , the inner product of a matrix from thi famili of matric with itself is <num> , that where the normal , orthonorm part come from , and the inner product of on matrix with ani other matrix in the famili is equal to <num> .
given a famili of orthonorm matric , phi u v , that we just defin in the previou slide .
then given ani imag f , it can be decompos in term of these basi , these orthonorm matric .
so i can write f as shown here , so thi mean that the imag f is a coeffici here f of <num> time fi , <num> , <num> which is a matrix .
plu f of <num> and then the fi <num> , and so on , all the wai to f , n minu on , n minu on , five , n minu on , n minu on .
so , it's the weight sum , where these ar the weight here , the f's of that base function , these orthonorm matric .
how doe on find the coeffici here , f of u , v ?
we have to perform the project of the imag f , onto each and everi these base fi .
and thi project , thi inner product we defin , will give rise to thi coeffici .
we have seen thi decomposit befor , with vector , not matric .
so we're all familiar with the fact that if i have here an orthonorm basi , so thi is vector e1 , e2 .
and given a vector x , then i project x on to here let's sai thi is alpha <num> , and thi is alpha <num> and we simpli sai that vector x , equal alpha <num> vector e1 , i can put bar here to denot that these ar vector , plu alpha <num> time vector e<num> .
so , thi is the extens of thi decomposit that thei assum you're familiar with when now we have matric and not vector as base .
here is a exampl we have thi imag of a smile face and as base we us hadamard base .
i will sai a few more thing later on , by project thi imag of the smilei face into each and everi of the basi , we have obtain thi result coeffici .
onli four of those ar shown , and therefor , again , i can decompos thi imag as the weight sum of these base , function and these other correspond weight .
so , the main idea is that if these base ar known , the hadamard base to both encod and decod , all i need to send to the decod ar these project coeffici .
and the decod util these coeffici can reconstruct the imag , just us these express shown here .
i'm go to mention here the kl transform for complet .
our object is to find the famili of orthonorm basi , i call them fi uv , so that the result coeffici , capit fuv , that thei're obtain by project the imag on to thi orthonorm basi , ar uncorrel .
so accord to the kl theorem , if i have such an imag f of an m and r m n p u , p q , is it autocorrel function , then i can find thi famili of orthonorm matric that will result in uncorrel coeffici , by solv thi equat .
what thi equat tell us is that thi orthonorm base , ar the argent function of the autocorrel function .
and thi delta u v it's simpli the expect valu of the magnitud of the coeffici , the of the coeffici squar .
so , we have a specif procedur in obtain these orthonorm matric we ar after , howev , thei depend on the other correl of the imag .
and also i can comput thi vice at the encod , the decod here ha no wai of perform the same comput , therefor these need to be sent to the decod .
so , it is a mathemat optim transfer for our purpos , howev it is not a practic on , becaus if i have to send the basi , thi defeat the purpos of compress .
in the class teach here at northwestern , i prove all these relationship howev , that clearli beyond the scope of thi particular class .
we see here that <num> , <num> by <num> base , function of the discret cosin transform , here is the interpret of the color .
so , in thi first row , we're have on dimension cosign that increas in frequenc horizont .
so , vertic here it's constant and in thi column , we have a on dimension cosign that increas in frequenc vertic .
for the rest of the basi we have a two dimension cosin , whose frequenc increas both horizont and vertic .
and down here the basi with the highest frequenc in two dimens .
i show exactli thi same plot back in week two , when we talk about complex exponenti signal .
and i did make the comment at that point that we'll be encount these basi function when we talk about compress , and now is the time to do so .
so , as i have explain alreadi , given an <num> by <num> imag block or imag patch , we , just find it's project to all these <num> base , and if for exampl , if i find the project or the inner product be , between thi base and the <num> by <num> pouch , a number will result which will be denot by fuv , and thi is the coeffici .
clearli , the project of the patch into thi here basi , it's black , so all it's valu ar equal to on , will give us the sum of the intens here .
if i divid by <num> will give us the averag of the patch .
so , instead of have <num> intens valu here , i have <num> such coeffici , thi by the wai ar real , we're go to talk about the dct transform .
the advantag of work with the fuv's instead of the fmn , as we denot earlier is that now if somebodi ask us to keep , let's sai , <num> of the pixel valu which ar more import , we have no wai of know which <num> of the <num> pixel valu ar more import than other .
howev , when we look at the dct coeffici , is rather straightforward to keep the , the si , the <num> per , <num> of the <num> that have the largest valu , these coeffici , again , ar , in principl , uncorrel .
and therefor , keep the on with the largest valu , we will do a veri good job in repres the origin patch and also in preserv most of the energi in the origin patch .
here we show the <num> , <num> by <num> hadamard basi function , here's that in the partit of the color , onli two valu plu and minu <num> .
so it's a similar descript as with dct , i should mention that with both case thi base is ar o for normal or in other word the inner product of thi with thi is zero .
thi with ani other .
is <num> but with itself is equal to <num> if it's normal appropri .
so , the stori's the same given an <num> by <num> imag patch it can find the project so do thi basi and these ar the hadamard transfer coeffici , which again ar less correl than the origin imag and therefor can serv our purpos thi for compress the imag .
in order to demonstr experiment the effect , the power , of thi decorrel properti of the transform , we conduct here a veri simpl experi .
given thi imag , we ar ask to break it into <num> by <num> block , and then out of each of these block , we ar allow to keep onli eight pixel or eight coeffici , and we're suppos to throw the rest of them awai .
so , try to decid in the special domain here which eight out of <num> coeffici ar more import is veri difficult , i have no mean of , of do it .
howev , if we go to the frequenc domain , we can keep per block the eight larger , largest coeffici .
and if we do so , by defin a threshold and keep onli eight out of the <num> per block that ar abov the threshold .
right , we adjust the threshold so onli eight ar abov the threshold .
here is a reconstruct imag , so we keep eight and set the rest equal to zero .
we see here that thi is veri close the origin on , we do the same experi .
when now the locat of the eight coeffici ar base on thi .
zonal descript , so if thi is an <num> by <num> block in the discret cosin domain , then we keep the <num> coeffici rather closest to the dc .
so the eight low frequenc coeffici , clearli threshold by and larg should give better result than the zonal approxim simpli becaus there might be a larg valu coeffici down here , larger than ani of the on that thei kept here , that i have neglect .
howev , when threshold is us , i have an addit to the coeffici transmit their locat , .
so spend for , for the locat while thi locat inform is fix here , when there's anoth approxim is us .
so if i look at the differ between the origin and the encod version , here is the differ scale appropri .
and , what you can see is that the differ is realli .
larg at the edg becaus the edg repres high frequenc inform , which wa discard in thi particular case .
we conduct the same experi with now onli <num> coeffici out of .
of <num> ar kept , and here is the result of threshold in , zonal , in thi case the same comment can be made as befor , but i believ that it's clearer here that the zonal approxim result in a larger error if we look at the intens , the error time the method us threshold .
and again , it's the same experi when we ar now onli two out of <num> coeffici ar kept and i believ it's quit impress that .
even though two out of <num> coeffici ar kept still we obtain the contract here that convei quit a lot of inform about the origin imag .
you start see these plot dark effect clearli but nevertheless these again imag ar .
convei quit a bit of inform about the origin imag and here , i believ , the error is much more pronounc with a zonal approxim than on us threshold .
so , thi is the basic idea behind transform base encod .
and as you see , next we're go to discuss jpeg .
these ar exactli the step taken by jpeg or ani transfer base encod scheme by and larg .
the differ is how to perform quantiz , how to decid which coeffici to keep and which to throw awai .
but more specif , how we decid how to encod each and everi coeffici with a fine or here these ar simpl idea to just demonstr the effect of the correl but again while the innov of the novelti come in is in the wai as .
it will see , of quantiz these , quantiz as well as enter pin code , these result thi is the coeffici .
welcom back .
in thi segment , we will look into some of the detail of jpeg .
jpeg ha been a veri success standard establish over <num> year ago in <num> .
it ha prolifer wide .
it can be found , for exampl , in almost everi digit camera .
the acquir imag is jpeg by default by the , on of the camera electron .
and the high end camera allow access to raw data .
jpeg like ani compress scheme consist of three basic build block .
the first on perform redund reduct .
the second on perform quantiz , and the third on , entropi encod .
thi idea is us for transform each and everi eight by eight block of the imag .
quantiz is perform by us uniform quantiz .
with differ step size base on the frequenc locat of the coeffici .
so in gener , fine uniform quantiz ar us for the low frequenc , and coars quantiz for the high frequenc .
the part which is terribl innov in jpeg is the applic of entropi encod .
the dc and ac coeffici ar encod differ .
differenti encod is util for the dc coeffici by find the differ of the dc in the current block from that in the neighbor block .
for the entropi encod of the ac coeffici , the block is first vector by zig zag scan .
and then , sinc , after quantiz we have a number of zero coeffici , the run of the zero preced the valu to be encod is encod , follow by the valu of the coeffici .
it is realli a great demonstr of how the sourc sampl can be modifi befor entropi encod .
so , let us proce with the coverag of thi success standard .
in thi segment , we will discuss the jpeg compress standard .
it stand for joint photograph expert group .
so jpeg is a work group which wa form in <num> by iso and ccitt .
it becam a intern standard , jpeg , in <num> , more than <num> year ago .
it cover compress ratio <num> to <num> , or result bit per pixel <num> to <num> .
the object of jpeg is the digit compress and code of continu tone still imag , both grayscal and color .
it's clearli a highli prolifer standard .
it can be found , for exampl , in ani digit camera .
the jpeg encod actual take place on the camera , and it's probabl an option of not jpeg ing the imag , onli for high end camera .
we saw that each and everi compress scheme ha three build block .
so , it's a transform base , approach .
but we discuss in the previou segment that the transform us is the dct .
we see how quantiz is done in jpeg .
and , more importantli , we'll see the invent wai that ar appli toward entropi encod .
the imag to be encod is first divid into <num> by <num> block .
the block ar zero shift , so thei rang from minu <num> to <num> , for an <num> bit per pixel imag .
then the discret cosin transform is taken of each and everi block .
so here ar the dct coeffici .
the zero zero coeffici is refer to as the dc coeffici , while the rest ar refer to as ac coeffici from direct current and altern current .
so , in thi direct , the horizont frequenc increas , while in thi direct the vertic frequenc increas .
after the dct coeffici ar quantiz , thei're zig zag scan .
the reason for that is to convert the two dimension <num> by <num> arrai into an on dimension <num> by <num> vector .
and the reason for that is that we want to gener long run of zero that will be util dure entropi code .
so the idea of zig zag scan is to visit the , visit the coeffici along thi path here , in the orbit indic by thi .
so the dc coeffici goe first , then thi coeffici is the second on .
the third , fourth , fifth , sixth , and so on .
entropi encod in jpeg is perform in a veri invent , i would even sai , ingeni wai , and provid a lot of the power , the compress power for the standard .
the dc coeffici ar encod differ from the ac coeffici .
when come to the dc coeffici , thei're encod differenti from the dc coeffici in the neighbor block .
the main idea clearli is that neighbor block with have similar dc coeffici and therefor the differ is go to be a small number .
thi differ is encod by the size first .
so there is a tabl here that encod the differ size is shown here .
by code of differ length , and here ar the actual code word .
these ar huffman code that ar built on , on the valu size .
so , for size <num> , we us a <num> length code , and thi is the specif code .
after that , the amplitud itself is sent .
so , if we look at the second tabl .
size <num> encod thi for differ amplitud .
so thi is the code for <num> , the code for <num> , and the code for minu <num> , and minu <num> .
when it come to the encod of the ac coeffici , the first zig zag scan as wa explain in the previou slide .
and then each non zero coeffici is first call in as run follow by size .
so there is yet anoth tabl .
tabl three , that provid the huffman code for thi combin of run of zero follow by size .
so , here's a run of <num> , <num>'s follow by size <num> , the length of thi code is <num> , and thi is the actual code word .
then , base on thi size here , part of thi code word will go back to tabl two and encod the amplitud valu .
so , here is anoth great exampl that when we perform huffman encod , we don't have to util the origin symbol of the sourc , the , these ar the coeffici themselv .
but we invent new symbol for the dc again coeffici .
it's differenti encod , and then we need the two code word of size follow by amplitud .
while for the ac coeffici , after the zigzag scan , we're look for run of zero , follow by the size , follow by the amplitud .
let us now walk through a jpeg encod exampl .
here is the imag , we'd like to jpeg .
so we divid it into block , and to look specif at thi block over here .
and these ar the valu in thi block .
the dct of thi block is comput , and here ar the actual dct valu .
the dct coeffici ar quantiz .
the wai quantiz is done in jpeg is shown here .
so , there ar quantiz tabl like the on shown here .
what these number indic is the step of a uniform quantiz that is appli to thi particular frequenc .
so , we see by enlarg that fine quantiz is appli to lower frequenc , smaller quantiz step size .
while coars quantiz is appli to the high frequenc coeffici .
so then , the wai quantiz is done , is to find the ratio between the coeffici and the correspond entri in thi quantiz tabl , and perform the round oper .
so for exampl , if we look at thi coeffici , the step size of the uniform quantiz correspond to that figur's locat is <num> .
so <num> divid by <num> , take the round oper will result in a <num> .
similarli , if we quantiz thi coeffici , minu <num> is divid by <num> and the quantiz valu is <num> .
so we see that again , thi tabl ha spectral shape , a lot of work ha gone into design such tabl .
quantiz tabl by also take into account properti of the human visual system .
so look at the quantiz , valu what we see is that there ar now a good number of <num>'s .
and thi is the motiv that we want to zigzag scan these coeffici , and then encod them by look at run of zero .
the other comment i would like to make here is that what's sent to the decod ar these valu .
and therefor dure the construct , thi valu need to be multipli by the correspond step size to give us the reconstruct valu of the dct coeffici .
after quantiz , the dct coeffici ar vector or zigzag scan to form thi on dimension arrai .
then thi on dimension vector will be input to the huffman encod step .
the dc coeffici is entropi encod first .
so , the coeffici is <num> , then thi oper is perform due to the fact that the mean wa subtract by , from the block .
and therefor the valu of thi dc coeffici is minu <num> .
if we assum that the valu of the previou dc coeffici wa minu <num> .
the differ is go to give us the valu of <num> .
so we need to encod thi differ of <num> .
we look at tabl t1 and see that <num> is here in size <num> and the codeword for size <num> is <num> .
then , we need to encod the actual valu of <num> , the amplitud .
so , if we look at tabl two , eight is repres by thi codeword , and therefor thi is the code , the codeword that would be sent to the decod to repres the differenti encod dc coeffici .
regard the encod of the ac coeffici , let us assum we want to encod thi coeffici of valu <num> .
if thi wa befor quantiz , first it would be quantiz .
so the quantiz is <num> .
therefor , the valu is <num> .
we look at the run of zero , and there ar no preced zero .
therefor the size is <num> , becaus <num> divid by <num> is equal to <num> .
so we go to tabl t3 and look for run , size , codeword .
so run <num> , size <num> thi is the actual codeword from tabl t3 .
then for size <num> , we go to tabl t<num> , and you see that the codeword for <num> is <num> , therefor , thi particular valu <num> is repres by the codeword <num> , <num> .
after entropi decod and invers quantiz , the invers dct is obtain .
so for thi particular block , here ar the valu of the invers dct that bring us back to the spatial domain .
then the imag is assembl from these <num> by <num> block , so thi particular <num> by <num> block is place back to it locat in the imag .
and for thi particular block the compress error is shown here , that we hear the exact valu and here's a compress error for the whole imag .
as expect the error is concentr at the edg , at the area of high spatial activ , becaus if you think of a whole process the high frequenc that ar coars quantiz .
and therefor thrown awai thi inform at high frequenc and therefor the arrow is go to have thi high frequenc appear .
here ar some gener observ regard the perform of jpeg .
the perform is a function of the special resolut of the imag , so when you consid here a small format cga <num> by <num> .
then , compress ratio at half a bit per pixel produc poor qualiti result .
but if the resolut increas to vga , the qualiti becom fair .
and for super vga the perform becom good .
similar observ can be made for the other bit rate <num> bit per pixel .
good , excel , excel .
thi is actual a three circumst that peopl could plai at time , thei would propos a compress algorithm test at higher resolut imag .
such high resolut imag have consider more correl data , and therefor more can be gain dure compress , or we can compress the data more .
the perceptu lossless result ar obtain at bit rate on and a half to <num> bit per pixel .
we show here some result us jpeg at variou bit rate .
so , cameraman at on and a half bit per pixel .
we see no distort , it seem veri , veri close to the origin imag .
at on bit per pixel , the qualiti is still veri good .
you start see some artifact around the edg , here .
at half a bit per pixel , then , these ring type of artifact ar quit pronounc , and also you see block artifact in the smooth region of the imag .
and if we go further down to <num> bit per pixel , then you see plenti of thi contour , the artifici contour and the edg ar all distort .
howev it's still impress that with onli <num> bit per pixel on the averag we see , we have some good idea of what is in the pictur .
there's quit a bit of work in the literatur , actual , as i mention when we cover recoveri , in remov these blot arifact .
there's a recoveri problem .
and for the post process step after jpeg or ani compress approach for that matter , we tri to remov some of the artifact that were introduc due to compress and therefor improv the visual qualiti of the imag .
for thi exampl , a standard quantiz tabl wa us like the on i show earlier .
on could modifi that tabl and us a flat tabl for exampl .
or us a tabl that would perform fine quantiz at high frequenc and coars quantiz at low frequenc .
you can experi with all these thing us , for exampl , the vcdemo softwar packag .
we can repres ani signal , such as imag , in the frequenc domain .
then , we can perceiv the segment in thi frequenc domain , the so call sub band , and examin the behavior of the signal in each of these sub band .
the characterist of an imag differ in each sub band .
some ar low frequenc sub band , band , some ar high frequenc in on dimens .
and low in the other , and so on .
then , the main idea in sub encod is that we can now adapt the compress scheme to each sub band .
thi mean that differ paramet can be util for the same encod , or that a complet differ decod can be us in each sub band .
therefor , there ar a larg number of possibl .
on of the issu , of cours , is to design appropri filter that would allow us to perform thi sub band decomposit .
filter that would allow perfect reconstruct of the signal .
we discuss and analyz all these concept in thi segment .
so let's have a specif look .
the idea of sub band code is quit interest and intrigu .
so we first us a bank of filter to divid the imag into sub band .
and each sub band contain a set of spatial frequenc .
so each sub band ha reduc bandwidth , with respect to the origin imag .
if the sub band ar of equal size then we're talk about equal rate sub band decomposit .
if , on the other hand , thei have differ bandwidth then we're refer to as multir decomposit .
the main idea from thi decomposit is now , we can exploit the properti of each band .
and us a differ compress scheme to compress the variou band .
so differ bitrat or differ code techniqu can be us for each sub band , by take advantag of the properti of each sub band , and also by allow for error to be distribut across sub band in a visual optim manner .
so thi is a celebr approach that ha found applic both in still imag compress as well in video compress .
as well as in speech and audio compress .
some of the most success audio compress standard ar base on sub band decomposit .
so the principl of sub band decomposit is demonstr here .
we show it for a on dimension signal , but also show it to the signal in a few slide later .
so , we have the analysi filter bank and the synthesi filter bank .
so , we see that the origin sig , signal is input here .
then , we us a band pass filter <num> to band pass filter m minu <num> .
after filter , the signal is decim , down sampl by a factor of capit m .
we assum again we have m such sub band .
and after thi decim , we'll call these sub band separ , us a differ encod per sub band .
the compress signal is either transmit or store to import applic in imag and video compress .
at the other end , the decod .
we have the synthesi bank of filter .
so each sub band is decod separ .
then , it's up sampl by a factor of m .
and then it's band pass filter and all the sub band ar ad to give an estim of the origin signal .
these ar oper that should make perfect sens to you at thi point , becaus we cover them earlier in class .
we saw what happen if we , we down sampl is the spectra overlap .
we have the problem of alias .
that's why we first low pass filter or band pass filter befor we down sampl to avoid alias .
on the other hand , when we up sampl , we introduc m zero in between the sampl .
and then we us a band pass filter to extract on replica of the spectrum .
becaus what happen , in the frequenc domain , i have replica of the spectrum , through thi introduct of zero .
and through thi band pass filter , i pull out on replica , and i pull the signal in the origin resolut .
here is the block diagram of a two channel sub band decomposit .
and have thi actual a two channel i can then cascad it and end up with multi band as well as multi dimension signal sub band decomposit .
so , we see the h1 , h0 filter here .
the h0 is a low pass filter , h1 is a high pass filter .
so , the summat by a factor of two , encod , up sampl by a factor of two , and here ar the up sampl filter , f1 , f0 .
conceptu , the up sampl filter ar , ar , ar undo what the down sampl filter did , you might sai .
and there is a lot of work on how to design these filter h0 , h1 , f0 , f1 , so that in the absenc of compress , i have perfect reconstruct .
we don't have per , perfect filter , if we implement the spatial domain thei have a pass band , a transit band and a stop band .
and there , for exampl the quadratur mirror filter that give you perfect reconstruct is a topic that ha seen a lot of activ .
in signal process and there ar quit a lot of result that on can util .
so thi is what is done in practic when , with two band decomposit system i want to build a multipl sub band decomposit system .
so , i start again , i show thi on dimension signal , you break it into the low frequenc band and the high frequenc band .
so x , x of omega .
if it's shift by pi  it give me , if the first on's a low pass filter it result in a high pass filter .
so downsampl take place here , and now i will take the low band or the low frequenc band and split it also in it low frequenc and high frequenc compon .
i can take thi low frequenc band , and fur , further split it into two .
i can take thi high frequenc and further split it into two .
so , in thi particular exampl , i end up with two , four , six , eight differ sub band , and thei have the name of , of thi essenc .
so thi is the lll band , it , onli low pass filter were appli to thi on to , to obtain thi band .
while thi on , if the first filter's low pass the second is low pass but the third on is high pass .
so pretti much we have all eight combin of these differ letter .
and the last on is hhh .
so the , the , the filter wa filter three time by how , high pass filter to give us thi band .
and thi band is here , the highest frequenc band .
the first band is down here , the lowest frequenc , and so on and so forth .
so , again , have on good pair of decomposit , i can cascad it thi wai , and i end up in an equal rate as shown here .
obtain as mani band as i want in thi multiband decomposit system .
and sinc thi pair ha also it reconstruct , perfect reconstruct pair , i can also go from thi eight band decomposit here , for exampl , to perfect reconstruct us the pair that i start with .
here's the pictur of sub band decomposit in two dimens .
if i have a filter that can break the frequenc spectrum of a signal into four band , so it's a four band split decomposit , here .
then , i can us that in a cascad to obtain as mani band as need .
so , in thi particular exampl here , you have a four band split .
and thi is the four band split .
thi is the ll , band and then lh is , is here , right ?
becaus it's center at zero you can do the period extens and see how these band look like .
and then we have the hl band and the hh band .
so in the first pass i split the imag into four band .
and then , for exampl , i can take the low frequenc band and split it into four addit band .
so that's how the pictur's go to look in the frequenc domain .
here ar the four origin band and then the low frequenc band wa split into four addit on .
so thi is actual an exampl of multir sub band decomposit .
becaus the band ar not all of the same size or of the same rate .
and in practic , that's how we obtain sub band , either equal rate or multir , just us on pair .
either two filter for a on dimension signal or four filter ar shown here for the two dimension signal .
here's on exampl of the us of sub band decomposit .
all these exampl again were us gener us dc demo .
the origin imag is shown here , again .
and thi is a four band decomposit us <num> tap filter , so the number of tap is the number of sampl in the impuls's filter .
so you see here the four sub band , the low , low sub band is just a decim version of the origin imag .
it wa just low pass filter .
thi is the , these ar the low h and hl band , so thei show the high frequenc in the horizont and the vertic direct .
and thi is the hh band , which show the high frequenc in both direct .
by and larg you see some structur of cours in the low frequenc band , and then .
in the lh and hl band and the hh band , by and larg , look like white nois , doesn't have much structur in it .
so for these four band , for the first on the ll dpcm wa us to encod the coeffici .
and we talk about dpcm , it's clear what we ar do here .
it's differenti pass code modul , so a predict model wa built to predict and then correct the intens valu of the low , low band .
now for the other band , the combin of high and low frequenc and high , high band , pcm wa us .
so , no transform wa done , but just reduc the number of bit repres the sampl .
and the rate wa <num> bit per pixel .
so here is the result encod imag .
the psnr is <num> db , so it's definit of high qualiti .
as i mention , anyth abov <num> db repres a veri close represent of the construct imag , veri close to the origin on .
here's a second exampl of the applic of multir , now , sub band decomposit .
the origin imag .
so it's split first into four sub band .
and then for the low sub band we further subdivid it into four sub band .
so it's certainli multir , it's a seven band decomposit , and also <num> , i'm sorri <num> tap filter were us for thi decomposit .
then here ar the quantiz sub band , the first sub band , the low , low dpcm wa us for that .
and for the rest , pcm at <num> bit per pixel .
and we see here the encod on is of similar qualiti , slightli higher , higher qualiti than the previou on for a veri similar bit rate .
but certainli there is more comput that is involv when you go to more than four sub band .
here we have again seven sub band decomposit .
so we have reach the end of week nine .
three more week to go .
<num> of the cours is over .
congratul to all of you .
you should realli feel proud about your accomplish .
dure thi week , the second week out of three dedic to compress , we talk about lossi imag compress .
thi is a veri import topic , sinc we ar surround by a plethora of applic depend on imag compress .
we discuss and analyz the fundament topic , and cover some of the intellectu interest and practic us techniqu .
we talk about the import concept of quantiz , both scalar and vector , and cover dpcm , fractal encod , transform encod and jpg and final we briefli cover sub band encod .
predict and transform of the data ar two veri fundament and import topic encount everywher in signal process .
we present an encod in term of three import build block , and tri to point out the differ and similar of all techniqu we describ .
there wa noth terribl mathemat in the materi of thi week , except mayb for the materi on fractal encod and the deriv of the optim quantiz .
so , i hope everybodi feel comfort with thi materi .
the materi , i believ , allow you to understand the imag compress technolog around you , us it , and also be abl to potenti take the next step in push the envelop , and develop the next imag compress techniqu .
next week , we'll talk about the system problem of im , imag compress , that of video compress .
so , see you all next week .
welcom to week ten .
thi is the begin of the third and last week cover in thi excit topic of imag and video compress .
base on the materi we cover dure the first two week , everyth should make perfect sens by now .
when come to video , we first still need to either perform a predict , or the decorrel the data , or do both .
then quantiz take place and final entropi encod .
the domin approach in video compress is to first perform tempor predict through motion .
the estim motion , a topic we cover in week four , is us to carri out thi tempor predict .
thi result in the so call hybrid motion compens video encod .
we will , we will describ thi in detail in thi first segment .
thi hybrid motion compens we're do encod is the scheme of choic for all video compress standard .
so after we understand thi model , we have realli understood all video compress standard .
howev , although there ar major similar among standard , there ar also import differ that allow the next gener video compress standard to achiev the same qualiti with the previou gener on at half the bitrat .
we will see whether the factor contribut to thi improv in perform .
so , with thi is mind , let us proce with the last week on compress .
we will talk thi week about video compress .
we see here the block diagram that appli to ani data compress system .
i show the same diagram last week when i talk about imag compress .
i show it again to exactli make the point that no matter what data we're compress , imag , video , speech and so on , these same three block appli .
so with the first block the redund is remov .
entropi is reduc by the second block and lossless code is the last block insid the system .
as we saw from last week for redund to move over to domin approach us of a predictor and or a transfer .
thi week we'll see that inde we us both , we us a tempor predictor and we're go to us a special conform of the predict error .
requant is us for entropi reduct .
and final for lossless code on can pick from the number of approach we have cover in back in week eight .
on could us huffman lzw or arithmet encod .
so , although we cover each and everi of these element here , we talk about predict , transform , requant , as well as lossless code .
we will see next how , all these thing ar combin when we try to compress video .
the outlin of the materi we cover thi week here is as follow .
we will briefli describ some applic which requir and benefit from video compress .
then we'll describ in some detail the oper of the hybrid motion compens video encod and decod .
it repres the domin approach toward video encod , and it's adopt by all video compress standard , which you will also discuss .
as alreadi mention , video compress is the enabl technolog behind the multimedia revolut we're experienc .
it is necessari for a number of applic where digit video is acquir , store , and transmit .
some exampl ar shown here .
it is need for video content acquisit and edit .
for store thi style video , in dvd or blu rai disc .
broadcast tv signal over either satellit , cabl , or terrestri transmiss system .
for send video over mobil and internet network , wire and wireless .
for real time convers applic such as video chat , video confer and telepres system , secur applic where leader acquir start compress as made it .
and the more recent applic where we want to captur , displai , and transmit stereo and multi view video , in gener .
we show here the block diagram of the hybrid motion compens video encod .
as we'll see in detail , it's a predict system .
some of you actual might have alreadi recogn it .
like the on we discuss in week eight , when we cover lossless compress .
and the dpcm system we discuss last week .
we'll see it perform redund reduct by both tempor predict and the us of a transfer .
thi is the actual appli on the unpredict part of the predict the so call displac frame differ .
actual if the oper of thi system becom crystal clear to you then we ar done with video compress at least at the conceptu level .
onli the fine detail will need to be work out .
so let us work through thi system .
the video frame to be encod arriv at the input of the system .
assum for the time be that we have a mechan to predict the current frame from the past alreadi encod frame , and here's the predict .
we then form the differ and thi is the unpredict part of the predictor , the predict error .
thi error is also call the spacial indiffer which ha a good number of zero or small valu when the predict is good .
these ar the grei valu in the imag , and is typic nonzero when the predict , which is base on motion as we will see , fail .
as we discuss a coupl of time in the previou week , thi is the signal the imag , which repres the unpredict part of the predictor , and that need to be sent to the decod .
sai that there ar still correl in thi imag in process it will follow the step of transform pose that we discuss last week .
first lead imag for instanc with jpg .
so the dct is taken .
and the dct valu ar quantiz .
and then these dct valu ar enter encod over here and ar sent to the decod or to the channel .
now let's look at thi other here we have the predict frame come in thi direct .
and from thi direct here we have the quantiz dct coeffici of the predict error .
after invers quantiz which mean again that we multipl valu by the step size of the quantiz and inverset here we have the error in the spatial domain .
so predict plu correct result in the construct frame current frame .
the onli piec left is to see how predict is done .
well , predict is done through motion , or the motion vector , or the motion field .
the underli assumpt here is that we ar co , we ar encod the dynam scene .
and the object can be track over time or that you can find out where each and everi pixel went when go from on frame to the next .
we cover motion estim in detail dure week <num> .
you could probabl go back and have if you can review the materi .
we saw , then , that we can onli estim the optic flow , which , howev , give us most , in most case a good estim of the motion in the scene .
and actual , what we estim is the two dimension project of the scene on the camera plane .
we also discuss that the underli assumpt with commonli us estim algorithm motion estim algorithm , be block base or region base match or optic flow base is that the bright in the scene remain the , remain the same .
that's the constant bright constraint .
and that the object ar rigid .
so on can us the favorit algorithm to perform motion estim .
in do so we need at least two frame .
the current frame come in thi direct and the previous reconstruct frame that come from thi direct .
the estim motion will be us to carri out the predict of the current frame from the previous in time reconstruct frame .
thi is refer to , typic , as motion compens .
instead of motion predict , sinc the motion vector face backward in time , instead of forward in time .
so , in other word , we're not ask the question where a block in the previou frame end up in the current frame , but instead , we're ask the question , where did a block in the current frame come from in the previou frame .
the predict question would not result in a practic system sinc it would have multipl predict for some pixel in the current frame and zero for other .
i have ask thi question befor and i'm ask it now again why don't to us the origin car in then previou frame to carri out motion estim compens sinc then call the ha the origin frame avail .
actual i can not tell how mani of you know the answer but hopefulli quit a few .
the answer is that the decod doe not have the origin frame , and therefor if we were to us the origin frame for motion compens at the encod , encod and decod would be us differ data to carri out motion compens and therefor the result would , would differ .
and thi would result in what's refer to as error drift .
of cours motion estim is onli take place in the encod so it would estim the motion us the origin frame .
but then sinc the predict is now us the reconstruct frame that would not make sens either .
in other word we would be minim the predict error between region frame but then the actual predict error could be differ .
larger , most probabl , sinc we ar predict from the reconstruct frame .
so as in all predict model , the paramet of the model need to be sent to the decod , and these paramet ar the motion vector .
so the motion vector ar entropi encod .
thei're not quantiz , clearli .
and thread to the bit stream .
as wa mention befor , the decod is part of the encod in thi predict scheme .
so , here is the decod , it will accept thi input here that quantiz dct valu .
of the displai frame differ , as well as the motion vector when perform for quantiz in dct .
over here , we'll do predict plu correct , and thi would be the reconstruct valu .
of cours , the decod would not perform motion estim , just compens us the transmit motion vector .
now , i've been defer in thi light to frame , in the gener term .
sinc typic the video frame is broken down into micro block or block or agent in perform the oper of motion estim , compens , and transfer qualiti .
so what thei have describ here appli equal to the whole frame or to ani smaller part of the frame , a block or a region .
what i just describ , actual , is refer to as inter frame code becaus the correl between frame is taken into account .
the question that aris is what happen if we cannot carri out meaning predict , and that's what we will examin next .
so let us examin the case when we cannot carri out meaning predict .
thi happen for exampl at the frame level if we have a scene cut .
suppos you're watch the nightli new and the program switch from the new to a commerci .
is absolut no correl wa probabl between the last frame of the new to the first frame of the commerci .
similarli a new object might enter the scene and therefor cannot be predict from the previou frame .
in case like thi we ar refer to intra frame code or intra code .
so here we show exactli the same block diagram as in the previou slide .
but now we have these two color switch .
and thi switch is oper synchron , in sync .
in other word , thei're either both open or both close .
so again , a frame is a damper of encod , need to be encod .
and in case like thi that no predict can be carri out then both figur ar open which mean thi frame appear at that locat as well .
so these frame have trade their still frame so a jpeg like procedur would be appli to them .
so the dct is appli , and then quantiz , and then entropi encod over here , and the zero and on will be sent to the decod .
thi inter encod frame or block will also come down here , come thi direct , so in thi quantiz and with dct .
thei go around there thei so thei ar store here in memori so that thei ar utilis for futur estim , motion estim and compens .
so no motion estim compens take place and therefor no motion vector ar sent to the decod for thi macroblock or cold frame .
although in gener the decod need to be inform that inter encod ha taken place .
so all these line ar dot here sinc no oper or signal is travel through these line .
i should mention here that inter encod at both frame and micro block level .
it's also perform for other reason such as top be error propag when video is transmit over a channel .
so these intra macroblock intra frame thei can be de , decod by themselv .
thei don't have tempor depend , so therefor robust is built into the bit stream .
and thei can also be us for easi access of the bitstream .
final in everi video code there's an import and necessari block , the rate control which repres in some sens the brain of the system .
it control the output rate of the encod bitstream .
which can be constant or can be vari .
the function of the rate control is to make all the decis that need to be made and set all the paramet that need to be set at everi time instanc , or for everi macroblock or for everi frame .
so for exampl the rate control would decid whether a macroblock or a frame should be intra or inter encod .
we'll set the step size of the uniform quantiz in perform quantiz .
which of cours directli affect the bitrat .
and also , it might have some effect on the context that is us when for exampl , a context adapt binari automat encod , a cabac is us .
clearli , the rate control is util as input the actual rate that is gener at everi time instanc .
and make decis so that the , thi bitrat is shape .
if the rate for exampl is too high , then the quantiz step size should becom larger .
we should perform coarser quantiz .
and or mayb fewer inter block should be code sinc thei requir more bit than inter block .
so thi block diagram repres a complet high level block diagram of the so call hybrid motion compens video encod .
there ar actual two more block , a pre and post processor that i will mention later .
again , if the oper of thi system ar clear to you , then you know how each and everi video compress standard work , and a lot of other algorithm in the literatur .
as alreadi mention the decod which is shown here is part of the encod .
let us look first at inter decod .
the entropi encod bit stream is the input to the decod .
and after entropi decod , what becom avail ar the quantiz dct coeffici of the predict error and the motion factor .
the , thi is the coeffici , ar invers quantiz , the inversel is taken and thi bring the predict error or the motion compens motion differ back to the spacial domain .
the motion vector connect the current frame to be reconstruct with the previou alreadi reconstruct frame , which ar sit at the memori of the decod .
thei re us to predict the current frame from the previous reconstruct frame .
thi is the function here of the motion compens .
clearli the expens motion estim part is not need here at decod .
so the predict is ad here to the correct , to give rise to the reconstruct frame .
the reconstruct frame is also fed back into the memori here , to be us for futur predict .
we show here the oper for the intra decod of a block or a frame .
after entropi decod where it becom avail ar the quantiz dct coeffici or the intens of that block or frame .
so after invers quantiz and invers dct in the spatial domain we have avail now the reconstruct intens .
thei would go through all the wai and form the output of the decod .
these block or frame will be fed back into the memori here .
so that thei can be us for futur predict .
clearli no motion vector ar fed thi wai and therefor no motion compens is take place .
hello again , in thi segment we cover some gener materi about video compress standard .
thei come from two intern parti itu t and mpeg .
although recent thei have collabor to creat for exampl the two most recent standard .
all video compress standard util the structur of the hybrid motion compens video encod that we cover in the previou segment .
mpeg <num> deviat in some sens slightli by ad the encod of the shape in the mix .
the standard howev ar gener .
in that thei onli specifi the syntax and semant of the code in bitstream and the code in process .
in other word , thei don't specifi the oper of the encod .
thei do not specifi how motion estim would be perform .
for exampl , as long as a motion vector per microblock is present in the bitstream in a particular locat .
thi obvious doe not provid ani qualiti guarante at the decod .
but provid great flexibl and empow the valu implement in the standard .
and the compani that will build these dot camera for acquir the video or blu rai player .
to distinguish their product from the competit .
we also show some experiment result compar the valu standard .
it more or less the case that the object of each new standard to obtain the same qualiti with it predecessor and how the is met .
the natur question of cours aris , of how far can on compress a given video ?
high resolut frame , the target of the more recent standard have of cours higher correl and therefor more room for improv .
but still the standard ar do a wonder job in push the envelop .
so let's dive into thi excit materi .
there exist a number of success intern video code standard .
the success is measur by the fact that thei've been adopt by the industri , and thei can be found in numer applic and product .
the video corpor standard have been creat by the itu t video code expert group .
and more specif , thi group creat h . <num> and h . <num> .
also by the iso iec move pictur expert group , mpeg .
and thi group creat mpeg <num> and mpeg <num> visual .
and from their collabor effort under the name of joint collabor team on video code .
that creat the more recent standard , h . <num> , that's the itu and , and mpeg <num> video is the mpeg name for the same standard .
and similarli h . <num> and h . <num> thei latest video compress standard .
the number indic the time sequenc in which the standard were creat .
the rule of thumb is that with ani newer standard , the same perform with the previou standard is achiev .
in term of peak , peak peak signal to nois ratio at half the bitrat .
so , the newer standard ar replac the older on .
although in principl each standard address specif applic , or there is typic a killer app , as the terminolog goe , behind each standard .
by and larg thei standard idea which have appear in the literatur .
but now , thei're specif test to make sure the best possibl perform is obtain .
the standard becom more sophist and more computation heavi as time goe on .
the comput resourc howev increas at a fast rate .
so it's possibl now to consid more elabor scheme in perform motion estim or spatial predict or transfer code .
while alloc the avail bit in the best possibl prefer optim wai .
some gener comment regard the standard ar that thei all us the hybrid motion compens encod , encod scheme that we have talk about .
the standard ar gener .
thei do not specifi the oper of the encod but instead the syntax and semant of the code bitstream and the decod process .
so a bit stream that is compliant to a specif standard can be decod by the decod of that standard .
so there is no guarante of the end to end qualiti , the qualiti of the construct video .
but thi wai there is great freedom to optim implement so that ar appropri to specif applic .
wherebi somebodi can balanc compress qualiti , implement cost , time to market and other consider .
final the standard follow a toolkit approach through the variou pro , profil as we'll see .
and depend on the applic somebodi need onli us certain featur of a given standard .
we show here the same block diagram of the hybrid motion compens video encod that we have alreadi analys .
on differ that the block ar now color code to indic the file that the standard onli specifi the decod .
or the syntax and schemat of the code bit stream and the decod process .
so yellow repres proprietari algorithm .
like i've actual ad the preprocessor here .
which is typic present in ani coder and is usual here to perform resiz , color convers from a given former for exampl , ycbcr .
nois smooth , convers from interlac to progress etc .
on can design an encod with the object of simpli increas the perform of the coder .
so motion estim is certainli a proprietari issu .
it's not specifi by the standard , how to perform it .
as long as motion vector for each block ar provid to the decod in a specif locat in the bitstream .
as discuss in week four , when we cover motion estim .
the design can choos the trade off between speed of calcul of the motion vector and accuraci of the vector or size of the predict error .
thi is clearli a design choic .
similarli , rate control is a proprietari issu .
and it typic ha a major effect on the overal qualiti of the compress video .
there ar choic also to be made when entropi encod is perform .
the magenta color repres block fix by the standard .
and final the cyan color repres proprietari possibl valu add , have an effici and mechan .
to decid , to decid whether a block should be code as intra or inter .
in collabor of cours with the rate control can clearli affect your video qualiti of your encod video .
and also increas it robust to channel letter .
and as i alreadi mention , the qualiti of the standard complianc stream can vari tremend .
i've also edit here inform regard header inform .
but also need to be to sent to the decod such as the pictur type , block type , time stamp etc .
that we see what exactli some of these mean later on .
final , there is also typic audio associ with a video .
which is multiplex with the video and sent over a pipe for exampl when inter or intranet , the wireless network cabl , satellit link etc .
we show here for complet the decod which we analys earlier .
but also with a variou block color code with the same interpret as in the previou slide .
the bitstream decod here also address error resili , resynchron , and error conceal .
we've includ also a postprocessor block , which is typic found in ani video decod .
it purpos is to do form sampl , composit , further conceal , code , nois reduct , and so on .
it purpos is , in gener , to increas the visual qualiti of the decod bit stream as much as possibl .
and effici postprocess unit can have magnific effect on the qualiti of the contrast video .
if in certain applic actual the preprocessor and postprocessor can commun then improv result can obtain .
we show here in thi tabl some of the earlier standard , the latest to h . <num> and h . <num> ar not includ .
so we see the bodi that creat them and the applic in mind .
so these ar the itu standard and these ar the mpeg standard , so commun applic ar the primari applic here .
why entertain come in thi direct .
then we see there the date of standard , <num> , <num> , <num> , <num> , <num> .
there's a first version that is releas and then there ar revis version that , that follow .
here ar the primari applic .
commun type of applic here .
video conferenc .
wireless or wide line .
while here storag of the video .
broadcast under mpeg <num> .
actual mpeg <num> is the adopt standard for digit high definit televis .
and then mpeg <num> ha , it's quit a number of applic here .
and we'll talk actual about them mpeg <num> ha quit some interest differ from the standard befor and after it .
we see here the bit rate , smaller imag and here ar the typic frame size .
so thi to a coupl .
actual the smallest size here we see is quarter cif , quarter common intermedi format , a tini frame <num> by <num> .
if we doubl the size abov the action we end up with cif .
relat to that is sif , standard intermedi format .
and then we see accommod <num> .
so these ar the size and then we see the rate , so well , the kilobyt rang here , while do the megabit per second rang here .
and mpeg <num> actual cover pretti much the whole rang from <num> kilobyt all the wai up to <num> megabit per second .
final we saw the video compress standard that ar associ auto compress standard .
and depend on the applic for these commun applic here , speech is all we ar interest in compress .
while with the applic come from mpeg we ar interest in stereo , cd qualiti , surround sound , and so on .
as alreadi mention , the rule of thumb in design a new compress standard is to achiev the same qualiti as the previou gener on at half the bitrat .
we show here some experi result with some of the earliest standard .
us thi particular sequenc , foreman , it's a qcif resolut , <num> frame per second and <num> frame in code .
so what it will show is the rate distort perform of video coder .
so on the horizont axi is the rate in kilobit per second while on the vertic axi the qualiti in term of psnr and in term of db .
so , go back to 70s and 90s , if each frame of the sequenc is encod as a jpeg frame .
thi is the rate distort perform we obtain .
util the frame differ and encod it , thi curv is shift .
with h . <num> the curv is further shift , mpeg <num> and h . <num> perform .
so in a span here of the year from <num> or <num> depend which wai you count til <num> .
we see that at a given a qualiti , the bit rate is reduc by <num> .
clearli if we look at a differ qualiti level , then thi reduct , let's sai at six db , then thi reduct is even greater .
and of cours , thi here refer to thi particular sequenc at thi resolut .
some of the newer standard , for exampl <num> , address extrem high resolut frame , uhd , such as 4k , and 8k resolut frame .
but in gener , the question is , how far can we push these curv for a specif sequenc .
if there is a limit base on which you cannot further compress the data .
we show here the result of a similar experi as befor thei encod sequenc foreman again .
but now it cif resolut so four time larger than the previou experi .
and the frame rate is <num> frame per second .
we go back here h . <num> with mpeg <num> standard profil plu q , mpeg <num> standard profil and h . <num> baselin .
the observ ar similar as befor .
if for exampl look at thi oper point , so thi effect four and <num> km per second and the qualiti is <num> dp .
and we see that we can achiev the same qualiti with thi oper point , which is around <num> kilobyt per second .
so same qualiti at almost half the rate in go from on gener to the next .
but clearli sinc there ar variou profil that the standard can util , these curv vari , ar shift as shown here .
but the direct is the direct of , of improv .
follow more or less the rule of thumb that thei mention .
here is yet anoth comparison among variou , video compress standard .
what thei're show here is the bit rate save when the qualiti is kept the same .
video that ar suitabl for entertain applic were us so rather larg format .
and a number of experi were conduct , so what's shown here is the averag bit rate save .
so , we see the comparison here of the latest standard , the high effici video code .
which is also , here is the name of h . <num> against a good number of previou gener standard .
and the same is done for <num> , mpeg <num> and <num> .
so clearli the gener observ is that when we compar a newer standard to it's previou gener on , there is bit rate save .
which is not alwai at <num> or larger as we would like it to be mayb or is the rule of thumb indic .
but we see here that <num> compar to <num> for thi set of experi , it us a bit rate by <num> .
and these save keep increas as we move back in time and reach <num> when compar to mpeg <num> .
a similar stori for <num> , actual close to <num> here .
mpeg <num> compar to <num> , we see small save .
h . <num> compar to mpeg <num> we see rel small save .
what it should be kept in mind here is the size , the resolut of the frame is import .
becaus as we alreadi mention , everi standard is design with differ applic in mind .
or put is differ as the express goe , there is a sweet spot of oper of each standard .
it's work perform best for certain resolut .
so for exampl h . <num> adress uhd resolut 4k , 8k , resolut while <num> down here work with littl imag such as qcif and cif resolut .
so here video suitabl for entertain applic were us where the resolut were rel larg .
and therefor , you might sai that some of the newer standard ar slightli favor .
howev , with on should definit keep in mind .
that when convent like thi ar made that again , the test materi is not outsid the sweet spot of standard .
otherwis it becom an unfair comparison .
hello , welcom back .
in thi segment we cover h . <num> , h . <num> , mpeg <num> , and mpeg <num> .
these all have been veri success standard although there exist newer , more power on .
the reason for cover them as well , and not just show the latest and the bravest is that there's a lot of innov convei by them when thei were first introduc .
in addit , it's import to see the evolut of standard to realiz and appreci what improv in the technolog contribut to the advanc perform of everi new gener of standard .
we show the level of sophist of each of these coder , and the decis that need to be made for the encod of each and everi so call macroblock .
we also describ how mpeg <num> is handl interlac video , the first standard to do so .
so , with that , let's proce with thi topic .
h2621 wa on of the earliest video compress standard it wa approv by itu t , in <num> .
it provid quit a bit of innov , base on which subsequ standard build upon .
the applic in mind wa video telephoni , and video conferenc over isdn .
therefor the rate ar integ multipl of <num> kilobit per second .
at these rate , small resolut frame ar us , either sif or qsif .
what we see here is that the lumin compon , the y compon is at thi resolut , while the cbcr , the compon ar sub sampl by two in each direct , as shown here .
on the progress , video is accommod and the aspect ratio is fix , four over three .
h . <num> wa introduc by itu t again five year later in <num> .
now the applic is video transmiss over wireless network and public switch telephon network .
so becaus of that , the rang of rate is smaller than wa . <num> .
and smaller resolut ar accommod .
qcif , but also sub qcif .
and the same stori goe here , that the chromin compon ar sub sampl version of the lumin compon .
and the progress also video is address , and a fix four by three aspect ratio .
some of the major differ between h . <num> and h . <num> ar discuss here .
with <num> , we can now achiev bitrat below <num> kilobit per second , of cours we're deal with qsif and even sub qsif resolut and the frame rate is below <num> .
can be seven and a half frame per second or ten frame per second .
unrestrict motion vector ar us , so the search area is not constrain .
and variou advanc motion convers mode .
with <num> , half pel motion vector ar estim , while with h . <num> onli integ pel motion vector were us .
the loop filter is a filter that come and go so it wa introduc in <num> , then wa not us for some of the standard , came back in h . <num> for exampl .
so thi is a filter that smooth out the predict that is made so it's in the feedback loop there of , of the predictor .
and also accommod overlap block motion compens .
it cover four differ type of frame , i stand for intra , p for predict or inter , b for bi direct , so predict is perform from the past as well as the futur , and we cover these thing back in week four when we were talk about motion estim .
and pb is a combin of predict and by direct frame .
by and larg these frame base on my understand have not realli been extrem us .
<num> as compar with <num> satisfi the rule of thumb which is it pretti much it achiev the same perform at half the bit rate .
becaus of the contribut from mpeg , mpeg <num> wa introduc in <num> with the main applic in mind that code of move pictur and associ audio for storag applic for up to on and a half megabit per second .
two year later , mpeg <num> wa introduc with a gener applic of code of move pictur and associ audio .
as i alreadi mention , out of mpeg , came also mpeg <num> in <num> , and to talk about it .
and jointli with itu t h . <num> and h . <num> becam standard .
there ar howev , two more standard out of mpeg , mpeg <num> and mpeg <num> which ar not video compress standard .
mpeg <num> standard the featur that can be us for search by a search engin , and mpeg <num> standard the seamless us , user experi as the user move around differ platform .
i've got to discuss the structur of the mpeg <num> video bitstream sinc it shed some light into the inner work of the coder , and also it's follow with some modif of cours by almost all standard .
the basic build unit of ani code there is the block , it size eight by eight pixel .
block ar combin to form the macroblock layer .
the lumin compon consist of four block .
while the cbcr , the chromin compon ar sub sampl by two in each direct , therefor consist of two block .
therefor there's six block for macroblock layer .
macroblock ar then combin to give rise to the slice layer .
the idea of a slice is that thi repres an independ decod unit within the frame .
so we cut all depend from neighbor , and it can be therefor decod by itself .
in mpeg <num> slice have thi form here .
it's all macroblock .
in other standard that you'll see , slice can have an arbitrari shape .
so thi mani slice give rise to the pictur layer .
we veri often refer to thi as a frame .
howev , pictur is a more gener term becaus we mai have interlac for exampl , video , and we can have frame and field in that particular case .
pictur ar combin to give rise to the group of pictur layer or the gop layer .
within mpeg <num> the structur is fix of the gop .
so we have an intrafram , we have a predict , or interfram , and in between we have two bidirection encod frame .
and then gop ar combin to give rise to the sequenc layer .
so with thi structur it's rather straightforward to indic where a block belong to which macroblock , to which slice layer , to which pictur , to which gop and to which sequenc layer .
i want to discuss here the veri mani differ option that ar avail in encod a macroblock , or the veri mani differ decis that need to be made by the rate control .
so if we deal with an i pictur , intrafram pictur , then all the macroblock within thi pictur ar also i macroblock .
and in that case , the decis that need to be made is whether to chang the step of the uniform quantiz , mquant or leav it the same .
and actual within the standard thi chang cannot be arbitrari .
it cannot go from quantiz step two to <num> , as an exampl , but it's done gradual .
when we deal with a p pictur , an interpictur or a predict pictur , then as we can see here , there ar addition mani more decis to be made .
so at the first level , the question is whether to perform motion compens , or set the motion vector equal to zero .
after motion compens is perform , still we can decid whether to treat thi as an inter or an intra macro block .
so if the predict error is veri larg , then it's decid that thi macroblock should be encod as an intra on .
and then the decis ar whether to chang the quantiz step size or leav it the same .
when the decis is made to encod thi macroblock as an inter macroblock , still there ar two option , we can choos to code the predict error , or not code it .
if the predict error is veri small then just do motion compens like point in the right direct of the macroblock is good enough , and no error is sent , it's veri small , it's close to zero .
now , if the predict error is code , then we still have to decid whether to chang or leav the same the quantiz as step size .
if the decis is made to set the motion vector equal to zero , then we'll still find the predict error and the same level of decis is made whether to encod the macroblock as inter or intra .
if intra , then we have to decid on the quantiz or step size , step size .
if inter , we have to decid whether to code or not code the predict error .
if the decis is not to code it , then thi is the skip mode .
so zero motion vector and zero predict error .
so in other word the current macroblock is just replac by the macroblock in the previou frame in exactli the same locat .
if the prediction is code , then the decis of whether to chang the step size of the uniform quantiz need to be made .
when we deal with a bidirect pictur , then at the first level the decis ha to be made whether a forward or a backward or a combin interpol motion compens should take place .
and then for each of these decis their subsequ step is whether to encod the macroblock as inter or intra .
if intra we have to decid on the step size of the uniform quantiz , if inter , you have decid whether to code the predict error or not code it , and then decid again if code on the quantiz step size .
so we clearli see that for each and everi macroblock , a multitud of decis need to be made , .
and thi is the job of the rate cont , rate control , and these decis should be made in the arrai distort optim out fashion , which mean that for a given bitrat , we should alloc the avail bit to encod the motion vector and the predict error , so that the qualiti of the reconstruct video is as high as possibl .
we show here the bit distribut among the variou pictur , or frame , i us , in the interchang , type .
so thi is for the encod of an sif video at <num> . <num> megabit per second us mpeg <num> .
on the horizont axi you see the frame number , while on the vertic axi you see size of each pictur or frame .
so on the averag the i frame consum <num> kilobit , the p frame <num> kilobit , and the b frame <num> kilobit .
so we see that there's an order of magnitud fewer bit in go from i to b , and it's a reduct by more than <num> in go from i to p .
thi is what we expect .
more bit ar requir for i frame that's you might sai the disadvantag compar to b and p frame .
on the other hand , the advantag of the i frame is that thei stop error propag sinc thei're decod by themselv , and those who allow us to access the content .
if for exampl , we want to fast forward through an encod digit movi then we can onli reconstruct the i frame and thi will provid thi function of a digit vcr .
mpeg <num> support a specif structur of the group of pictur .
it consist of <num> pictur , where the first on is an i frame , it follow by two b's , a p , two b's , and so on , and thi is exactli what we see here .
so although the specif number have to do with the specif sequenc that wa encod us mpeg <num> , probabl it goe without sai that it's the typic profil that we expect to see no matter which sequenc , which movi we encod .
that is again , we need to spend most of our bit in decod an i frame , follow by a p , follow by a b .
when bidirection predict frame ar util , then there ar some issu that need to be address .
so we see the three differ type of pictur , i , b and p .
what's import to notic is that p pictur ar predict either from an i pictur or from anoth p pictur .
so thi p on is predict from anoth p .
on the other hand , b pictur ar onli allow to us either i or p pictur for the predict .
so thi b on is util on i and on p pictur , while thi b for exampl is util on p from thi side and on p from thi side .
so becaus of thi constrain , if we number the frame it's clear that the order of encod is on , four , two , three , seven , five , six , and so on .
while clearli we want to plai them back at the natur order .
on , two , three , four , five , six , seven .
so becaus of that there is some buffer , some delai that need to be introduc dure encod , decod , and plai back .
to give a tast of how the macroblock ar distribut in encod a sequenc by mpeg <num> we have the three differ pictur type here , so when the pictur is intra , then clearli all the macroblock in it ar intra .
howev , when the pictur type is p then some macroblock ar intra code , some ar predict , mani more of them intra , for some the motion vector is zero but the predict error is encod and for some thei're skip .
zero motion vector , zero predict error .
similarli for the bidirection encod pictur type there's some i macroblock , b macroblock , bidirect macroblock and skip macroblock .
and then the correspond number of eight by eight block that were code , right ?
here is it's intra then all these ar code .
and sinc on macroblock equal six block , then if you multipli thi time six , we're go to find the number of block code .
and we have similar calcul along the wai , creat for the skip on , there ar no motion vector no predict error that is encod .
we show here an exampl of the distribut of the comput load in mpeg <num> decod .
what we see and , it quit surpris mayb to some extent , is that the major of the comput load , like almost <num> , is due to motion compens .
so just compens , no estim , the motion vector ar send over by the encod take , <num> of the comput alon .
so on can imagin that if motion estim wa part of it as in encod , then thi percentag will increas consider .
then , it's equal , almost distribut , by <num> to huffman decod , invers eight by eight dct and color transform and displai .
mpeg <num> wa introduc two year after mpeg <num> .
although conceptu similar to mpeg <num> , it includ extens to cover wider rang of applic .
the main applic is the broadcast of tv qualiti video at bitrat between four and nine megabit per second .
the syntax wa found appropri for other applic , such as hdtv , which wa the result of the format of the grand allianc .
some of the characterist of mpeg <num> is that it is backward compat with mpeg <num> , so if you have alreadi an mpeg <num> decod , it can decod an mpeg <num> bitstream .
it also handl , i , p and b type of pictur as mpeg <num> .
on of the signific enhanc is that now it can handl interlac video .
and to sai a few thing about thi .
it adopt thi tool like approach , so is divid into profil and level .
and final it can produc scalabl bitstream .
the idea of scalabl is that the video is encod onc and then from thi encod bitstream we can extract sub bitstream , part of it .
and you can construct the video , either at the lower qualiti , if it's a psnr scalabl bitstream or at the lower special resolut , and thei ar talk about special scalabl or at the lower frame rate , and thei're talk about tempor scalabl .
interlac video is a techniqu for doubl the perceiv frame rate of a video displai without consum extra bandwidth .
the interlac signal contain two field , a top field and a bottom field as show here , or an odd and an even field .
thi enhanc motion percept to the viewer , and reduc error , by take into account the so call fi phenomenon effect , which is the optic illus of perceiv continu motion between separ motion when thei view rapidli in success .
so thi effect doubl their time resolut or the templ resolut as compar to , compar to non interlac video for frame rate that ar equal to field rate .
so interlac signal requir a displai that is capabl of show the individu field in a sequenti order .
and onli crt displai and some plasma displai ar capabl of do so .
so , becaus crt ar not in exist anymor , most displai ar progress on , interlac video becom less and less import as time goe on .
so in the special represent we see here the two field that i mention the top field and the bottom field .
over here we see the progress scan and in the time domain here is the frame rate , so for ntsc thi is on 30th of a second , the distanc between two frame .
why when we deal with interlac video the distanc between field now is on 60th of a second .
when we deal with i frame we need to take the dct of eight by eight block of intens valu .
so given a <num> by <num> interlac macroblock we have two wai to break it into four , eight by eight block .
the first on shown here is the field mode .
the <num> by <num> macroblock is broke into these four eight by eight block , where here we put the pixel that belong to field on , which is also call the odd field or the top field .
while in these two block we put the pixel that belong to the second field or the even field or the bottom field .
clearli if the frame mode is chosen then thi <num> by <num> interlac macroblock is broken into four , eight by eight , also interlac block as shown here .
clearli thi is a rate control decis but need to be made .
mpeg <num> support both the frame and the field predict mode for motion estim compens .
so , accord to the frame predict , the two field ar treat as a frame .
it's an interlac frame and the motion estim compens is done at the frame level .
in the field predict mode we have an exampl here where thi field could be a top field or a bottom field , and can be predict from either the top field or the bottom field of the previou frame in time .
while in thi exampl , we're look at the bottom field of thi particular frame at time t , let's sai , which can be predict from the first field of the same frame , the same time instanc , or the bottom field of the previou field , time t minu on .
so in thi case , the distanc here is on 30th of a second , while the distanc between these two field is on60th of a second .
anoth motion compens mode provid in mpeg <num> is the dual prime mode .
thi mode is applic onli to p pictur and to gop that have no b pictur between these p pictur and the refer frame .
so for frame pictur , two motion vector ar associ with each field .
so for thi top field here , the motion vector v1 and pv1 ar associ with thi , thi dot line .
if we , if we denot by pv1 x , the horizont compon of thi vector , then pv1 x is encod in term of v1x .
and , as you can see here , v1x connect thi top field which ar on 30th of a second apart .
while pv1 correct the bottom field of thi frame and the top field of thi on , which ar on 60th of a frame apart .
therefor , pv1 is half v1x , shown here .
and delta of x is a correct there .
if you can see there , the vertic compon of pv1 .
it's the same cours and durat .
it's half of the v1 of y .
plu , minu thi term here , which correct , take into account the shift between a top field and the bottom field .
an even field and an odd field .
and here is the correct term .
so , what's includ in the bitstream is not pv1 and pv2 , but instead thi correct factor delta .
similar consider ar made here , when we have the , the field pictur .
thi tabl summar the kei characterist of the profil and level defin for both scalabl and non scalabl mpeg <num> to bitstream .
in thi tabl the upper bound for the pictur resolut , frame rate and bitrat ar provid .
the bitrat data refer to the maximum compress bitrat support by the input buffer of the decod .
while na indic that , that there is no conform restrict for these variabl .
it's expect that ani implement of the standard will support onli the main profil at the main level .
the main profil provid the basic function of mpeg <num> .
the simpl profil is a low cost version of the main profil .
code is similar , as in the main , but without ani bidirect predict .
level refer to pictur resolut .
the upper bound of the main level is c , ccir , <num> pictur format .
the high <num> and the high level resolut correspond to pictur resolut for hdtv .
the low level resolut correspond to sif format .
so , these profil and level have a hierarch relationship .
that is , a syntax support by higher profil level includ all of the element of lower profil level .
a decod that can decod bitstream at a certain profil level should also be abl to decod bitstream at the lower profil level than it's own .
we show here some of the system support hdtv around the world .
so in north america the result of the grand allianc goe to adopt for video encod mpeg <num> main profil at high level .
thi is the aspect ratio , the similar on with movi the special resolut and then for audio , dolbi advanc code three is us .
in europ there is digit video broadcast .
it also adopt mpeg <num> , but the simpl profil at high <num> .
the aspect ratio is differ .
the resolut is differ , and for audio encod mpeg layer two is chosen .
and final in japan , there is muse , is us the same aspect ratio as north america , the resolut is slightli differ , but the video is also similar to main profil at high level mpeg <num> .
the most excit standard from mayb an academ point of view is mpeg <num> .
it deviat from all other standard but it also keep some backward compat .
thi is the topic of thi segment .
on of it major differ is that it look at some level at the content of the video .
the video now consist of video and audio object , which ar encod and manipul separ .
becaus of that , base on a script , new scene can also be compos .
we describ in detail , how the video object ar encod , in other word how their shape and textur ar encod .
we also discuss the hybrid scene that can be encod by mpeg <num> .
scene consist of synthet and natur object .
so let's proce with thi realli excit topic .
mpeg <num> actual is the excit standard that gave a fresh look at video compress .
up to that time and actual after that time as well after mpeg <num> all the standard treat the video in a content agnost wai .
thei take each frame thei break it up into macro block and block and proce that wai .
with mpeg <num> .
now , we ar given the abil to access and manipul individu element that make up each scene .
so we're look at the content , and the special decomposit of the content in a frame .
so in a cartoon , the reposit , delet , alter movement of individu charact within a scene can be captur .
so thi is a veri repres slide , becaus it stro , show the structur of an mpeg frame .
we see here that there is a scene depict which consist of .
arbitrarili shape object , like the father and child , and associ with them , there's an audio object .
the floor and wall ar synthet , and sprite ar us to gener them .
and thi is a concept from comput graphic .
then there's an applic screen here , thi websit .
the furnitur ar synthet object .
and then there is an hdtv set , a home dvd tv frame , and so on .
so you see here that we have a hybrid scene that consist of synthet as well as real object .
and the object ar individu , like we have the object of thi father and child and there's the video object and the associ audio object .
so the mpeg <num> bit stream can accommod such a composit scene .
so thi is a major departur again from all futur and previou standard .
so as demonstr by that synthet scene i just show mpeg <num> deal with the encod of both audio and visual object .
and it provid video and audi , audio code tool .
it's merg natur and synthet data , and that wa the main or the main intent of that slide i just show .
and also , provid a robust bitstream syntax and flexibl system layer for interact .
so , let's see what ar some of the applic , the technolog behind it , the composit of a frame , and then how video object ar handl .
how the , how ar thei repres and encod .
so the applic space of mpeg <num> cover from the tradit applic , such as surveil .
sai mobil multimedia , but now addit applic aris .
quit a few in entertain and interact game and dvd .
also applic have to do with content base storag and retriev .
and also with interact tv .
and these newer applic ar base on the fact that the shape of object is describ .
and therefor i can manipul visual object , as well as audio object .
therefor i can either util them to do search .
or i , can utilis them in have an interact game applic or interact tv for that matter , and also i can utilis them to recompos a scene base on a specif script .
we see here an mpeg <num> scenario .
so there's a scene it decompos then .
elementari stream ar sent over to the decod , and thi elementari stream includ primit audiovisu object .
so the scene again ha been decompos into these audiovisu object .
then util a scene descript as shown here , we can render and propos the scene accord to the script of thi scene descript .
so on can envis possibl applic wherebi , depend on the characterist of the variou market , a differ scene descript is us .
and certain object , either thei're place in a differ posit , or certain object do not appear at all , base again on the prefer and the restrict of the market .
so when , when it come to the code of visual object within mpeg <num> , natur textur , imag and video can be accommod .
then , frame can be progress or interlac .
and here is a major innov , is that we can encod arbitrarili shape object .
and we're go to see exactli how thi is done .
scalabl is handl , and address , and also sprite ar part of the equat .
these ar again , comput graphic model techniqu .
also , the resili of the bitstream to error in the channel ar address .
when it come to synthet object , facial anim can be handl .
we'll talk a littl bit about it , anim mesh and bodi anim in the second version of mpeg <num> .
so the scene is decompos into video object plane , vop .
so thi particular frame is decompos in three vop , vop <num> repres thi person .
vop <num> the car or at least part of the car sinc it's includ by the person .
and vop <num> , the remain of thi scene which is the hous and the background .
so as we'll see each of these vop is encod separ and then thei're just match togeth to recompos the scene .
thi is a veri illustr slide .
it show that the video object plane ar compos from shape and textur .
so , vop <num> here , shape is the whole frame , thi is the background and thi is the associ textur , video object plane <num> , is compos of these children so thi is the shape , at the binari version of the shape , so where is white is where the object ar and for these we have the textur .
and then there is thi move i guess slogan which we show here both the shape and the textur .
so if all these ar put togeth , we compos the frame which is shown here .
so , the main idea is that for each video object plai , both the shape and the textur need to be encod .
as far as the textur goe , as you'll see right awai , the techniqu that have been develop prior to mpeg <num> such as mpeg <num> and h . <num> will be realiz code detector but new technolog is need to encod the shape of the object .
we show here the block diagram of an mpeg <num> code , decod .
the , the video frame is input to the coder , the video object plane ar identifi , defin and thi give rise to the scene and object descript .
then each of the video object plane is encod separ , all is encod down here all the inform is multiplex is sent over the network .
at the other end at the decod , the demultiplex each of the vop is decod .
and the decod inform along with the scene and object descriptor is util to compos the output video frame .
audio of cours is also decod and it's output over here .
what is differ realli when we look at mpeg <num> and the previou and next standard is how the vop encod and decod is take place , and thi is what we ar go to discuss next .
as mention earlier , and will also be shown later , when come to the encod of an object the textur of the object and the shape of the object ar encod separ .
so thi is what thi vop encod schema , schemat is show here .
so , in thi upper part , the textur , the underlin textur of the object will be divid in macroblog , motion estim and compens will be perform , then the displac frame differ will be dct'd and quantiz , and thi will becom the encod of the textur , .
while down here is the predict model , the motion vector that need to be sent to the decod .
so thi upper part that i just mention repres a standard h . <num> mpeg <num> video encod .
what is again differ with mpeg four is that there's a shape code modul here that is go to encod the shape of the object and all these three piec of inform will be multiplex and sent over to the decod .
so , what to look at next is how shape encod is carri out in mpeg <num> .
there ar differ wai to describ the shape of object .
on wai first of all is , is to describ the boundari of the object while the other is to treat the shape as a binari mask as shown here .
so the approach that wa follow by mpeg <num> wa to encod the mask that repres the shape .
so , a bound box is util around the object of interest .
so , then , thi bound block bound box .
is divid into block , as shown here .
and then clearli , there ar solid block like thi on , there ar block that belong to the object .
also block that belong to the background .
so these block do not need to be encod .
i mean the color need to be signal to the decod .
but the block that realli requir encod ar these boundari block , which ar refer to as binari alpha block , or bab .
so these block contain both background and object pixel , and again thi is a mask , so the object let's sai is repres by zero and the background by on as shown here in color .
so the question is how can we encod thi binari block there , the block which ha zero and on .
and clearli the materi that we cover two week ago , when we talk about lossless compress and fact and arithmet code and content adapt arithmet code could come to mind .
becaus that's exactli what mpeg <num> is util .
so let's look at the detail next .
so first of all , similarli to the intra and inter block , when we encod textur , there ar intra shape , and inter shape code .
so with inter shape there is motion estim compens involv .
while with intra the shape is encod by itself .
so , for these binari alpha block , or bab , the binari shape pixel ar encod us context base arithmet encod , cae .
so to encod thi pixel , which is a binari pixel , these ten neighbor ar us .
there ar , therefor there ar <num> to the 10th , <num> differ context .
so there ar <num> differ arithmet coder that ar util .
but thei all us the same machineri .
but the probabl of zero and on for each of them chang .
so we look at the ten neighbour and pull out on of the <num> arithmet coder to util to encod the valu of x .
if either shape is us then we us the current frame , the current bab but also the motion convers bab .
so the neighborhood then is as shown here .
there ar four pixel in the current frame , these four neighbor .
and then there ar the five neighbor in the previou frame .
so in thi particular case there ar onli <num> plu <num> , <num> neighbor and therefor <num> to the <num>th or <num> differ context .
so thi is a frame from the mpeg <num> effort .
and , we can see here .
but , when the video plai .
so what we show , is the boundari of the object .
and we see some of the challeng ar that the object ar deform , thei chang shape veri easili .
and then we have three object but these three object merg at some point and becom two object .
right .
so now we've three object .
now we have two , sinc the ball and the child merg and so on .
so thi is certainli a challeng situat in , in code in thi bound inform , or shape inform .
so , the textur is encod the tradit wai .
in other word , we have here the mask identifi the object , and then we see that thi macroblock base mask is extract .
then each macroblock is encod , the good old standard wai , it's with intra , it encod by itself , if it's intra , motion compens , and the predict error is encod .
and after i reconstruct thi , i us the mask , i superimpos , the mask on that , and i extract the , both the shape and the textur of thi visual object .
sprite ar also accommod by mpeg <num> .
so we see here a , a scene , so the idea is that the background is encod us , us sprite .
so first some time is spend as a mosaic decomposit or composit of the background and then the background can be manipul by motion paramet such as the pan , rotat , and zoom .
so then the idea is that the background ha alreadi been transmit to the decod and then at each time instanc onli thi object of interest is extract and encod .
so what is sent over to the decod is thi visual object plu paramet .
regard the background .
so base from these paramet the sprite base represent of the background avail to the decod will be manipul and then the object will be ad to the scene to compos the final scene .
so , you can see there is a much wider view of the thi , again , mosaic , mosaic reconstruct of the background .
and , base on these motion paramet , we can zoom into a section of it , and we see , again , the visual object , thi tenni player .
when it come to face object , then thei're .
these ar a set of facial definit paramet , and facial anim paramet , and facial interpol paramet , these three set of data that can be us .
so , the facial definit paramet , thei defin the proport and the shape of the face .
then the facial anim paramet anim vertic of thi wide frame that underli thi , thi model .
and there's specif set of paramet that control , for exampl , the inner lip , the outer lip movement , the nose , ey and so on .
and then the facial interpol .
transform is utilis to interpol miss frame or to increas their tempo of frame rate .
so there face is defin either through a 3d featur point set or a 3d mesh or scene graph , then there is facial textur that is super impos on that and the facial anim paramet , that further control the paramet of the face .
so , see here an exampl of the underli wi , wide frame of thi face model .
so , it consist of these vertic that can be manipul by the facial .
anim paramet and then we see the textur of , of the face of a person that is mask or super impos on thi wide frame .
so by control the underli vertic , the underli wide frame , we can anim thi realist look , realist look person .
h . <num> is the latest and bravest of the video compress standard , although h . <num> is along the wai .
we describ it major advanc and differ .
over preview standard in thi segment .
by and larg , there ar no conceptu differ with respect to the preview standard .
again , thi hybrid code that is us .
howev , comput technolog ha advanc , and now it's possibl to perform consider more complic oper when a code is implement even a on a hand held devic , which keep in mind is the code is ar computation much lighter than encod becaus it involv motion estim .
and thi is why thei're implement first on a small portabl devic , we will see that there ar advanc with respect to motion estim , special predict , and entropi encod .
sinc by now , you have knowledg of over two week of materi uncompress , everyth should make perfect sens .
so , let's check out the detail of thi particular topic .
let's us now discuss h . <num> .
thi is the latest and greatest offer by jvt .
there is actual h . <num> , but it in it phase of complet as we speak and we'll sai a few thing potenti about it as well .
so as i mention earlier , the rule of thumb is to have twice the compress effici as anyth els and the last standard wa establish in about <num> .
so <num> ha the same name as mpeg4 part <num> becaus it's the collabor between itu and mpeg and it also carri the name of h . <num> avc advanc video code .
initi at least it wa carri the name h . 26l .
so if you look in the literatur and see ani of these name , you should realiz that , you're talk about the same standard .
so we're go to see next what ar the distinguish factor .
what ar the similar , but primarili part of the major differ that offer so much improv in , improv perform in h . <num> .
let us look now at the new featur of h . <num> .
as you'll see these featur do not deviat from that basic block diagram i show at the begin of the cours .
in other word it's a hybrid motion compens video encod .
howev , due to the advanc of , processor , now more elabor process step can be taken along the wai .
and therefor for exampl addit consider , addit situat can be check when we do motion estim .
so , specif , as we'll see , the motion compens and intra predict differ from previous .
we'll see that , motion compens can be done , now , with respect to <num> frame in the past , not just on frame , and also there ar addit intra predict mode per macroblock .
also , the transform have more flexibl , when dct is us there is an integ dct , and some other differ that we'll talk about .
the deblock fil , filter ar back .
as i mention at an earlier point , thei were <num> for exampl .
and then thei were not us for a while and now thei , their benefit wa again reevalu .
so thei're back into the new featur of <num> .
entropi code is differ .
it's actual , as you'll see , a context adapt arithmet code , a topic we cover two week ago when we talk about lossless encod .
and also there's a differ in how the frame and slice can be defin .
you'll see that it's a mu , a much more flexibl structur .
so let's go down the list and examin each on of them in some detail .
so on of the major differ is the user variabl block size when motion estim compens is take place .
thi is not a new idea .
it ha been us wide i would sai in the literatur .
howev it wa deem that it wa appropri now again to the advanc in comput power to implement such a , a chang while encod .
so the motiv is clear and simpl sinc the move or stationari object ar variabl in size , .
if we us a fix block size if it's too small then we're lose too mani bit to encod .
if it's too larg then the predict is not good .
so clearli we have to have a mean to adapt to accommod both situat .
and thi is exactli what h . <num> is do .
so we start with a <num> x <num> macroblock as were the case in the preview standard , but then we have choic .
so , it can be kept as a whole , or it can be divid horizont , or vertic into two sub block of size <num> x <num> , or <num> x <num> .
it could be divid into eight sub block and then the last case , the four sub block mai be divid onc more into two or four smaller block .
so there ar a number of choic , seven actual as you see , and , but thi choic ar not arbitrari , thei have actual , a quarri structur review in vision of the split of the <num> x <num> into the situat , then there's , structur .
of cours the price you pai , you have to signal the decod for each of the particular block i us when motion estim compens is take place .
so here we see exactli the seven size , differ size of block that thei mention earlier .
so .
the microblock , it's still at <num> x <num> block .
it's the same definit actual back from mpeg <num> and <num> .
and then , the first choic is i just divid it horizont .
it's shown here .
so thi is now <num> x <num> .
or vertic , thi is <num> x <num> .
it will split thi split into four , so each of them now is <num> x <num> , a block in essenc .
further subdivid , the wai it is shown here , so thi is now a <num> x <num> block .
thi is an <num> x <num> block , and each of these littl on ar <num> x <num> .
and then you can have combin as shown here .
so , thi wa divid in four .
and then we have the choic of the vertic and the quarter .
so , you see that , the , larg number of combin of the block size and therefor we can accommod ani scene util in thi wai .
so it offer quit a lot of flexibl .
again , it's not a arbitrari visual that would be veri difficult to signal to the decod , but each on of these seven choic , so therefor we need three beat to let the encod , the decod know which of these choic were pick , so which block wa us for motion estim and motion compens .
howev , the benefit outweigh the cost and thi is on of the featur in h . <num> that provid quit a lot of benefit .
in thi exampl we show the benefit of the variabl block size in do motion estim compens .
so it's a specif sequenc you us , the bu sequenc , it's a cif and it's at <num> frame per second .
so on the horizont axi we see the bit rate ; how mani bit ar sent per second .
and then vertic is the qualiti of the construct video , the moder .
so what we see here is that if a fix block size is us , then we get thi curv , the green curv .
if mode run in four from previous us we get the red curv .
on three the blue curv , and so on .
so , two main observ here .
in go from a fix to a variabl block size , you see quit a bit of benefit .
so , for exampl , if you take ani point here , you can look at it either , i fix the bit rate , and then you see that , you gain about a degre in perform , or if you think the qualiti , at thi point for exampl , we see that we sai , thi is about <num> kilobyt per second .
and the second observ is that the major benefit come from util variabl block size versu fix and then within the fix it's , it's it's the situat of diminish return like the improv is not as great as possibl .
howev , in go from a fix again thi green curv .
to the combination seven , if i allow myself to us ani of the seven is shown befor then we have taken thi care .
and again , the , the , differ either , the differ in bit rate is over <num> kilobyt per second or in qualiti , you gain over <num> just by allow the encod di flexibl of variabl block size when motion estim is perform .
so let us see with a littl toi exampl here what is the benefit of , the variabl block size in do motion estim .
so you see here the two frame that time equal <num> and t equal <num> .
and you see that the cloud move to the right here awai from the sun .
now , thi is a microblock , a <num> x <num> microblock that i tri to match to the previou frame , so that predict base on the motion is take place .
us thi fix on , the best possibl match is achiev at the locat shown here .
so we see that the best possibl match doe not realli reflect what happen becaus here the cloud and the sun overlap , while here thei , thei're complet separ .
so thi is realli a veri bad , terribl predict , but that's the best that we can do under thi specif model of block match .
so here we see the match of the rest of the block .
in which case thi is accur so in thi case there is no need to consid , split the block , but us just the fix block size can do a good job in , predict the scene .
but now , if we ar allow to us variabl block size then it would be reason to split as shown here the block vertic so each of them is <num> x <num> .
and then thi on on the left is match to thi on .
it ha much bigger overlap with the sun while thi on to the right is match to thi on sinc there is much bigger overlap with the cloud .
so it's again a toi exampl but i believ it strongli demonstr the benefit of thi addit of flexibl of us a variabl block size .
on of the major innov of h . <num> in from previou standard is the us of an arbitrari refer frame .
so , in <num> , as we saw , the refer frame for predict is alwai the previou frame .
and we also saw that in mpeg , in other version of h . 26l , some frame ar predict from both the previou and the next frame and we call them bi direct frame .
so thi is what wa done in the past .
now in <num> , ani frame can be us as a refer .
so the encod and decod maintain synchron buffer of avail frame that were previous decod and their refer frame is just specifi by the index into the buffer .
so clearli thi allow thi tremend flexibl , becaus you can match on block if not in the previou frame if you're allow to look at <num> or so frame in the past then you ar bound to find a much better or the best possibl match .
clearli thi increas tremend storag .
but storag as we know is veri , veri inexpens .
so there is no major difficulti here .
but of cours it increas the search size .
but thi is becaus of the faster processor we have avail , doe not present an issu either .
so we still have the bi predict mode .
and now , the , each macroblog can be predict from on of the two refer and if predict from both weight mean of predictor is also a choic .
so thi get not chang , but instead of us two frame , on in the front , on in the back , we can us arbitrari number of frame .
so here is a simpl demonstr of thi multi refer frame motion compens predict .
so what ha been done so far by all the standard ?
i'm at the frame n and i consid just the previou frame , so then for thi specif macroblock here we look and find the best match in the previou frame as we cover multipl time and also go and talk about motion estim earlier in the cours .
so thi is the best match for thi particular case .
so thi is where the frame is match with thi particular macroblock .
in the previou standard we onli have avail the previou frame and therefor that's the best job we can do .
now with <num> we're given the option to look at frame and minu <num> and we find the best match there .
and let's sai for exampl it wa with thi is a result motion vector .
and then we ar abl to compar if the match at frame n minu <num> is better or wors than the match of frame n minu <num> .
and we ar allow to pick the smaller on .
but we don't stop at n minu <num> , we can addit frame it is a matter of factor allow to look at <num> frame in the past , and it's should be intuit clear that you ar bound to find by and larg a better solut .
but in the worst case the solut you obtain by us just frame n minu <num> is includ in the other solut .
so you cannot do ani wors .
you ar onli bound to do at least as good , but probabl better .
so here's the look at the rel perform comparison , we compar <num> if we onli us the previou frame , then we intention modifi <num> us up to five frame .
thi is not allow by the standard but we want to see even <num> how it will improv .
and then <num> us on frame and us five frame .
so the blue curv , the worst perform , is h . <num> with on past frame and do motion estim compens .
and we see that <num> , if we're allow to get the offici wai to us up to five frame it move now to thi curv .
so , we see a benefit of about 1db let sai at <num> kilobyt per second we see that , the perform improv by 1db , with respect to the video qualiti , in term of psnr of cours .
and here we onli comput with respect to the y compon .
now , with , <num> , just us on past frame , we have thi consider jump in perform , and , actual , justifi thi , rule of thumb .
that you get the same perform at half the bit rate .
so it will look , for exampl , here , at <num> db right <num> is around here and thei should be around <num> or so kilobit per second while it over here for <num> and thi is around <num> kilobit per second .
so it roughli speak again , twice their ag for the same qualiti .
and then we see that the improv in <num> by allow multipl frame for predict is not as sizabl as in jump from <num> to <num> .
and thi would be expect becaus the , the , the , the higher you increas the perform the smaller the room for improv there is .
intra predict is anoth major notat of h . <num> , so we do tempor predict through motion estim but no special predict when an intra encod macroblock is , is encount .
so the motiv is that intrafram in natur imag exhibit strong correl .
it's the same exact motiv we've been us when we talk about predict .
thi is actual implement to some extent to <num> and but it's done in the transform , not in the spatial domain .
so the macroblock and intra code frame ar base on previous code on .
and we need to have alreadi code pixel becaus we want the decod and the encod to be synchron .
to be abl to oper on the same exact data , so there is no error and the past is abov and to the left of the current block , assum a raster scan of the frame and those of the macroblock can be sub divid as we'll see into <num> <num> x <num> sub block which ar predict in a cascad fa , fashion .
thu show it right awai with an exampl .
of cours we have to let the decod know which of the neighborhood , which of the mode is us in , do the predict .
so there's an overhead but again , the benefit outweigh the cost .
so here the macro block is shown .
so thi is a <num> x <num> macro block .
and then as you can see it divid into <num> x <num> block .
so the nabl to the left , and the bov ar us as predict .
so thi ar also <num> x <num> block and these repres code intens valu so thi is recurs comput .
were us also the past to predict the current valu .
so if vertic predict is us , then the valu of these block ar propag vertic .
that's what we're try to show here with these color code .
so thi grai valu is propag thi wai .
it's differ valu is propag thi wai .
and so on .
so thi for the predict of thi micro block under consider and we're go to take the differ between the actual valu and the predict valu to form the predict error which is go to be sent to the decod .
so the assumpt here is that there is continu into your smooth or strong correl to vertic direct .
altern we can us the horizont mode which mean now these valu ar propag horizont so these ar all the same valu , these ar all the same valu .
again that's a predict , i find the predict error and encod it and send it to the decod .
thi predict along the main diagon so these valu now the same .
so in summari here we have all these mode that ar shown here .
so we can predict actual at the <num> x <num> macroblock level .
the predict is vertic , horizont , the and the three plane as demonstr here , all the predict can be done at the <num>x <num> level .
and it's the vertic , horizont , the down left diagon .
or downright , vertic right , horizont down , vertic left and horizont up .
so you see that there ar four <num> x <num> mode and then five plu <num> , <num> x <num> mode , and therefor , the idea goe that each and everi situat , i consid all these mode .
and of cours we'll util the on that will give you the best perform the smallest predict error .
so there's a cours of cours again associ with thi that the decod need to be notifi as which on of these all , all , all of these choic wa us in do the predict .
but base on excess , extens experiment .
the benefit outweigh the cost and that's why it ha been inter , includ in the standard .
so from the list of new featur that i show at the begin of thi part of the present .
we've talk about motion compens , intra predict .
so let's look now at what is differ when imag transform ar take place .
so when it come to the transform , the dct is us again , as in the previou standard .
howev , it's realiz that when real number oper ar us in fight the cosin transform , then inaccuraci can be us when intak the invers dct .
so in other word , if i take a block and take the forward and follow by in the invers dct , i will not find exactli the block i start with .
so sinc now we ar us variabl block size for motion estim compens , there is less spatial correl and therefor there is no need for the 8x8 transform .
so what <num> is do is us a veri simpl integ 4x4 transform .
so it's an approxim to the 4x4 dct , but it's implement us onli integer in other word , .
matrix , matric that contain onli plu minu <num> and plu minu <num> .
and then it can be comput clearli with onli addit , subtract and shift .
so it's a veri effici implement that doe not take anyth awai from the implement of the dct us real life method .
the loss in qualiti is neglig , at the level on the averag of <num> . <num>2db .
so the gain in , in speed of implement outweigh the , the littl margin of loss here in qualiti , due to thi approxim of the dct that is us .
the deblock filter is a filter that you us in the feedback loop .
when the construct pixel ar us from the past to predict the current pixel valu .
so thei had been us in the past , but , as we know when we compress and especi at high compress ratio's .
we have these annoi block artifact .
thei ar artifici , and thei , distract from the qualiti of the imag .
thei're veri visibl to the human ey , especi at low bit rate .
so , previou standard us a deblock filter , but thei us a veri simpl on to , as i call it here , to smudg the edg between block .
no sophist filter wa us , and therefor there wa no benefit .
that's why thei were us earli on , and then thei were abund .
but here , what is done in <num> , is that there is a choic of filter .
so there's some adapt and depend on the type of edg on of five deblock filter ar us .
and thi is just a veri reason but also known thing that on can do .
you us adapt and you adapt to the content of the imag and base on the type of an edg at differ filter appli .
so , for exampl , if both block , both neighbor block have the same motion vector , then less filter is need .
the experi show that the qualiti improv , not just the psnr .
so , for the same psnr .
on can reduc the bit rate by <num> to <num> , and of cours , everi littl , bit help .
i should add here that all these benefit and effect ar not necessarili addit .
so , we mention here a benefit due to the deblock , earlier , we mention a benefit due to the multifram motion estim compens .
but these two benefit again , thei , thei do not add , it's not a linear process and therefor on ha to includ all of them to see what the benefit is .
so here an exampl of the benefit of the us of the de block filter .
thi is a frame from foreman , so no deblock filter on the left .
the psnr is <num> . <num> db .
and while the deblock filter is us , on the right , then the psnr increas by about <num> or so , point <num> that is db .
although in term of psnr , the , the benefit is not tremend .
if you have a close look at the imag , the visual qualiti doe improv .
and thi is on of the issu of how exactli on can measur the , the visual qualiti of an imag .
but by and larg , the block is part of <num> , and the benefit ar there .
move down the list of the new featur in <num> , let's see what's new in entropi code .
we have cover alreadi these three new featur .
so with respect to the new featur in entropi code .
the , we have to look at what wa done in the past and in the past the tradit code us fix , variabl length code .
the huffman style code thei're non adapt and thei cannot encod symbol with probabl greater than than a effici .
sinc at least on bit is requir .
and these ar all point that we made when we were cover imag and data compress in week eight of the class .
<num> defin an arithmet coder .
but it is still non adapt and it us multipl non binari alphabet .
and thi result in high , high comput complex .
so , .
there wa an improv , improv alreadi in <num> .
but with <num> thi so call cabac call the deduct binari code is us .
so thi is a framework that wa specif design for <num> .
and it binar all syntax symbol .
which ar translat into bit string .
so , there ar <num> predefin context model , and these ar us in group to encod the variou paramet .
so , for exampl , model <num> to <num> ar us to code the macroblock type for inter frame .
if you recal we have all these possibl in do intrafram predict and therefor each of them need to be signal to the decod and the model to us is select base on previous encod inform as the context basic same idea that we cover .
but a number of time alreadi .
so us the same test sequenc as befor .
thi is the bu sequenc cif at <num> frame per second .
we show the rel gain for go from univers variabl length code to thi binari context adopt binari .
so thi is a for vlc .
and thi is the for cabac .
so , you do see some , some benefit certainli .
you might sai it's not tremend , but it's , it's sizeabl .
so , for the same qualiti here , it will look at <num> db psnr .
we see that there is about <num> kilobit per second or so improv . the fileum , new featur we're go to address is that of frame and slice .
so along thi line in previou standard , <num> and mpeg each frame is either p , interfram or i , intrafram .
except is that some macroblock in p frame mai be intra code , and ar call i block .
but now with <num> , thi is gener .
and each frame now consist of on or more slice .
the slice ar quit flexibl .
thei ar form by contigu .
group of macroblock , and thei're process in intern raster order .
the main concept of a slice , which wa also includ in previou standard , is that thi group of macroblock can be independ encod and decod .
so thei've us , been us by and larg to stop error propag .
due to thi independ encod decod , there is no , there ar no depend from on slice to anyth outsid the slice and now we have , we can have intrapredict and also bidirector , bidirect or b slice , so look at applic <num> demand a strong processor .
it should be clear base on all the mani comput and choic we have to perform .
it ha been us in cellular product but usual the baselin .
so it's a simplifi version of <num> it doe not have as the typic refer to all the bell and whistl .
and , but there ar mani variant to decod onli .
it also been us in set top box .
so broadcast , in conjunct with transcod and for person media , such as camcord storag .
it's , you might sai an overkil for surveil applic .
but sometim is us in high end system so there's no such great need for a surval video but typic stationari noth is happen and onli onc in a while an event of interest is take place .
so in provid some commentari regard <num> on on hand is thi magnific latest and greatest of the standard .
it includ veri competit compress , applic friendli user us , such as the flexibl macroblock orbit here .
and the flexibl slice .
and also it includ a larg select of option tool in the higher profil , such as the film grain analysi , .
but it's also a cumbersom standard .
we , we see that there ar so mani comput that have to , to take place .
and it's a much higher complex than <num> or mpeg2 .
and some of the complic featur is the 4x4 transform , the smaller inter predict block .
and again there ar mani more choic , mani more featur to run such as the multipl refer frame , the deblock filter that we talk about the quarter pel motion estim motion convers and then actual on can us also adapt vlc's for half encod but the content of that binari code is the main featur of it .
so , in summari , with expect to <num> , some of the veri strong result is the quarter pixel predict , cabac and the deblock filter , and it's been the major improv sinc the 90s and here's thi two fold improv in perform .
welcom back .
in thi segment we'll briefli describ the latest video compress standard , the high effici video code standard , hgvc .
it's a result of the effort by the joint collabor team on video code and it is therefor addit name .
it's call h . <num> by itu t , and mpeg h part two by mpeg .
as comput becom more power , more involv idea from the literatur , or new idea can be implement and test .
so the old idea of break a frame into block of variou size us a structur .
to perform motion estim and compens can now becom part of a standard .
sinc adequ comput resourc ar avail .
similarli , instead of the eight spatial predict mode us in h . <num> <num> plu <num> .
such predict mode can be implement in h . <num> .
the overal result is that the latest standard is a veri power on .
especi for larg spatial resolut .
as a matter of fact , it support resolut up to 8k uhd , ultra high definit .
it's realli fascin to watch the progress the video compress standard ar make .
thei bring of cours up the import question of how much longer can we be push in the envelop .
by have the rate of the previou standard while maintain the qualiti of the construct video .
mayb some of you might be the on to further push thi envelop .
so let us look into some of the detail of thi excit standard .
high effici video code standard is the latest standard out of the joint collabor team on video code .
that initi object can be to reduc the bit rate by <num> of the same qualiti when compar to h . <num> high profil .
sinc it's a joint def it ha variou name ; in itu is refer to as an h . <num> or an h next gener video code .
wherebi the iso is refer to as mpeg h part <num> .
in compar hevc to h . <num> it provid in practic better code effici by more than <num> at the same qualiti level .
it support resolut up to 8k uhd while h . <num> support resolut up to 4k uhd .
it also support stereo and multi view video encod and also it support increas us of parallel process , as we ar go to see .
on of the novelti of atvc is the us of code tree unit and code tree block .
the ctu contain the lumen and chromac b as well as syntax element .
so thi is a departur from the standard <num> by <num> microblock us by all standard .
of cours , we saw that h . <num> subdivid thi microblock into variou size .
thi ctu howev can be as larg as <num> by <num> pixel .
and therefor , it's suitabl for encod high definit content and result in better code effici .
the ctu is subdivid into code block , which can be as small as four by four , base on their structur .
and of cours some rate control logic .
what we see in thi tabl is how the ctu maximum size affect the bit rate , the encod time and the decod time .
so when the largest possibl ctu is us , we ar save bit .
becaus there ar mani more choic in sub divid the ctu and adopt to the content of the frame .
so with the smaller ctu size the bit rate increas by <num> here and <num> .
if we consid the smaller on , which is concis with the standard size of the macro block .
the encod time howev is higher here , becaus again there ar more choic to be made .
the decod time howev is smaller than the other choic of the ctu's .
becaus there ar larger now block and not so mani block to be decod .
the idea of cours of us a quad <num> segment or tessel the frame is not new .
here's an old result and we see here the segment for thi particular frame .
and those ar the associ motion vector for each of these specif block .
the actual segment as well as the bit alloc wa done in the in thi particular work .
behind the segment i show you the previou frame , there's thi multilevel trelli that on hand show the structur .
so a <num> by <num> block is potenti broken down into four <num> by <num> , <num> by <num> and four <num> by <num> and so on .
but thi trelli also allow us to perform optim bit reloc for encod the segment , the motion vector .
as well as the textur so that the overal perform is optim or the overal distort is minim .
we see here the code three unit idea be demonstr .
base on thi segment or tessel of the space or the code decis will be made .
how the bit will be alloc again , amongst segment , motion vector , as well as textur .
here's an exampl show that the tessel of thi frame from the foreman sequenc by h . <num> and h . <num> .
clearli seem mani more choic avail with h . <num> , their code effici onli increas .
so here we see that there ar larg block <num> by <num> , smaller on all the wai down to <num> by <num> .
their choic again ar not as mani when we work with h . <num> we talk about the variou choic in the previou present .
when it come to motion estim and compens , quarter sampl precis is us for motion estim .
and thi wa the case also with h . <num> .
h . <num> howev us <num> tap or <num> tap filter for thi fraction sampl interpol .
while h . <num> us a <num> tap filter to go to half sampl precis and then linear interpol for quarter precis .
regard motion vector signal .
an advanc motion vector predict scheme is us .
accord to which candid motion vector have deriv from neighbour predict block .
in addit there's the option to merg or inherit motion vector from the tempor or spatial neighbor .
and thi compar to hw64 then it's an improv skip or direct motion mode .
as far as interpredict goe aw65s support <num> differ direct mode .
as compar to the eight on that ar support by aw64 .
and thi direct mode appli , thei're appli to block from <num> or the wai up to <num> by <num> .
in addit , there is the planar mode predict .
and it's done by assum an object servic with the horizont and vertic slope that is deriv from the boundari .
and final there's anoth mode , the dc predict or flat mode predict .
accord to which a flat surfac with a valu match the min valu of the boundari sampl is util .
we see here a pictori the <num> predict direct , and direct zero is the planar predict and on the dc predict we just mention .
it should be note here that all these direct ar not equal space and some direct ar more popular than other .
so we see here schemat that intra predict by the direct of mode <num> as goe number in the previou slide .
when us thi intra angular mode each block is predict direction from spatial neighbour sampl that ar reconstruct .
but not get filter by the in loop filter .
for a block n by n , a total of four n plu on spatial neighbour sampl mai be us for thi predict .
when it come to entropi code a cabac encod , context adapt binari arithmet code that is us to in , in <num> as is the with <num> .
the on h . <num> ; howev , ha undergon sever improv to improv it throughput speed .
especi when it us for parallel process , it compress perform and to reduc it context memori requir .
and in <num> no variabl length code ar us as oppos to and variabl length code in h . <num> .
with respect to the in loop filter .
thei're us in the inter pictur predict loop .
it's similar to the on us in h . <num> howev it's simpler than the on us in <num> and it better support parallel process .
and also a differ filter , thi sampl adapt offset filter is us .
it's appli after the deblock filter so that a better reconstruct of origin signal amplitud by us an offset from a look up tabl .
hevc support slice and tile .
slice ar row of ctu , as shown here .
thi is an exampl of a slice .
and as mention multipl time dure thi week , slice ar need for termin error propag .
sinc thei're independ decod , decod .
in addit to slice , hdvc support tile .
and tile ar self contain and independ record rectangular region in the pictur .
so thi is on tile here , thi is anoth tile and so on .
the main purpos of tile is to enabl the us of parallel process for encod and decod .
now the slice is divid into row of ctu's .
so the decod of each row can begin as soon as some , the decis ar made .
and therefor thi support parallel process in the form of thread as shown here .
so all thi thread can be process at the same time .
so there ar two differ mechan , if you will , that support parallel process .
the us of tile and the us of thread .
we show here an experi of comparison , of some of the more recent standard .
so hdvc is compar against <num> , <num> , mpeg <num> , and mpeg <num> .
so the rate distort curv ar shown here for thi particular sequenc .
so , the bitrat is down here , from <num> to <num> megabit per second , and the psnr improv is shown on the vertic axi .
so as expect you see kind of the chronolog of a develop of these standard .
the older standard ha a registr curv shown here and the newest on ha the registr curv shown here in blue .
so there ar consider save involv as the newer standard arriv and the save ar shown on the plot here on the right .
so what's shown here , is the bitrat save with respect to hevc .
and we sai that with respect to the older standard , there's save anywher between <num> and <num> .
y with respect to aw64 the save rang from <num> to around <num> down here .
so in some sens , we can , we have come to full circl .
if you recal at the veri begin of thi week's lectur .
i show the similar rate distort comparison with some of the earlier standard with also smaller sequenc .
we us their format , a qcif imag .
at frame rate i believ it wa ten frame per second .
nevertheless the philosoph question still remain .
as time goe on these curv keep be push thi direct and we see here that there's not that much space left .
so the obviou question is will there then be a next standard that can push the envelop even further .
or in other word , what is realli the limit of compress ?
how far can we compress a given video ?
thi is a question that we can not realli answer .
we have to wait and see .
you know for the reduct of the bit rate is go to be with the new standard while keep the same qualiti .
of cours , the object chang as well .
we have the prolifer of larg displai and larg format the 4k and and 8k format .
and clearli , we need new tool and new approach to handl these larger format .
at the same time , the comput speed and capabl increas tremend as time goe on .
and it's onli natur that more sophist algorithm will be abl to be implement .
that will of cours provid the addit gain that ar need .
so we reach the end of week ten , two more week to go .
dure thi week the third week out of three dedic to compress we talk about video compress .
thi is probabl the most import topic from an applic point of view sinc we ar surround by applic us in video compress .
thi is also reflect by the larg number of video compress standard .
we discuss and analyz the import topic and cover some of the intellectu interest and practic us techniqu .
we talk about the import concept of tempor predict and also of the concept of intra and inter predict .
we describ the evolut in video cooper standard which repres a histori of the research and develop in thi area .
i repeat here a comment i made last week , that is , there wa noth realli terribl mathemat in thi part .
so i hope everybodi feel comfort with thi materi .
you're now knowledg to also follow the futur develop in thi excit film .
next week we'll talk about a differ topic .
the topic of imag and video segment .
so , see you next week .
welcom to week <num> .
thi and on more week to go .
we'll address here the import topic of imag and video segment .
for mani applic you're go to be abl to group pixel togeth base on some of their characterist .
intens and color come to mind right awai , as such characterist , but also mayb motion .
so for exampl , bright region in an imag can be group togeth , or region which have a certain color , or region which have similar characterist in a medic imag , or region which move the same wai in a video .
thi is the problem of imag and video segment .
it's an import problem , with a larg number of public in the literatur .
on of the difficulti actual with thi problem , is that there is no establish ground truth in an imag .
in other word .
if an imag is present to two dif , two , let's sai ten differ peopl .
and thei're instruct of how to perform manual segment .
most probabl thei'll end up with ten differ segment .
we describ segment techniqu , which ar base on intens discontinu , that is edg .
on intens similar and on morpholog featur of the imag .
we also present , present techniqu perform motion base segment and final some techniqu which in , we can call them advanc techniqu , such as mean shift and graph cut .
so , let us proce with thi excit materi .
as the sai goe , the whole is greater than the sum of it part .
human be perceiv an imag as a whole , extract mean behind the imag , and the segment of the imag is a natur and intuit task , an easi on we would sai .
machin on the other hand , perceiv an imag as a matrix fill with number .
don't have a clue what the big pictur is .
and therefor , segment of the imag is an extrem difficult task .
the object of imag and video segment is to break the imag of the video into constitu meaning region .
and thi divis can be base on a number of attribut .
such as color , textur , and , or motion .
as alreadi mention , segment is a difficult task for the comput and some of the challeng ar the ambigu in the data .
the ever present nois , the need to integr high level inform into the segment process and the lack of ground truth .
if for exampl the , an imag is given to ten differ peopl with specif instruct of how to go about segment thi imag .
most probabl , we'll , we will end up with ten differ segment .
base on that , the current think in evalu the perform of a segment system or the qualiti of the result segment is to do so by consid the end to end system .
so in other word , how will thi segment be us ?
will it be input to a restor system , a classif on , compress on , track on and so on .
we will present some basic techniqu in thi class which ar base on intens discontinu .
intens similar and and morpholog .
as we will see with some of the techniqu , the output of the system will be the boundari of a region .
and clearli if thi boundari is close as shown here , then thi boundari defin a region , the pixel that ar insid thi boundari .
other techniqu .
will provid the pixel belong to a region .
so , if all these pixel belong to a specif region then clearli on can defin the boundari that separ thi region from neighbor region .
dure thi week , we will look at method toward segment base on the intens discontinu .
and more specif , we will look at edg base segment .
we'll also look at method that ar base on intens similar .
more specif , threshold , region grow and region split and merg .
we will then studi the watersh and k mean algorithm .
and final we will look at some advanc method , such as motion base segment , mean shift and graph cut .
on group of algorithm we will studi toward segment , ar base on the detect of the discontinu .
in the imag intens .
and these discontinu repres the special edg in the imag .
so , given an imag like thi , thi is a pictur actual of a statu of hercul hold the two pillar , europ and africa .
it is the statu that can be found at the entranc of the harbour in ceuta , in spanish morocco .
so we want to find the pixel at which the intens transit from high valu to low valu or from low valu to high valu .
and such pixel will give rise to these edg here .
if we have a sensit enough algorithm it might also detect the .
chang in intens at these locat .
thi is a mountain rang in the distanc , if you pai close attent you should be abl to see it or mayb pull out these intens chang .
the result with on of the algorithm we will discuss is the on shown here .
so thi result .
thi algorithm did a good job in pull out the major edg , howev it miss the not so strong on .
the on in , in the distanc , i alreadi mention .
so what ar some of the wai to detect the edg ?
a group of algorithm ar base on take the first deriv of the intens , the so call gradient of the imag .
we will see some specif kernel to allow us to take the gradient due to sobel , prewitt and robert .
we will also look at algorithm that util the second deriv of the intens or the so call laplacian and more specif , we'll discuss an algorithm due to marr and hildreth .
and final we'll also look at an algorithm due to canni , that also detect the edg in an imag .
we talk actual about gradient and the laplacian when we cover recoveri .
and when we cover also , enhanc .
let us see what inform the 1st and 2nd order deriv provid us with .
let's consid and on dimension continu function f1 of x that look like thi .
if thi were to repres the intens of an imag then thi is a good represent of a transit in intens where an edg is locat .
so it transit from a low valu here to a larg valu up there .
thi is actual a more realist represent of a .
transit in intens in imag of natur scene versu these sharp transit you might see veri often as repres edg .
so let's take the first deriv of f1 of x .
we know that the deriv is zero down here and it's also zero up there , so it increas the deriv and after a point it start decreas so that it reach zero again .
so inde the first deriv look like thi , so the maximum of the first deriv is a good candid to tell us where an edg is locat .
in thi smooth transit .
it's probabl hard to tell which specif pixel repres the edg , but the maximum again of the 1st deriv is a definit good candid for that .
let us look at , anoth imag or on dimension continu function f2 of x that look as shown here .
so it start at the larg valu and .
decad to a smaller valu .
so thi could also be an edg go from a high intens to a low intens valu .
take the 1st deriv of thi we know that the deriv is zero here and it's zero here as well , so it should decreas and after a point start increas and until it reach zero again .
so inde thi is the 1st deriv of f2 of x .
in thi case is the minimum of the 1st deriv that indic the locat of an edg , or if i take the absolut valu is again the maximum valu of the 1st deriv indic the locat of the edg .
let us now consid the 2nd deriv of f1 of x .
clearli , thi is the 1st deriv of it 1st deriv , f1 prime of x .
if we look at f1 prime of x then thi .
is realli an f1 of x follow by an f2 of x .
so , we think thi is up to a point and then start .
decreas .
and therefor , the deriv , the 1st deriv of a function like thi should be thi .
so if i take the 1st deriv , it should be an f1 prime of x , follow by an f2 prime of x .
so inde , the secondari valu of f1 of x look like thi .
so in thi case , it's the zero cross that indic the locat of an edg .
if you consid the 2nd deriv of f2 of x , which is the 1st deriv of f2 prime of x , then we see that f2 prime of x consist of an f2 of x , follow by an f1 of x .
and therefor , if i take the deriv of thi , it should be the deriv of f2 of x follow by the deriv of f1 of x .
so inde the 2nd deriv of f2 of x , look like thi .
so again , in thi case , it's the zero cross that indic the locat of an edg .
so in summari , take the 1st deriv of the function , that maximum of it absolut valu will indic the locat of an edg , while when you consid the 2nd deriv is the zero cross , the locat of the zero cross that indic the locat of an edg .
let us now look at the gradient oper .
we introduc the gradient dure week <num> when we talk about imag recoveri .
given an imag , x , n1 , n2 , is gradient , you notic by thi upsid down delta , or is a vector .
x is a scalar , it gradient is a vector .
the first compon is a partial of x with respect to n1 .
while the second compon is a partial with respect to n2 .
so here is our imag coordin system .
and let's consid a pixel locat n1 , n2 .
so at thi pixel , the partial with respect to n1 .
is denot here , so thi is , the partial with respect to n1 , which we also call g1 , n1 n2 while , let's assum thi is the partial .
with respect to n2 .
so , thi is the length , or the valu of the partial in the n1 direct .
so the gradient is the vector that ha .
these partial as it compon , it project , so thi here , the gradient at locat n1 n2 and clearli point to the direct of the greatest chang in intens .
veri often we're interest in the magnitud of the gradient .
so it's a magnitud of thi vector and us the pythagorean theo , theorem , is a squar root of thi compon , squar .
plu , these compon squar .
we can also find the angl of thi vector , alpha , which is simpli the invers tangent of the vertic compon which you call g of <num> .
n1 n2 divid by the horizont compon , g1 of n1 n2 .
the next step toward edg detect , is the calcul of the gradient .
on of the standard question in numer analysi is how to approxim deriv .
1st order , 2nd order deriv , in on or higher dimens .
so the gradient consist of thi partial .
deriv of all the on and in approxim thi variabl us , we're go to us neighborhood differ .
there ar clearli multipl wai to do so and what we'll be do , we will find filter .
with impuls respons , let sai , h1 .
so , thi is the filter that will give rise to the estim of the partial in the n1 direct .
so thi is what we call g1 .
so , thi is the partial of x with respect to n1 .
so it's a linear , especi in variant filter , with impuls respons h1 .
similarli , we will defin filter with impuls respons h2 , which will give rise to the partial of the imag in the vertic direct .
as alreadi mention .
toward the detect , we will be , be make us of the magnitud of the gradient , which is written again as the previou slide in term of g1 now , and g2 .
so , clearli the next question is , what ar some exampl of thi impuls respons of these filter that will again approxim the horizont and the vertic partial deriv .
we show now some exampl of the impuls respons , h1 and h2 , as we call them in the previou slide .
for find respect the horizont and vertic first order differ , i call them here kernel .
at lyon , peopl would associ their name with some of thi wai to approxim first order deriv .
so , the on due to robert ar shown here .
so thi is the impuls respons to find the horizont differ , h1 .
actual , what's shown here is minu n1 and minu n2 .
so thi is a flip around he point the spot in both direct , it's a step we need to take when we go for convolut .
so thi particular mask is move around on the imag and directli multipli the pixel valu .
so we see here that accord to robert to find the horizont partial deriv we find the differ along the forti five degre direct , so the pixel valu at .
xn<num> <num> , n2 <num> will be us and from that we will subtract the valu of the pixel at n1 and <num> .
so similarli thi is a wai to find the vertic first order differ .
these kernel accord to sobel look like thi .
so , in thi case , six pixel ar us in find the horizont and the vertic differ .
and the mask , kernel , impuls respons accord to prewitt look like thi .
again , thei're all reason wai to find thi first order deriv .
actual , if we compar thi and thi , thei look quit similar .
the onli differ is that the valu here , at thi particular locat , ar differ , while everyth els is the same .
thei do have actual sobel and prewitt also filter , to detect diagon .
chang , so for exampl , accord to sobel , thi is also an impuls respons to find , differ in the <num> de , degre direct .
so <num> , <num> , <num> .
minu <num> , minu <num> , minu <num> .
so when you see exampl in what we'll be do or in the literatur that the sobel or robert , agit wa us , you know , exactli now , that these ar again ampl respons that were us to approxim .
restor the deriv and therefor , the gradient .
we show here the block diagram of a repres gradient base , edg detect system .
x1 and <num> is the input imag for which you want to find the edg .
the gradient for thi imag is what you want to find first so at thi point we have avail a two dimension arrai and each entri of the arrai is a vector .
so here's exampl of it .
after thi step the magnitud of the gradient is found so at thi point we have thrown a wai the direction of the edg and we just kept it strength so that .
length of the vector , so we now have a 2d arrai where each entri is a scalar .
so , for exampl , thi is <num> , <num> , <num> , <num> , <num> , <num> , . <num> and <num> .
so these number ar compar against the threshold .
if the number at locat m1m2 is smaller than the threshold , than no edg exist at that point .
if , howev , the valu's greater than the threshold , then .
that m1 , m2 pixel belong to an edg .
sinc we identifi edg pixel base on thi threshold oper , veri often we end up with thick .
edg , multipl pixel belong to an edg and therefor typic an edg thin algorithm .
as the name impli , the of such edg is thin , becom smaller , mayb a coupl of pixel .
and after that .
we have avail the edg map of the origin imag x , n1 , n2 .
we will demonstr the effect of the applic of the oper with thi imag .
thi is an imag that i show back in week five when we talk about enhanc .
it's a pictur actual of the technolog institut here at northwestern that wa taken back in <num> .
the build look veri differ todai .
my offic is around here .
plu here where like michigan us to be there and now about .
half a dozen build , due to a landfil that wa made sinc <num> .
we can thi imag with h1 , n1 , n2 .
due to sobel .
but we did see the exact form of thi function a coupl of slide ago .
so with thi filter , with a simpl respons , we approxim the partial deriv of the imag in the horizont direct .
therefor , in the result imag .
we detect the vertic edg in the origin imag .
we also detect the boundari in the origin photograph .
we also convolv thi imag with h2 n1 and <num> .
also due to sobel and as you recal , thi h2 approxim the calcul of the parcel deriv in the vertic direct of the imag .
therefor , the result imag will exhibit the horizont edg .
so , thi is what we see in thi pictur and we also see again the .
horizont boundari in the origin photograph , what we observ is that edg that ar neither perfectli vertic nor horizont like , an edg like thi .
thei appear in both imag .
thi on as well as thi on .
the reason for thi is that these slant edg can be approxim by linear either vertic or horizont edg .
so , you see similarli activ in these region where the edg ar not perfectli horizont or perfectli vertic .
let us look now at the us of the laplacian in detect edg .
here is the definit of the laplacian .
is the gradient of the gradient or thi number squar of the imag x n1 and <num> .
it's equal to the second partial deriv in the n1 direct .
plu the second partial deriv in the n2 direct .
the obviou next question is how to go about evalu thi second order deriv ?
as we saw there ar variou wai to approxim the horizont and the vertic first order deriv .
so if h1 is the impuls respons of a filter that will calcul the horizont first order deriv it's appli to the imag so thi is a first order deriv and then we appli gener , anoth filter to find the first order deriv of the first order deriv .
then in find the vertic second of the deriv we appli h2 to find the first deriv and h2 prime to find the first of the deriv of the first of the deriv .
so clearli even the fact that we have multipl wai to repres h1 and h2 , we saw for exampl the as exampl , and sinc , in addit , we can us differ h1 prime and h2 prime to find the second order deriv so the first order deriv of the first order deriv , there ar veri mani combin here and therefor , veri mani wai to calcul the , laplacian .
if i combin the two term here , i have the imag of the outsid which is with the composit filter here , which consist of the convolut of the h1s plu a convolut of the h2s .
and thei can call whatev i have here .
the second site their parenthes and h , n1 , n2 .
so at the end clearli we want to find thi filter that will approxim the calcul of the laplacian .
so when convert with the imag , will give us the laplacian .
we'll show in a simpl exampl what h1 and h1 prime and h2 and h2 prime we can us , so that we end up with the impuls respons of the filter calcul of the laplacian that look like thi .
that's minu <num> in the middl and <num> , <num> , <num> in the other two direct .
let us see now what choic we need to make for the impuls respons h1 , h1 prime , h2 , and h2 prime so as to obtain the two dimension impuls respons of the that i show you in the previou slide .
so in obtain the horizont deriv , .
we us thi express to obtain the 1st partial horizont deriv .
so thi mean that the impuls respons h1 minu n1 minu n2 look like thi .
minu <num> here and <num> here .
so thi is what thi express is tell us .
in find the second deriv which is the first deriv of the first deriv , we us thi express .
so , accord to thi .
the impuls respons of the field there which we call h1 prime minu n1 minu n2 look like thi .
and if i now substitut here for g1 , the g1 i have alreadi deriv abov then we obtain thi express .
so thi tell us that the filter for find the second deriv in the horizont direct ha invers respons .
so thi is h1 , m1 , m2 coevolv with h2 , n1 , n2 .
a respons that look like thi .
minu <num> in the middl , on .
on .
similarli in comput the vertic second deriv , we us thi express for the first order deriv .
thi mean that .
h2 minu n1 minu n2 ha thi form .
minu <num> here and on here .
then in comput the second of the deriv , which is again the first of the deriv of the first of the deriv , we us .
express , which simpli mean that the impuls respons of the 2nd filter which we call h2 prime , minu n1 , minu n2 , look like thi .
it's <num> here and minu <num> here .
substitut g2 from the express abov in here , we obtain the express for the secondari shown here .
so , therefor .
the filter which comput the 2nd partial deriv , 2nd order partial deriv of the vertic direct that is the result of convolut of h2 , n1 and <num> with h<num> prime and <num> and <num> .
here's thi form it's minu <num> in the middl .
<num> and <num> .
and if you recal , at the end , the laplacian is the sum of thi impuls respons shown here .
plu the impuls respons i show in the previou slide and therefor the , the sum will give rise to the theater with impuls respons .
thi on minu <num> in the middl becaus it will be a minu <num> from thi .
minu <num> from the horizont second of the deriv and then <num> at thi four locat .
we show here the blog diagram of a system which can be us to find the edg in an imag us the laplacian .
as you'll see precaut ar taken so as not to gener fals edg .
so xn1 and <num> is the imag of which you want to find the edg it's input to the system .
accord to thi block here the laplacian is found .
the laplacian can be found us ani of the approxim we discuss in the previou slide .
then , we check if each and everi pixel is a <num> cross pixel .
which mean that neighbour pixel chang valu from neg to posit or from posit to neg .
if thi is not the case , then thi is not an edg pixel .
if it is the case , we don't declar thi yet in edg pixel becaus , for exampl , it can be locat in a flat region , so there's no edg there .
but due to nois , when you take the laplacian it give rise to <num> .
so , to avoid the situat we also evalu the local varianc of the imag and we compar it with the pixel locat at which a <num> cross wa detect .
the local varianc is greater than a threshold .
if thi is not the case , thi mean that thi pixel again is in a flat region and the <num> cross wa due to nois .
and therefor thi point is declar as a non edg point .
and don't leav thi local varianc as greater than the threshold we declar the pixel as an edg point .
the result of appli the laplacian to the cameraman imag and find the <num> cross is shown here .
as is clear , we find a lot of addit <num> cross than the on belong to the edg of the imag and thi can be due to the exist of the nois .
if we appli the system that wa shown in the previou slide , accord to which .
at though <num> cross we also utilis the local varianc to determin whether that <num> cross belong to an edg or not .
we obtain thi result .
it's a much cleaner obvious result and .
what we see is white pixel here belong realli to edg and not to nois in the imag .
intens chang occur at differ scale .
for exampl , there ar blurri region in an imag which repres low frequenc , and also fine focus region which repres high frequenc .
it will therefor be desir to band limit the imag first , and then perform edg detect .
so we ar go to have edg correspond to differ scale .
maren hildreth argu that edg map of differ scale contain import inform about physic signific paramet .
in battl within the imag , a gaussian filter can be us , where the variant of the gaussian control the cato frequenc .
did you note that variant here by sigma squar ?
so , for thi smooth imag , edg ar detect and toward the task ani hd detect approach that we cover can be util .
if the laplacian is us , then we can either take the laplacian of the imag , then convolv it with gaussian or convolv the imag with the laplacian of the gaussian , as shown here .
so thi is where the approach deriv it's name .
it's the log approach becaus again , thi is here the laplacian of the gaussian .
the laplacian of the gaussian can be comput analyt .
it's express is shown here .
we've been show all thi function here .
there's a continu x , y variabl .
a plot of thi log is shown here .
what is more inform actual is to look at the log in the frequenc domain .
so the full transform of the log is , shown here , we can again find the analyt express .
if we plot it , here it's how it look .
in thi exampl , sigma is equal to <num> .
we see clearli that the log perform band pass filter and the width of the .
pass band is control by the varianc of the gaussian sigma .
we show here an exampl of the applic of the log approach to thi particular imag , it's the segment of the cameraman imag .
we blend thi imag with a gaussian with standard deviat equal to <num> .
if you recal , take the laplacian of the imag after it is convolv with a gaussian , is equival to convolv the imag with the laplacian of the gaussian .
so , take now the laplacian of thi imag , we obtain thi edg imag shown here .
so , these ar the <num> cross .
if we blur the origin imag with a gaussian with standard deviat equal to <num> and then obtain the laplacian we find thi result .
and final blur with the gaussian with standard deviat equal to <num> and find the laplacian here result in <num> cross .
so , we obtain an edg map at differ scale .
the densiti clearli of the edg is control by the paramet sigma .
on can therefor choos the scale that provid the more suitabl edg for the applic at hand .
or on could potenti combin the edg from the valu scale .
anoth advantag of the us of the gaussian is clearli , the suppress of nois , that might be present in the origin imag .
imag .
a popular and effect techniqu toward edg detect is due to canni and carri hi name , so it's a canni edg detector .
it also us the gradient toward edg detect .
but as you'll see , it us both the magnitud and the angl of the gradient fill .
it consist of four step .
the first step is to smooth the imag with a gaussian filter .
and thi is done toward nois suppress .
so the variant of thi gaussian filter is input to the system .
the second step is to comput the gradient , both the magnitud and the angl .
thi is a step , we cover in detail earlier and we know now that there ar differ wai to comput the gradient and we also know how to obtain both the magnitud and the angl .
the third step , is to appli non maxim suppress to the gradient magnitud imag .
thi is a step i'll explain in detail next , but accord to thi step .
we find the local maximum of the magnitud of the gradient along the direct of the edg .
so therefor the angl inform is us .
and the final step is to creat connect edg with the us of two threshold .
there'll be a high threshold and a low threshold .
and these ar also input to the algorithm .
so we'll look at the detail of the last two step next .
seem there is noth that we need realli to add with respect to the first two step .
the idea of the non maxim suppress step is to find the local maximum valu of the gradient by onli consid the pixel in the neighborhood that belong to the same edg .
thi is determin by the valu of the angl of the gradient , so we util with thi approach all the inform of the gradient field that is both compon of the gradient vector , the magnitud and it angl , and not just the magnitud , as we did in the previou case that we studi .
now , as we saw , the gradient vector is perpendicular to the direct of the edg .
so , a vertic edg ha a horizont gradient vector .
we do not want to be stringent in determin which pixel belong to the same edg , so we quantiz the edg direct into four group .
horizont , minu <num> degre , plu <num> degre and vertic edg direct .
by do so in essenc we divid there <num> degre celkon into four region .
so , an edg is a vertic edg , as long as it direct is in the shade rang between <num> and <num> degre .
thi is a <num> degre here arc .
and , in thi region , so thi is <num> plu <num> and thi point here is <num> plu <num> .
after we establish thi , we examin each and everi point in the angl imag .
and for the particular angl valu , we find on of the four direct that is closest to it .
so , we classifi thi particular pixel as have horizont minu <num> , plu <num> , or vertic edg direct .
then we look at the magnitud of the gradient of that pixel , and we consid the neighbour base on thi classif that you alreadi did .
so if thi magnitud is less than at least on of it neighbour , we ignor it .
we suppress it .
otherwis , we keep it .
we obtain a thin edg from the previou step , but not necessarili a connect edg , thi is actual a common problem with thi gradient base edg detect algorithm .
so , the object of thi step is to link edg pixel .
two threshold ar input into the algorithm .
a high on , t of h and a low on , t of l .
then base on thi threshold , pixel with valu greater than th ar classifi as strong edg pixel , while pixel with valu smaller than tl ar classifi as weak edg pixel .
so the procedur for link the edg pixel is to locat a pixel p that is classifi as a strong pixel and then we look for weak pixel that ar connect to thi strong pixel and if we find such pixel then thei ar append .
to the strong pixel p .
clearli , the valu of t of hand t of l ar critic for the qualiti of the result edg imag .
we compar here experiment three of the algorithm we start so far .
we util thi imag that i show earlier , the pillar of hercul .
and we appli to it , the sobel edg detector and obtain thi result , the log algorithm and we obtain thi result and canni's edg detector with thi result .
as mention earlier , there is typic no ground truth in compar the result of the variou edg detect algorithm .
and so , it's not possibl to come up with an object metric that will again compar the perform of the , these three algorithm .
now , the result shown here were obtain clearli with specif valu of the variou paramet that ar need .
so , a threshold is need for obtain the sobel result .
the varianc of the gaussian is to defin with log and we saw that their three paramet need to obtain the result by canni's algorithm .
so clearli chang thi paramet that result with look differ .
by look at the result we can comment at variou attribut i guess of which , of those .
so we can comment that , that .
thick of the line here obtain by sobel , not a veri desir necessarili qualiti , or we can point to the disconnect edg here by the log or we can also point at the incomplet edg here by canni's algorithm .
on could argu , again look subject at thi imag and qualit that canni's edg detector is definit do a , a veri good job in just pull out these thin and straight edg along thi direct , along thi direct .
still , howev , even thi album ha thi problem i mention , of the incomplet edg .
and that's why we need a hough transform that we will be discuss in the next slide .
the hough transform address the incomplet of straight edg , result from variou algorithm , as wa point out , for exampl , in the result by the canni , s detector in the previou slide .
the basic idea is explain here .
let us consid a set of point that belong to a line or a line ha been fit through the , thi set of point .
so here is the equat of the line .
a prime is the slope .
and b prime is the y intercept of thi line .
we can rewrit the equat of thi line in term of and b .
so in thi ab domain , mine wa .
<num> over x is now the slope , and y over x is the a intercept .
so , thi is now a line in the ab space , the so call paramet space .
for each xiyi , if i fix the valu of x and y here , i obtain a line in the ab space .
so , for on valu of x and y , i obtain thi line .
for an anoth on , thi line , thi line .
thi line and so on .
what is the main characterist of all these line ?
it is that thei go through the same point and thi is the point , a prime , b prime , the paramet of my initi line .
therefor , by look at thi paramet space , the ab space , the paramet of the initi line that i start with , my a prime and b prime , can be pull out .
so thi is the main idea that if i have a set of point that belong on a line then look at the paramet space i can find a slope and the y intercept and therefor i can find an equat .
for the line that goe through all these point .
a difficulti with thi represent is that a vertic line that ha an infinit slope cannot be repres into thi ab paramet space and therefor we need to find anoth .
represent for thi case .
in address the difficulti of repres a line with infinit slope in the ab paramet space that we show in the previou slide the polar represent of a line is consid .
so we see here again a line and hough is the distanc .
of the line from the origin , so thi is perpendicular to the line and theta is the angl .
so , all the point of thi line satisfi thi equat .
we can now us a , a row feta paramet space to repres the variou point on thi line .
so if we consid a particular point xi , yi then it satisfi thi equat and by plot thi equat we get a sinusoid type of curv .
so the reason is exactli the same as befor if i consid multipl point on thi line .
thei will give rise to multipl sinusoid curv like thi and all these curv will go through the same rho theta point that describ my initi line that i want to character .
we show here an experiment result of the applic of the hough transform util the rho theta .
but on the space , which is a space of choic when the hough transform is implement .
so we see here in the xy plane , point that belong to a line , but all the point ar not connect .
for each and everi point , we find it represent in the hough theta domain .
and we get thi sinusoid curv that we show in the previou slide .
so what we observ is that all these curv go through on specif point and thi specif point ha coordin rho equal <num> and theta is minu <num> degre .
so , the domin line that describ all these point pass through the origin and form a minu <num> degre angl with the x axi .
we summar here the procedur step of the hough transform .
we start by find the edg in an imag , us ani of the avail techniqu , like the on we have alreadi discuss .
we then map each and everi point of an edg onto the rho theta plane .
we take the raw theta plane and we break it into cell .
and for it cell , we count how mani intersect we observ .
if thi number is a substanti , then there is a line in the origin imag plane , otherwis there is no line .
and with thi procedur , we bridg the gap base on continu .
and we can declar that the gap is bridg if the length of the gap is smaller than the threshold .
we show here result of the applic of the hough transform .
we util again thi imag .
canni's edg detector is appli to thi imag .
we obtain the edg map , the on i show a few slide ago and then we take each and everi edg point and we map it on to the raw theta plane .
so , that's how it look and we see here that there ar three intersect point here , three at thi locat and three at thi locat .
so , therefor there ar nine line , the domin line that have been identifi .
and these line ar superimpos on the origin imag .
we can us these line to complet some of the edg .
that we found by thi particular exotyp .
so that as we point out earlier , thei were not , complet .
welcom back .
in thi segment we first discuss threshold techniqu .
thei're simpl and straight forward to understand .
the main drawback is the determin of the valu of the appropri threshold .
we describ on approach .
by otsu , which estim thi threshold from the data , util an estim of a histogram .
the criteria for choos the threshold , is that the two class will end up with , in a two class segment problem , should have the largest between class variant .
such a result ha been gener to multipl class .
we also present the region grow and region merg and split approach .
there all intuit straight forward , but their success depend on the predic function us to measur the similar between region .
in addit the region grow method requir the termin of the seed , which might need to be determin manual .
so , let us now look at the detail of thi materi .
segment method base on threshold ar between of clear , simpl to implement and computation effici .
the idea is quit straight forward .
if we have a two class segment problem , then we look at the valu of each and everi pixel .
and if thi intens valu is great or equal then the threshold , then the pixel belong to an object , otherwis it belong to the background .
in thi consider , we assum here that the bright of the object is higher than that of the background , but thi is without luck of gener .
so thi is a similar base segment approach , sinc all the pixel with valu greater than t ar similar .
and so ar the pixel with valu less than t .
clearli , the approach can be extend to the case when multipl threshold ar avail .
in which case , there ar multipl class .
so with two threshold i have three class , and so on .
clearli , with such approach , the valu of the threshold or the valu of multipl of those us is quit import and critic in determin the qualiti of the segment result .
we consid here an experiment studi to see the effect of thi simpl threshold approach that we describ in the previou slide .
we will util the camera man imag and the map will perform shown here .
so for those pixel .
let's have intens abov the threshold , or equal to the threshold thei would be match to valu <num> and those that ar below the threshold would be map to <num> .
so the output of the threshold oper would be a binari imag .
we first set the threshold to <num> .
sinc all the valu in the imag ar greater and equal to <num> , what we will obtain , as expect , is just a white imag .
we rais the valu of the threshold to <num> and here is the binari segment imag you obtain .
the black pixel here have valu between <num> and <num> in the origin imag .
the imag of an object start appear in the segment imag .
we see here the result segment base on threshold when the valu of the threshold is equal to <num> .
and in thi pictur the segment imag when the threshold is equal to <num> .
i would , i view that thi is a surpris satisfactori segment , given the simplic of the approach .
and it could veri well serv our purpos .
class in certain applic .
of cours we can observ here on of the main drawback of such an approach the fact that the region of class ar disconnect .
for exampl if we look at the pant of the camera man thei belong to two differ class and thi is not a desir outcom .
we show here the segment result when the valu of the threshold is at <num> .
we can see that a lot of more pixel now belong to the same class as the camera man .
and here is the result for the threshold valu equal to <num> .
the tripod is pull out with thi particular threshold .
overal , with thi simpl threshold approach , on could experi with differ with threshold , as we did here in thi experi .
and util the segment that is most suitabl for the applic at hand .
and the segment might be subject to further process .
we will see next , what is on wai to determin the threshold in an autom fashion .
we discuss now a method the otsu accord to which the optim valu of the threshold is found onli perform in my segment .
there is a method that ha been veri popular for over <num> year now .
accord to thi method , the global optim threshold is found so that the between class varianc is maxim .
the largest thi varianc , the more like that the threshold will segment the imag properli .
as you will see , in find thi optim valu of the threshold , onli the histogram of the imag is requir .
we discuss now the algorithm detail of otsu's method .
we first comput the normal histogram of the input imag .
so for each intens , we find the number of pixel that occupi that intens and we divid by the total number of pixel in the imag .
therefor each pi  here is a probabl between <num> and <num> , and the histogram repres the probabl densiti function of the imag .
we assum that we have capit l differ intens level .
we chose a threshold k from the avail intens rang valu .
and by do so , we divid the number of pixel in the imag into two class .
class on which contain the pixel that ar below or equal to the threshold .
thei have intens valu between <num> and k .
in class two the set of pixel that have in test valu in thi rang .
accord to otsu's criteria , the optim threshold is obtain so that the between class varianc is maxim .
so thi is the express for the between class varianc , which of cours is a function of the threshold k , that we have select .
p1 of k is the probabl of set c1 occur , while p of <num> of k is the probabl of c<num> of k .
m1 of k is the mean of the intens in class c1 , m2 of l , the mean of intens of class c2 and m of g is the global mean of the imag .
so sinc we deal with the set of intens or set of valu k .
we can evalu thi express for all valu of k we can step through it and pick the on that will maxim the between class varianc .
as we will see howev thi express can be further simplifi make thi calcul even a bit easier .
the variou quantiti for find the between class variant ar shown here .
the probabl of set c1 or p1 of k is given by thi express .
is the sum of all probabl up to intens k .
so it's accumul distribut function .
and p of <num> of k is a sum of probabl from k plu <num> to l minu <num> , and it's equal to <num> minu p1 of k .
m1 and m2 is alreadi mention ar the mean intens of c1 and c2 , respect .
the mean intens up to a level k , it's simpli given by thi express .
it's the probabilist mean .
while the global mean intens is given by thi express , a sum up from overal intens valu in the imag .
by substitut the express from the previou slide into the express for the between class variant i show a few slide ago , we can easili show in a straightforward wai with a human manipul that the between class variant is a function of k , is equal to thi express .
so accord to thi express , there ar onli two paramet that need to be comput for all valu of k , p1 of k and m of , m of g , the global varianc of the imag is comput onli onc .
therefor , it's quit straight forward to step through all the valu of k and there ar capit l of those .
so that we find the maximum valu of the between class varianc and thi is the optim threshold k start accord to otsu's method .
we show here the segment imag .
which wa obtain by appli the optim threshold accord to otsu's method to link densiti of the camera man imag shown here .
so far we have discuss segment techniqu which ar base on find the boundari between region base on discontinu and intens level .
and also on techniqu , which perform segment via threshold base on the distribut of pixel properti such as the intens valu .
we'll discuss next , segment techniqu which ar base on find the region directli .
so , in gener , the region base segment problem can be formul as follow .
assum that r repres the entir imag region .
then , we're want to partit r into subregion , r1 through rn so that the follow properti ar satisfi .
the first properti indic that the segment should be complet .
so , the union of the region will give back the origin imag .
that is , everi pixel must be in on region .
the second properti requir that point in the region ar connect , either <num> or <num> connect .
the third condit indic that the region shall , must be disjoin , so the intersect of two region is the null space .
the next condit deal with the properti that must be satisfi by the pixel in a segment region .
so the predic appli on region r of i is true .
that is all the pixel in r of i have the , for exampl , the same color .
and final .
the last condit indic that adjac region r of i and r of j ar differ , in term of the predic p that need to be defin .
as the name appli , region grow is a procedur that group pixel into region base on some pre defin criteria for growth .
the basic approach is to start with a set of seed point and from these seed point grow region by append to these seed point enabl pixel that have predefin properti base on a similar criteria .
there ar two import consider with such a method .
how to select the seed point and how to select also the properti and also the similar criterion .
with respect to the first question , prior knowledg can be util and then the seed point can be select manual .
if thi is not possibl , .
we can perform , for exampl , cluster of the point base on some properti of the pixel and then util the centroid of those class as , as the seed point .
in grow the region , you could us differ featur and differ similar criteria .
with respect to the second question , featur that could potenti be us is color , moment and textur .
then of cours we have to also defin the similar criterium .
we show here a region grow exampl .
given thi mandril imag , we manual select a seed point and we want to grow the region around thi seed point .
the featur we us for .
thi , for grow thi region is the intens valu of the pixel and the similar metric is thi decai exponenti .
so , thi is the distanc between intens squar is part of the expon .
so , if the distanc is <num> , the similar is <num> and as the distanc and intens grow their similar goe to <num> .
so clearli we need a threshold so that we can compar the similar valu against thi threshold and if the similar valu is abov the threshold then the neighbor pixel becom part of the seed otherwis it doe not belong to the same region .
so , us thi algorithm , here is the region we obtain .
and here thi region is superimpos on the origin imag .
we would sai , by and larg , quit satisfactori job wa perform , although .
when we think of a object , the nose of the madril , the whisker here would not necessarili be includ as part of the same region .
an altern to region grow we just discuss , is to divid into region and then us split and merg step , converg toward the final segment .
so let r be the entir imag .
we select the predic function , an exampl wa given when we talk about region grow .
base on thi predic function , we can divid the imag into smaller quadrant if the pixel of region r here do not satisfi the predic function .
so in thi exampl we see the imag is divid first into four quadrant and the fourth on here is further subdivid into four smaller on .
clearli you have to defin the minimum size of thi region so that the split process termin .
the split approach describ here give rise to a quadri represent of the process .
so , r is the origin imag .
we first divid it into four quadrant .
and then the 4th quadrant as shown here , it's further subdivid into four smaller quadrant .
imerg block we also us the predic .
so if the pixel of region ar of j and the j , jason region ar of k .
satisfi the predic then the two region ar merg .
so altern between split and merg we've converg toward the final segment of the imag .
we show here a simpl exampl to demonstr the effect of the region split and merg approach .
we util the baboon imag that we us earlier .
so we carri a step of split oper and thi is the result we obtain .
clearli in carri out those step we have to defin the featur of the imag that will be us us toward declar the similar .
we us the intens valu in thi particular case .
we then have to defin the predic function base on which split will take place and to util the decai exponenti of the distanc of intens function in thi particular exampl .
we also have to defin a threshold base on which the .
valu of the predic function , it's either true or fals .
and final , you have to decid and defin the smallest size of the block where the split process will termin .
so look at thi result , we can observ that there is over segment .
we see , actual , the block defin here .
we see thi blotch artefact that we encount when we talk about compress .
if we follow the split step by emerg step , here is the result we obtain .
it look like a rather satisfactori result , although again , it's hard to defin an object metric base on which .
the qualiti of the segment should be evalu .
so split and merg is on of those valid segment approach .
and , of cours , the effect of the overal segment , it qualiti , depend on how the variou paramet that i describ here ar chosen .
we show here with thi exampl that in some sens the region split imag approach can be us toward as detect .
so , for the imag on the left we show the segment with thi imag on the right .
so there ar two region , the black and the white region .
in obtain thi result , the smallest size of the block , the imag can be split into is a <num> by <num> block , so a tini on .
and then , for the predic function , we look at the local variant or the local standard deviat of the block .
and if the local standard deviat is greater than <num> , then .
it's classifi as belong to on region , otherwis it belong to the other region .
so clearli all thi boundari block here have high local varianc and therefor classifi , ar classifi as white block pixel while the rest ar classifi as black pixel .
hello .
anoth wai to segment an imag is by look at it as a 3d surfac and exploit the morpholog shape of the surfac .
then the interest idea of the watersh method can be us .
if we look again at an imag as of 3d surfac it consist of mountain pick and vallei , or catchment basin .
if we were to assum that water start pour in from the bottom of the lowest vallei , then when thi water reach the peak of a mountain , it will start pour into the catchment basin next to it .
it is that point , the so call the watersh line .
in that we want to detect , becaus it will separ the two object repres by the valli .
sinc the watersh method typic result in over segment , we also describ mean to control it .
we further describ the <num> dimension k mean cluster approach .
and how it appli to the segment of medic mri brain imag .
so , let's look at the detail of thi visual also interest approach .
in geographi , a watersh is a ridg that divid area drain by differ river system .
a catchment basin is the geograph area drain into a river or a reservoir .
the watersh transform appli thi idea to grai scale imag , in a wai that can be us to solv a varieti of imag segment problem .
watersh segment requir that we think of a grayscal imag as a topolog surfac .
in other word , the valu fxy of an imag ar interpret as height .
let's look for exampl at thi si , simpl imag .
it shown here as a grayscal imag .
and here , as a <num> dimension surfac .
if we imagin that rain fall on thi surfac , the water will collect in these four area , shown here , which ar call catchment basic .
rain fall exactli on thi line , on thi watersh line .
will collect into thi two catchment basin , thi and thi on , with equal probabl .
so the watersh transform find the catchment basin and the ridg or thi watersh line .
in a grai scale imag , that will result in the segment of the imag .
as describ in the previou slide , accord to the watersh transform , there ar three type of point in an imag .
point that belong to a region minimum .
point that belong to a catchment basin of a region minimum .
so these ar the point at which if a drop of water fall will certainli fall to a singl minimum .
and then point that belong to ridg line or watersh line .
and if a drop of water fall onto point belong on a watersh line , then .
equal like will fall to more than on minimum .
so the object of the algorithm is to detect thi watersh line which will result in the segment of the imag .
we're go to address the concept behind the watersh transform without get into ani of the fine detail .
so accord to it , given to thi topographi shown here , if we punch a hole here at thi local minimum and flat the region with water from below , then water would be rise here .
until we reach thi point .
and thi point , an addit drop of water , if it's to fall down , it will equal like go into thi catchment basin or thi catchment basin , or thi vallei or the other vallei .
so in order to prevent thi from happen , we build here , a dam .
and after thi is build we keep , go .
we keep flood the area with water until we reach thi point , where again an addit drop of water will equal like go between thi vallei and thi vallei .
in order to prevent thi happen , we build a second dam here and we keep go until there ar no more dam to be built .
and thi dam here is a watersh line and thi is what we ar after with the watersh transform .
if we determin thi watersh line , then we have separ .
on object from the next from the next on .
so again thi is hopefulli the concept that is clear to you treat a grai scale imag as a topograph surfac and be abl to determin thi divid thi ridg .
these watersh line between differ object that , that will result in the overal segment of the imag .
we show here the result of appli the watersh algorithm to thi imag that i show earlier and here is the result .
we see that the algorithm did a , a great job in identifi four differ region .
and the background , the region , the fifth on and thi here ar the watersh line .
it's easier to segment thi object .
it's more challeng to find thi watersh line .
but , by and larg , thi is a veri satisfactori result .
we show here the result of the applic of the watersh algorithm to thi imag .
it is a magnifi microscop imag of a slice of the ey of the fruit fly or the so call drosophila .
thi is a project we ar current involv in .
if on is abl to segment successfulli the cell shown in thi imag .
on is abl to studi how cell transit from a stem to a differenti state .
the develop of the fly ey serv as a us model in understand thi transit .
if we appli the watersh algorithm to thi imag , we obtain thi result .
clearli , the imag is over segment .
becaus there ar a larg number of potenti minima , mani of which mai not be relev .
so we need to find wai to control thi over segment that result , and thi is what we will discuss next .
a solut to the over segment problem that wa demonstr in the previou exampl is to us .
marker .
a marker is a connect compon belong to an imag .
we would like to have both intern marker which ar insid each object of interest as well as extern marker which ar contain in the background .
in fact the intern marker , some of the properti ar that each on correspond to an object .
thei're surround by point of higher altitud , the point in the region form a connect compon .
and all point in connect compon have the same intens .
as far as the properti of the extern marker goe is that thei should partit the imag into region where the region minima ar allow to locat .
these marker bring prior knowledg into the segment process and therefor thei constrain it .
variou method have been suggest in the imag process literatur for comput both intern and extern marker .
thei involv linear and nonlinear filter , as well as morpholog process .
which method on choos depend on the specif natur of the imag on deal with , as well as with the applic at hand .
we revisit here the exampl of appli watersh algorithm toward the segment of the imag of the ey of the fruit fly , those microscopi imag that ar magnifi .
we ar go to util now .
marker .
we see here the origin imag with intern marker overlaid on it .
these ar the white part here .
so , these intern marker were obtain by threshold the intens valu of the origin imag , so thei repres the bright spot in the imag .
obtain extern marker is even harder .
here the extern marker we will be us in thi case .
thei were obtain by appli the watersh algorithm of the origin imag intens , not on the gradient imag .
so these extern marker constrain the region to which the watersh algorithm will be appli .
so it will be appli for exampl insid thi region .
so make us of both intern and extern marker , we obtain thi segment result .
it's certainli an improv result .
it doe not suffer from over segment and it doe a good repres job in delin the cell in the origin imag .
anoth wai to perform segment is through the us of the k mean cluster algorithm .
cluster mean group similar data togeth .
so , given alphanumer observ , we attempt to classifi the data point into k differ cluster .
and these cluster mai repres segment .
in an imag .
k stand for the number of cluster and thi is a paramet that is input to the algorithm by the user .
thi algorithm is iter in natur as you'll see and is not confin to imag segment .
it is a gener algorithm for machin learn applic .
it's actual the same algorithm we encount in week nine when we design the code book for vector quantiz .
we provid an explan of the step that ar follow toward k mean cluster .
these ar intuit step as we'll see .
and more than that , the step should look familiar to you sinc or sound and look familiar sinc we follow exactli the same step back in week nine when we design a code book for vector quantiz .
so , the first problem is how to assign a class or a cluster to a given pixel .
we see here two cluster , the red on and the blue on and these ar the repres pixel of the red class and of the blue class .
these ar the centroid actual of the cluster .
so , given a new pixel , the question is , where should thi be classifi to belong to ?
the red cluster or the blue cluster ?
in answer to thi , thi question .
we ar go to find the distanc of thi pixel to both center .
and we ar go to compar the distanc , thi distanc here to thi distanc .
as shown graphic here , thi is smaller than thi distanc and therefor , thi is go to be classifi as a red pixel .
the second sub problem we need to address is how to find new center from known cluster .
we show here two cluster , a red on and the blue on .
and the problem at hand is to find the repres pixel for each of the cluster .
the answer is that the repres pixel let's sai the red pixel here is the center of mass of the red pixel .
in find the center of mass i need to know the probabl distribut , the probabl densiti function of the red pixel .
we typic don't have that inform and we typic assum that the point ar uniformli distribut in which case the centroid is simpli the averag of the red vector .
so thi is what we do .
we find a new center by take the averag of the red pixel here and the averag of the blue pixel here will give us the new blue center .
so the k mean cluster algorithm altern between the solut of the two sub problem we just describ as we'll see also next in form of an exampl .
let us look at the simpl exampl of the applic of the k mean cluster algorithm .
we're give an imag , with these , white pixel here .
and you want to cluster them into two class , so k equal <num> .
we initi at random with these two centroid of a cluster .
we assign the data to the , to cluster base on their proxim from the centroid .
so , these pixel here ar closer to thi centroid .
and these ar all red pixel , while these pixel ar closer to the centroid and ar given the label blue .
we recalcul the locat of the centroid .
so , now thi blue centroid .
is the averag of thi blue pixel while thi centroid is the averag of these red pixel .
we re assign data base on the new locat of the centroid .
we then re comput the locat of the centroid .
re assign data .
and re comput the new locat of the centroid , until there is no more chang and we have converg .
so in summari , k mean cluster algorithm consist of choos the number of centroid k and then .
until converg , we altern between assign each train point to it's closest centroid and re comput the centroid locat .
so the output of the algorithm is the k centroid and of cours the label of the pixel to which centroid thei belong to .
as alreadi mention , there ar numer applic of k mean cluster in machin learn applic and design of code book in vector quantiz alik .
when it come to imag segment , thei have found applic to process medic imag .
we see here an mri imag .
we see here the frontal view , the so call sagit view and the horizont view of thi .
of the brain of thi person .
there ar three group typic with these imag .
white matter .
grei matter and thi cerebr spinal fluid , or csf .
so we're go to cluster voxel's , these ar three dimension pixel , into on of these three categori .
some of the prior knowledg you want to us is that .
voxel with the same intens should belong to the same group and those ar voxel that ar next to each other .
so we want to us intens as on featur but also special proxim .
so we .
us a featur vector here , a four dimension vector .
it ha the intens of the voxel , it's a function of three special coordin , as well as the three special coordin .
in defin distanc between two vector , we us the euclidian distanc .
as mention in the previou slide , thi is the featur factor that can be us in cluster the voxel in an mri imagin into thi three categori , grei matter , white matter and csf .
so , k equal <num> , for our purpos .
we can us wave here , alpha and beta .
base on which the rel import of the intens and intens , similar or proxim of voxel is control .
as far as the distanc metric , we could us either the l1 or the l2 node .
we will see actual dure the last week of class .
the impact or the effect or the reason why we should us l1 or lp in gener norm versu l2 norm .
so , i will not sai mani more thing here about it but nevertheless , it's , it's an interest topic of analysi .
typic , what's done in segment mri imag .
is to start with a larg valu for k .
so we segment the volum as shown here into possibl a hundr class and then util merg algorithm that will merg similar class .
and , and up at the end with a three desir class .
we show here a recent result we obtain in our lab .
which is a three dimension k mean cluster applic .
so , we see the human brain , and we see the three differ tissu's .
grei matter , white matter and csf .
so .
we see here on slice at a time .
howev , the cluster is a k mean base cluster , but in three dimens .
blank audio we show here some of the recent result that were obtain by <num> dimension k mean segment .
in our lab .
we compar our result with the result obtain by spm8 , which is a public toolbox support by matlab .
slice <num> wa util and were segment into three region .
grei matter , white matter and csf .
as mention multipl time there is no object criterion in compar segment result and the comparison becom even harder when we deal with medic imag simpli becaus it's the diagnost qualiti that we ar interest in .
expert actual have look at these segment .
and carri out their own comparison .
it seem like k mean provid somehow more delic segment than spm8 .
brain imag segment is a veri difficult problem .
what's even harder actual is the identif of lesion in these brain imag .
if we ar abl to identifi stroke lesion and also peri lesion region , the region around the lesion .
will assist the medic profess in predict the recoveri of the stroke patient .
but also the respons of the patient to therapi .
we see here an mri of a healthi brain and the mri of a brain with damag and these ar the lesion region or plaqu region .
so segment is current typic drawn by hand .
by the expert .
and thi is a time consum process but also a subject process and therefor not a repeat process .
therefor , there is a great need to overcom the nois present in the imag .
the exist of weak edg and the inhomegen in the data and , and dab with the automat procedur in identifi the lesion and the peri lesion , region for all the purpos that we describ .
as alreadi mention , segment techniqu can be appli to brain mri imag and potenti save live .
the segment techniqu can be us proactiv so that the brain of a healthi individu can be screen to detect the abnom , abnorm .
but also after a diseas , the same techniqu can assess the patient's respons to therapi and also can be us to predict the respons to , to drug and therefor , the recoveri of a patient .
so , we see the brain imag for two patient here , on and two .
and thi wai , we see the veri slice of the brain .
we see detect in green , the legion in thi brain imag .
we also see a number there which is the valu of the dice similar index .
for case for which the ground truth exist , obtain mayb manual .
x repres the ground truth segment and why the segment provid by al , algorithm , or ani algorithm for that matter .
then we see that in , in thi index we have in the numer the cardin of the intersect of the two segment .
divid by the sum of the of the individu segment .
clearli if x is ident to y .
the valu of the index is equal to on .
so the rang of the valu is between zero to on .
and the higher the valu vari , the closer to on , the better the segment with respect to .
the provid ground truth .
so the number ar rel high and our technolog ha been compar to other compet techniqu and the object valu , thei compar veri favor to the competit .
hello , motion is a power cue us by human and mani other anim to extract object or region of interest from a background of irrelev detail .
although it's done so effortlessli by human , it's a challeng task for the comput .
it is a topic of great activ , becaus it's so fundament , in mani applic such as object detect and track , like vehicl and pedestrian , robot , surveil and video manipul and edit .
we describ some of the basic idea and show some result .
in thi segment .
we also describ , at a high level , some of the most recent and power approach for segment .
specif , the mean shift and graph cut algorithm .
so , let us look at the fine detail of thi materi .
so far , we have primarili focus on segment base on intens valu .
or segment of still imag .
when we deal with video , then motion is an import featur , that can also be us to perform segment .
the idea of segment is that you want to group object , pixel with similar properti .
so , the domin properti here is motion , so , an object that move in a certain direct should stand out and be segment base on motion .
motion is definit a power cue that is us by human and mani other anim to extract object or region of interest from a background of irrelev detail .
so given an imag , imag sequenc we have to defin the number of motion model and the type of motion model if it an affin model and so on .
and then us thi motion inform we want to perform segment .
thi is a rich field in imag process and comput vision .
there ar techniqu that ar publish everydai i would sai on the topic of motion base segment and motion base track that is tightli coupl with what we ar discuss here .
so here is an exampl of on frame of a scene .
is actual on campu here outsid my offic and base on on approach , thi is the result segment .
there ar a lot of peopl work and some ar work awai from the camera , some toward the camera and thei ar identifi by the variou color .
so , green is toward the camera and red is awai from the camera .
there ar realli a larg number of applic that util motion base segment , some of which ar just list here .
so , object detect and track is the on i alreadi mention .
robot as a similar problem if the interact is base on a camera , we want the robot to be abl to identifi object and track them .
surveil is a larg applic area .
imag and ved , video compress , as we saw in mpeg <num> , we ar abl to perform motion base segment and then in mpeg <num> we can encod visual object separ .
scene reconstruct and video manipul or edit .
video mat where we want to pull the visual object out of the scene .
annot motion magnif , and so on .
we see two result here of object base , motion base segment .
so thi is the call monitor sequenc .
three differ method ar compar .
the on at the bottom right is the on that is lesser suscept to nois , it give cleaner result , so .
you see again , the object that ar move these peopl that thei ar walk around , that ar pull out from the video .
we see a similar result here .
thi is a sequenc from the top of the engin build where my offic is and you see car ar move as well as individu peopl .
there's anoth piec of work we did here in the lab where we track the motion of the hand of the person perform cpr on thi mannequin .
so thi can be us for train purpos , for exampl , then base on the motion , we try to extract the frequenc of compress as well as the depth of compress .
there is an actual system that real time can demonstr that .
the basic approach to perform motion base segment , mayb the on that first come to mind to everybodi is just to look at the differ between two consecut frame or a refer imag and a second imag .
so .
if we have these two imag , we take the absolut valu of the differ .
if it's abov a threshold , then we put in <num> there .
otherwis we put a <num> .
so it's a threshold base detect of motion .
and that wai we obtain a binari imag again .
the move part is <num> and the non move part is <num> .
the underli assumpt ar that the imag ar regist spatial , otherwis would be detect , detect the shift and that the illumin is constant .
otherwis you chang the illumin , you see a lot of moistur and these ar the effect actual that i demonstr when we talk about motion estim earlier in the cours .
an improv to the previou simpl idea i just explain is thi accumul differ imag , adi and you then have the absolut base valu or the absolut imag , accumul imag or posit or neg .
so , on absolut , we have a refer imag here and then a number of frame .
but to compar again .
so if the absolut valu is greater than the threshold , then the accumul here valu is increas by on .
otherwis it stai the same .
so it's exactli the same oper , but now instead of the absolut valu , we take just the valu , the posit valu if it's abov the threshold , and otherwis we take the valu if it's below a neg threshold .
the isol en , entri in the dij result from nois and ar not signific .
the threshold is the connect remov , but mai remov thi entri as well .
and the us of the adi ignor chang that occur onli sporad .
here's a simpl exampl we perform is just a white squar that is move in a certain direct over a number of frame .
so we show the posit adi here , so it can show the size of the move object and the locat of the move object in refer to the imag frame .
so thi is the idea behind a posit , it can nice isol the size while the absolut and neg , can show us the speed and direct of the motion .
so , actual , it's a good idea if all these adi metric , absolut posit and neg ar us togeth .
becaus each of them convei a differ piec of inform .
on of the most current and us and effect techniqu in do segment is the mean shift techniqu .
so as the first step , the data is transfer into a featur space .
it could be the color , the textur , the gradient , the combin of the abov .
and then the idea is to find the maximum densiti in thi featur space so here for exampl , in thi particular exampl that's where the maximum densiti take place and we would like to locat that .
so .
we start with an initi estim of where the maximum densiti is .
thi is depict by thi circl .
of cours , thi is a multi dimension space , so thi is a hyper sphere .
and then , we estim the center of mass of the point that belong to thi region .
so , let's sai the center of mass there , then the vector that need to move the center of the initi hyper sphere to the new center of mass is the mean shift vector .
so now we move the region , we center it around the center of mass and then we perform the same oper .
we find the new center of mass which happen to be there , thi is the new mean shift vector , we shift the analysi region to the locat of the new center of mass and keep go thi wai .
until at the end we land at thi locat .
so then thi will provid on of of , of the segment in perform thi segment .
so thi is the intuit idea behind behind the mean shift algorithm .
so here is the result of the applic of the mean shift algorithm .
we see it appli to thi imag , these two fine gentlemen and thi is the result segment imag .
we see that it's do a veri satisfactori job when it come to thi .
region here but also in kind of segment the , the featur , the cloth of , of the peopl , then the ocean is behind it .
the sky is a separ segment and then the sea and thi is kind of a land mass here that is nice separ .
and thi is yet anoth exampl of the applic of mean shift .
we see quit a few variat there in the color , the sky , the letter here and so on .
so , for thi particular segment , the .
featur vector contain the three rgb compon of , of , of the color imag and the two compon with a special locat .
so , it wa a fifth dimension featur space , to which mean shift wa appli .
anoth on of the current approach , the modern approach toward segment is base on graph cut .
so the idea here is that , an imag can be repres as a graph .
so , the pixel in an imag ar vertic of the graph .
then if i consid two pixel , then there's a correspond edg that connect the two pixel and the similar give rise to a weight or a cours , or a cours that weight these two pixel .
so you have two pixel , an edg in between and a similar base .
on , on some metric will give me the cost .
so after a graph is build base on an imag , graph cut is what the name impli .
i want to cut , creat a cut in thi graph , so that as shown in the exampl here on cut will separ .
the whole graph into two piec , the foreground and background for exampl piec .
so the question is which edg should we cut and the intuit tell us that we should cut the edg that have low cost , when the cost express similar .
so the low similar edg should be remov .
and therefor , the , the similar pixel should be in differ segment while the similar on should be in the same segment .
what the minimum cut or the st minimum cut problem is take it name actual , s stand for sourc and t stand for termin but it can be call the s , s .
mincut problem as well .
so here we see a toi exampl , two vertic , a sourc and the sink and the associ cost connect sourc sink and the two vertic .
so the idea of the st cut is to divid the node between sourc and sink .
so on possibl would be thi on like v1 belong to sourc , v2 belong to sink and then we see the associ cost if we cut here , that's the , the red vertic if we cut here the associ cost should be equal to <num> .
so we add the cost of thi vertex , so it's a five here , it's a two for thi on and it's a nine for thi on .
if we consid the altern configur where v2 belong to the sourc and v1 to the sink , then we see that the cost if we cut along these edg is thi two plu on plu four is equal to seven .
so thi is a smaller cost so for thi particular toi exampl , that's the cut that should be chosen .
but in gener thi is not the wai , exactli the wai when to find the minimum cut but instead we solv the , so call , maximum flow problem .
thi is a dual problem becaus on can prove , on ha proven , peopl have proven that the min cut and the max flow problem ar equival .
so solv the on give you the solut for the other .
so the idea of the maximum flow is to flow , to push the maximum flow through the network and see what is the .
the , the number for thi maximum flow .
so for thi toi exampl we can , there's the augment , augment path base algorithm .
so if i look at thi configur again then we see that we can push a flow of two and a flow of five .
of these link in red .
so clearli , i can push a flow of two from sourc to the sink and if i do so , the flow increas by two and then the remain capac of thi edg is two minu two , zero .
while , the remain capac of thi edg after the flow of two is push will be five minu two equal three and that's what these valu ar here .
so then i look for anoth path that will allow the maximum flow and thi is thi path , so i can push a flow of nine here , push a flow of four through thi edg and clearli i can onli push a flow of four becaus thi here is provid the constraint .
so if i do so , the remain flow is five here , zero here and thei have increas the total flow by four .
if thei get an addit path , well , ye , and thi is thi path .
i can push as much as five from here , on and three .
the minimum is on so i can push a flow of on through there and i increas the total flow by on and here the remain capac is zero , so thi is the result situat and clearli no more flow can be push from the network .
so base on thi , then thi is the result cut .
so thi the wai these problem solv through the maximum flow outgo that i just .
illustr here in a toi exampl .
so , appli the minimum cut algorithm to thi cameraman imag , we obtain the segment here .
it's clearli not extrem satisfi for thi particular implement .
howev these algorithm , the graph algorithm , have all kind of other advantag that can be explor and exploit .
but thei simpli want to demonstr that thi high level , the the min cut algorithm which i assum it's rather intuit .
at least base on it princip .
welcom to the end of week <num> , on more week to go .
it's hard to believ that we ar reach the end of the class .
we look thi week at the interest and activ topic of emerg video segment .
we cover some of the basic approach , but there ar realli so mani more techniqu in the literatur and techniqu which ar us in practic on a daili basi .
i believ the materi cover dure thi week provid you with enough inform and tool , to be abl to understand other techniqu in the literatur and also decid which might be the most appropri on .
for an applic we ar interest in .
some of the techniqu , such as x detect ar easier to understand than other , such as graph cut .
sometim , a complic approach result in improv perform , but thi mai not alwai be the case .
veri often , simpl techniqu and idea win .
it is howev a problem with no ground truth and therefor there is alwai room for anoth method .
next week we'll talk about some of the recent develop in imag process , which ar base on the concept of sparsiti .
so see you next week , the last week of class .
hello and welcom to week <num> , the final week of the cours .
as the express goe , time fli when you're have fun .
dure thi week , we'll cover some of the more recent result in imag and video process .
thei're base on the simpl notion of sparsiti .
a signal can be spars in it nativ domain , for exampl , an imag of the star in the night sky , or it can be spars or compress in some transfer domain , such as the dct domain .
our first reaction might be , what's the big deal ?
we know that an imag is spars to the dct domain from week nine alreadi .
the big deal is that , if we know that a solut to a problem is spars , we can then solv problem for which we did not have meaning solut befor .
on such problem is a solut of an under determin system of equat .
such a system of equat appear in numer applic .
in the first segment of thi week , we will look at applic not just from the imag and video process domain but also from machin learn , statist , genet , econometr , neurosci , and other domain .
we will describ them at the high level in order to see under what circumst we have spars signal or vector in gener .
we will also discuss a formul and even their solut approach .
howev , we will need the materi we will cover in the subsequ segment befor be abl to fulli appreci the solut .
oper approach will be follow .
the applic ar present here to hopefulli excit you and increas your interest on the topic .
we will revisit some of these applic , howev , at the end of the week .
so , let us proce with thi current and excit materi .
dure thi week , we will first talk about applic where sparsiti plai a kei role , and these applic will be from signal and imag and video process but also from machin learn , statist , econom , and so on .
we will then see what is the role that the l2 , l0 , and l1 norm plai , and we'll see , for exampl , that the l0 and l1 norm promot sparsiti .
we will then discuss specif solut approach to optim problem when the l0 , l1 norm ar involv .
so when the l0 norm is involv , we talk about the match pursuit .
thi is a greedi iter algorithm for find a solut .
when the l1 norm is involv , we'll talk about smooth reformul of both the basi pursuit and the lasso problem .
and , final , we'll go full circl and revisit some of the applic where we show specif the formul of the problem and the solut approach that is follow to obtain a solut .
what is sparsiti ?
as the name impli , a vector is spars if it onli ha a few non zero compon while the rest ar zero .
now thi vector can repres a signal , such as an imag or a video , in which case the signal can be spars in it nativ domain , if for exampl we have an imag of the sky at night , so there ar some bright star onli and the sky is dark or it can be made spars in anoth domain .
so natur imag , for exampl , in the nativ domain ar spars .
a spars vector , howev , mai origin in numer applic as we could see .
there is a larg number of applic in which sparsiti plai a kei role .
of cours , for the purpos of thi cours , imag and video process applic ar the on we primarili ar interest in .
but , in the begin , we'll also talk about applic from machin learn in gener , statist , genet , econometr , neurosci , and so on and so forth .
it is known that some diseas , like cystic fibrosi , ar caus by alter in a singl gene or a small set of gene , and thi knowledg can be util in creat gene target therapi .
howev , the genet basi of mani lead caus of death in the world , such as heart diseas and consequ of diabet , ar so far not clearli understood , and thi limit the us of gene therapi in these situat .
genewiz associ studi the associ between million of genet loci from across the human genom with quantit trade , such as cholesterol and glucos level , which in turn can be us as strong predictor of the abov mention diseas .
thi problem howev , the genom wide associ , is extrem under determin becaus even for larg studi there ar typic a few thousand individu , but there ar ten of thousand of gene .
we show here a linear model of the problem , so an ax equal b formul .
a is the genotyp matrix .
and contain genet inform about each of the individu that took part in the studi and the correspond trade level here , so each of these end of thi matrix show the number of so call allel .
these ar the altern form of the same gene for the ith person at the jth locu .
so , thi matrix a , as alreadi mention is , is a long matrix .
so , for exampl , it can have <num> , <num> row and <num> thousand column .
in solv thi problem , it is desir that the solut here , x as a long vector , is spars .
so thi wai , there ar a few gene that give rise to understand thi particular trade .
so , for exampl , if thi is a known zero entri , then it is thi column of thi matrix that will be util again toward the predict of thi particular trade .
so , thi is a specif exampl where we ar ask to solv an ax equal b problem and their solut x here is desir to be spars .
function or magnet reson imag , frmi of the brain is becom more and more popular in diagnos disord , such as adhd , attent deficit hyperact disord .
in thi applic , three dimension scan of the brain ar acquir , while the subject is be ask to perform certain cognit task .
now onli certain part of the brain light up or fire up .
the on respons for the specif task be perform .
the f mri scan actual can combin with eg , electroencephalographi signal , and find which part fire up in the brain is refer to as the sourc local problem .
so you see in thi exampl here which part of the brain fire up while the subject , the person is perform an , a rhyme task .
now , in process such volum , we typic divid them into small cube , which ar refer to as voxel .
so these ar volum pixel of three dimension pixel , so scan the volum we can stack these voxel into vector , and again here is anoth applic in which the vector we deal with ar spars .
so the problem we might be interest in solv there , for exampl , the social character problem that i just mention , or we might be interest in solv a classif problem if the person is classifi as have adhd , for exampl , or not .
in which case , spars logist regress can be us or we might be solv a predict problem , try to predict if the person will develop adhd in the futur .
so again , here is an exampl where the signal we ar work with ar spars due to their natur .
econometr is allow economiet to sift through huge amount of data and extract simpl and us relationship .
so here we see a map of the world , and for each countri , we see the gdp , gross domest product per capita .
an interest question is , which factor correl in a posit or a neg wai to the gdp of a countri ?
so , economist have consid hundr of factor , such as the on shown here popul densiti , size of economi , life expect , land area , and so on .
so we put in a matrix a , the actual valu of these factor and in a vector b , the gdp of each countri , and then we ar interest in find an x so that ax equal b .
so we want to solv thi linear system of equat under the constraint that solut we obtain x here is spars .
similarli to the genet problem , sinc we expect a small number of factor to have strong correl , posit or neg to the gdp while the rest of them be irrelev , but equal to zero .
actual from studi , the factor here shown insid these red rectangl , show strong correl , neg or posit , to the gdp .
so again , we need to know how to solv an ax equal b system of linear equat under the constraint that x is a spars solut .
linear regress is a common problem in mani applic area .
given a set of point , as shown here , we want to find a line that best describ or best fit these point .
so , if we call the axi here a and b , we ar given pair of point , a of i , b of i , such as thi on , and the model we us , the model of the line is that a of ix is approxim equal to b of i .
our object , therefor , is to find the best possibl valu of x to describ thi data .
a veri common approach we follow is that thi squar approach accord to which we minim back to x the sum of the squar arrow .
thi minim will result in an optim valu of x base on which , if a new point a is given to us , we can form ax star , which will give us the new valu of b .
so , if here is a new , we have found the equat of thi line .
after we find the x optim , and therefor we can us it to find the valu b new .
we can write thi equat in matrix vector form .
our model take the form ax equal b , where in vector b , we have stack all the valu of a of i , and matrix a we start the badg of a of i , which in gener is not a scalar but is a row vector .
then the object , the squar object here is to minim with respect to x the , thi norm squar , and thi is refer to as an l2 norm , as we will see later in the class .
in a number of applic , there ar spars outlier in the data like the on shown here .
so these ar clearli outlier , thei don't look like the rest of the data , but thei're spars .
there's just a few of them otherwis , thi , thi would be the data .
the question is now , how well can a line describ thi data if we follow the squar approach that we describ in the previou slide ?
follow squar approach in solv the linear regress problem , we obtain the blue line here as the optim line for fit the avail data .
clearli , as these squar approach toward linear regress , tend to fit to these outlier and therefor produc poor result .
we can make linear regress robust by introduc a spars arrow term that compliment the linear model .
that is , we're us now the model ax plu e , approxim equal to b .
so thi is the spars arrow term , and the object is to find optim x star here to describ the data .
so we need wai now to be abl to solv thi problem by take into account the sparsiti of b and as you'll see , we have mean through the us of the l0 and the l1 and the lp norm to accomplish thi .
the result method is refer to as the least absolut deviat approach .
in some other applic , you might be interest not just in robustifi the least squar problem as we describ here , but also in find the spars term , e , as well .
so follow the least absolut deviat approach with thi toi exampl here , we obtain the red curv as the best curv to fit the data .
so thi is lad , the least absolut deviat , and thi is least squar .
so clearli we ar do a much better job now in describ the data and not feed to the outlier .
match consum with the appropri product is kei to enhanc user satisfact and loyalti .
therefor , more and more retail ar interest in recommend system , system which would predict the prefer of a user to a product base on which the retail can then recommend or not recommend the product to a user .
a version of the problem address by the recommend system is describ here .
it relat to the so call netflix problem , sinc it's pose by the provid of stream movi here in the us , netflix .
so , we have in thi column variou movi while in thi row variou user .
when a movi is rent and watch by a viewer , he or she is ask to rate the movi .
let's sai from zero to five or from zero star to five star .
so thi person here watch thi movi and gave it on star , while thi person watch thi movi and gave it four star .
so , each user watch and rate certain movi , but , of cours , there ar a larg number of other movi that he or she ha not watch .
so , we don't know the prefer of thi user to thi movi , and the retail would like to predict thi prefer so that the retail can decid whether to recommend or not recommend thi movi to thi user .
so , the retail ha an incomplet matrix .
some of it's entri ar known , but veri mani other ar not known and would like to complet thi matrix .
so , the problem becom a matrix complet problem .
by the wai there , ar thousand of movi but million of user , so thi is realli a veri larg matrix .
the matrix complet problem , by the wai , appear in variou other applic .
clearli , if there is no addit inform or addit constraint , we cannot provid the meaning solut to thi problem .
the addit inform we have with the problem at hand is that there ar typic a few type of peopl , or put it differ , similar peopl like similar movi .
so if these two user have similar prefer in movi , then thi column of the matrix , and thi column will be veri similar or there will be ident .
a matrix with mani similar column or group of similar column is of low rank .
the matrix complet problem , therefor , becom a rank minim problem .
a low rank matrix give a number of zero singular valu .
therefor , the vector of singular valu of the low rank matrix is spars .
it is that nuclear norm of a matrix , which is equal to the sum of the singular valu of the matrix , that is typic minim , subject to the requir that the fidel of the data is preserv .
so , here's yet anoth exampl where we encount a spars vector , and thi vector in thi particular case contain the singular valu of the matrix we tri to complet sinc thi matrix is a low rank matrix .
here is the denois or nois problem again .
we address thi problem at variou point dure the cours , but , for exampl , we talk about enhanc dure week five .
and also when we talk about recoveri dure week six and seven .
we can look at the imag denois problem from a differ angl as well .
we know from the discuss from week nine when we talk about compress that we can transform thi imag to a differ , and in that differ domain , onli a few transform coeffici can do a good job in repres the imag .
then us for exampl , the , the dct transform .
so , if we consid a patch here of thi imag .
let's call it y of i , then we can write that y of i equal ax of i .
a here repres either the basi of the dct transform , so it's a fix dictionari , or it can be design specif for class of imag in which case it would be anoth complet , a long matrix , anoth complet dictionari .
the import point here for the current discuss is that thi vector x of i is a spars vector , which mean that onli a few coeffici of thi transform ar need to provid a good represent of thi patch or a good approxim of thi patch .
so by and larg , we're interest in solv problem of that natur , so y of i is the observ noisi imag .
a is the dictionari , either fix or design from the data , and we're interest in solv for x of y .
we can obtain a solut to thi problem by minim with respect to x of , the l2 norm of y minu ax squar minu lambda , the l1 norm of thi vector were the coeffici .
as you will see , the l1 norm promot sparsiti .
sinc nois is not spars in the transfer domain , by solv thi problem , we ar go to reconstruct a smooth patch .
and , of cours , we can solv thi problem for each and everi patch of the imag or we can combin all the patch , and we can rewrit thi equat in term of matric .
so , if we follow such , such an approach , here is the result de nois imag .
we ar go to talk about the detail of thi approach later in thi lectur .
we talk about imag inpaint when we cover imagin recoveri dure week six and seven .
it is inde a recoveri problem .
inform is lost due to some scratch in the imag , as the depict here or due to the superposit of text on the imag .
we want to recov thi lost inform about the pixel densiti , which ar repres again here as black pixel .
why there ar a number of techniqu publish in the literatur in provid solut to thi problem .
we want also to also obtain solut util the sparsiti machineri we ar discuss thi week .
we'll us similar idea to the on we us for denois .
so , if we look at a patch here of thi imag , will be note by y of i , and we us thi model to repres y of i , r ax of i .
so a is the dictionari again , which is either fix or design util the data .
x of i is the spars vector that provid thi approxim , and r is a mask , which allow us to us thi represent for the pixel that we know but not the pixel we do not know .
the black pixel in other word insid thi patch .
we want again to be abl to obtain solut with x of i , which ha spars , and we can accomplish that , can obtain an xi star here as the argument that minim with respect to x of i , the l2 norm of thi error squar plu lambda .
the l1 norm of thi represent vector , which again is remot sparsiti .
we can util x star to obtain the impaint imag as ax of i star .
so , put thi machineri to work , we obtain these result here .
we see that the inform that wa lost due to scratch and text super posit is fulli recov .
we also mention super resolut dure week six and seven when we talk about recoveri .
it is inde the recoveri problem .
inform is lost dure the down sampl process .
we ar observ an imag like thi on , and we want , for exampl , to increas it's resolut by a factor of four in each dimens .
there remain techniqu in the literatur provid solut to thi sr problem .
we can also provid solut util dictionari and the sparsiti machineri we have discuss thi week .
we assum we have a set of low resolut and correspond high resolut imag .
util these data , we train low resolut and high resolut dictionari simultan , relat these low resolut , high resolut patch .
the same spars coeffici vector provid the represent of both the low resolut and it's correspond high resolut part .
so if we take thi patch here and denot by h low resolut , given thi patch and the whole imag , you can find an x star spars , as we alreadi mention , to repres y low resolut as a .
low resolut h star spars but also y high resolut equal to a , the high resolut dictionari , but the same represent spars co effici vector .
so , util thi approach , we observ thi , and we can construct , reconstruct thi .
and with the imag at hand here , we can obtain the high resolut imag as shown here .
if we ar to blow up thi patch here in yellow by us pixel duplic , we get thi imag .
while if we blow up thi patch here , we obtain thi imag .
so clearli , there is a lot of addit resolut that ha been recov due to thi method we discuss here .
a typic problem in video surveil is to separ a background from the foreground in a video .
here is an exampl of such a video .
thi is an old problem in video process and comput vision , but a lot of peopl have look at us the sparsiti machineri we ar discuss thi week .
we can also obtain a solut to thi problem .
we put all the observ data into on matrix , and then decompos thi matrix into a low rank matrix as wa the case that made thi complet and the spars matrix .
the low rank matrix repres the background .
thi is a video .
it seem like it's still imag becaus noth chang there in the background .
while the spars matrix repres the foreground .
so we see that we can obtain a veri good separ foreground , background us the machineri of sparsiti that we will cover thi week .
we'll provid the detail of the solut to thi problem in the later lectur .
anoth applic where we deal with spars vector is robust face recognit .
given a databas of face , as shown here , we form a face dictionari .
let's call it a .
in thi a , we stuck each and everi imag into a column of thi matrix .
then , given a queri imag , such as thi on , if we call thi b , b is approxim equal to ax where x here is a spars vector , indic which entri in the databas thi b correspond to .
so , x can have just on entri equal to on if there is a perfect match of thi squar imag into the databas or the queri imag can be a combin of imag in the databas , where x will have more than on entri , but nevertheless it is spars .
here is anoth queri imag .
in both these case , we have abnorm , such as a scratch or occlus .
therefor , the model we end up work with is that b is approxim equal to ax plu e .
so thi is an error term that take the scratch or the occlus into account where also thi vector e is spars .
therefor , we need to be abl to solv problem of thi natur wherebi we just constrain again both x and d to be spars solut when we try to solv for x .
so , therefor we identifi a person that exist in the databas .
compress sens , or compress sampl , is anoth import applic area where sparsiti plai a kei role .
we show here an n by n imag .
it ha therefor n squar sampl .
we talk about nyquist's theorem earlier in the cours .
accord to which , i need to sampl with sampl frequenc at least twice as high as the highest frequenc in the signal .
in the imag , you're talk about spacial frequenc in the two dimens .
accord to compress sampl , we can reconstruct the origin imag with veri littl or no error if we acquir fewer sampl than those , dictat by nyquist's theorem .
the sampl , howev , now is not done with delta were we go and pick out the valu of each and everi pixel , but by project the imag onto random base .
project mean that we form the inner product of the imag with a random matrix , and thi inner product will give me a scalar which repres the sampl .
then , we end up with an undetermin system of equat , which we can solv effici , as we'll see later in the class , while inform sparsiti .
and the imag is spars there in it origin domain or in a transform domain .
so , by acquir onli <num> of the sampl , in other word n squar over two , big cell , and get out the construct , we obtain thi imag .
it is almost indistinguish from the origin imag .
util onli <num> of the sampl , so n squar over <num> , we see thi at construct , and if we go down all the wai to <num> , n squar over <num> , we see thi reconstruct shown here .
so we're go to talk about thi applic later in thi cours with consider more detail .
welcom back .
we will describ in thi segment , wai to formul problem so that the result solut ar spars .
in mani applic , we end up with solv underdetermin system of linear equat .
so the system of equat can be either <num> or infinit made solut .
in order to restrict the set of possibl solut , we regular the problem .
prior knowledg is us , to constrain the solut space .
when thi prior knowledg , we bring into the problem is that , the solut is spars , then spars promot norm need to be us .
by visual the regular solut of the problem ax equal b , we see that the l0 , l1 , and lp norm , where p is less than on , ar promot sparsiti .
the us of the l0 norm result in the np hard problem , while the us of the lp norm with p less than on , result in an non convex problem .
therefor , the us of the l1 norm becom in some sens , the natur choic , sinc it is convex although non differenti .
it's actual the tightest , convex surrog for the l0 norm .
we also discuss convex optim , and offer some simpl experiment comparison between the us of the l0 and l1 norm .
so , let us proce with thi , interest materi .
let us begin by consid a linear invers problem encount in mani applic .
we're given the system a x equal b , where a and b ar known and we try to solv for x , so it is inde an invers problem .
i us a color code represent here where green repres known quantiti , so thi is a known matrix , thi is a known vector , while red repres , an unknown quantiti at the unknown vector x in thi particular case .
we have a fulli determin system of equat , when the number of equat equal the number of unknown .
in thi case , matrix a is clearli a squar matrix .
as we probabl know , we obtain a uniqu solut to thi problem when a is full rank .
in thi case a's invert , and therefor the optim solut x star , is simpli obtain by multipli the invers of a with b , which repres the data .
let us consid the case now , when we have an over determin , system of equat .
so the number of equat is greater than the number of unknown and therefor , the matrix a here is a tall matrix .
let's sai it's m by n where m is , greater than n .
in thi case , on solut we can obtain , is the least squar solut .
it is obtain by minim the norm of the arrow , ax minu b .
so thi is the l2 norm squar and the minim is with respect to x .
thi is actual a minim , we carri out back in week six when we talk about restor .
if you recal , we obtain the gradient with respect to x of the norm , and set it equal to <num> , and thi is the necessari condit for a minimum .
if we expand thi , we have the gradient of ax minu b transpos ax minu b , is equal to <num> and if we expand there the , product insid the bracket , we should obtain x transpos , a transpos ax minu <num> , x transpos a transpos b , plu b transpos b , equal to <num> .
and if we obtain the gradient , thi term will give us <num> , a transpos ax , and thi term will give us minu <num> .
a transpos b is clearli independ of x , so thi is equal to zero .
and if a transpos a is invert , then the minimum normal squar solut we obtain is shown here .
a transpos a , by the wai , is an n by n matrix , the smallest dimens of matrix a .
the last case to consid is when the number of equat is smaller than the number of unknown .
in thi case , we deal with an under determin system of equat .
in thi case , as shown here , matrix a is a long matrix .
we encount thi , situat in mani of the applic , we discuss , for exampl , the super resolut applic .
in thi case , the observ low resolut imag b is of lower dimens than the unknown high resolut imag x .
with underdetermin system of equat , we can have either no solut , if b doe not belong to the rang of a .
which you might sai is not the case of interest or we can have infinit mani solut .
the question in the latter case is , which of these infinit mani solut should we choos ?
the answer is that it depend on the applic .
how do we pick , on of such solut ?
we can follow the standard approach of regular , that we also discuss back in week six and seven when we cover recoveri .
accord to the regular principl , we bring prior knowledg into the solut process , by defin a function on j of x .
so we minim thi with respect to x , subject to the constraint , that the solut x satisfi the data .
thi is the fidel to the data constraint .
there's a problem that peopl have look at for mani year in linear algebra and optim , and what's new here is that .
on type of prime , or knowledg , that we can bring into the problem , is that the solut x is spars .
in thi case , power result have been shown in the literatur .
and the question is , what type of function here j of x , can we us that promot sparsiti ?
so thi is what we'll discuss next , we'll look at norm that inde promot sparsiti .
we're interest in look at variou form of the regular problem , i describ in the previou slide .
we'll , we'll introduc function j of x which depend on valu norm and we'll start with the l2 norm .
so , the l2 norm of a vector is defin here , it's also call the euclidean norm .
i'm sure that you've encount thi mani time , in the past .
so for exampl , if we ar given a vector with element <num> , <num> , <num> , a three by on vector , then it l2 norm is simpli equal to the squar root of <num> squar plu <num> squar plu <num> squar , so the squar root of <num> , which is equal to <num> .
let's look at how the unit bowl , look , with respect to the l2 norm .
so , let's look in two dimens , it is easier to visual .
so , let's look at , the gaze where the , l2 norm squar of the vector is equal to <num> .
and in two dimens , thi mean that x1 squar plu x two squar , equal to <num> .
so thi is clearli the equat , of a circl in two d , or a hydrospher if we ar in the undimension space .
so with , our axi here , x1 and x2 .
thi is the , unit circl , accord to the l2 norm , so the radiu here is equal to <num> .
we ar interest in solv thi constraint optim problem .
we want to minim the l2 norm of the vector , subject to the constraint of the vector , the solut satisfi , the data .
so , we want the small solut in term of the l2 norm .
if we , visual thi problem in two d , then thi equat here , defin a hyper plane in the undimension space or a line in two dimens .
so thi is my constraint , and then to obtain the solut , we take here the unit ball and , enlarg it until it intersect , it touch the line which mean that i have a solut with the smallest x that satisfi , the constraint .
so , we us a larger circl here , and yet a larger on and at thi point , clearli thei touch .
so , thi point here is the solut to my origin optim problem .
the main observ here is , that , in two dimens , the circl and the , line ar go to touch most probabl at the point , but will give us a non spars solut .
so thi solut here is an x1 compon , which is thi on .
and an x2 compon , which is equal to thi on .
a spars solut would be , if we were to select thi point or thi point , or these , ani of these four .
for thi particular problem actual , we can find the , solut in close form .
it's given by thi express which is an express i'm go to deriv next .
on of the advantag of the us of the l2 norm is that , veri often close form express result from , the optim problem like the on we ar discuss , so , let's look here how we can inde obtain in a , veri few easi step the solut in thi case .
so , we're do to get the problem of minim with respect to x the l2 norm of x , subject to the constraint that ax equal b .
the first on the step , is to turn the constraint problem into an unconstrain on .
so , we minim , with respect to x , the l2 norm of x plu the lagrang multipli , transpos a x minu b .
if we call thi l of x , then thi is equal to the minim with respect to x of l of x .
the so call kkt condit , for obtain an optimum ar that the gradient with respect to x of l of x , should be equal to <num> and the gradient of l of x with respect to lambda should be equal to <num> .
from the first kkt condit , we obtain here in a rather straightforward wai , follow step that we first discuss dure week six and seven , when we cover recoveri .
we see that the gradient of the l2 of x , is equal to x , plu thi term here actual , lambda transpos a x is a scalar , therefor , is equal to x transpos a transpos lambda , so the gradient of thi is , a transpos lambda .
thi is equal to <num> therefor , x is equal to minu a transpos lambda .
from the sai , the second kkt condit wa simpli obtain that ax minu b is equal to <num> .
so if i sai , substitut x in here , i obtain minu a , a transpos lambda equal b .
and assum that a a transpos invert , lambda is equal to minu a a transpos minu <num> b .
and then substitut thi , in the first equat , we'll plane that x equal the minus , cancel out a transpos aa transpos minu <num> b .
so , thi is the , close form solut .
we can call it , x star here , of the origin optim problem when the l2 norm is us .
so , the advantag of the l2 , is that we have a close form express .
the disadvantag with respect to our purpos , is that we do not obtain a spars solut .
in our quest toward obtain spars solut , let us look at the us of the so call l0 norm .
it is defin as shown here , it is a count norm .
it count the number of non zero entri in x .
you mai or mai have not seen thi norm befor .
it's actual not a , a norm , in the sens that it doe not satisfi the scale properti .
alpha x l0 norm is differ than alpha the l0 norm of x .
so , if we us the exampl i us earlier , and i have the vector <num> , <num> , <num> .
then the , l0 norm of thi vector , is simpli equal to <num> .
sinc there ar onli two non zero element .
how doe the union ball look like when the l0 norm is us , the l0 ball .
if i look again at two dimens , my two ax , x <num> , x <num> .
all the element on the axi except from the origin , belong to the unit ball util the l0 norm , becaus if i look at an element here , it ha norm <num> .
anoth element here ha also norm1 , an element here ha norm <num> .
an element here ha norm <num> and so on .
it's , i assum , quit clear to see inde that , the unit ball ar the two axi with the except of the origin .
let us look now at the problem , under consider , we want now to us the l0 norm to carri thi optim .
so again , in two dimens , the constraint defin a straight line and therefor .
the point of intersect of a straight line with the l0 ball here , ar solut to the problem and we see inde that , in thi particular exampl , in two dimens , i have two solut .
both solut ar , inde spars , right ?
if we look at thi solut , let's assum that thi valu is here minu <num> .
so thi is minu <num> <num> , so it's a spars solut , iif we look at thi on , assum thi is a <num> .
so it's a <num> , two base solut .
so , with the us of the l0 norm , we do obtain spars solut .
the solut , howev , is not uniqu as wa visual here with thi simpl exampl .
let us now look at the l1 norm , which you will be util in our optim problem .
it is defin as shown here , so it's the sum of the absolut valu of the element of the vector .
so for the vector us befor as an exampl , <num> <num> <num> , clearli , the l1 norm of thi vector is <num> plu <num> equal <num> .
by the wai , if you recal the l2 norm of thi , is equal to <num> and the l0 norm is equal to <num> .
so , how doe the unit ball when we us thel1 norm look like ?
in two d .
again , for easi visual , x1 , x2 , the axi , and thi is the l1 bowl .
so , here we ar show into the , the l1 bowl which is equal to thi .
so the corner of thi rhombu ar at <num> or minu1 .
and then for exampl thi line is the x1 plu x2 equal <num> line .
so , let us look at the solut , of the optim problem shown here .
so we us the l1 norm now , and we want to .
constrain x by l1 , we can find , we want to find the smallest l1 normal vex , subject to thi constraint that the solut satisfi the data .
by the wai , thi is refer to in the literatur as the basi pursuit problem .
in visual the solut , we show ax equal b line into b and then we take the l1 ball and we keep increas it size or nflate it until it hit thi line .
so here is , the l1 ball and here it larger size that is go to result in thi point here , as be the solut to the basi pursuit problem .
clearli the solut is a spars solut .
thi point here ha x1 coordin equal to zero and it x2 ha a specif valu , x2 .
so , through thi visual , it should be clear that when the l1 norm is us in an optim problem like thi , then the result solut is spars .
we're go to have an intersect of a plane or hyper plane in gener with these rumbl in , and dimens .
and of cours there is a small chanc that , the straight line here is along the line of the side of the , rhombu , but thi is a veri low probabl event .
so the l1 norm actual is the tightest convex surrog to the l0 norm , as we'll discuss in the follow .
let's look at the us of the lp norm now , where p is less than on in solv the regular problem that we ar consid .
here's a definit of the lp norm .
if i us the exampl i've been carri through in thi lectur , here is my three by on vector .
and if we look at the norm with be on half , then thi is simpli equal to the squar root of <num> plu the squar root of <num> , the whole express squar .
how doe the lp ball look like ?
if i visual it , again in the two dimension x1 , x2 space .
ten it look like thi .
if it's the unit bowl , then these point here ar equal to <num> .
i'm interest in us the lp norm to solv thi optim problem , so the function of j x that i defin a coupl slide earlier now is just the lp norm of x , we want to get the smallest possibl on subject to thi constraint .
in visual thi solut , as we did befor , we show the hyper plane ax equal b or the straight line into b , that's the constraint .
and then we consid the lp bowl .
we keep inflat it , until it touch the constraint .
and , thi is then the point that provid a solut to the optim problem we're interest in .
we see that with the lp norm , we also obtain a spars solut .
thi is the good new , on might sai , howev , the bad new ar that the lp bowl now is not convex .
therefor solv problem that do not includ either convex function or convex set is not as straightforward as when when convex is present .
so we ar go to sai a few thing about convex .
regard convex thi is how when on dimens of convex function look like .
if i take ani two point of the graph of the function and draw a line segment , then thi line segment li abov the graph .
here's a pictur of a non convex function , which clearli doe not satisfi the properti i just mention .
i can consid these two point and here is the line that doe not lie abov the graph .
when it come to set , here is the pictur of a convex set , consid ani two point of the set , the line segment that connect them li .
on to the set and thi is a non convex set that doe not have thi properti , by larg , we ar interest in solv convex optim problem which mean that both the function , we minim is convex and the set of point that defin thi function is also a convex set .
for such optim problem , we can obtain a global , minimum , such as thi on , or global minima , if we have an f of x , that look like thi .
then thi is convex and all the local minima ar also a global minimum .
we talk actual about convex when we talk about motion estim and i show the graph of thi natur .
we show a synthet experi here which compar the effect of the l2 norm and the l1 norm toward provid spars result .
it provid actual the , experiment evid that the l2 norm enforc small of the solut while the l1 norm enforc , promot spars .
so , we creat a vector x here that look like thi , it consist of <num> point and it ha plu , minu <num> impuls and it is clearli as per signal .
we creat a matrix a , of dimens <num> by <num> and it entri ar random .
we multipli a time x and we obtain the observ b that look like thi .
there's a signal that ha <num> point .
so , given b and given a , we solv the problem of minim , the normal vex , subject to the constraint that ax equal b .
so now , if the l2 norm is us , that is the solut we obtain .
so thi is the estim x here when the l2 norm is util .
as argu , for the valu of x ar rather small , howev , the solut is not spars .
if the l1 norm is util , over here , and we solv again thi problem , the , optim solut we obtain , is thi on .
it is actual ident to the origin signal x .
we show here in on graph , all the unit ball util the valu , norm that we introduc .
so , the circl is the l2 ball , by the wai all these point ar equal to<num> minu <num> minu <num> .
the two ax with the except of the origin , ar , repres the l0 unit ball , the red curv repres the lp .
the lp is between <num> and <num> .
ball and the diamond repres the l1 norm , as we discuss , the , the us of the l2 norm result in a convex optim problem and more than that , in mani instanc , we can obtain the close form solut .
so , these ar the advantag of the us of the l2 norm .
howev , we do not obtain spars solut , but instead , small valu for the solut .
what we're realli after in obtain spars solut , is the us of the l0 norm .
howev in thi case , we end up with an np , non polynomi hard problem .
the us of the lp norm , result in a non convex optim problem , although the solut ar inde spars .
while the us of the l1 norm , result in a convex optim problem , although the function is not smooth , is not , differenti point and the solut is spars .
so , we see some sens here all the possibl engin trade off , we have kind of lazi talk time solut , but is non spars , the hard solut to obtain , also hard sinc it is non convex and therefor in some sens the us of the l1 norm repres the avail choic .
and inde it ha been util in solv spars problem in mani differ formul , as we will see later in the class .
and over here in summari , a comparison of the l0 and l1 norm in solv these constrain optim problem .
minim x with respect to l0 , subject to thi constraint or minim x , util the l1 norm subject to the same constraint and thi is the basi pursuit problem .
we did compar the solut graphic or visual the solut and it should be clear , by now , that both formul provid spars solut .
howev , the l0 norm model sparsiti directli .
just count the number of non zero element , while the l1 doe so indirectli .
l0 is non convex , the l1 is , and is actual the tightest convex surrog to the l0 norm .
the overal problem is np hard with the l0 norm , while here it's convex but non smooth .
in solv the l0 problem , there ar greedi approach such as the match pursuit that we're go to discuss in thi lectur , that provid an approxim solut .
while solv the basi pursuit problem , that ar convex optim algorithm we're also go to discuss .
welcom back .
in thi segment , we discuss variou formul of the optim problem we ar interest in .
the formul ar rather power when it come to solv optim problem .
we also present a veri intuit greedi approach solv the l0 minim problem , by the name of match pursuit .
as alreadi mention , the problem is mp hard and therefor mp is a greedi algorithm that choos on column vector at the time from the dictionari present the data .
so that the residu error occur the largest decreas .
we'll explain and demonstr through an exampl how exactli thi is done .
an extens of the algorithm is orthogon match pursuit .
when the spars represent vector select so far , ar simultan recalcul at each iter step .
mp and omp as thei're typic refer to , ar rather simpl to understand , and thei're wide us .
it's import therefor to understand them sinc thei serv as a standard refer for solv l0 base optim problem .
there is extens of them that exist in the literatur .
so let us now look into the algorithm detail .
reformul of the optim object function and find surrog or function or norm ar two import step in optim .
so here's a problem we've been look at .
we want to find a spars solut x that satisfi thi constraint .
veri often when there is nois present in the data which is actual almost alwai the case .
then we cannot guarante that thi solut will belong to thi hyperplan and in thi case we , it lack the constraint , so it's relax to that x now belong to thi ellipsoid here defin by thi paramet epsilon .
we follow actual similar formul when we talk about recoveri in week six and seven .
we look for exampl at minim c of x , the l2 norm of thi subject to a nois constraint .
c goe a hypo filter therefor c of x is the energi of the signal at high frequenc .
we can further swap the constraint and the object and end up with a problem like thi .
so now we minim the nois , subject to a constraint on the sparsiti of the signal .
so we follow thi formul , for exampl , when we have a notion of how fast the signal should be the solut is clearli a function of s in thi case .
we could possibl follow thi formul when we have knowledg of the nois on the data .
the solut in thi case is a function of epsilon .
and if epsilon and s ar chosen appropri , we mai end up with equival solut .
of cours the approach is the step that will result in solv thi problem and thi problem ar not necessarili the same .
and actual that's part of the reason on introduc thi reformul , so that on end up with an easier problem to solv .
let's look at certain reformul where we deal with the l1 norm .
thi is the problem we have been look at .
as befor , when the data is noisi , we can allow x to leav thi hyper plane , and allow it to belong to an ellipsoid .
and thi ellipsoid is defin in term of the paramet epsilon , which is a function of , of constraint of the nois of the data .
we can swap object and constraint and end up with thi optim problem where s is a major of the sparsiti of the data .
now sinc the l1 norm is convex , then we can turn thi constraint optim problem into an unconstrain on .
we can relax it by bring the norm up to the object , so weight by a paramet lambda , it's call a regul paramet , or the lagrang multipli .
and lambda chosen so that the solut of thi optim problem which is a function of lambda should satisfi the constraint , so the l1 norm of thi should be less equal s .
we have look at relax problem like thi , but in week six and seven , when we talk about recoveri .
there , for exampl , we solv the constraint list squar problem , the result of thi minim .
blank audio the differ of cours be that here we us the l2 norm for the stabil function , while here we us the l1 norm .
when it come to consider about lambda howev , thei ar similar .
for exampl , when lambda becom veri small , goe to zero , we ar solv a least squar problem , just minim thi norm .
while , on the other hand , when lambda becom veri larg , we end up with x equal zero as a solut .
as mention alreadi , when the l2 norm is us , then we can end up with a close form solut .
so the solut to thi problem , if you recal , it's simpli equal to a transpos a plu lambda c transpos c minu <num> a transpos b .
thi is not the case when we dealt with the l1 norm .
thi problem , by the wai , is refer to as the last problem and we're go to look at wai for obtain solut to the last problem .
let us look now at the match pursuit algorithm .
it a greedi algorithm for obtain the solut to thi problem that we have been investig .
befor we proce let look at the ax equal b represent .
it should be clear that b here can be written as the weight sum of the column of a , which ar also call atom , and the weight of the entri of x .
so , in thi particular exampl , where x is a spars vector .
it onli ha these entri , <num> and <num> , and the rest ar <num> , it mean that b is the first vector correspond to <num> and weight by <num> plu the seventh vector here which is weight by <num> .
so we have a vector a here and to project b onto a , so thi is orthogon project here .
and sinc as we know , the arrow b minu ax star which is thi vector here is orthogon to a .
thi mean that their inner product is <num> .
and solv for x star , we obtain thi express here .
typic , the column of a ar normal , so a transpos a here or the norm of a is equal to <num> and therefor the project or the length of the project along the direct of a that's what x star is , is equal to a transpos b .
so we see that , the project again , the norm of thi equal the , amplitud of x star , time the norm of a , which is equal to <num> and therefor thi is equal to , the amplitud of x star .
so if on pose the question that let's sai we have onli on column of a avail to repres b .
which column shall we choos from , from a to repres b the best possibl wai , or with the smallest possibl error ?
and the intuit answer is that we should choos the column that result in the largest project of b onto that column .
so , for thi particular exampl , if we onli have on column avail of a to repres b then we should a7 becaus the project of b on to o7 , a7 is the largest on and it's equal to <num> .
so , the best column is the on that ha index i which is the argument of the maxim of x of k , thi project coeffici with respect to k .
we illustr here pictori the match pursuit algorithm .
it's an iter greedi algorithm , accord to which , at each iter step , we try to reduc the residu error the most .
and we do that by find the largest project of the residu onto the column of matrix a .
so in thi particular exampl , we assum that a ha three column , a1 , a2 , a3 , as shown here .
at the first step , the residu is set equal to the observ vector b .
so we take the vector b , we project it onto the three column , and we find that the largest project , is along column a1 .
so x1 star , a1 is the project , therefor the residu becom now b minu the project .
so the residu here is orthogon to a1 .
the solut vector is updat and the project , x1 star becom the first entri of the vector , of the solut vector .
we move the residu vector to the origin as shown here and project now the residu on to the remain of the column of a .
so , a1 is not includ in thi consider .
we find that the largest project is along the vector a3 .
so , x3 star is the project coeffici which is updat the solut vector x , and then the residu wa thi and now x3 star a3 subtract from that so that's the new valu of the residu .
we move the updat residu vector to the origin , and keep iter by project now to the remain vector .
we've exclud the on that were alreadi util .
we keep iter that wai , and we stop when the constraint of the sparsiti of x is met , so if we want the spars vector with sparsiti <num> , let's sai we stop after <num> iter .
let us describ now the orthogon match pursuit algorithm as we will see , it's a simpl variat of the match pursuit algorithm .
here is again the problem we ar solv .
the input with the algorithm is a matrix a .
it column have been normal , the norm is equal to on .
the observ b and the sparsiti level s .
as explain in the previou slide , we initi the residu by set it equal to obeserv b .
we also util the set of mega which includ all the vector , column vector that have alreadi been util .
so clearli when we initi , the set is empti .
so , while the sparsiti constraint is not met , we find the project of the residu onto all the column that do not belong to omega , cannot be util .
and we pick the project that is the largest .
so that's the index of that project .
we then updat the set of omega by includ the index that wa just select .
so far , i have describ the match pursuit algorithm .
and what differenti now orthogon from the regular match pursuit is thi highlight step .
so , i look at all the vector that ar includ in the set omega , that have been util befor , plu the new vector that wa chosen in thi step .
and i simultan updat the valu of the coeffici by get out of thi minim .
after that , i updat the residu base on the newli found or updat valu of the coeffici vector .
i can solv with the same algorithm , the reformul problem so , i minim the norm subject to constrain on the error , and all it need to chang is , i need thi input now epsilon instead of s .
and i iter as long as the norm of the residu is abov the threshold , everyth els remain the same .
hello again .
the formul or reformul trick ar veri commonli us in optim , and thei're veri effect .
in thi segment , we'll examin two such trick , which allow us to solv the so call basic pursuit and lasso problem .
the first on , the posit neg split trick tell the basic pursuit problem into a linear program and the lawsuit problem into a quadrat program .
the same is true for the second trick , the suppress trick .
we will also look at dictionari techniqu , which ar veri wide us .
the idea is simpl .
we want to learn a represent scheme for the actual data instead of reli on fix basi such as the dct .
gener speak , a better represent perform result in thi case .
so , let us proce with the detail of thi section .
veri often in solv optim problem that involv the l1 norm , we end up have to solv with a linear program or a quadrat program .
so , let us look first at the basic idea behind the linear program .
is defin by these mathemat express .
the object function is linear in x and the constraint ar linear inequ .
that you might think interpret of a linear program is quit straightforward , the linear inequ defin a polyhedron and thi is the valu of x insid the polyhedron , that form the visibl region .
the object , if i set c transpos x equal to a constant c3 for exampl , defin a hyperplan .
so we see here <num> differ hyperplan for <num> differ valu of c .
c3 , so c2 is less than c3 , c1 is less than c2 .
so , we want the minimum of c transpos x , as long as thi x belong to the feasibl region .
so we can start here , we keep decreas c , we move thi direct .
so thi is , the object is smaller here , but no x belong to the feasibl region , and therefor the solut is for thi x star , where again x star belong to the feasibl region .
there ar a larg number of algorithm for solv linear program veri effici , includ interior point method , simplex method , and activ set method .
the name of the solver for exampl in matlab is linprog .
so the basic idea is that as long as we can reformul the given prog , problem optim problem to take thi form here , we realiz that we have a linear program to solv and we're not go to spend ani more time just talk about the variou approach for solv such problem .
but we ar fulli awar that we can realli util a larg number of solver for obtain a , an effici solut to thi linear program .
a quadrat program ha the form shown here .
the constraint ar linear again , but now the object is a quadrat function of x .
so the geometri of thi problem is shown here .
again the constraint defin the polyhedron and in , sinc here we have less equal the surfac abov the polyhedron belong also to the feasibl region .
and if we set the object equal to a constant , then we have a contra shown here .
so thi is the quadrat equal to c1 , equal to c2 , equal to c3 .
so , we want the smallest possibl valu of the quadrat , which would be here for exampl , but we need that x belong to the feasibl region .
therefor , the optim solut is obtain by thi point .
thi is also an extrem well studi problem with a lot of theoret result , but also with specif solver avail that on can util to obtain solut .
the matlab solver is call quadprog .
i should mention here that if we have a constraint in the form of equal , it can be handl for both by a linear quadrat program , by write the equal as to inequ .
so , for both case of linear and quadrat program , as long as we can bring the optim problem wherein thi the d after reformul into the on or the other form .
then we know that there're a number of effici solver we can util and obtain effici solut .
the l1 norm is not differenti at the origin .
becaus of thi , when we deal with optim problem that involv the l1 norm , we cannot resort to take deriv or gradient of the object function .
we will introduc two reformul trick that transform thi spars optim problem into well studi linear and quadrat program .
we know that effici solver exist for solv such problem and we can resolv to util these solver .
the first trick to consid is the posit neg split trick .
given a vector x with entri x or y , we can write each of them as p of i minu n of i .
p of i is the posit part , defin as equal to x of i for x of i posit and <num> otherwis n of i is the neg part defin as minu x of i if x of i is neg and <num> otherwis .
as an exampl , let us consid the vector with entri <num> minu <num> , <num> , <num> .
then , b1 is equal to <num> .
and <num> is equal to <num> .
b4 is equal to <num> .
you can , i write the vector x as the p vector , which ha entri <num> , <num> , <num> , <num> , minu an n vector with entri <num> , <num> , <num> , <num> .
so thi is a p vector minu an n vector .
then with thi split of the posit and neg part , the l1 norm of x , it's simpli the inner product of thi vector here , thi vector ha all on for the problem at hand .
it's the transpos of the column vector so it ha entri <num> , <num> , <num> , <num> and then i form the inner product of the p vector , which we just saw it's <num> , <num> , <num> , <num> plu the n vector which is entri <num> .
and it's pretti straightforward .
it's obviou , almost i would sai that thi is inde the l1 norm of x .
due to thi , the composit it's also clear that the inner product of p and n is equal to <num> becaus a number cannot be posit and neg at the same time .
so whenev p ha an entri and ha a <num> and the other wai around .
let us now util the posit neg split trick to turn thi base pursuit problem into a linear problem .
we write x is equal to p minu n , and then the basi pursuit problem can be written as the minim over p and n of <num> transpos b plu n as we saw that's the l1 normal of x , subject to ap minu n equal b .
where p and n ar both non neg and p transpos n is equal to <num> .
thi last constrain actual is not need , sinc it can be shown by contradict that an optimum , thi equat hold the inner product is equal to <num> .
so , we can disregard thi .
so now if we us a new variabl , z equal to p n , then we can rewrit the problem as the minim of <num> transpos z over z , subject to cz b , where z is not neg and the matrix c is equal to af where f is thi matrix that ha the n by n ident here as the first part and the minu n by n ident as the second part .
so thi is an n time 2n matrix .
so thi is easili recogniz as a linear program .
the object is linear and the constraint as linear .
and those ar a dimens the equal can berat them as two inequ .
we should comment here howev that we have doubl the dimens of the input space .
that is now we're minim over p and n to variabl that each of them is of equal size , 2x .
howev , thi is not a huge problem sinc as alreadi mention , there ar veri effici solver for provid solut to thi lp problem .
we will show here that us the posit neg split trick , we can turn thi , the lasso problem into a quadrat program .
so that the composit is that x p n , base on which we can rewrit the object as the minim of lpn of ap minu n minu b .
l two squar plu lambda therein a product of <num> with p plu lambda product of <num> with n .
and in the condit that both these gui ar no neg and p transpos n equal <num> .
as mention earlier , at the optimum thi condit is satisfi .
we can prove thi by contradict and therefor we don't need to carri with us .
us the new variabl z as the concaten of the posit and neg part , on can show in a straightforward wai that lasso take thi form .
the minim of z , opposit transpos bz plu we transpos z under the constraint that z is not neg .
well the matrix b is equal to thi .
and c is equal to lambda <num> .
now that thei gave you actual thi form , you can just substitut in here b and c and find inde the express for the lasso .
so , it's easili recogniz that here we have a quadrat program .
the object is quadrat , the constrain ar linear .
there for we can util ani of the avail solver for obtain a solut .
the same comment would be made again that we doubl the size of the unknown instead of 1x we have two unknown now , p and n of the same dimens .
howev thi doe not present a major issu sinc again we have effici solver .
we will us the suppress trick now to turn the basi pursuit problem into a linear program .
we will introduc a variabl s with element , it's a vector s with element s of k .
such that the absolut valu of x of k is less equal than s of k .
so thi is the suppress variabl .
base on thi variabl , we can rewrit the basi pursuit problem as the minim with respect to x and s of the inner product of <num> with s , subject to the constraint that ax equal b .
each x of k is less equal than s of k , for all valu of k , and the vector s is non neg .
we can express each absolut valu and equal here as two linear inequ and thi here problem becom as the minim again of thi inner product subject to again ax equal b .
but now x of k is less than s of k , or k while x of k is greater than , equal minu sk for all k , ns is non neg .
so , thi is now easili recogniz as a linear program , linear object and linear constraint .
and we can us again ani of the mani effici solver to solv it .
the dimension of the space doubl here instead of <num> variabl x thei have x and s now .
but , again , assum that thei have effici solver of the lp problem , thi doe not present a major issu .
there're a larg number of optim method or tool for solv the variou optim problem that we have been discuss here , which involv the l0 and the l1 norm .
the solut approach we discuss were done so to give you a flavor of how on can go about solv such problem , but anyth more advanc is beyond the scope of thi cours .
i just want to mention here some other method .
so variat of match pursuit and the match pursuit as shown here is the stomp and the cosamp .
variat of the method we discuss to solv the lawsuit problem is fista and some of the popular and power techniqu is admm , altern direct method of multipli , accord to which the problem at hand is brought into thi formul .
so there ar two function , f of x and g of y .
thei're minim with respect to x and y , and the constraint just connect the x and y variabl .
in mani applic , we have multipl observ b of i , we have b1 , all the wai to b of n , and we want for each of them to find the spars represent , util a dictionari a .
so , x1 is a spars vector , x of n is also a spars vector with the same sparsiti .
instead of solv each of these problem separ , we can combin them into on problem , as shown here .
the matrix , matrix equat now look like thi .
so , into matrix b , we have stuck the b of i vector , so the b1 observ is here , the b2 observ in thi column and all the wai to the bn .
observ , while the spars represent x1 is the first column , x2 the second on , all the wai to xn .
here f denot the frobeniu norm of a matrix .
so the frobeniu norm over matrix a , it's simpli the squar root of the sum over ij of all it element aij squar .
instead of us a static dictionari , an interest question is if we can do a better represent of the data b if we solv for a dictionari .
if we find the dictionari that is most appropri for the class of data we ar interest in repres .
so a becom an unknown in thi case .
the answer is ye , we can design a dictionari by solv the optim problem describ here .
so , we minim the frobeniu norm as befor , but now not onli in term of x but also in term of a , the dictionari .
the constraint remain the same that each and everi column of matrix x is spars with the same sparsiti .
the next question clearli is how to go about solv such an optim problem .
so here is the dictionari design problem we're interest in solv .
we want to minim the frobeniu norm of thi error with respect to both a and x .
subject to thi sparsiti constraint on their present vector .
accord to the method of optim direct , we altern optim between a and x .
so we first fix a and solv for x .
so , we minim with respect to s , x subject to thi constraint , and we can us a match pursuit type of approach to obtain a solut .
then we ar fix x and solv for a , so then there's no constraint impos .
we have a non constraint problem , and thi is a type of problem for wai we can find a close form solut , which is given by thi express .
we solv similarli squar problem multipl time so far , so it should not be difficult to obtain thi solut as well .
so thi is the gener approach of altern minim and depend on what is fix and what we're solv for , we can either us a close form express or we can us a match pursuit type of greedi algorithm .
for the dictionari design problem , instead of the l0 norm we can us the l1 norm of a matrix .
and sinc the l1 is convex , as alreadi mention , we can solv thi unconstrain problem in term of the lagrang multipli , which need to be appropri chosen .
we can follow again in solv thi problem the method of altern optim .
so if a is fix and solv for x , we have thi lasso type of problem to solv .
so thi is inde a seri of lasso problem and we discuss method such as the variou trick in solv thi problem and turn it into a quadrat program for exampl .
if a's fix , then if solv for x , we have an unconstrain quadrat problem .
and as mention in the previou slide we can obtain the close form express for thi problem .
so , thi is similar to the mod approach .
we , how to make minim in both case , howev now we ar solv a lasso problem when we're solv for x .
while when we're solv for a , the solut is the same with both method .
in thi final section , we look at few of the applic of sparsiti .
we realli just touch the tip of the iceberg .
it's realli impress how mani differ problem have been solv us the idea we have present thi week , both in imag process and we will discuss for exampl , the nois smooth , paint , and super resolut problem , which ar invers recoveri problem that we also discuss back in week six and seven .
the problem ar the same , but their formul and solut approach ar differ now .
we will also discuss some never problem such as the foreground background separ problem through random and robust vca .
we will final discuss the compress sens problem , which ha given rise to a lot of activ in the area in the recent past .
so let us have a closer look at these applic now .
in form the observ , vector b , we typic take the imag , like the on shown here .
and break it into block or patch .
so here's a patch , out of an imag .
and then , we stack thi patch , thi sub imag , lexicograph into a vector , as shown here .
so if thi is , for exampl , an 8x8 patch , thi becom a 64x1 vector .
in form the dictionari matrix a we first look at the case when the dictionari's static .
so if the dct's us as a dictionari we show here the 8x8 basi , of the dct .
we look at thi imag actual multipl time .
where , for exampl , we start video and imag compress in week nine and ten .
we take each of these two dimension basi , turn them into a vector , and thi becom a column of the dictionari matrix , a .
these actual ar call also atom of the dictionari .
in thi case we have a , a rectangular dictionari 64x64 in thi particular exampl .
we demonstr here with a simpl experi that natur my ds ar spars repres over the dct .
these of cours someth we know ver well .
from week nine and ten , when we cover imag and video compress .
given thi imag , we take it's , thi get fulli transform and all of the coeffici here in decreas order .
thi is , by the wai , long scale .
now if we keep onli <num> of the largest coeffici , that we were to throw , everyth awai , abov thi line , then thi is the construct imag .
if we onli keep the <num> of the largest coeffici , everyth abov thi line now is thrown awai .
thi is what we obtain and if we onli keep on person , the coeffici , so what's below these blue line .
so , thi on goe awai as well .
thi is the construct .
these two imag look almost indistinguish from the origin on .
so thi demonstr , also , the energi compact of the discreet cosin transfer .
while thi on is also of good qualiti , although when examin side by side with the origin , on can see that smooth ha taken place .
we show here an 8x8 patch of thi imag .
which can be , i correctli repres by <num> base out of <num> base of the densiti base dictionari .
we do the same experi with an eight by eight patch from a noisier imag .
and we see that in thi case , we need at least <num> out of <num> base to obtain a reason represent of thi patch .
anoth wai to describ thi is to sai that nois is not compress .
which is someth we know sinc the nois signal doe not have , ani correl in it , or ani construct in it .
that we can explor in order to compress it .
thi properti is us to us , when we deal with a denois problem .
simpli becaus the signal can be spars repres , util a dictionari , such as the dct , while the nois compon cannot .
so sync a sparsal represent of the signal , we know that , we will not be construct the nois compon but just the signal compon .
here's the formul of the imag denois problem .
it contain the patch of the input noisi imag .
each patch is a column in thi matrix b .
while a is the dictionari .
if the dictionari is fix , if we us for exampl the d c t .
then , we solv thi last type of problem by minim with respect to x .
howev , we can us a dictionari which we learn from the data , in which case , we then minim with respect to a as well .
so , thi on is the biconvex dictionari learn .
a problem which we describ earlier , and we altern optim between a and x .
a is fix , we ar solv a lesser problem , we solv a , the squar type of problem for which we have a close form solut .
of cours we can us the l0 norm as well , in which case we follow the mod approach .
so given the spars represent x , then ax star , the optim solut , form the recov imag .
we show here an experiment result .
thi is the origin imag .
thi is your observ noisi imag .
the pixel nois ratio is <num> to b .
and util a fix dictionari , base on , here is the solut we obtain util the method we show in the previou slide .
so thi is the nois free , or de nois imag .
with psnr <num> and a half db .
we introduc the imag inpaint problem multipl time alreadi .
so b is the observ imag , and certain pixel ar miss .
which pixel ar miss is indic by thi .
r matrix , the degrad , matrix , or the degrad mask .
so , for the , pixel that ar not miss , that we know their valu , then we try to minim thi error .
thi , again , the is , all here in matrix four .
so we solv thi last o .
problem with respect to x .
find an optim x star , then we form the recov imag as a x star .
the formul is shown when the dictionari is fix .
we can howev design a dictionari accord to what recov two slide ago .
so , carri out the minim with respect to a as well .
so , here is an experiment result .
thi is the origin imag and thi is the , the degrad imag where <num> of the pixel ar set to black ar miss .
util the method i just describ with the fix diction a , it is a t base diction a .
here is the result inpaint imag .
it is certainli a veri satisfactori result .
it should be mention here howev that in carri the inpaint as wa describ here .
we assum that the locat of the miss pixel that matrix r that i includ in the formul of the previou slide is exactli known .
in gener , howev , thi mai not be the case , and on need to also identifi which pixel need to be inpaint first befor the inpaint process is appli .
we talk about the imag resolut problem multipl time .
we first introduc it in week six and seven when we talk about imag recoveri .
the problem is given a low resolut imag to find an estim of a high resolut version of it .
we describ here a formul of the problem and a solut approach when dictionari and a spars represent is util .
so accord to thi approach , there's a train and the test phase .
dure train , we assum that we have pair of imag , and each pair consist of a low resolut imag and it correspond high resolut version of a .
so dure train , we design both a low resolut dictionari and a high resolut dictionari .
and the spars represent of the signal util both the low and the high resolut dictionari .
the import point here is that the spars represent is ident no matter which dictionari we ar us .
so thi is the term , the forbiniu error regard the load solut data .
thi is the forbinian's norm , the error regard the higher resolut data .
and here is the requir that thi represent is spars .
i should mention here that we us bilinear interpol of the low resolut imag .
so , the size of the low and end high resolut dictionari is the same and therefor , thi vector here is ident .
then , dure the reconstruct phase , a new low resolut imag is observ .
and util the low resolut dictionari , we try to find the optim spars represent of thi particular imag .
then have x star here , we util the high resolut dictionari to obtain the high resolut imag .
here is a low resolut imag of which you want to find it high resolut version .
util the method that i just describ in the previou slide .
here is a high resolut version of it .
the interpol factor is <num> in each dimens .
if i look at a specif block of the first imag and the correspond block of the high resolut imag and blow up these two block , then thi is how thei look like .
so , clearli , in , interpol us zero order hold the low resolut version obtain thi imag .
while thi what we obtain from the high resolut imag .
clearli , we have all these , jag edg here , which ar not present in the high resolut version of the imag .
the robust face recognit problem , we assum for that each person , we have multipl version of it .
face and it imag is under differ light condit sinc light pose variat .
so each of these imag form a vector which becom a column in the dictionari for the nth person here .
so all these individu face dictionari of the concaten .
as shown here to form the face dictionari for the whole databas .
now , we ar given a queri imag and we try to find if thi person can be found in a databas .
sinc , thi queri imag ha abras such as scratch .
then the model we us that , is that b is approxim equal to ax , so thi is the present import to the dictionari plu it nois there .
so x is spars .
becaus thi face is on of the mani face in the databas , and also e , the error , is spars .
it onli repres a small part of the whole imag .
so the formul we follow in solv thi problem is shown here .
we minim the l1 norm of x , the spars represent , plu lambda weigh the l1 norm of the error .
so the error as well as x ar spars signal .
and the constraint is that ax plu error equal the observ .
in obtain a solut to thi problem , we introduc z , thi concaten vector , and if the matrix f is equal to thi then we can write thi problem as shown here .
minim the l1 of z , and the , the constraint that f of z equal b .
and thi clear , clearli is a basi pursuit problem .
we look at thi problem earlier thi week and we know certain wai to obtain a solut .
util the methodolog present in the previou slide for thi queri imag , here is the reconstruct error imag .
and here is the reconstruct face imag .
the spars represent vector x star look like thi .
so the reconstruct face imag is a combin of a number of imag in the databas .
veri often , after the face is reconstruct , we ar interest in identifi the person .
so if you recal the overal dictionari a consist of the dictionari that belong to individu person .
so we either find the largest valu in the represent x star , or we find the reconstruct arrow per sub dictionari , the dictionari belong to an individu .
so if for exampl for thi particular case , we find that the largest valu here belong to the dictionari an , thi mean that , that person that you construct here is identifi as the nth person in the databas .
as mention in the begin of thi week's lectur , we can us idea to solv thi surveil type of problem , which consist of the separ of video sequenc into the background frame and the foreground or move part frame .
the basic idea here is that if we look at thi background imag , imag .
if we take actual it frame and form a vector , and put it vector as a column into a matrix l , is that thi matrix l that consist again of the background imag .
assum thi background is stationari , these column will be veri similar .
so , therefor , thi is a low rank matrix and again if each frame is absolut ident , then thi is a rank on matrix .
so , the question is how to model thi low rank matrix .
and regard the move part or the foreground , sinc it onli occupi a small part of the frame , then thi matrix e that is form by thi frame , that will becom the column of e is a spars matrix .
of cours we know what to model sparsiti by util either the l0 or l1 norm .
so let's see what it take to solv thi surveil problem , the separ of video sequenc into background and move part or foreground .
in proceed with the origin problem , the foreground , background separ , the first step we have to take is to be abl to approxim the matrix b by anoth matrix l , so that the rank of l is less equal than a given rank , k .
and the approxim is in term of thi verbinus norm .
the solut to thi problem can be found by look at the singular valu composit of b .
us the left singular vector , the right singular vector , and s of y is the singular valu .
so b is rank r .
so here is how the composit of b look like .
and the singular valu ar order from larger to smallest .
so given the singular valu composit of b , the best matrix l that approxim b in term , again , of thi frobineu norm is found by keep the k largest singular valu of thi , the composit .
we show here the formul of the background foreground separ problem .
b ar the observ data .
in l , we repres the background .
so thi is the load on matrix .
while in e , we repres the foreground for the spars matrix .
so , we want to minim the error between these term util the forbiniu norm while make sure that e is spars .
and l is a low rank .
so , the rank of l is below a given number here , k .
we'll follow two differ direct in solv thi problem .
go to the first on , we find the singular valu decomposit of l , so the matrix sigma ha the singular valu in descend order .
then the problem is reformul as shown here .
the object is the same .
howev the constraint now is in term of the matrix sigma .
we want the l0 norm of thi matrix to be below k .
a differ formul of the problem is shown here .
by util the so call nuclear norm .
the nuclear norm , is the sum of the singular valu of the matrix .
so in other word is the l1 norm of the matrix sigma .
so the l on be a convex norm , we can then have thi unconstrain optim problem .
the second direct we can follow is by decompos the l matrix , the low rank matrix , into the product of a and x .
the rank of l is determin by the number of column in the matrix a , so we make the matrix a .
so let's sai l is n by m .
so a would be n by k , and then x would be k by m .
where again , k is the desir rank of the matrix .
so then with thi the composit , we're just minim with respect to a , x , and t , the differ here , with respect to the norm plu the l1 of e , so that we make sure that e is spars .
in other word , the constraint of rank l be less than k ha been absorb into thi decomposit , ha been absorb into the number of column of matrix a .
so here is a result i show at the begin of thi week's lectur .
here is the observ video b .
while here's the low rank l present the background , it seem like , as if noth , move .
it is a stationari background .
while here is the foreground so thi is the spars matrix e .
now of cours we now how to obtain l and e base on the discuss of the previou slide .
we show here the tradit wai of acquir a signal or an imag .
we us a sensor , we sampl at nyquist , acquir n sampl then we exploit the redund or the structur in the data , and compress the data .
therefor now case sampl ar us to repres the imag where k is much smaller than n .
the compress imag is transmit or store , and then either receiv or retriev , and from the case sampl , us decompress , we end up with a reconstruct imag util n sampl again .
so sampl here by delta function is dictat by the nyquist theorem and the idea here is to try to do better than that in some sens by combin the sampl and compress stat .
the idea of compress sens is to directli acquir the compress data .
so , we combin again , someth in compress , so we acquir now m sampl where m is much less than what's dictat by nyquist .
and greater , typic , than what we can obtain by compress the data that ar acquir accord to nyquist .
so the pattern is the same , the data is either transmit or store , receiv or retriev and then , from the m sampl , us a reconstruct procedur , we can obtain a .
represent of the origin scene .
the kei question here is how to obtain thi m sampl and as you'll see , we do so by us gener or gener measur .
let us assum without loss of gener that the signal x , we ar sens , it's spars in it origin or spatial domain .
so it's k spars , mean that k element ar nonzero .
and the sparsiti with respect to a basi or a dictionari , a .
so with a tradit sampl approach , a is an ident .
i us delta to sampl it , the pixel locat .
so , thi valu is transfer directli to the observ data .
with compress acquisit , we us a sampl matrix a here , which is non diagon .
it's a long matrix becaus the number of acquir sampl , m is less than n , the dimens of the vector x .
x is again k spars , and now each acquisit is form by get out the inner product between the correspond row of a , with x .
so the compress acquisit directli acquir thi condens represent with littl or no inform lost through thi dimension reduct .
the import question is what should thi sampl matrix's .
be equal to , and the interest mayb surpris result ar that these sampl matric ar random matric .
and in acquir each and everi compress acquisit , we carri out the inner product between the origin imag and on of these matric .
so the inner , or dot product , will give me a scalar which is just on specif acquisit .
in the previou slide , i treat that as the row of a multipli x , so that's the product of two vector which is exactli the same if i vector these imag then the matrix in a product becom vector , in a product .
so , thi is a power result that we can us again random matric , as the sampl matric , to obtain thi compress acquisit .
suppos we have thi on dimension signal , and here's capit n sampl .
and we ar allow to us onli a certain percentag , let's sai <num> of the sampl in the present the signal .
if we us the tradit , the nyquist delta base .
sampl and us impuls to pull out element of thi signal .
most probabl , we ar go to meet some of the import element in the signal which ar these impuls .
i don't know the locat of the impuls and therefor , at random or equal space delta ar go to miss some of these impuls .
when we perform compress acquisit , howev , we cannot obtain a product of the signal with thi random compon .
and clearli , each now compress sampl is go to contain inform about all these impuls .
so , the signal is local , but the measur ar global .
and as alreadi mention , in each compress acquisit , there is , littl inform about each and everi compon of the signal .
therefor , get out , a number of them , we have multipl inform about the delta in the signal , and therefor we ar abl to deconstruct the origin signal from thi compressor posit .
we mention earlier that we assum without loss of gener , that signal to y is spars in it nativ domain .
howev , thi is not , a strict constrain becaus , as we know , we can , obtain ani imag , and through dictionari , a fix dictionari or a design dictionari , can have a spars , represent of thi signal x , with respect to the dictionari d .
and y is the spars represent .
so , thi is the model then , the more gener model that the acquisit b is the result of a , the sampl matrix , multipli the dictionari d , time the spars represent of the signal , y .
and it caus the theoret result random measur can be us in thi case as well .
so the end result here is that we have on vector equal along matrix , the product of a with d , time a spars long vector y .
so , thi is b .
thi here is ad and thi is y .
so , we ar given b .
we ar given ad and try to find y .
so , thi is an invers problem again .
and there's an under determin system of equat .
and through thi week we will be look at differ wai to reconstruct spars signal from and system of equat .
we can us the l0 norm or the l1 norm , and we can us the basi pursuit , or the lasso formul of the problem .
so there's a plethora of techniqu like the on we studi in reconstruct the signal from it compress acquisit .
we show here some experiment result of reconstruct imag from compress acquisit .
here is the origin imag .
it's actual the imag that is reconstruct when the number of compress acquisit equal the number of pixel .
it's veri close to the origin , but not ident .
becaus also nois wa ad to the compress question .
when the number of compress acquisit is half the number of pixel , here is a construct .
<num> of the number of pixel , here is a construct and all the wai down to <num> of the number of pixel .
clearli up to thi level , the reconstruct ar veri close to the origin , and the <num> reconstruct is surprisingli good , surprisingli code , close to the origin .
thi , by the wai , the so call shepp logan phantom , which is util for start and compar the construct for project algorithm .
we show here the perform of two differ algorithm , on is us l on for enforc sparsiti , so it's a lasso problem while the other algorithm is us tv as a regular .
tv also promot piec wise smooth solut .
and then we have two imag that shepp log and fun to be show in the preview slide .
and the camera among the , i show at the begin of thi week's lectur .
we see that the tv with the shepp log and perform the best .
but also , the l1 for the shepp logan is the second best .
so , the shepp logan is an easier imag to reconstruct from project and here is a perform of tv and lv1 with respect to the cameraman .
so , the imag i show in the previou slide .
with <num> here acquisit util the phantom tv wa us , so inde the qualiti , the big smr is <num> db , which is gener speak , decent qualiti imag .
with <num> acquisit , the peak signal is between <num> here , approxim , and <num> .
so , it's high but not extrem high .
in principl it should go to infin if the reconstruct imag wa ident to the origin on .
but , as i mention , nois is ad to the compress acquisit , the signal to nois ratio is <num> db and thi is on reason that perfect reconstruct is prevent .
we were expos thi final week , to some recent and hot develop .
in sigma imag process and machin learn .
we saw how the simpl notion and inform about the sparsiti of a signal can chang the wai we solv certain problem .
we learn how to solv problem which requir the signal ar spars .
we were also expos to some of the interest applic which result from such consider .
thi week's materi ha close ti to the materi on recoveri we cover dure week six .
we talk quit a bit there about constraint optim .
the idea and thought ar veri similar .
but now the function we optim ar convex but not differenti .
we also saw great connect with the materi of week nine and ten , where we cover compress with a us of it's great to see all these connect made .
as a final note it's hard to believ that it's been <num> week we have been togeth .
it ha been a new experi for me interact with so mani of you from all corner of the globe .
teach thi on class result in interact with mani more student than i taught here at northwestern for the last <num> year .
it's been a reward experi for me , and i hope you share the same opinion .
best of luck , put to us , the inform you learn here .
i hope the materi you learn , will prove us , and i am also certain that some of you will be the next gener pioneer in the field .
i am sure , i'll see some of you around .
hello .
i want to extend a veri warm welcom to all of you through the fundament of digit imag and video process .
my name is aggelo katsaggelo and i'm a professor here at northwestern univers , in the depart of electr engin and comput scienc .
i'm realli veri glad to meet all of you in thi new modern wai of commun .
i'm realli veri excit about teach thi class , it clearli repres a major departur from the tradit wai of teach a class .
i've been teach the materi we'll be cover in thi , in thi class for almost <num> year now , here at northwestern and around the world .
in all case howev , except mayb a few on that there wa a live feed of the lectur i wa give , the student and i , we were all physic in the same room .
so the situat clearli allow for interact .
we're all familiar with real time interact ; wherebi student can stop me and ask question and that question bring up anoth on by anoth student .
and base on the question , i start discuss other aspect of the materi , and so on and so forth .
these ar all the posit aspect of face to face interact .
a potenti neg aspect of it howev is that it repres synchron learn .
the underli assumpt is that we ar all suppos to learn at the same rate .
thi is hardli the case .
each of us learn at their own rate , base on our background and so mani other factor .
and thi is where asynchron learn come in .
you'll have the video of my lectur avail , and you can slow it down or speed it up , and you can go back and listen to part of it multipl time , and then someth is clear .
you can actual skip a segment all togeth if you all readi know the materi .
you can learn at your own pace , at your own time and place suitabl to you .
some of you , you'll be in sunni place , and some in cold place with snow .
some of us learn better first thing in the morn , while other , late at night .
of cours , due to the fact that most probabl there ar student in all world time zone , we'll be activ <num> <num> .
now , regard the materi , there is probabl littl need to sell the topic of imag and video process .
we ar all surround by countless applic , which make us of imag and video , and requir knowledg of the materi we will be cover in thi class .
we'll be cover , for exampl , the topic of imag and video compress .
if compress technolog wa not success , we should not be abl to watch thi video , and we will not be abl to have thi cours materi .
you can go back and watch also the promot video for the cours where we talk about other applic .
in ani case , i assum you've regist for the cours sinc you either have some background of the topic and you want enhanc it .
no pun intend here , sinc we will be talk about imag enhanc in the cours .
or you know that the class cover import materi that will serv you well in the futur .
or , you have a specif problem in mind , and you want to find out if the materi , we'll be cover here , will help you to solv thi problem .
or we just have a simpl curios to find out what the imag and video process is all about .
my hope and expect is that no matter to which of these case you belong to , and of cours there mayb other case , upon complet of the cours you'll all have meet your goal .
thi is not an easi task , and i don't want to mention it lightli .
it's not an easi task becaus , we will be draw materi from differ area of topic within scienc and engin .
unlik a class at an engin or comput scienc depart , where the background of the student is rather uniform , in thi case it's safe to assum that your background vari quit a bit .
as we'll see we'll reli on background from <num> dimension signal process , which we'll extend to <num> dimens , calculu , linear algebra , probabl , random variabl and random process , and optim .
howev , an import point i want to emphas here is that the cours ha been carefulli design so that it take into account thi highli vari background of the student .
on on hand i'll try to first describ the background inform we'll be need befor we us it , us it .
while on the other hand , i try to emphas the intuit behind each and everi process step we'll be take .
so , even if you don't have a background in the topic i just mention , i believ you leav the cours with some basic understand of the variou technolog .
even if not all the mathemat detail like thi ar clear to you , and also with some us algorithm you can make us of right awai .
now , for those of you with strong background in the topic i mention , i still believ you can find the materi inform and challeng .
regard the logist of the cours , all inform you need is on the web page of the cours under announc and the variou tab .
regard the materi to be cover in the class , we'll start smoothli thi week with an introduct .
then we'll spend two week on fundament signal and the fundament of two dimension linear and spacial invari system , both in the spacial and frequenc domain .
we'll then spend a week on motion estim and color , two topic we'll be make us throughout the cours .
and then we'll look at import applic , mainli enhanc , recoveri , compress , and segment .
we'll finish the cours describ recent advanc in the field which have to do with the concept of sparsiti .
so let's start thi week smoothli again by pass the titl of the cours and defin what is digi , what is a digit signal , and what constitut process of that signal .
with respect to the definit of a digit signal or describ an end to end system with input and output in the analog world but process perform in the digit world .
thi is the topic of thi segment .
we'll discuss the import concept of sampl and quantiz , which allow us to move back and forth between the continu and discret .
sampl actual , not quantiz , both in space , time and also .
so let's start , and my best wish to all of you for a success cours .
let us first defin what is a signal .
a gener definit , is that it's a function in <num> dimension .
the an x of t for exampl , function is the independ variabl or a <num> dimension x of t1 , t1 , t<num> ar independ variabl .
that contain inform .
it tell us someth us about the behavior or the natur of some phenomenon of interest .
in the physic world , we can sai that ani quantiti that chang with respect to time and or with respect to space , is potenti a signal .
so the speed of a move car repres a signal .
the pressur that i appli on the ga pedal of the car is a signal .
if i go and measur the height of the build in a citi , then thi becom a two dimension signal .
it tell us , at each locat , what the height is , and so on and so forth .
anoth exampl here is the price of the oil over the year , so the independ variabl is time , becaus the local axi here is time in year and the vertic axi is the price of oil in dollar and cent .
it goe up as we all know and expect .
similarli here is an e k g signal , an electrocardiogram .
again , here is time on the horizont axi , and the object of the signal on the vertic axi .
so a signal like thi show the count of somebodi heart .
signal and system plai a veri import role in mani area of scienc and technolog .
from commun , to aeronaut , astronaut design , bio medic engin and so on .
clearli in thi class imag and video ar the signal of interest we'll be deal with .
we have analog and digit signal .
to put them in some perspect let's look at the speech gener , transmiss , process , and percept system , like the on depict in thi figur .
so speech is gener , by the pressur provid by the lung , but becom sound in the glotti in the larynx .
which is then convert in to vowel and conson by the vocal track .
speech's an acoust signal , that is transmit through sound wave , util the vibrat of the aero m , air molecul , so here we have an acoust signal .
so such a signal reach , microphon here , which is a transduc .
it convert on form of energi , acoust energi , into anoth form of energi , electr energi .
so here , i have an electr signal .
both the signal ar analog signal , or continu signal .
if i take a kind of toi , exampl here such a signal , let sai look like thi , where here is the time max is , and here x of t is the amplitud of such a signal .
thi is an analog signal becaus the independ variabl t , as well as the amplitud x , which is a function of t , ar continu number .
now , i want to process , such a speech , speech signal by a digit comput .
and thi is realli the object of ani digit signal process class .
and digit comput onli understand zero and on or understand digit signal and therefor i need to convert my analog signal into a digit on , which is a function of thi a to d convert box .
in do so , convert an analog to digit signal , on ha to take <num> step .
the first step is to sampl the signal or discret it in the time domain .
thi mean that i look at the valu of the signal at equal space point , so at valu time zero time capit t time 2t , 3t , 4t minu t and so on .
so now i have the valu of the signal here at thi time , at thi time instanc , thi time instanc , and so on .
so , i have convert my signal into a discret time signal through the process which is call sampl .
the second step is to discret the amplitud of the signal .
thi mean that i have onli certain valu avail to repres x of t integ valu .
so , let's assum that the valu i have avail ar thi on , thi on , thi on , thi on .
thi mean that , so let's call thi zero delta to delta <num> delta .
so thi mean that thi valu here at zero will be repres by thi valu .
the second valu will be repres by thi valu .
similarli , thi on will be repres by thi valu .
thi will be repres by zero .
and thi on will also be repres by thi valu .
okai ?
so , through thi process that is call quantiz i have now a discret amplitud of the signal , right ?
so , the valu at <num> , t here is the quantiz valu of x , x , <num> , t , right ?
actual , here will also be the same valu x quantiz at 4t , while the actual valu here , thi is x of 4t .
right ?
and after quantiz , it becom the blue valu .
so , clearli , quantiz introduc an error .
so after both sampl and quantiz , i end up with a signal that ha both it independ variabl as well as it aptitud be repres by discret valu .
and , such a signal is call a digit signal .
okai ?
so thi signal is an input to the comput , which is go to process it and then at the other end i follow somehow the revers order .
in other word the signal the turn from digit to analogu through the convert shown here .
then thi analogu signal , reach anoth transduc , thi is also call the nuctuat , that will turn the current in to a vibrat .
and therefor in to anoth acoust signal , which is go to be perceiv by the human auditori system .
so here again , i have an electr signal .
and thi is and again , an acoust signal .
the object of a digit signal process class is to focu onto the central part here , right ?
to focu on the techniqu that will allow us to manipul digit signal to perform certain task that depend on the applic .
so we see here that we have <num> word , we have the analog world here and here , right ?
so analog , analog here , and the digit world or the digit domain here in the middl .
that is of our primari interest .
a similar situat to the previou on is depict by thi block diagram .
that show the gener , record , process , and sens of an imag .
so electromagnet energi in the visibl part of the spectrum is leav the sun , reflect by the object , travel through the air , and reach here .
a sensor , a transduc , which is an analog camera that through photochemistri convert light energi into chemic chang on the film .
some of you might be too young to rememb analog camera that were us in film .
but there is still some around in exist .
so the , the brighter part of the imag , have higher concentr of silver halid grain .
and thi film , after it's process , neg or black and white film .
repres an analog imag .
so again my object here is to process the imag by digit comput .
and therefor i have to convert my analog imag to a digit on , through thi a to d block .
in thi particular case , i can us a densitomet , that measur the concentr of thi silver highlight plane on the film , or a scanner , to end up with a digit imag .
of cours now dai , you have digit system ar preval .
which mean that these <num> unit here ar group togeth , and thi becom a digit camera that we ar all famliar with .
so i guess we should put here that thi in here is an analog camera .
after the digit imag is process by the comput , and again , thi is the main object of thi class .
we'll talk about techniqu that will allow us to cross those digit imag .
we want to take the process imag and in mani case , we want thi imag to be seen by the human viewer .
so the revers path is follow wherebi the digit imag is convert into an analog on .
and thi then , signal will feed into a monitor , an analog monitor , such as a crt monitor , that will convert the imag into an electromagnet wave that is go to reach the human , visual system .
the ey of the observ .
again , nowadai digit monitor or flat panel ar , ar preval so , and lcd , here will be fed by the digit signal directli .
a video adapt plai the role of the convert .
so , in thi class we'll sai a few thing about sampl .
and quantiz of imag .
that i repres by thi a to d block , and actual could be someth or frequent as we'll see .
we'll sai a few thing about properti of the visual system , but by and larg our main focu is in thi center block where the input is a digit imag , and the output is a anoth process digit imag on .
to demonstr sampl , or better yet , re sampl , let's consid thi digit imag .
it's a <num> by <num> imag , which mean it ha <num> row and <num> column .
and it's an <num> bit imag which mean , each element here which is call a pixel from pictur element ha <num> to the <num> , or on of <num> valu .
okai ?
so , i'll take thi imag , and i will downsampl it by a factor of eight in both the horizont and the vertic direct .
so out of eight sampl , horizont , i'll keep on .
i'll do the same in the vertic direct .
or in other word , if you consid here an eight by eight block i will onli keep thi valu and throw awai that s .
so , i keep on and throw awai <num> .
okai ?
if i do thi , then i end up with a <num> by <num> imag , thi tini imag shown here .
if i bring it back to , the sixth , if i bring it back to the sixth dimens for organ purpos , then , that's how thi imag will look like .
so , you see , that due to thi downsiz .
you see thi block effect and thi so call jag edg , right ?
thei're not straight edg anymor , but thei're jag .
of cours drop sampl thei someth veri simpl .
i us so call zero order hold .
which mean , i just took a , <num> by <num> block , i onli had thi valu i wa miss the other , <num> valu , and i simpli gave to the other <num> valu , the valu of thi .
so , each <num> by <num> block here's the same valu and thi is appar by look at thi imag .
thi is an <num> by <num> block for exampl , and it ha constant valu or constant intens .
similarli , the idea of re quantiz is the depict here .
over here is the <num> bit per pixel imag you start with .
so , here i have <num> to the 8th , <num> differ grade valu and while here i have onli <num> to the 4th equal <num> valu to repres the differ intens .
and over here , i go down to <num> to the second that is <num> differ valu .
so clearli you see thi so call contour effect , that visibl here even , right ?
so there's a you know , artif , contour abound that is have , noth to do with origin imag .
so you save bit clearli in go from <num> bit to <num> to <num> bit will present intens , but at the same time you introduc error with so call quantiz error .
welcom back , in thi segment we defin , 1d , 2d , 3d , and multidimension signal .
we also distinguish between scalar and vector valu signal .
whether the equat is a color imag a two dimension , or three dimension signal , or what's an exampl of a four dimension signal .
we will show repres exampl of imag with differ intens resolut .
for exampl , binari imag such as a text imag , through color imag , when each pixel assum on of <num> million color , and pseudo color imag .
when we decid the number of color to be us for visual purpos for a color but also for a black and white imag , there's pseudo color problem .
we also show exampl of stereo imag emul human percept that is variabl to perceiv depth sinc we us two ey .
if we were to us two camera at some reason distanc , the so call base line , then the two imag or video record by the camera emul our human visual system .
we discuss what the term process , in the titl of the cours mean .
the narrow definit of a process system is on that accept an imag at the input and gener anoth imag at the output .
the broader definit howev , the on we adopt in thi cours , is that of a system which for an imag at the input might gener an imag at the output or a decis base on the analysi of the imag , which might result in an action such as to oper for exampl in a patient if there is a medic imag .
or the extract or segment of an object from an imag base on it color or it's motion and mayb even it classif .
so let's look at some of these exampl in thi next segment .
depend on the number of the independ variabl , signal can be group , classifi into on dimension , two dimension , three dimension or in gener multi dimension .
so tone , speech , audio , biomed ar on dimension typic a function of time .
if i look at thi continu or discreet i'm call thi s of n .
so on independ variabl .
text and grayscal imag ar certainli two dimension signal where thei're independ variabl to present space .
i can have s , x , y , for exampl , i can call it .
while color , multispectr , hyperspectr imag , we'll sai a few word about them , have two special coordin , and then on can look at the amplitud in two differ wai .
the on is to sai that the amplitud is not scalar anymor , but the vector three by on vector when it come to color sinc thei have three differ channel or a seven by on , let's sai , for a multispectr imag .
or , thei can view as three dimension imag with two spacial and on spectral coordin .
video is a 3d signal .
it ha two spacial and on tempor coordin , while a 3d volum ha three spacial coordin x , y , z .
as an exampl of a four dimension signal i can look at their volum and x , y , z signal that chang over time , so time is the fourth independ variabl .
some of the tool that we us to describ signal carri over from 1d to 2d to md is the straight forward extens on just add on more variabl , and everyth remain the same in some sens .
on the other hand , there ar certain result that hold true for undimension signal , but thei cannot be gener for higher dimension signal .
imag and video ar clearli the focu of thi class and the imag ar two dimension signal but can also be three dimension , where we talk about multispectr , hyperspectr imag while video is a three dimension signal .
so we ar a dimens .
so let us look now at some exampl , repres exampl of , of signal .
tone ar exampl of on dimension signal .
on top you see a sine wave that onli ha on frequenc present in it , at <num> hertz .
that's why it's call a pure tone .
let us listen to that .
at the bottom , you see a squar wave .
it also ha the frequenc at <num> hertz .
howev , it ha addit frequenc , the so call harmon .
let's listen to that as well .
it should be clear that the bottom squar wave is richer in the sens of have addit frequenc down the proton the sinu wave .
here we have anoth exampl of anoth on dimension signal , it's a piano piec familiar to , i assum most of you , and thi is a synthes piec , and we can listen to that as well .
here ar some exampl of the imag .
on the left , you see a binari imag , that is i onli have two bit to repres the differ color , i have a black and a white valu here .
binari imag , text imag like thi on ar us in the fax encod when i want to transmit such text from point a to point b through the fax machin .
in the middl , you see the again , an eight bit per pixel imag , while on the right is a <num> bit per pixel imag .
thi is a true color imag .
i have two to , to the <num> differ color valu .
thi should be around <num> million differ color to repres such an imag .
there ar differ wai to repres the color imag , on of which is shown here , in term of three differ channel , the red , green and blue channel .
thi is an rgb decomposit of the imag .
so , each of these channel is a , black and white imag .
i us eight bit to repres it , so each of the channel here ha two , <num> differ valu and eight bit per channel time three , therefor <num> bit to repres the color imag .
so , if we look at thi you notic the nose of the mandril here is quit red .
and therefor , we see that the pixel valu in the red channel ar quit high .
why it is repres by height ?
valu closer to <num> , while <num> <num> so close to <num> while the darker valu ar closer to zero .
so , the red nose ha high valu in the red channel and pretti small valu in the other three channel .
on the other hand if i look at the cheek of the mandril thi is the variat of blue not exactli the blue color , so i see high valu in the red , i'm sorri , in the blue channel and there ar the smaller valu , well definit smaller than the red and semi somewher in the middl in the green channel , right ?
actual thi particular valu appar is a combin of green and blue .
the landsat program is respons for the acquisit of satellit imageri of , of the earth .
it start in <num> , and the most recent satellit that landsat <num> wa launch in thi year .
landsat <num> data , here's eight spectral band with special resolut rang from <num> to <num> meter , and the tempor resolut is <num> dai .
the main instrument on board landsat <num> is the enhanc themat marker plu , etm plu .
the resolut is <num> meter , except band six , that ha <num> meter resolut , and band eight , that ha <num> meter resolut .
band eight by the wai , is the panchromat band .
so you have low , or high rather special resolut , <num> meter , while we have low spectral resolut .
by the wai , thi is the visibl rang of light here .
so thi is the blue , green , red channel , while the rest ar infrar .
landsat data have help to improv our understand of earth , and due to landsat todai , we have a better understand of thing as divers coral reef , tropic deforest and antarctica's glacier .
so here's an exampl of a landsat <num> imag of the citi of amsterdam .
up here you see the blue , green and red channel , and the rest of the channel for other channel ar infrar .
by the wai hyperspectr imag ar the on that have mani more bond , up to <num> and <num> bond , but the main characterist of the , of the bond ar much closer space .
let's compar it to the multispectr imag .
veri often in order to be abl to appreci the landsat the imag , the visibl band ar combin .
thi is what you see of the left imag .
thi is by the wai , the landsat imag of the citi of london .
so , these natur look imag ar familiar with the human ey .
so , the reservoir here close to heathrow ar shown in dark blue , while the citi itself is shown in grai .
so these imag offer veri good view of citi infrastructur , sediment and also by symmetri .
we can tell how , how deep the water is over there .
howev , the band <num> <num> imag , it's not us , it's difficult to distinguish between differ type of veget and between cloud and snow .
so , therefor in the middl imag , we combin the three channel , channel four , two and three .
in other word on infrar bond and the green and blue channel , thi is a wide us combin , that's especi us for studi of veget , sinc the differ type of plant , reflect the infrar light in differ wai .
now anoth combin is the seven , four , two shown on the right .
so two infrar band plu green , and thi combin is especi us for geolog and agricultur studi , becaus band seven can help discrimin between variou type of rock and miner .
and bright green here indic veget while the water appear dark blue or black .
now our natur world is three dimension while the imag ar two dimension .
thei present the project of a three d world on to the two d plane .
in order to perceiv depth , we need two ey .
so , we need to camera that will captur the same scene , and therefor thei will emul the human visual system .
so , here you see on the left what the left camera see , and on the right , what the right camera see .
and the differ between these two imag is the so call dispar map .
it tell us how each and everi pixel move from on imag , and go from on imag to the next .
or if i us dispar map , i can map the left imag onto the right imag .
the dispar map relat to the depth in , in the imag .
so the two channel infus the properti will give us the depth percept , and the fusion could be done through a red and blue channel and therefor i can us the color code glass or i could us glass with differ polar and so on .
here's anoth exampl of a stereo imag .
in thi case thi is a landsat imag , actual two landsat imag were us that were acquir of the same scene that were acquir on year apart .
so the satellit doe not go exactli over the same posit necessarili and the two imag ar repres two differ imag from the left and right channel of the same scene , and therefor thei can be combin to give us the depth percept .
you can obtain depth inform also us the kinect camera .
it project a known pattern onto the scene and infer depth from the inform from the pattern .
so the kinect combin structur light with two comput vision techniqu depth from focu and depth from stereo .
the kinect is intend to us with the xbox and therefor it is of interest there to comput the depth map but also infer the bodi posit .
so you see here the skeleton of the person on , on the left imag , right .
so here is the person , thi is the depth map , and also the kinect provid a visibl imag shown here .
so you see the visibl and the correspond depth imag that show where the person stand and where the door is and so on .
we can see here short video but show both the visibl imag as well as the depth imag acquir by the kinect camera .
veri often we're interest in captur the three dimension structur of an object .
so , instead of us two camera as in the stereo case , we us mani camera on a specif rig .
so , as you can see here , the imag of thi particular object is view from mani differ angl .
here's an exampl of a video .
a video consist of individu frame , and on could argu that a video is noth els than a collect of imag , and therefor , if i have an outgo that is effect in process an imag , a still frame , as it's call .
also , i could appli the same algorithm to frame after frame and i will be done .
howev , what is special about video is that these frame ar highli correl and therefor , i can gain if in process such frame .
i take thi correl into account .
of cours these frame , if thei're displai at some frame rate , <num> frame per second , for exampl , on can perceiv the actual motion indic .
final , process in the titl of the cours mean the manipul of the valu of an imag or a video by comput .
so as the result imag is more us to us , or ha some desir properti .
for exampl the result of process might be the remov of blur , as is the case here you , you see , the input to the system is an aerial photograph that is blur with the motion between the camera and the scene and the output is a sharpen , a restor imag .
now if an imag is input , an imag is output thi ha been the kind of narrow definit of process , or so but if i do as filter , and the broader mean of process that we adopt here is that an imag or video can be input to a system and we're interest in extract import featur from such an imag or we're interest in make decis base on the imag .
the best exampl here show thi is a chest x rai and the input and base on the analysi that would be perform whether there's a malign tumor or not , for exampl , certain decis and action will be the output of the system .
as time goe on , what we see is that the boundari is between tradit and separ area becom fuzzi or in other word there's overlap between these tradition separ area .
so , when it come to signal process and more specif between with the video process that we'll be deal with in thi class .
there is overlap between the , thi field and the field of commun , comput vision , machin learn and optim .
welcom back , the imag and video process field is an excit on for a number of reason .
on of which is the amaz divers of both the applic that us imag and video process techniqu , but also the type of imag that aris and which deriv ani type of radiat .
now , when we think of imag and video , the on that come to mind first ar the on that we can see .
at ani given moment howev , we see veri littl of the radiat around us .
of cours thi is good enough for us to function fulli , and we don't need necessarili superman's x rai vision .
our ey , like ani sensor , give a certain bandwidth .
and allow us to see the so call visabl part of the em spectrum .
from an evolutionari perspect , the band of em radiat that the human ey perceiv is perhap optim , sinc the data that is us is highli reli , reliabl and abundantli avail .
the sun emit strongli the visibl bond , and the earth's atmospher is also transpar in the visibl wavelength .
have a limit bandwidth is also a form of data reduct .
we would have been overwhelm had we been abl to sens a much broader area of frequenc in the em spectrum .
in thi segment , we look at repres imag from the variou part of the em spectrum from gamma rai imag from on end to the radio band at the other end .
we also look at repres imag outsid the em spectrum , such as ultrasound , electromicroscopi and comput gener imag .
regard the dimension of the object we , we ar imag , due to the invent of power telescop and microscop we're ab , we're abl to see the atom structur of object and object far awai in the sky .
the size of object we can see now ar from a few nanomet .
took hundr of thousand of light year .
so let look at some fun imag in thi segment .
on aspect of imag and video process that make it such an excit topic of studi , is the amaz divers of applic that us imag process or imag analyz techniqu , as well as the divers of imag type that aris .
in try to put some order in our mind regard the variou imag type , it's import to realiz that the principl sourc of energi for imag in us todai is the electromagnet energi spectrum .
so , we will look at exampl of the type of imag origin from the variou part of the spectrum .
some of the most excit develop in medic imag for exampl , ar the result of new sensor , that record imag data from previous littl known sourc of radiat , such as positron emiss tomographi , pet , and magnet reson imag , mri .
or new sensor , that sens radiat in new wai , as in comput aid tomographi , cat .
while x rai ar collect from multipl angl to reconstruct a ridg aggreg imag .
anoth import sourc of imageri includ acoust or ultrason radiat .
ultrasound is a , a sound pressur wave with frequenc greater than the upper limit of the human hear rang .
anoth import sourc of energi includ electron in the form of electron beam us in electron microscopi .
and final , we have imag that do not exist in natur .
but thei exist in our mind , and then with the us of comput graphic , thei can be given shape and form , and thei can be visual .
and , we'll show some exampl of all the imag abov , start with the studi of the imag result from the variou part of the electromagnet spectrum .
anoth possibl classif of the imag is into reflect imag , emiss imag , and absorpt imag .
reflect imag send radiat that ha been reflect from the surfac of object .
the radiat itself mai be ambi , ambient or artifici .
it could be from on sourc or multipl sourc .
the type of inform that can be extract from reflect imag is primarili about object surfac regard their shape , textur , color reflect , et cetera .
most of our daili experi in optic imag through our ey is about reflect imag .
other known visibl exampl includ radar imag , sonar imag , lar , laser imag and even some type of electron microscopi imag .
emiss imag ar even simpler , sinc in thi case the object that ar be imag ar self lumin .
in thi case , the inform is primarili about the intern structur of the object .
and the exampl of emiss imag ar thermal , infrar and mri .
final , absorpt imag provid inform about the intern structur of object .
in thi case the radiat pass through object and it's partial absorb or attenu by the materi compos in the object .
exampl includ x rai , transmiss microscopi , and type of sonic imag .
here's a pictur of the electromagnet spectrum , which is the rang of all possibl frequenc of electromagnet radiat .
the electromagnet spectrum extend from below the low frequenc us for modern radio commun , to gamma radiat at the short wavelength high frequenc .
it cover therefor wavelength from thousand of kilomet down here to a fraction of the size of the atom at the other end .
it might be hard to read all the number but the scale here is logarithm so thi is on held here .
so then ten to the first is here , the second , the third , and if you call all the wai it's ten to the fourteenth up here at the gamma rai , and you can do a similar thing for the wavelength .
we see here that the visibl part of the spectrum is just a tini part of the em spectrum .
and what we'll do next is just go through some repres exampl when , exampl when come to gamma rai , x rai , ultraviolet , visibl , infrar all the wai down to radio frequenc .
major us of imag base on gamma rai includ nuclear , medicin , and astronom observ .
in nuclear medicin , the patient is inject with a radioact isotop that emit gamma rai as it decai .
imag ar then gener from the emiss collect by gamma rai detector .
so the first imag show a complet bone scan .
imag of that natur ar us to locat infect or tumor .
in posit emiss tomographi , pet , the patient is given a radioact isotop that emit positron as it decai .
when a positron meet an electron , both ar elimin and two gamma rai ar given off .
these then ar detect and a tomograph imag is creat us a , the basic principl of ct .
so it similar to x rai ct .
anoth applic is gamma rai radiographi system , capabl of scan track , us a rang activ sourc and a vertic tower of gamma detector .
thi gamma camera is abl to produc on column of an imag while the horizont dimens of the imag is produc by move either the track or the scan hardwar .
the system provid good qualiti imag we can be , which can be us for identifi cargo , and by compar it to a refer , anomali can be detect .
we also have instanc where an imag is obtain us the natur radiat of the object be imag .
thi is the case for exampl of the star in the constel of cygnu , explod about <num> , <num> year ago gener a super heat stationari dust cloud known as the cygnu loop .
and thi is what thi figur c show here .
similarli , we can observ the natur radiat of an object be imag as here , the bright spot from a reactor valv .
x rai were first observ and document in <num> by redkin .
a german scientist who found them quit by accid when experi with vacuum tube .
a week later , he took an x rai photograph of hi wife's hand , which clearli reveal her wed ring and her bone .
redkin call it x to indic that it wa an unknown type of radiat .
although sometim thei're call also redkin rai .
so x rai ar among the oldest sourc us for imag .
thei're gener when electron which flow in a vacuum tube , strike a nucleu and energi is releas in the form of x rai radiat .
the best known us of x rai is medic diagnost .
but thei're also us in industri and other area like astronomi .
so here we see a chest x rai and here is the cygnu loop that emit x rai natur .
higher energi x rai ar us for industri inspect and here we see the x rai of a , a circuit board which clearli is done to find possibl abnorm on the board .
there ar a number of applic for ultraviolet imag such as lithographi , industri inspect , fluoresc microscopi , laser , biolog imag , and astronom observ .
actual fluoresc microscopi is on of the fastest grow area in microscopi .
fluoresc is a phenomenon which wa discov when it wa observ in the mid 1800s .
that the miner our fluorspar fluoresc when uv light is direct up on it .
uv light is not visibl but when a photon of uv collid with an electron in an atom of a fluoresc materi , it elev the electron to a higher energi level .
the excit electron relax to a lower level and emit light in the visibl red region .
materi actual can have primari fluoresc or secondari fluor , secondari fluoresc , when thei ar treat with chemic capabl of fluoresc .
regard astronom observ , we show here an ultraviolet imag of the globular cluster , ncg <num> .
in our daili experi , we think that what we see is what realli exist around us , but in truth , our ey record veri littl of the inform that is avail at ani given moment .
as with ani sensor , the human ey ha a limit bandwidth .
the band of electromagnet radiat that we ar abl to see , or the visibl light , is quit small , as we can see from thi chart of the electromagnet spectrum .
it is typic from <num> to <num> nanomet and in term of frequenc , thi correspond to a band in the vicin of <num> to <num> terahertz .
at ani given moment , we see veri littl of the avail radiat around us .
although thi is certainli adequ to allow us to function fulli .
from an evolutionari prospect , the band of em wavelength that the human ey perceiv , is perhap optim , sinc the data that is us , is highli reliabl , and abundantli avail .
the sun emit strongli the visibl band and the earth's atmospher is also transpar in the visibl wavelength .
have a limit bandwidth of cours , is a form of data reduct .
we could have been overwhelm by the amount of data , had we been abl to sens a much broader rang of frequenc in the em spectrum .
imag of the visibl band , outweigh by far all the other , in term of breadth of the applic , like microscopi is an area with a wide rang of applic .
we show here three imag obtain of , by a light microscop and you see a cholesterol magnifi <num> time , a microprocessor magnifi <num> time , and the surfac of an audio cd magnifi <num> time .
next in the visibl band is the infar band .
we spoke earlier about landsat imag as us for exampl , in mode sens in the introduct of thi week class .
we show here again a seven band landsat imag .
thi is the blue channel , the green of the red channel ir frequenc band to middl , band and final a thermal band .
each of them provid us inform about the , the , the area that is be imag some of them can discrimin veget better , other moistur , other miner and so on .
thi pictur show an applic of ir imagin .
these imag ar part of the nightlin light of the world data set , which provid a global inventori of human settlement .
the imag wa gener by the ir imag system , mount on a nation , oceanograph , and atmospher administr , noaa , a noaa satellit .
the satellit oper in the band , ten to <num> micro meter .
and ha the uniqu capabl to observ faint sourc of visibl near ir emiss present on the earth's surfac includ citi , town , villag , fire and so on .
so we see here , the map of the unit state there ar certainli dark area around here and here , and then the map light up around metropolitan area like chicago is over here and new york around here and lo angel here .
we also see the map of europ over here .
it's also well lit up but the whole contin of africa is rather dark .
after the ir band , we ar now imag in the microwav band .
we see here , an imag of the death vallei .
as seen from the space shuttl's synthet apertur radar instrument .
sar is usual implement by mount on a move platform such as an aircraft of spacecraft in thi particular case , a singl beam , beam form antenna from which a target scene is repeatedli illumi , illumin with puls of radio wave .
at wavelength anywher from a meter down to millimet .
thi particular imag here is clearli in fals color .
the surfac color and intens repres the radar reflect properti of the ground cover .
the imag is arrang like a map .
the imag pixel repres approxim rectangl on the ground .
we're imag now in the radio band .
as with the case , when imag at the other end of the spectrum , imag with gamma rai , the major applic of imagin in the radio band ar in medicin and astronomi .
me .
in medicin , radio wave ar us in magnet reson imag .
you see here an mri imag of a human spine .
thi techniqu place a patient in a power magnet and pass radio wave through the person's bodi in short puls .
each puls caus a correspond puls of radio wave to be emit by the patient tissu .
the locat from which these signal origin and their strength ar determin by a comput which produc a two dimension pictur of a section of a patient .
although imagin in the electromagnet spectrum is domin , there ar a number of other imag modal that ar also import as we mention in the begin of the present .
so specif , we'll sai a few thing about acoust imag , electromicroposi , and comput gener imag .
so imag us sound ha applic in geolog explor , industri applic , and medicin .
so , when it come to ultrasound , ultrasound imag is us in applic like manufactur .
but the best known applic of thi techniqu is in medicin .
and especi in obstetr , where the unborn babi ar imag to determin the health of their develop .
so the basic idea behind ultrasound imag is that there is a probe which consist of a sourc and a receiv which transmit high frequenc , on to five megahertz sound puls into the bodi .
so the sound travel into the bodi and hit boundari between soft tissu let's sai , in bone .
so some of the sound wave ar deflect by the probe , while some other travel further down to hit anoth boundari and get reflect .
so , these reflect wave ar pick up by the probe and relai to the comput .
and the comput calcul the distanc from the probe to the tissu or the organ boundari , us the speed of sound .
at the end , the system displai the distanc and intens of the echo .
on the screen , form a two dimension imag , and thi is the imag we see here of thi embryo <num> week , or <num> week rather .
electron microscopi is an imag method outsid of the electromagnet spectrum .
electron microscop function the same wai as optic microscop .
but now instead of light thei us a beam of electron .
so a beam of electron is produc by an electron sourc and thei're acceler toward a specimen , interact occur insid the sampl , effect the electron beam .
so these interact and effect ar detect , and transform into an imag , the same wai that light is reflect or absorb by object in the scene .
so with the scan electron microscop , sem , the electron beam scan and record interact of the beam with the sampl in each and everi locat .
so a complet imag form by just raster scan of the beam through the sampl .
so what we see here is , an sem imag of normal circul human blood .
and we can see in thi imag red blood cell .
thi for exampl as well as white blood cell .
white light microscop can reach amplif up to a factor of a <num> , <num> .
electron microscop can reach magnif of up to a factor of <num> , <num> and even more .
comput graphic , it's an excit field of research and develop .
it studi method for digit synthes and manipul visual content .
it address the variou technolog us to creat and manipul imag .
on of their object is the creation of photo realist imag .
and here you see an exampl of a realli beauti and appeal comput gener imag .
regard the scale of the imag we'll be deal with .
the invent of power microscop and telescop , ha open to us the gate of nano and galact world , and enabl us to take imag of object that were previous too small or too big to captur .
so the size of object we can see now , vari from a few nanomet for the afm imag shown here of silicon atom , through hundr of thousand light year for the andromeda galaxi shown here .
so down here is the scale , here's on meter and it goe all the wai to ten to the 21st here and <num> to the minu nine here .
an import point is that no matter what the scale of the imag is , the process techniqu we will be develop , and discuss , and analyzinig in thi class ar in principl applic to ani imag , independ of scale .
i hope you enjoi the first week of class .
dure thi week , i tri to paint the big pictur , what doe , imag and video process mean and what ar some of the type of imag on can work with .
we did not talk much about applic , sinc we have plenti of time to do so , and in consider detail for the remain of the class .
you can , of cours go back to the promot video , and check some of the applic exampl there .
we saw that there ar mani divers type of imag origin from the variou part of the electromagnet spectrum , and also outsid the spectrum such as acoust and electron imag .
on of the main attribut which make imag and video process an excit field .
there is also such a wide rang of size of object we ar imag from the nano world to the galact world .
now , what you should keep in mind is that some of the principl we'll be cover in thi class such as sampl and oper of linear and special invari filter .
and the frequenc domain represent of signal and system , ar imag type and imag scale depend .
that is we can appli them to ani imag .
on the other hand , while the princip of the import applic we'll be cover , enhanc , recoveri , compress and segment , ar also imag type and imag scale depend .
a lot can be gain if we have inform about the process that gener these imag so that the process now can be adapt to the type of the imag .
we'll be revisit these concept later in the cours .
so again i hope you had a smooth introduct to the cours .
next week , we'll start talk about specif signal and system that process such signal .
so , see you next week .
welcom back .
i hope you enjoi the first week of class , dure which you cover the introductori materi .
in thi and next week , we will cover the fundament of two dimension signal and system .
we're interest in describ some import and us signal .
on of them , as you'll see , the complex exponenti , is the build block of ani signal , and we're also interest in the input output relat of system .
thi week , we will carri thi discuss in the spatial domain , while next week we will move the discuss to the frequenc domain .
we us two dimension signal and system in our present .
howev , all the inform it provid is also applic to on dimension signal , but also to higher dimension signal , that is , multi dimension signal in gener .
we will becom now more specif and talk about import to the signal , the on you encount often and system that process those signal .
we're primarili interest in the algorithm or the mathemat , or the softwar implement of such system in thi cours .
we will then move on as specif class of two dimension system that have <num> import properti that these ar linear and time invari or special invari .
such system ar veri us and popular for process imag and video and thei're friendli in the sens that thei allow us to describ them in a succinct wai in the special domain through their impuls respons , but also allow us to look at their behavior in the frequenc domain .
thi week's materi form the backbon of ani cours on multidimension signal and system .
equip with the knowledg you'll acquir thi week , you'll be abl to understand ani paper or work that deal with the process of signal in ani dimens .
if you alreadi have had a cours on on dimension signal process , then the materi i'll be present here these two week will reinforc your knowledg of the topic .
we will simpli add on independ variabl to our signal represent , and we'll take everyth from the on dimension line , to the two dimension plane .
if thi is the first time you ar expos to thi materi , don't be discourag if everyth is not clear right awai .
it might take some time and experi for everyth to sink in .
we will be util some of these idea throughout the cours .
so by the end of the cours , everyth should becom much clearer .
i will clearli be present onli basic materi which will be requir for the remain of the cours .
for those of you interest in thi specif topic , there is a plethora of book and resourc that will allow you to look deeper into the topic .
in thi first segment , we'll introduc some convent repres 2d and 3d space and then , we'll introduc <num> basic two dimension signal , the unit impuls and the unit step .
we will see that both of these signal ar separ signal .
so let's proce with the materi of thi second week .
let us first establish some notat and convent when we deal with <num> d and <num> d discret signal .
let x n1 and n2 be a two dimension signal .
n1 and n2 ar then depend variabl .
thei're integ , thei take valu <num> , plu minu <num> , plu minu <num> .
and mathemat speak , a signal , an imag can have infinit support .
that is the valu that n1 and n2 take ar between minu infin and plu infin .
when it come to the orient of the axi , i can us n1 as the horizont axi and to the vertic on with thi orient .
that's how we're us to present function in calculu .
so , here is <num> .
here is the point n minu <num> .
here's the point m minu <num> .
so thi is an n by m imag .
so if thi is n1 prime , thi is m2 prime , then here is the pixel with coordin n1 prime , n2 prime .
the valu of the pixel is in gener a real number .
now draw from the wai matric ar repres on the comput , i can pick the n1 axi thi wai and the n2 axi gone , to have gone like thi .
so in thi case if i pick the same n1 prime , it would be here , approxim here .
the same n2 prime would be approxim here and therefor , thi is now the pixel with coordin n1 prime , n2 prime .
clearli as long as the orient of the axi is known , the result of process an imag should be ident .
it shouldn't matter which wai i have chosen to repres the axi .
when i deal with color imag , then there ar <num> channel involv , the blue , the green , the red channel .
if these channel ar ad up , i end up with a color imag .
so if thi is the n1 axi , and thi is the n2 axi , again , the locat , the n1 prime , n2 prime locat of the pixel of the same , the pixel of the same locat xn1 prime , n2 prime , but the differ now from the previou case is , is that x n1 prime , n2 prime is now a vector , a <num> by <num> vector where i have the valu of the red channel at thi locat follow by the valu of the green channel at the same locat follow with valu of the blue channel at same locat .
okai , so the algebra represent .
so x , therefor in the gener present can be a scalar or it can be a vector .
when i deal with three dimension discret signal , then xn1 and <num> and <num> is the represent n1 , n<num> , n3 ar integ .
and again , mathemat speak , thei can rang from minu infin to plu infin .
so , here is a collect of frame repres a video .
so i can choos n1 .
go down thi wai , n2 is the second axi and <num> is the third axi , it repres discret valu of the time domain .
and now , nx , n1 prime and <num> prime and <num> prime would be a pixel , let's sai , n3 prime is here , it will be a pixel in thi frame with the other <num> coordin n1 prime , n<num> prime .
a littl bit hard to exactli repres it in thi case , but you do get the idea .
we'll just now talk about some specif signal that we would be make us of in thi class .
the first on is the unit impuls .
it will be note by delta n1 , n2 , and by definit is equal to <num> when the argument ar equal to <num> .
so if here on the 2d plain , here's n1 , here's n2 , then i'll denot delta like thi , and the height of the delta equal <num> .
i can shift the delta around , so i can write delta n1 minu n1 prime , n2 minu n2 prime .
and then accord to the definit , it's equal to <num> as long as the argument ar equal to <num> and <num> otherwis .
so from here , we see that it's <num> when n1 equal n1 prime and n2 equal n2 prime .
so again if i'm to sketch it , depend on the valu of n1 and <num> , i have not restrict them .
so let's sai n1 prime is here and n2 prime is here , therefor in thi case i have a signal like thi , so it's a delta , it valu's <num> , and it's <num> everywher els , everywher els on the plane .
i can talk about the three dimension delta by introduc an n3 there , so the definit will extend to be <num> when n<num> equal n2 equal n3 equal <num> .
an interest notion is the notion of separ signal .
a signal g is separ if it can be written as f1 which is a function onli of the on variabl , n1 time a function of <num> which is a function of the second variabl , omni .
the question then is whether the 2d delta is separ , separ signal , and the answer is ye .
we can if we let's , let's look at it pictori first , right ?
if i have a signal but it look like thi .
so it's a line of delta .
so it's <num> on the vertic axi and <num> everywher els and all these valu ar equal to <num> , right ?
and then if i have a signal that , here's a line of impuls on the horizont axi , so , with solid dot here , valu of <num> , and the signal is <num> everywher els , right ?
so now if i multipli these two signal , then it should be clear by just these pictur i'm draw here that i multipli it like thi , on is multipli by <num> here , thi on is multipli by <num> over here .
thi on is multipli by <num> at thi locat and it's onli thi on here at the origin that is multipli by <num> here and therefor the result is just thi signal which of cours is just , we have to find if thi is delta n1 and <num> .
now what is the first signal equal to , thi is a delta n1 , right ?
becaus thi is by definit equal to <num> when the argument is equal to <num> and <num> otherwis .
but i'm on the two dimension plane , right , so delta n1 is <num> for n<num> equal <num> and ani valu of n2 , no restrict on n2 .
so therefor n1 equal <num> on the vertic axi , n1 equal <num> here , n1 equal <num> here , here , here , here .
so thi line of impuls , the first on is repres by thi automat by thi function , delta , delta n1 and similarli , thi line of impuls is a delta n2 signal .
therefor delta n1 and <num> can be written as delta n1 time delta n2 and it is therefor separ accord to the definit , right ?
so delta n1 take the place of f1 n1 in the definit , right ?
so thi , i'll be write the definit here time f2 n2 .
anoth us function is the discret unit step .
it's denot by u .
and by definit , it's equal to <num> as long as the it argument ar not neg .
so n1 is greater equal than <num> , n2 greater equal than <num> .
so from the schedul here , is again <num> as long as n<num> is greater equal than <num> , but also n2 greater equal than <num> .
so the valu of the solid circl is <num> , and then the signal extend from <num> to infin in the n1 direct , and <num> to infin the n2 direct .
we often label the quadrant ; thi is the first quadrant , thi is the second on , thi is the third on , thi is the fourth on .
and in thi case we sai that the , the discret unit step here support in the first quadrant .
we can shift the unit step function around , so if i have n1 minu n1 prime , n2 minu n2 prime , then by definit , thi is equal to <num> , as long as it argument ar not neg and <num> otherwis .
so from here , we see that n1 is greater or equal to n1 prime .
n2 is greater or equal to n2 prime .
so , if i'm to sketch thi shift step depend on where n1 prime and n2 prime ar locat , so let's sai , n1 prime is here and n2 prime is here , right ?
so then .
shift it .
the step function look like thi , and extend between thi wai , and continu thi wai .
so thi is , the coordin of thi point is n1 prime , n2 prime .
the next question is whether the unit step is separ as wa the delta and the answer is ye .
so , un1 , n2 can be written as un1 time un2 and pictori , un<num> is <num> as long as n<num> is greater or equal than <num> .
so , it look like thi .
again , these solid circl have a valu <num> .
so it extend to infin thi wai .
thi wai and thi wai , right ?
so thi is un1 , un2 is the signal that is <num> as long as n2 is non neg , so it will look like thi .
right ?
so we fix them thi wai , thi wai , thi wai , infin .
so thi is un2 and clearli if i multipli these two signal , then what i'll end up with is the unit step , right ?
so , it's go to be non zero onli in the first quadrant .
so , thi is un1 , n2 .
welcom back , in thi segment we will introduc a two dimension complex exponenti signal .
it's the extens of the on dimension complex exponenti .
it is of cours noth els , than a cosin for a real part and the sine for it imaginari part .
complex exponenti ar probabl the most import signal in signal process .
thei go through lsi's system with their frequenc unchang , and thei're the build block of ani signal , as we'll see in week three .
the period properti also is respons in determin what constitut low and high frequenc in the normal frequenc spectrum of a digit signal .
the two dimension cosin also an import signal sinc evalu at variou frequenc it form .
the set of base over transform .
the discret cosin transfer or dct which is wide us in imag and video compress as we will see in detail in week nine and ten .
the basic idea when the dct is us for compress is that it de correl the data .
each of the dct coeffici contain inform that none of the other coeffici contain .
now , some of the coeffici contain a lot of inform .
or as we sai , the imag of the signal is compact in a few coeffici .
while other coeffici contain veri littl inform .
and therefor , thei can be discard or cours quantiz without much loss of inform .
so , let us look at the specif detail of the complex exponenti .
complex exponenti ar veri import signal in digit signal process .
here we see the two dimension complex exponenti at frequenc omega on , omega two .
thei're import for at least two reason .
the first on is that thei're eigen function of linear and spatial invari system .
don't worri about the detail , the fine detail at thi point , we'll talk about it later .
but what thi mean is that if i have an lsi system , that's a system that is both linear and spatial invari , and put at the input , at it input a complex exponenti like thi on , j omega <num> n<num> plu j omega <num> n<num> .
then the same complex exponenti will appear as the output of the system .
so thi complex exponenti simpli go through thi linear and special invari system .
with a possibl chang of the amplitud , that will becom let's sai a , and the possibl addit of a phase .
with phase shift .
and the second import properti is that thi complex exponenti ar the build block of ani signal .
as you'll see later i can write ani signal as a weight sum of thi complex exponenti .
now , anoth form to describ thi complex exponenti is with thi formula attribut to euler .
so into the j omega <num> n <num> , into the j omega <num> n <num> is the polar represent of thi complex signal and thi is equal to cosin of the argument plu j sign of the argument and doe the cartesian represent of the complex function the real part and the margin part .
it should be clear look at either of the polar of the cartesian present that the magnitud of thi complex exponenti , each on of them actual is , equal to <num> .
right from the cartesian is cosin squar plu sine squar and that's equal to <num> .
the first question we want to address here , the first properti we want to examin , examin is the period of thi complex exponenti with respect to the frequenc , omega <num> , omega <num> .
as it's straightforward to see here .
these complex exponenti ar period with respect to frequenc with period 2pi in both direct , 2pi in the omega on direct and 2pi in the omega two direct .
so , if we simpli write e to the j omega <num> plu 2pi , n1 and the j omega <num> plu <num> pi  n<num> , then thi is clearli equal to , i just break it down to thi <num> .
right ?
and if i look at thi gui here , it's a cosin plu sine , cosin 2pi n1 , n1 is an integ .
so , it's a cosin of an integ multipl of 2pi , which is equal to <num> .
and the sine of integ multipl of 2pi is <num> .
therefor , thi is equal to <num> , and so is thi .
and thi is equal to to thi , all right ?
so thi is just the , the proof , if you wish , that inde , the two dimension complex exponenti is period with respect to frequenc , with period 2pi in both the action .
thi same properti , actual everyth i just mention in thi slide with respect to the two dimension complex exponenti hold true for the on dimension complex exponenti or the three dimension , multi dimension in gener complex exponenti .
let us look now at the period of thi two dimension complex exponenti with respect to the spatial coordin , n1 and n2 .
so the question is , is the complex exponenti alwai period with respect to n1 and n2 .
so if it were period , with period , n1 , n2 , then thi equal should hold true .
whenev n1 , if we substitut n1 plu capit n1 , and whenev n2 , if we substitut n2 plu capit n2 , and if it were period , thi should be equal to e to the j omega1 , n1 , e to the j omega2 , n2 .
right ?
so the question other word is , to , can i alwai find the capit n1 , capit n2 , so thi equal hold true .
well let's see .
if we just expand thi , or break it down to it compon .
i have thi for the first exponenti , it's the j omega <num> and <num> time to the j omega <num> n <num> .
and thi is equal to thi .
now thi cancel out with , cancel out with thi , and thi on cancel out with thi .
therefor , what i'm left with is , that thi should hold true .
and from thi i should have that omega <num> , n <num> as an integ multipl of <num> pi  .
and that omega <num> , n<num> should be an integ multipl of pi  with anoth integ here , right ?
so therefor from here , capit n1 is equal to k1 2pi over omega <num> while capit n2 is should be equal to k <num>pi over omega <num> .
clearli n1 is an integ , k1 is an integ , therefor for thi equal to hold true , <num> pi  over omega <num> should be a ration number .
that is the ratio of two integ , p over q .
right ?
and the same should hold true for thi on so thi should also be a ration number p over q , right ?
so thi is what the analysi tell us , right ?
as long as <num>pi over omega <num> and <num> pi  over omega <num> ar ration number , then i can alwai find a n1 and a n2 so that the two dimension complex exponenti is period with respect to n1 , n2 .
right ?
so that's what we should keep in mind .
so just for , and on dimension or let's sai a two dimension thing i have e to the j <num> n1 time e to the j <num> n2 , then here's omega <num> is right from here omega <num> equal <num> .
omega <num> equal <num> and therefor <num> pi  over omega <num> equal <num> pi  over <num> , therefor , which is not a ration number .
and the same is true for 2pi o , over omega <num> .
therefor , thi two dimension complex exponenti is not period with respect to n1 and <num> .
and thi analysi here again , call through for on dimension discret complex exponenti signal .
three dimension , four dimension , multi dimension complex expon in gener .
so , in summari , what we have seen in the last two slide is that unlik the continu time complex exponenti which ar alwai period in the time or spatial domain and not period in the frequenc domain .
the discret time complex exponenti ar period in the frequenc domain and mai or mai not be period in the spatial or time domain as we just saw right here .
to illustr the previou <num> properti of a discret cosin we show here an <num> dimension cosin function cosin omega n for valu , valu of a frequenc omega .
now , omega , in all case , involv pi  therefor , thi cosin is period in the time domain .
time is the horizont axi .
so discret time , m , right ?
so , for exampl , here , for omega equal pi  over <num> , the period is 2pi over omega , which is equal to <num> .
the period here is equal to <num> , equal to <num> , equal to <num> and so on .
so the period keep decreas as you move to the right , therefor the frequenc keep increas .
so for omega equal <num> .
cosin of <num> is equal to <num> .
thi is the signal that doe not have ani other frequenc other than the <num> frequenc , the busi signal where omega equal pi  over <num> we that the frequenc increas .
we see , right from here to here , is on period of the signal .
<num> over <num> keep increas and omega equal pi  thi is the highest possibl frequenc of the discret cosin .
and as a matter of fact cosin pi  m equal to minu <num> to the n .
so the valu of the signal keep altern .
it switch from <num> to minu <num> and back to <num> and so on .
so thi is the highest possibl variat of the signal .
now as the frequenc keep incr , increas from omega plu pi  to <num> pi  , right ?
we see that the frequenc of the variat of the cosin keep decreas .
as a matter of fact thi and thi signal is ident , becaus <num> pi  over <num> , plu pi  over <num> , equal <num> pi  .
so these ar two complementari angl and cosin of pi  over <num> equal cosin of <num> pi  minu pi  over <num> which equal <num> pi  over <num> , right ?
so gener i have cosin a equal cosin of <num> pi  minu a .
all right ?
and similarli , these two ar the same signal and these two ar the same signal .
so the , thi particular discret cosin is period the time domain becaus we chose the frequenc omega carefulli .
and then the other properti that thi discret cosin is period in the frequenc domain with , with it , with frequenc period with period 2pi .
and therefor the rang of frequenc that thi cosin can chang ar from zero to pi  .
zero is the , the lowest frequenc pi  is the highest frequenc , i move to two pi  , keep decreas the frequenc , and then omega equal <num> pi  , cosin of <num> pi  is also equal to <num> .
thi is the constant signal equal the cosin at zero here .
i've complet the full a full period that wai in the frequenc domain .
similarli to the previou slide , we show here the valu of the three dimension cosin , cosin omega<num> and <num> plu omega<num> and <num> , for variou valu of the frequenc omega1 and omega2 .
so we can see that the frequenc's <num> pi  over <num> , pi  over <num> , pi  over <num> and pi  .
and sinc pi  is involv , the result cosin is period in the spatial domain .
instead of show it as a 3d plot , we show thi cosin as a two dimension grai scale imag where white correspond to the valu on , black to the valu minu <num> and grei to the valu <num> .
the axi ar , should have thi orient shown here and each of these block is an eight by eight block .
okai ?
so if we look at thi imag for exampl , then , thi show cosin <num> and <num> plu <num> and <num> , so cosin <num> is <num> , so thi a constant d merg with the valu of <num> .
if we look at the first row here of imag , then thei all have omega on zero , so therefor thei show cosin omega two n two for variou valu of omega two .
if i look , for exampl at thi imag here , then , thi is an imag of cosin pi  over <num> and <num> , right ?
for thi particular round the , the period is <num> pi  over pi  over <num> equal <num> pixel or <num> sampl .
right ?
so if i take on line of thi imag .
and see how it look .
then , we see that there's a valu of on , follow by valu of zero , follow by the valu of minu <num> , follow by the valu of zero .
so thi is on period of the cosin pi  over <num> n <num> .
and sinc thi cosin is independ of the valu of n1 it mean that for all n1s the same valu of thi cosin will be through therefor you see thi vertic stripe right ?
it's the on pixel white so all these valu for exampl here ar equal to <num> .
and if i look also at thi cosin , thi repres cosin pi  n2 , which is , which as we saw , is equal to minu on to the n2 , so thi is the highest cosin in the n2 direct .
i have on and minu on out of and if i final look at thi cosin here , thi is cosin pi  n1 plu pi  n2 .
and you can easili verifi that thi is equal to minu <num> to the n<num> , minu<num> to the n2 .
so clearli the pixel ultim between minu <num> and <num> , and thi is the highest two dimension cosin that uh , we can have .
we ar go to encount these imag later on in the cours go to talk about compress .
welcom back .
system or system theori , we're typic interest in the number of properti that system might have .
for exampl , we ar interest if the system ar stabl .
an import properti , sinc you might sai that in gener unstabl system ar of not much us .
whether thei ar causal , and so on .
all of these ar independ of each other .
on properti doe not requir anoth properti , or doe not lead to anoth properti .
out of all possibl 2d system , we're primarili interest in system that have two import properti .
thei're both linear and spatial invari .
that's form lsi system .
we'll be introduc them in thi segment .
these two properti defin an import subset of all possibl 2d system .
linear mean that the , a sum of signal is that the input of a linear system , the system can process each signal separ , and add up the process signal .
spatial varianc , mean that , it is irrelev where the origin of the coordin system is locat .
as we'll see in the next two segment , we can describ and implement lsi system effici in the spatial domain through convolut .
we can also describ them in the frequenc domain as we'll see in week three .
thei're therefor friendli system .
in that thei reveal their properti to us in a rather straightforward wai , but the same time , extrem us and wide us in a number of applic .
so , let us see how lsi system can be defin mathemat , and also let us look at some simpl exampl .
so far we've talk about signal , two dimension , multi dimension signal in gener , we have exampl of some import signal such as the delta , and the cosin that will be us throughout thi class .
we ar interest in process or manipul such signal through system .
so x in <num> and <num> , is the input imag to start the system .
y is the output , which is equal to a transform version of the input .
a manipul version of the input .
some exampl of such signal y n1 n2 is equal to <num> minu x and <num> and <num> .
assum these imag ar eightbit per pixel .
therefor the rang from <num> to <num> .
what such a system doe is chang the polar of the input is turn black valu into white , and white valu into black .
so a neg into a posit or a posit into a neg .
we go to have anoth system that perform thi transform to the input valu accord to thi function .
and what the system doe is stretch the intens valu of the input imag .
we'll see actual quit a few system of thi natur when i talk about imag enhanc .
similarli , we have a system , that provid an output which is equal to the averag of the input valu in a neighborhood denot here by n .
so thi denot a neighborhood of input valu .
and yet as a final exampl , i can have a system that give me the output , the medium of the input valu again in the neighborhood .
when we talk about system we're interest in a number of their properti , some of which ar mention here .
whether , if the system is stabl , whether it is ha memori , or is memori less , whether it's causal , whether it's linear , and whether it's spatial invari .
all these five here list properti ar independ of each other .
a system can have all of them , none of them , just on or two , and so on .
and out of all these five properti we're go to focu next on system that have the last two properti .
and system , we'll be refer to them as linear and spatial invari system , ar quit us , ar us veri wide .
and it's rel straightforward to describ such system , both in the spatial domain as well as in the frequenc domain .
a two imension system is linear if it satisfi the homogen properti shown here .
in other word , if at the input of the system might put the weight sum of two signal , the weight is alpha on and alpha two .
and if at the output , i find the weight sum of the individu output .
so alpha <num> , the respons of the system to x1 plu alpha <num> , the respons of the system to x<num> , then the system is linear .
thi is clearli a veri us properti , becaus in mani applic , i have to process the sum , weight sum of individu imag .
and it might be easier to process each imag individu and add up the respons , or look at it the revers wai , in some sens , i can take ani signal and decompos it into simpler symbol , simpler imag .
which then i process individu , and again i add up the individu respons .
from thi equat it's clear that if alpha <num> is equal to <num> then the respons of the system to alpha <num> x <num> n <num> and <num> is simpli alpha <num> the respons of the system , x1 .
so if an imag is multipli by scalar , i don't need to be concern , i can process the imag and then multipli the output by the scalar .
similarli , if alpha1 equal minu alpha2 , and x1 equal x2 .
sinc thi properti hold for ani x1 , x2 .
and then you wait .
then , i see that the respons to alpha on x on , minu alpha on x on , which is equal to zero , right ?
so the respons to the zero signal is equal to alpha <num> the respons to x <num> .
minu alpha <num> the respons to x <num> .
which is equal to zero .
so , in other word , we see that the system is linear when i put the zero in the input , i find a zero in the output .
now , thi is a properti that can be share also by non linear system , therefor , therefor it's a properti that i cannot us to prove that the system is linear .
but i can us to prove that the system is non linear .
and thi is a simpl exampl , we can proce there the system , that we look at the previou slide , so us the notat here yn1 is the respons of the system to x x as an input , right ?
and we defin the system as <num> minu x , n1 , n2 , right ?
so , it's like the system take an eight bit imag and invert it , find the neg of it , right ?
.
so clearli if i put a zero as the input of the system , the output equal <num> , hich is differ than zero , and therefor thi system that find the neg of an imag is non linear .
gener speak is rather forward to util thi homogen properti in thi equat that you see here on top , and prove or disprov that the system is linear .
and thi properti and everyth that we cover here , thi light appli to twodimension system and signal as well as on dimension , three dimension , five dimension signal and system in gener .
let us consid again the two dimension system t , x n on and two thei input y , n on and two to the output .
system if when i sift the input by k1 , k2 , i find that the output is shift by the same amount , k1 , k2 , then , the system is spatial invari .
anoth wai to express thi , is that to sai that the system doe not care about the locat of the axi , doe not care where the <num> , <num> point is locat .
thi properti import by itself , but even more import when combin with linear as we're go to see right awai .
now thi properti is independ of linear , so if we consid the system we look at earlier , which for an input x n1 , n2 gener as output <num> minu x n1 , n2 .
so the system find a neg of an eight bit imag .
we saw that thi system is non linear .
now , if i shift the input to the system by x n1 minu k1 .
so , i shift by k1 , k2 .
and i put thi as input to the system .
the output is equal to <num> minu x n1 minu k1 , n2 minu k2 , which is clearli equal to the shift output .
therefor , the system is spatial invari , si .
so , the system take the neg of an imag is no linear , but is spatial spatial invari .
as anoth exampl , if i look at thi , thi system that multipli the input by a time vari gain , so thi .
c is a gain , but chang accord to the locat of the pixel n1 and n2 .
it is rather straightforward for you to verifi that .
so the system is linear , but is not spatial invari or it is spacial vari .
that's anoth wai to express it .
again , thi particular properti fault through everyth we talk about here for , call to for on dimension , three dimension , multi dimension in gener system and signal .
let us look now at system that ar both linear and spatial invari lsi system .
such system ar us wide , and we have develop veri us and conveni tool to describ and analyz them .
now , such system can be complet describ by a signal that we'll , we'll be refer to as the impuls respons of the system .
as the name impli , if i put a delta at the input of sight system and measur the output which i'll denot by h , and oneand two .
thi is again the respons of the system to an impuls , and we will refer to it as the impuls respons of the lsi system .
thi is not just a mathemat construct , but in mani case , i can util the system , such as a camera and point the camera to a printout that is , a black background and a white spot in the middl .
or i can point the telescop that is orbit outsid the atmospher , such as the hubbl space telescop , to a distant star in the dark sky measur that is forc and that's the impuls respons of the system .
know the impuls respons now again i can complet describ the system which mean for ani input x n1 , n2 .
i can find the output of the system , and thi is equal to the convolut of the input , with the impuls respons of the system .
so thi doubl star here denot the two dimension discret convolut .
so linear system or filter , as we often refer to , ar perform convolut , discret convolut .
the convolut of x with h , as we will show , is equal to thi super posit sum .
k1 minu infin , infin , k2 minu infin , infin , x k1 , k2 , h , n1 minu k1 , n2 minu k2 .
i'll show some exampl of perform convolut in the follow slide .
it's easi to verifi by substitut variabl that the convolut he's the communit properti so in other word convolut of x with a equal convolut of a with x .
welcom back .
now that we've learn that two dimension lsi system , in produc the process imag , thei perform the convolut of the input of the system with the impuls part of the system and anoth through the signal .
we can start get our feet wet by plai around , in some sens , with variou lsi imag process system for which you know the impuls respons .
so for exampl , if the impuls respons that went through the system is flat , over , sai , a <num> x <num> region , and flat mean that it sampl in the impuls respons give the same valu .
so for the <num> x <num> exampl , each sampl ha valu equal to on over nine .
so , in thi case , what will the effect of such a system on an imag go to be ?
you can write a simpl program or a few line to perform the convolut of the two imag and we can util ani imag you have avail .
so , we can find out what thi effect is go to be .
we will see that the high frequenc content of the imag is reduc .
the imag will look blurri .
the system with thi <num> x <num> flat impuls respons is a low pass system , or a low pass filter .
we will also see exampl of system which would us the low frequenc format in an imag and allow the high frequenc to go through the system unchang .
in thi case , the edg in the imag at the output of the system ar pronounc .
such system ar refer to as high pass system or high pass filter .
we will show such exampl earli on in the cours so that you obtain a good feel about the manipul or filter of imag .
we jump the gun , in some sens , in thi segment by provid imag nois smooth exampl and the extract of edg in an imag , which is a topic that we'll cover in week five .
and thi is the topic of imag enhanc .
we actual also show an exampl of filter impuls nois or more specif , the so call salt and pepper nois both with an lsi and a non linear filter , for demonstr that lsi filter ar not appropri for remov such type of nois while the non linear filter or the medium filter specif inde is .
so , it's alwai fun look at the imag , and let's proce with the materi of thi segment .
as we show , in process an imag with a linear and shift variant system or in filter the imag we typic refer to , we're perform the convolut of the imag with the impuls respons of the system .
in do so , we need to have inform about the imag outsid it border or boundari , which is typic inform we don't have , sinc in most case , the imag is a window version of a larger scene , sinc we have a limit view of the larger scene through the camera len or the sensor in gener .
so , let's look at thi specif exampl .
you see here on the left a synthet imag .
it ha <num> x <num> pixel .
it is a binari imag and therefor each of the squar is <num> pixel wider and and tall .
we convolv thi imag with a <num> x <num> symmetr flat filter .
so the impuls respons of the filter is center at <num> , <num> .
the height of each sampl of the impuls respons is <num> over <num> so that if i sum all the sampl , the sum is equal to <num> .
clearli in find a filter valu of the imag , let's sai , at thi locat of the boundari , i bring the flip around impuls respons for the system at thi locat , right ?
and it's clear that i need here a band with seven , seven column for thi particular filter of pixel valu that i do not have , that do not belong to the imag .
so , for thi particular exampl , i need to know a band of width <num> around the imag .
these boundari valu .
we also see down here , a line that goe through , around here the imag .
so , you see the black valu <num> , white valu is <num> , and so on .
i have variou wai to gener thi boundari inform .
the first wai is zero pad , which mean simpli that i assum alreadi acquir boundari valu ar equal to zero .
with the symmetr method , the size of the imag is extend by mirror deflect it around it border , and with the circular method , the imag is period extend .
if i look at all the result here and the on dimension line , it's the line in the same locat through all the imag , shown down here , it's clear that awai from the border , the result is ident in all case .
thi is actual how the , thi puls here is , is shown , look like after thei perform the convolut with thi particular symmetr filter .
so it becom narrow up here and then these sharp edg becom smooth or becom broader here , right ?
howev , in all these four case it's clear that the result imag differ depend on how these boundari were gener .
it should be clear that there is no method of choic here .
there's no kind of clear winner tell us which wai the boundari should be gener .
we show here an exampl of a color imag on the left be process by a system with impuls respons shown down here .
it's a symmetr impuls respons , which mean that thi is the h <num> , <num> valu of the impuls respons .
it is call the low pass filter becaus it allow the low spatial frequenc of the imag to go through it while reject the high frequenc , then thi concept will becom clearer later in the , in the cours .
but thi manifest itself by look for exampl , at thi part of the origin imag , you see the fine branch there in it , while it's harder to do in the low pass filter or blur imag .
for thi <num> x <num> filter , i need the boundari of width on around the imag to process it and to us the symmetr method that we mention earlier .
final thi is a color imag and in process it we process each of the three channel , the rgb channel separ with the impuls respons of the filter shown below .
thi is the same type of experi as the previou on .
you see origin imag on the left and the filter on is shown on the right .
the impuls respons of the filter is differ now .
it's flat , it ha a bold <num> x <num> , and all the valu ar the same , <num> over <num> .
we see that with thi filter , the blur effect is more sever .
in other word more , higher frequenc ar reject or attenu as compar to the previou case .
we show now the result of process the same imag with a filter with the impuls respons shown down here .
it's a symmetr filter .
so thi is the h <num> , <num> valu of the impuls respons .
and thi now is a high pass filter , which mean that the low frequenc ar attenu or reject , while the high spatial frequenc ar allow to go through the filter .
and high spatial frequenc manifest themselv in region of the imag where we see larg variat in intens valu , and these ar the edg of the imag .
so thi type of filter perform edg detect for the given imag .
on of the us of low pass filter is to remov nois that might have been ad , might be present in an imag .
so , on the left you see the same imag we've been work with , to which nois ha been ad , iid gaussian nois with peak signal to nois ratio around <num> db .
so , thi imag is process with the same figur that we us befor .
thi is the h <num> , <num> valu of the impuls respons .
and on the right you see the process imag .
some of the nois ha been remov , as hopefulli somebodi can see by look at thi imag , while at the same time the price on pai is that the imag is now blur as compar to the origin on .
we'll talk about nois reduct and other enhanc techniqu later in the cours .
here's anoth exampl of nois filter .
you see on the left the imag we've been work with , to which nois ha been ad .
but thi time , time the nois is not thi gaussian broadband nois but instead is a type of nois we're refer to as salt and pepper , sinc it resembl throw salt and pepper on the imag .
it's actual color salt and pepper becaus the salt and pepper type of nois is ad on the three channel separ and give thi color appear .
so , if we appli again the filter shown here to thi imag as impuls respons of the filter we've us multipl time befor .
you see the process imag on the right .
so in thi particular case the filter is , doe not do such a great job becaus it doesn't realli remov the nois , but instead it correl it .
for thi type of salt and pepper nois anoth filter refer to as median filter , it's a non linear filter , is do a consider better job than the low pass filter we us befor .
so on the left you see the same imag that i show in the previou slide .
and on the right the result of process the imag on the left with a <num> x <num> median filter .
clearli in thi case the salt and pepper nois is greatli remov and thi is a consider improv qualiti imag .
we'll cover all these thing in much more detail when we talk about imag enhanc .
so , we reach the end of week two .
dure thi week we learn some fundament concept for 2d signal and system in the 2d spatial domain , a crash cours in 2d system theori , you might sai .
the concept we've discuss in 2d ar reduc to on dimens or extend to multi dimension signal and system in a rather straightforward wai .
so we learn , for exampl , what is a linear and spatial invari system ?
we also learn that complex exponenti , sine and cosin go through such system without chang their frequenc .
we will actual see next week that thi complex exponenti ar the build block of ani signal .
we also learn that 2d lsi system can be uniqu character by a two dimension signal which is call the impuls respons of the system , and it is inde the respons of the system to an impuls .
thi quantiti can typic be measur .
you can take a photograph with your camera of a page which is black everywher and onli ha a white spot in the middl .
the signal , the impuls respons is all we need to fulli describ the system , a veri power signal and a veri compact descript of the lsi system .
with the knowledg of the impuls respons of the system , we can then find the output of the system for ani input , by simpli convolv the input imag with the input respons of the system .
what we have cover so far is extend to dimens larger than two .
so thi is a , in a sens , a mini introduct to multi dimension digit signal process .
i expect that you'll feel veri content now when you pick up a book or an articl on imag process , and feel veri comfort with it content .
what we will do next week is to take what we've learn thi week to the frequenc domain .
it is worth it becaus if noth els , in find out the output of an lsi system , instead of convolv two signal , we can instead multipli their spectra , a much simpler oper .
so , i'll see you next week in the frequenc domain .
welcom back .
i hope you enjoi the first two week of class .
as i mention at the begin of last week , in these two week , week two and three , we'll cover the fundament of two dimension signal system .
last week , we get thi analysi in the spatial domain .
while thi week we move to the frequenc domain .
we us two dimension sequenc system in our present .
howev , all the inform we provid is also applic to on dimension signal .
but those at the higher dimension signal that is multidimension signal in gener .
thank to joseph fourier , who live in the late 18th , earli 19th centuri , we can describ ani signal of ani dimension , and the oper of ani linear and spatial invari system in the frequenc domain .
the frequenc domain is mostli familiar to us when we refer to on dimension signal .
for exampl , we can distinguish between a bariton and the soprano or between low and high frequenc in a music piec .
imag have similarli low and high frequenc , which you cannot hear , of cours , but we can see .
thei're spacial frequenc .
we'll get familiar with the concept first and then we will take the materi and the oper of system we learn last week to the frequenc domain .
we'll also understand what is involv when we convert the continu signal to discret signal .
what we call in week on sampl .
and also when we chang the size of an imag when for exampl we want to displai a larg imag on a small screen , of our cell phone .
or a thumbnail imag on a larg screen .
and thi is call sampl grade convers .
equip with thi materi you can understand what will follow in thi class .
but also when you ar interest in learn new materi outsid thi class .
as for exampl , what's the process of acquir an mri imag ?
or an x rai imag of a slice of a patient's bodi us computer tomographi .
it's in fact to a ct or ct scan , a term you might have heard befor .
in thi first segment we'll defin the two dimension continu fourier transform of a two dimension discret signal .
and we will discuss some of it import properti .
we will then work out a number of exampl which will give us a good understand of what constitut a low pass and what constitut a high pass filter .
we'll final talk about the import convolut theorem which state that the convolut oper in the special domain becom a multipl oper in the frequenc domain .
so , let us start cover thi import materi .
let us go see the linear especi in varianc system with impuls respons h , n1 and <num> .
we put in signal x as it's input and signal's a complex exponenti with specif frequenc omega <num> prime , omega <num> prime .
thi is a two dimension q tone , sinc it onli contain again thi particular frequenc , omega <num> prime , omega <num> prime .
we want to find out what the output of the lsi system for thi particular input is equal to .
i did mention at some earlier point in the cours that these complex exponenti ar eigenfunct of lsi system .
which simpli mean that such complex exponenti go through the system without their frequenc be alter .
of cours by now we know how to find the output of an lsi system .
it y n <num> and <num> is equal to the convolut of the input to the system with the system's input respons .
if i appli directli the definit of the convolut thi is equal to thi doubl sum .
again .
i just appli the diffus of the revolut .
now we see that these term .
ar independ of k1 k2 .
therefor thei can come outsid the summat , and all i'm left with these ar these term here .
so we see that the complex exponenti appear at the output of the system .
thei just went through the system .
and thi term here tell me how the system respond to thi particular complex exponenti of thi come , at thi specif frequenc .
thi here is a complex quantiti .
it ha a phase .
and we see that the lsi system is abl to discrimin among sinusoid system on the basi of their frequenc .
so if the magnitud of thi term here is equal to on , then the sign , goe through the system unchang , while on the other hand , if the monei is equal to zero , the complex is reject by the system , so therefor thi is the , of the lsi system .
with h , n <num> and <num> at these frequenc omega <num> prime , omega <num> prime ar denot by capit h , omega <num> prime , omega <num> prime and thi is the frequenc that respond to the system .
now sinc thi resolv is not go to chang , if i consid addit frequenc , let's sai omega on doubl prime , omega <num> doubl prime , we have that thi is again the respons of the system frequenc and thi capit h , omega <num> and omega <num> is the fulli transform of the impuls respons of the system h and <num> and <num> were go to sai caus there will be more thing about the fourier transfer in the next slide .
we show here the two dimens of fourier transform pair .
thi is here the express for the forward transform that will take an imag from the special domain and map it to the frequenc domain where omega <num> , omega <num> continu of variabl .
so x omega <num> , omega <num> is the two dimension fourier transform or the spectrum of the imag x n1 and <num> .
thi is the express of the invers fourier transform that will take us from the frequenc domain back to the spatial domain .
we see with the express on top that even when the imag is real as it's usual the case .
the fourier transform is complex due to the presenc of thi complex exponenti .
therefor , it i can show the magnitud and the phase of the fourier transform .
and thi repres the polar represent of a complex number .
or equival i can show the real .
and the margin part .
i see here in the express for fourier transform between the grade for minu pi  to pi  in the omega <num> and minu pi  to pi  in the omega <num> direct .
and thi is due to the first properti of the fourier transform that it is period with period <num> pi  , <num> pi  , in the omega <num> , omega <num> direct .
thi is a straightforward express to show , in essenc , we show it when we start the complex exponenti , we saw that thei're period with period <num> pi  , <num> pi  , and thi is what give rise to thi properti .
anoth us properti is to consid what happen , when i shift the imag by amount m <num> , m <num> in the special domain .
and what happen in the frequenc domain is i get the spectrum of the signal , but it's multipli by thi complex exponenti .
so sinc the magnitud of the complex exponenti is on , the magnitud of the shift imag ha not chang but i have thi linear face compon that , is due to the spatial shift .
the reciproc of thi properti is the modul properti that , tell me what happen if i shift the spectrum by <num> , <num> .
so similarli , i see that i have thi complex exponenti appear in the special domain .
anoth us for properti is thi which is typic the properti which tell us that when the signal is real , then the magnitud of the fourier transfer ha even symmetri .
while the phase of the fourier transform ha odd symmetri .
and final thi is the parsev's relat theorem which tell me that the energi of the signal , which is found accord to thi express in the spacial domain can also be found in the frequenc domain by integr over on period to pi  , to pi  thi energi densiti spectrum .
there ar clearli addit properti , quit a few of them , that on can find in a standard imag process textbook , but these ar some of the more us on .
let us consid a simpl exampl .
we ar given a system with an impuls respons depict here .
and we want to find the frequenc respons of thi system .
so , we appli the definit of the fourier transform and the frequenc respons is equal to thi doubl summat h n1 , n2 , e to the minu j omega1 n1 , e to the minu j omega2 n2 .
now for the given impuls respons , you see that we have onli five sampl .
so we have the .
h minu <num> <num> sampl .
h <num> <num> , h <num> <num> , h <num> minu <num> and h <num> <num> .
so out of thi infinit sum , i onli have these five term .
so h <num> <num> , multipli by e to the minu j zero which is on plu h minu on zero multipli by thi term and now i substitut the , i substitut the given valu of h .
so thi is on third and all the rest ar on sixth .
so equal to <num> 3rd .
now we will observ here that due to euler's formula , e to the plu j omega on , plu e to the minu j omega <num> will give me two time cosin omega , and similarli , the other two term will give me two time cosin omega <num> , and thei can further simplifi thi as .
<num> <num> , <num> plu cosin omega <num> , plu cosin omega <num> .
so we see that , for thi particular exampl , the frequenc respons of the system is 3l .
thi should come as no surpris , sinc on of the proposit of the fourier transform is that if the signal ha even symmetri then the fullier transfer is real .
thi mean that the magnitud is the absolut valu of the stem , and therefor the phase is zero at both frequenc except when the stem here becom neg , in which case i have a plu or minu pi  phase jump , henc minu on ha absolut valu on and phase plu minu five .
so let see how thi frequenc respons look like .
so i brought there the magnitud on the vertic axi and thei show it over period the mega <num> for minu pi  to pi  and the mega to for minu pi  to pi  .
thi actual magnitud ha even symmetri , which is also , should come as no surpris , becaus we saw in the previou slide that on of the properti of the fourier transform is that if the signal is real , then the magnitud ha even symmetri , and the phase odd symmetri .
so if i look at thi magnitud , i see that h zero , zero is equal to on , right .
cosign zero is on so you have three over three .
and also you observ that at certain frequenc the magnitud becom exactli zero .
so for exampl if i look at the frequenc , mine wa pie .
pi  over <num> .
i have <num> plu cosin minu pi  , which is minu <num> , so thei cancel out , <num> .
plu cosin of pi  over <num> , which is <num> .
and therefor thi is <num> .
thi is actual the frequenc over here , right ?
so by and larg , thi is a low pass filter .
is pass the <num> , <num> frequenc unchang .
attenu slightli the low frequenc , but as the frequenc increas , the continu becom , greater .
we show here , and exampl similar to the previou on , where given the impuls respons of a system , and well distribut to find it frequenc respons .
the form that h n <num> and <num> is the depict slightli differ from the previou case and shown here as a <num> by <num> matrix .
it should be understood that thi is the h <num> <num> sampl .
thi on , the h <num> <num> , while let's sai , thi on is is the h minu <num> , <num> , and so forth .
thi actual approxim a gaussian shape function in thi three by three window .
after a point , when you look at thi impuls respons which is again , is symmetr , ha even symmetri .
on should be abl to identifi term in the frequenc respons , so for exampl , thi and thi term , should give rise in the frequenc respons of a <num> time cosin omega <num> time the coeffici while the diagon term thi term and thi term should give rise to a term like thi in the frequenc respons .
<num> time cosin omega <num> plu omega <num> .
so if you work out the exampl you should find out that thi is the frequenc respons of thi system as shown here .
it's again , a real signal which should come as no surpris becaus hn1 and <num> share even symmetri .
if we plot the magnitud of the stem it look like thi .
here a plot of the vertic axi that <num> time log base <num> of the magnitud , so on can see more clearli small valu of the magnitud of the frequenc respons .
again , if i look at h <num> , <num> thi is the sum of the valu of the impuls respons and thei sum up to <num> .
and therefor , the logarithm of thi valu is equal to zero .
so thi term here , that's the zero , zero , it's equal to zero .
we'll see again that thi is a low pass filter .
it , attenu slightli the low frequenc and consider the higher frequenc .
and of cours the zero zero frequenc goe through the system unchang of , of the input signal .
here's a final exampl .
we're given a system with impuls depict here and , we're go to find it frequenc respond .
the comment i made earlier appli here as well .
so thi is the eight zero zero sampl .
we see actual that thi simpl respons differ in some sens from the previou on in the sens that i take differ now between the center sampl here nine in the neighbor sampl .
so we should expect that the shape of the frequenc respons should be differ .
so follow exactli the same step that we follow in the previou two exampl on can find that the frequenc respons of thi filter of thi to the system is shown here .
it real again becaus h n1 , n2 ha even symmetri if i plot thi .
so i plot here the magnitud in the vertic dimens and i plot again the <num> log <num> magnitud so that i am abl to see smaller differ .
anylsi .
we see that now the shape is differ in the sens that the low frequenc ar attenu while the high frequenc ar amplifi .
we can easili that the h <num> <num> is equal to <num> , and therefor the log of thi is equal to zero .
while if i look at , some frequenc .
for exampl , the h <num> pi  frequenc , which is the frequenc over here .
thi is equal to <num> , while the h pi  pi  is equal to nine .
so , consider higher valu than <num> at high frequenc and small valu at zero .
again low frequenc ar attenu , high frequenc ar amplifi high special frequenc and ar repres by the edg .
therefor the edg ar allow to go through the system while the flat region ar reject or greatli attenu .
and therefor , a filter like thi perform edg detect on an imag .
on of the import properti of the fourier transform is the convolut properti , or , as also refer to , the convolut theorem .
it describ the input output relationship of an lsi system in the frequenc domain .
so given a system with impuls point h , and x in , the input , y , the output , we know that , the input output relationship in the spatial domain ar through the to the convolut .
so , the output equal the convolut of the input with impuls respons of the system .
clearli , i can take each of these quantiti through the frequenc domain .
so i can find the spectrum of the signal .
i can find the fulli transform of the impuls respons , which is the frequenc respons of the system .
and i can find the fulli transform of the output signal .
sinc the signal ar clearli relat in the spatial domain on expect that thei should be relat in the frequenc domain .
and what the convolut theorem tell us is that inde the spectrum of the output signal equal the spectrum of the input signal time multipli by the frequenc respons of the system .
so convolut in the spatial domain becom multipl .
the frequenc domain , and actual the revers is also true .
multipl , the time domain , becom convolut in the domain .
of cours , here , we have to talk about period convolut sinc the signal ar period .
so , let's see that inde , thi is the case .
so , if i , deriv the output of the system , as the system t , let me call the system t oper on the input signal x n1 , n2 , and then i'll replac the signal by it invers fourier transform .
so thi is equal to thi doubl integr of x omega <num> omega <num> e to the j omega <num> n <num> and to the the j omega <num> n <num> d omega <num> d omega <num> .
actual , the invers fourier transform tell me that you can think of ani signal x , n1 , n2 as the weight sum of thi complex exponenti where the weight ar inde the valu of the fourier transform .
now sinc the system is , is linear , and assum all the signal here ar well defin , i can interchang the order of integr and , the oper of the system , and the system oper on signal that ar function of n1 and <num> , therefor thei're fulli transfer the weight as i call them .
constant , as constant as far as the system is concern .
so , i am left with thi express .
now , we have start the , express , thi express we know that thi complex exponenti ar eigen function of lsi system .
so thei go through the system unchang and thei're multipli by the frequenc respons of the system , so therefor , thi express .
becom equal to thi on , so if the frequenc respons of the system time the complex exponenti .
so now thi is the express for the invers for the transfer of y , and therefor thi signal here is the fulli transfer of y , so thi is y omega <num> , omega <num> .
so , inde , we show that y omega <num> , omega <num> equal x , omega <num> , omega <num> time the frequenc .
and so thi is .
we ar root to thi oper when we talk about the exampl .
so therefor all thi tell me that look at the frequenc respons of the system , i have to just process each frequenc on at a time , right ?
so if h here is <num> at certain frequenc then the output y is go to be <num> .
therefor those frequenc of the input signal would not go through the system .
welcom back .
have introduc the two dimension continu fulli transform of a discret two dimenst signal in the previou segment , we can now describ and understand the oper of someth .
that is , the oper of turn a continu signal into a discret on .
as we've discuss dure the first week of class , sampl is need in be abl to bring a continu signal into the discret world , so that it is process by a comput .
in most case thei're also interest in bring the discret signal back to the continu world .
so that we can see it , or so that we're abl to hear it .
the fundament question , therefor , when sampl is perform , is under what condit can we move back and forth between the continu and discret world , without loss of inform .
or , under what condit we can reconstruct the continu signal from it sampl .
we deriv these condit which ar refer to as the nyquist theorem .
a signal can be reconstruct from it sampl if it is sampl with frequenc at least twice as larg as the highest frequenc of the signal in each dimens .
we deriv the theorem in two d .
howev , it's straightforward extens of the on d subject theorem .
and it can also be extend in similar wai to dimens higher than two .
actual , in two and higher dimens , there is more freedom in preform period sampl .
we'll onli cover here rectangular period sampl , but on could us , for exampl , hexagon period sampl in two d .
sampl provid the intuit in understand what happen when we sampl now the continu fourier domain .
it lead to the definit of the discret fourier seri .
and also the definit of the discret fourier transform , which is the topic of the next segment .
so let us now have a closer look at thi excit materi .
on of the import concept in digit signal process is the concept of sampl .
it connect the analog to the discret world .
it's true that with the prolifer of digit sensor , there is less of a need for convert an analog imag to a digit on .
but , the mathemat concept of someth that import , for understand other topic in imag and video process .
thei're import , for exampl , in allow us to understand the step we need to take in chang the sampl grade in the digit domain .
for exampl , when we up sampl or down sampl an imag , as you'll see later .
so assum that we have an analog imag like the on shown here , such an imag can appear for exampl on a posit photograph field .
i realiz of cours that for the younger peopl in the class you mai or mai not be familiar with neg or posit field , it is howev worthwhil continu with thi topic .
again i present the signal in the frequenc domain , and here is the spectrum of the analog signal x sub' a' omega on , omega two .
what we show here is realli the region of support of thi spectrum and not that shape of thi spectrum itself , but it's not relev the shape for the discuss that follow .
i want now to repres thi imag by discret sampl so , i super impos a grid that's shown here , and onli keep the valu of the imag at the grid point .
so the digit imag i end up with is the on shown here .
and there ar two paramet of control .
thi grid , the space in thi direct t on .
and the space of the vertic direct , t two .
and these ar refer to as a sampl period .
i can now repres thi descret signal in the frequenc domain .
i can take the fulli transfer of thi signal as we've done alreadi in thi class , and if i find thi spectrum , it look like thi .
it's not surpris thi period becaus we do know the spectrum of a discret signal is period a properti that we cover in quit some detail .
and it is form realli by perform the period extens of the spectrum of the analog signal , again as shown here .
the mathemat express to describ thi , is the on shown here .
you ar us to put , so far we've been us thi notat omega on , littl omega on , omega two .
denot the fourier transform of a discreet signal , and thi is exactli call thi is sinc omega on is the normal frequenc and equal big omega <num> time t <num> .
so omega on is in gradient , while bigger omega on is in gradient per unit distanc .
spatial distanc , let's sai , millimet , as an exampl .
and t <num> is also in millimet , so the unit , the dimens realli match .
and of cours , omega two is given by similar express .
so what thi express tell me again is that thei take the spectrum of the analog signal , and i period extend it .
so k on rang from minu infin to infin .
so doe k two .
and the period extens in the horizont direct is with respect to two pie over t on .
on , the vertic direct with respect to two pi  divid by t2 .
so thi point here is two pi  divid by t1 , while thi point is two pi  divid by t2 .
so , we see that in perform someth , there ar two import paramet the sampl period , t1 , t2 .
thei control the space of the point in the spatial domain , and thei also control how far apart the replica of the the analog spectrum in thi period extens , ar go to be locat .
we sai that the analog imag is critic exampl , if i us the appropri t1 , t2 here , sampl period .
so that when i find now the fulli transform of a discret signal , which is form by the period extens of the spectrum of the analog signal , the spectra here just touch , next to each other without overlap .
and in thi case , at least mathemat speak , i can filter the base bond of the spectrum of the discret signal , and then thi will give me back the spectrum of the analog signal , therefor , i will be abl to go from the discret weld , but the continu weld without lose ani inform .
if i us a smaller t on , t two sampl period than in the previou case , then when i look at the spectrum of the discret signal , is go to look like thi .
and , in thi case i've us more sampl i need to repres accur the continu imag .
i therefor , i have oversampl .
if i go the other direct , and us sampl period here t1 , t2 , which ar greater than the period us for critic sampl then if i look at the spectrum of the discret imag , it look like thi , while my new period extens , on replica overlap with anoth replica , and thi phenomenon is refer to as alias .
which mean that the high frequenc here alia themselv as low frequenc the us of fals ident .
under thi case , it's not possibl to recov the origin signal .
i am not abl to untangl the low and high frequenc that can be , mix up .
in perform sampl , an import question is what should the sampl period t1 and t2 be quell to .
so that , i'm abl to go back from the discret sampl to the analog imag .
intuit , on should expect that how close togeth the sampl ar should be a function of the spatial frequenc in an imag .
if the imag intens vari a lot and rapidli , which mean that there's a lot of high frequenc energi then , intuit , on should us sampl that ar close togeth , so that all of these first variat of intens have captur the properti .
if on the other hand , thei have anoth flat imag , then a few sampl will suffic , and thi is exactli what the nyquist theorem tell us .
so here is again the support of the spectrum of the analog imag , and let call omega n1 the highest frequenc in the horizont direct and omega n2 the highest frequenc in the vertic direct .
after i sampl thi imag , the spectrum of the discret imag is desir but it look like thi .
so in other word , there is no alias .
so thi point is two pi  over t1 and therefor the point in here is two pi  t1 minu omega and on .
so clearli , as long as the order of these two point is as shown here .
so , as long as two pi  over t1 minu omega n1 is greater or equal than omega and on , there's no alias in the horizont direct .
and thi give us the condit that the someth frequenc should be at least twice as high as the highest frequenc in the imag .
and thei can obtain the similar condit in the vertic direct , so the someth frequenc in the vertic direct should be greater equal then omega and two .
so if these two condit ar satisfi , then i can recov the analog imag from the discret on by us a low pass filter , as shown here .
so , thi low pass filter , let's sai , f omega <num> omega <num> should be equal to t <num> t <num> as long as omega <num> is less than pi  over t <num> and omega <num> less than pi  over t <num> , and <num> otherwis .
thi t <num> t <num> gain is here becaus if you look back , a few slide back , at the relationship between the spectrum of the discret signal and the analog signal , there's <num> over t<num> t2 factor there .
so i need thi gain to bring back the signal it's origin valu .
so thi frequenc , thi is for exampl , minu pi  over t1 , thi is pi  over t2 , so thi is the filter that is shown exactli here .
so in summari what the nyquist theorem is tell me is that if i have an unlimit analog signal i can sampl it with frequenc that satisfi these condit .
and then i can recov the analog signal from the discret on us a filter like thi on the frequenc domain .
and what thi mean in the spatial domain is that i perform bundl with the interpol with a candl , which is the fourier transform of thi ideal low pass filter , and thi is a two dimension sync function .
a sine x over x function .
in illustr the concept of sampl , oversampl , undersampl let us consid a simpl on dimension signal , the cosin depict here .
it ha frequenc equal to <num> hertz , or in omega unit , <num> pi  f <num> . <num> radium per second .
so , in a ten second interv shown here , there ar nine cycl of thi particular cosin .
if i take the on dimension fulli transfer of the signal now .
i see that it spectrum look like thi , it consist of two impuls at <num> pi  minu <num> pi  .
and clearli , thi tell me that there's onli on frequenc present in the signal , it's therefor a pure tone .
now the nyquist frequenc , for the signal , it's either <num> hertz or <num> pi  time <num> radian per second .
so , here , with the grid exampl , we show the sampl version of thi cosin when we grade the over sampl .
if you recal from the previou slide , the omega nyquist , with a note like thi , wa , <num> , time two pi  , radiu per second so , <num> , by rad per second , so instead of us the nyquist , i us a <num> pi  rad a second or the sampl period is run a 30th of a second , so therefor i get <num> sampl per second .
there ar ten second in thi interv , so there ar <num> sampl shown here .
so , if i look at the spectrum of the signal , then as we know , we take the spectrum of the other analog signal , these two impuls , and period extend it with period <num> .
so here on replica here at <num> pi  and other minu <num> pi  and so on and so forth .
and in thi case , i can go back and forth between the continu and discret world by just us a low bu filter pull out these two impuls .
and , in the time domain , i'm go to get continu cosin signal that i start with .
i sampl now my analog cosin i'm work with with period on second or frequenc on halv .
or , an omega with <num> pi  radian per second , we call that the nyquist , where the signal omega band is <num> pi  radian per second . so with thi sampl period in thi interv of ten second , i have <num> actual sampl , sinc i also sampl at equal <num> .
let's see how thi sampl signal look in the frequenc domain .
here is the spectrum of the analog signal , and i know that the sampl signal is a spectrum which is a period extens of the spectrum with period <num> pi  .
so here's on , the first replica of the spectrum , a second replica , and so on and so forth .
so clearli , the sky frequenc compon in the origin signal alia as itself , as a low frequenc compon .
so , when i reconstruct thi alias signal us the low pa signal shown here .
i end up reconstruct the signal shown here on the left with frequenc <num> hertz or <num> cycl in thi <num> second interv , i'm start .
you can , look at thi signal also , the on that result from the first sampl signal , where i had over sampl , i had <num> sampl there , in thi interv , and if i down sampl by a factor of <num> , so , i throw awai <num> sampl , i keep on , throw awai <num> .
and so on , then , thi is the signal that , we'll end up .
so we can either think of thi signal here as result from the down sampl of the origin analog sampl or down sampl the sampl , the digit sampl , right , so with the down sampl in the discret domain .
we would like now to pictori connect what we've learn so far and what , is go to follow .
i will not be show ani equat .
sinc thei can be found in ani book on imag process of multidimension signal process .
i think it's import to see what the situat is behind the variou concept underlin the special frequenc domain , and just focu on the element that ar of primari import in imag process .
so we start with analog imag , such like the on shown here .
which we repres also in the frequenc domain .
so , here see the continu spectrum of the continu imag in the omega on and omega two , axi and of cours we show here , just the unit's apart of the spectrum .
so then we sampl thi imag .
disagre and we kept the valu at the grid point .
and we also can repres as we know by now , thi discret imag in the frequenc domain .
we know by now that the fulli transfer of the discret signal is period and is form by the period extens of the spectrum of the analog imag .
i can present the spectrum in the bigger omega on , omega two domain , the continu frequenc , or the normal frequenc , littl omega on , omega two .
in go back and forth between the continu and discret world , i need to know the sampl period , or the sampl frequenc .
if howev , all we ar given is a discret imag , or a two dimension arrai of number , we don't know what is the spatial distanc between these number .
between the big cell , and therefor , i can onli express the spatial frequenc content in term of the normal continu frequenc in the domain .
and thi is materi we have cover so far in the previou slide .
now an interest question that aris is what will happen in the special domain if i sampl the fournier transfer of the split imag .
we saw befor that sampl in the spatial domain result in period extens of the spectrum in the figur domain .
so our intuit tell us that the similar oper should take place now in the special domain now that there's someth in the frequenc domain .
in other word the imag should be period extend .
and thi is exactli what happen as we can show mathemat .
so we can see the period discret spectrum correspond to a period discreet two dimension signal .
of cours , the densiti of sampl in the frequenc domain will determin the period in the period extens in the special domain .
if i under sampl in the frequenc domain , alias will take place in the spatial domain .
so we see that a discreet period signal ha a discreet period represent in the frequenc domain .
and thi is , inde the fourier seri .
go from here to here is the fourier seri represent .
the discret spectrum is often refer to as a line spectrum .
now on period in the frequenc domain correspond to on period in the spatial domain .
and in show thi here , i have chosen the sampl in the frequenc domain to be done critic , so i have the same number of sampl in on period in both the spatial and frequenc domain .
so , we see here that , and then on , let's sai , by m <num> , period imag correspond when on and two sampl in the frequenc domain , and thi map here is that discret fullier transfer map that we will studi next in quit some detail .
so we see that if i have an n1 by n2 imag , i can repres it uniqu by an n1 by n2 sampl of the frequenc domain of the spectrum of thi imag .
so it's import to keep in mind that behind the dft , there ar discret period two dimension signal in both the spatial and frequenc domain sinc the number of the properti of the d . f . t .
can be deriv and understood , by consid these , period extens .
welcom back .
the main drawback of the continu fourier transform with the discret signal is that thi is not a comput transform .
unless the imag ha a close form express , it fourier transform cannot be comput .
base on the materi of the previou segment , we'll go show in the segment that a sampl version of on period of the continu fourier transfer is all that is need to repres the discret imag .
thi repres the discret fourier transform , or dft , which map m by m sampl of an imag in the spatial domain , into m by m sampl in the discret frequenc domain .
in addit , what make the dft such a us tool is that there ar fast wai to comput it , collect refer as fast fourier transform or fft .
we will look at some exampl of spectra of imag in thi segment us fft .
so , let us proce with thi interest and us materi .
let us in more detail some of the part we cover in the previou slide .
here , again , is the definit of the continu fourier transform of a discret time signal x n1 n2 .
it's an n1 by n2 , signal .
that's a support of the signal .
thi is , a veri us transform , and we'll spend quit some time talk about it becaus it allow us to describ , character , analyz imag in the frequenc domain .
the main drawback of it howev is that it is not a comput transform .
i have to find x at all possibl frequenc omega <num> , omega <num> ar continu quantiti .
so , if i have an analyt for x n1 , n2 , then it is possibl to find a close form express for x omega <num> omega <num> , as wa the case with the simpl exampl we did in the previou slide .
if , howev , i want to find the continu fourier transform of an imag that i acquir with my digit camera then clearli i don't have an analyt express for the imag and therefor am not abl to find an analyt express for x omega <num> omega mega <num> .
so what you saw in the previou slide is that i can sampl the fourier transform x omega <num> omega <num> at equal space frequenc .
and the space between frequenc is <num> pi  over n1 in the horizont direct and <num> pi  over n<num> in the vertic direct .
and by do thi sampl of the frequenc domain i onli keep on period .
so , k1 is from zero to n1 minu on , k2 between zero and n2 minu on and again thi is for a n1 by n2 imag .
so , if i substitut two pi  over n on for omega on , and two pi  over n two for omega two here , i end up with thi express , which is the fourier discret fourier transform , dft .
it give me a descript of the imag and the discret frequenc domain , k on , k two when k on , k two rang over on period is shown here and thi is clearli a comput transfer becaus it onli involv the finit summat , therefor in finit number of oper .
the invers fourier transform shown here , take me from the frequenc , the discret frequenc domain , back to the discret spatial domain .
algorithm , it ha the same structur as the fourier transform .
the onli differ be that here i have e to the plu j .
the exponenti while is to the minu j .
and i also have thi normal factor in the front .
so thi here is the discret fourier transform pair .
that map n1 by n2 discret space imag , sampl , to n1 by n2 sampl of the fourier domain , of the fourier transform in the frequenc domain .
it's an exact transform .
i can go back and forth between x k1 k2 and x n1 n2 with , with no error .
and it make sens , sinc an n1 by n2 imag is mount to anoth n1 by n2 imag , both discret , and therefor i don't need infinit mani frequenc to repres the signal in the frequenc domain .
actual , even if the imag is real , the dft is complex , so it seem that a map n1 by n2 real number into n1 by n2 complex number .
howev , the properti of the fourier transform that the emiss properti that we start , start hold through here for the dft that is when x n1 n2 is real .
the magnitut of x k1 k2 ha even symmetri while the phase ha odd symmetri .
therefor i'm map n1 by n2 real number into n1 by n2 over four complex number .
and assum that on complex number correspond to two real number , i have the same number of number in , in both domain .
the dft and the fourier transform share mani , if not all , of their properti .
on main differ , howev , is that the linear shift in the fourier transform becom when it come to dft circular shift .
on wai to perform in the extend fourier shift is to period extend the imag , and then thei form linear shift , but onli keep the central part of the imag , the base bond or the imag that is defin by n1 , n2 , in thi window here .
by know the descript of a fourier transform it is clear that it is a comput transform .
it involv a finit number of compu , comput .
the same statement is true also for the invers discret fourier transform .
howev , what made the dft , veri popular , you might sai , transform is the fact that there exist effici comput , effici algorithm to comput it , which collect ar refer to as fast fourier transform .
so an fft is not yet anoth transform , it's simpli an effici wai to comput the dft .
so let's see how mani multipl we need if we directli comput the dft .
so we see that for each frequenc k1 k2 we need n1 n2 complex multipl to do the multipl of the signal by thi complex exponenti .
sinc i have n1 n2 frequenc , i need n1 squar n2 squar complex multipl .
clearli if n1 equal n2 equal n , then i need in thi case n to the fourth complex multipl .
i can do better than that by rewrit , reorgan the term in the definit of the dft .
so i see that what's insid the bracket is that on dimension dftof the signal with respect to n2 .
so if here is my imag .
so n1 , n2 is the rotat of the axi , so x n1 , n2 , what the summat insid , insid the bracket is do is comput the on dimens of the dft of the row of the imag .
thi signal then insid the bracket is i can call it g is a function of n1 nk2 .
with thi i can then rewrit the dft as shown here .
and what thi last express tell me is that if i take g n1 , k2 is a function of n1 and k2 , accord to thi summat i know but form the on dimension dft of each of the column of the signal .
here's the name row column decomposit .
first , we take on dimens of the fft of the row , follow by on on dimens of the fft column .
so let's see how mani comput we need of thi row column decomposit if i direct the comput the on dimens the fft .
so what we've done is to first take n1 and <num> . 1dimension fft and if again directli comput i need n2 squar multipl .
and then we take n2 and n <num> dft , and for that i need n1 squar multipl .
thi is clearli equal to thi .
so again for n1 equal n2 equal n , i see that i need 2n to the third multipl .
so , by just exploit thi decompos structur of the dft , i see i can bring the number of multipl down by an order of magnitud .
i can do even better than that sinc i have fast fourier transform to comput on dimens of the fft and thi transfer date back to the mid60s .
so <num> , coulei and turkei were the first peopl to invent such fast fourier transform and by enlarg thei develop meant gave a big push to the whole field of dft sinc now we were abl to effici mayb real time in some case , implement algorithm that were veri hard to implement befor that .
so , us on of those , fft , i can comput them n<num> . <num> dimension dft by us n <num> over <num> , locg <num> , n<num> multipl .
and then for comput the n1 point dft i need n1 over <num> log n1 .
and thi is clearli equal to n1 n<num> over <num> log n1 n2 .
so we see here that for n1 equal n2 equal n , i need n squar log <num> n multipl .
so we brought down the number of multipl by anoth , anoth order of magnitud .
and thi is actual in most case the wai to implement the two dimension dft by follow the row column decomposit and then util effici algorithm to comput the on dimension dft .
i can do better than that if i us a so call radix two by two fft and i bring down the comput to three fourth n squar , log <num> n .
and with the dft , which is a comput transfer , and even more specif with an fft , a fast wai to implement it .
i can see how an imag look in the frequenc domain .
so here is the orient of the axi , n1 , n2 .
and thi is a <num> by <num> pixel imag .
and thei ar <num> bit per pixel .
so here in the middl , i see the dft of thi imag .
so , it's a <num> by <num> point dft .
so here is point <num> pi  becaus half of thi <num> is the point pi  and about here on forti seven is the point pi  .
so here in the middl is the highest frequenc , the pi  pi  frequenc .
so in the middl you see the mesh plot of the dft , the magnitud of the dft while on the right you see an imag version and it's cover code .
and so , red , here , is high valu , and blue ar the lower code valu .
so we can see that there is a lot of energi at low frequenc .
thi is the zero zero .
there's a pink there , and the magnitud of the dft drop off as i approach higher frequenc .
so here we see the same imag again on the left , but often it's more inform if the magnitud of the spectrum of the imag is center .
so , in other word , the zero , zero point is around about here .
and therefor here is minu pi  , pi  , and minu pi  , pi  in the other direct .
so we see here more clearli that there's a peak at zero , zero and then as i move awai from that frequenc as the frequenc increas in all direct the magnitud drop or becom much smaller .
the question is how can i center the spectrum i've shown here .
and on wai to do that is by multipli the imag by minu on to the n1 plu n2 .
so thi is a checkerboard pattern .
it altern between minu on and on .
and y would search a multipl center of the spectrum , becaus thi is clearli to , e to the minu j pi  , n1 plu n2 .
so , in the spacial domain , i multipli my signal with thi complex exponenti .
and , on of the properti of the dft is that thi introduc a circular shift of the dft by pi  pi  .
we saw thi properti actual , i believ , when we talk about the fourier transform and there the complex explan , the spetial domain gave rise to a linear shift but here it's a circular shift .
so , circular shift , on of the wai again to look at it is that i take the spectrum , i period extend it , i shift it linearli by pi  pi  in both direct but then i onli maintain the base period .
the on shown here , right , from zero to three nineti two and zero to two nineti four .
and again here you see the spectrum as an imag so the high valu is at zero zero center and again thi provid in most case a better visual of the spectrum .
welcom back .
we can now us thi valuabl tool , the dft and it fast implement .
to bring signal and the oper of lsi system in the discret frequenc domain .
thi is realli on of the main practic object .
perform the filter of an imag in the discret frequenc domain with a user fft .
we saw when we talk about the fourier transform , that convolut in the spatial domain result in multipl in the frequenc domain .
it seem that too should be done , but there is a small glitch .
sinc the multipl of the dft signal result in the circular and not the linear convolut in the special domain .
we therefor explain in the segment how the two circular and linear convolut ar relat .
and most importantli what ar the step that we need to take so that the result of the linear and circular convolut of to the signal ar ident .
often , i us the term signal instead of the modul to the signal .
to indic that all these result we ar obtain here ar extens of 1d process .
and similarli , these result can be extend in a straightforward wai to dimens higher than two .
visual , howev , dimens higher than two in the special tempor or frequenc domain , it's not alwai a straightforward task .
so let's proce with the materi of thi segment .
now that we have a comput transform , the dft , to take us suffici through an fft through the frequenc domain .
would like to us thi tool to implement field data in the frequenc domain .
so let's see what ar the step to accomplish thi .
so we start with lsi system , shown here , hn1 and <num> is impuls as part of the system .
x is input , the output i denot by y of l .
and we know by now , that y of l and n1 and <num> is equal to the convolut of the two dimension , linear convolut of x with ag .
i now find the dft of impuls respons , that's the frequenc's respons .
i do the same for the input .
i find the dft of the input .
and i form the output of the system by multipli the correspond dft .
so y k <num> , k <num> , the dft of the output equal the dft of the input time the dft of the impuls respons of the system .
a side note here is that in order to be abl perform thi multipl i have to have all the dft be of the same size .
so , otherwis the multipl doe not realli make sens .
so , if the support of x and h is , differ , i have to part them with 0s to bring them to an appropri size .
i want to bring now thi equat back to the spatial domain .
i would expect that the quantiti i get by come back to the spatial domain should be relat .
and actual our intuit tell us that the invers dft of y k1 , k2 should be the convolut of the invers dft of x k1 , k2 with the invers dft of h k1 , k2 .
we ar partial correct , in the sens that , what we obtain is not the linear convolut , or the convolut .
but instead , the circular convolut of x with h .
on wai to think of the circular convolut is to follow the step of the linear convolut .
but now all the shift and deflect ar circular and not linear .
anoth wai to think of the circular convolut , mayb a more us wai , is through the linear convolut as shown by thi express .
so accord to thi , i first find the linear convolut , y of l , up here , of x with h .
and then i period extend it with period n1 and n2 .
r1 , r2 rang from minu infinit to infinit .
and then after i do that i keep just the base period .
so n on is from <num> to n <num> minu <num> and n <num> from <num> to n <num> minu <num> .
it should be note here that in order to perform circular convolut the two signal who have the same support and the result of the circular resolut give me an imag with the same support with the two imag i'm circularli convolv .
so what you've seen here is i that i can util the effici of the dft to perform filter in the frequenc domain .
howev what i obtain by multipli the correspond the x's in the fit domain is the circular convolut of the two signal .
thei input with the impuls respons .
lsi system perform linear convolut .
so , the kei question that aris is , under what condit should the result of the linear and circular convolut be the same .
we'll , we'll look into thi , into some detail next .
although , on might alreadi have the answer .
as long as there is no alias in perform thi period extens the two result , result of the cycl of the linear convolut will be the same .
let me refresh you memori here .
thi is someth we cover at an earlier point .
if i'm convolv two signal .
let's sai thi is my x n1 and <num> signal .
thi is my h n1 and <num> signal .
result of the convolut y of l n <num> and <num> .
then if the support of the first signal is as shown here , thi is n1 by n2 .
while the support of the second on is m1 by m2 .
then the support of , the result of the convolut is go to be as shown here , l1 which is equal to n1 plu m<num> minu <num> .
and by l2 , which is equal to n2 plu n2 minu <num> .
thi is anoth straightforward result to show just by follow the step of the convolut .
so , clearli , the , the result of the convolut the output signal ha greater support than ani of the individu signal i'm , i'm , i'm convolv .
now , if i want to perform linear convolut through the us of , of a dft , i should util dft of sizel1 by l2 .
so , i should take the input signal and increas it size to l1 by l2 , by pad it with <num> .
i should do the same for the second signal i'm convolv with .
so thi is l2 , thi is l1 .
and here i pad it with 0s .
i take the dft , i multipli them in the discret frequenc domain , and i take the invers dft , and i come back to the spatial domain .
and as i mention earlier side , slide , the result then is the circular convolut .
which is form by the period extens of the linear convolut shown here .
but sinc the period extens is go to be with respect to l1 , l2 would clearli see here .
that there is not go to be anoth lab between the replica of thi signal yl .
and therefor , the result of the secular linear convolut is go to be ident .
we show here the period extens of the result of the linear convolut with period l1 , l2 , as explain in the previou slide .
so in thi particular case , there's no alias l1 , l2 ar chosen appropri .
if instead i choos an l <num> prime which is less than l <num> and l <num> prime which is less than l<num> perform the period extens .
and l <num> , l <num> prime by the wai , ar the size of the dft .
then clearli alias is go to take place so the result imag .
which ha size l <num> prime l <num> prime is go to have the , so mani first row and column alias .
and the number of the alias row here .
thi is l <num> minu l <num> prime .
and the number of the column that ar alias is l2 minu l2 prime .
the rest of the imag , of cours , the on shown here , the result of a circular and linear convolut ar ident .
let's recap what we've learn so far .
and i also want to make an addit point .
so , we're given thi eight by eight imag .
and we're go to convolv it with a system that ha thi three by three impuls point .
first of all , we know that the result of the convolut is go to be a signal that is go to have <num> plu <num> minu <num> equal <num> .
in the n1 direct and <num> in the n2 direct .
the is go to be a ten by ten imag .
so the step i have to follow ar the follow .
i'll take the origin imag , and turn it from an eight by eight imag to a ten by ten imag .
so i'm go to pad it appropri with 0s as shown here .
now as far as the impuls part of the filter goe , we see here that it is center at <num> .
when i talk about dft , the rang of valu ar from <num> to n<num> minu <num> , <num> to n2 minu <num> .
so it cannot accommod the neg n1 n2 valu of the signal .
so in order to handl that i will period extend thi three by three signal with period ten in both dimens .
and then i'm go to pull out the base period from <num> to nine and then on , and zero to nine and then two .
so , what's in thi red dot rectangl is a ten by ten imag .
i will part it with 0s so now i have two ten by ten imag in the spacial domain .
i will take the correspond dft .
i'll bring them to the frequenc domain , ten by ten dft .
i'll multipli them , take the result of the multipl and bring it back to the spatial domain through an invers dft .
and that will give me the linear convolut of the two signal i start with .
on of the advantag of frequenc domain filter , in addit to fast implement is that thei can process each frequenc individu .
so on can select allow certain frequenc of the input signal , go through the filter unchang .
or with some gain , or with some loss , or some of them will be complet reject .
so as a simpl , but hopefulli repres , exampl we show here the <num> by <num> imag with a sinusoid superimpos underneath .
such an exampl can possibl result situat where the period nois is ad to an imag .
which might resolv from electr or electromechan interfer view acquisit .
so in thi particular case , the observ imag , if i call it y , n1 and <num> equal origin imag x n1 and <num> plu cosin <num> pi  n2 .
sinusoid ha frequenc <num> pi  .
so such a sinusoid signal is repres in the frequenc domain by two delta at plu minu <num> pi  .
so if on can estim the frequenc of thi sinusoid , we can design a notch filter , as it's call .
that will allow all frequenc of the imag to pass through the filter unchang .
except that the frequenc where the sinusoid is locat which will be reject .
the total reject is minu <num> pi  plu <num> pi  frequenc in the omega two dimens .
so , we do that and come back to the spatial domain and the result imag is thi on .
so , we see that the littl gui who wa behind bar now ha been freed .
welcom back .
now that we cover and understood someth in the previou segment , we address in thi segment the chang of sampl rate of a discret signal .
ani mani applic we ar interest in either increas the number of sampl in an imag , refer to as up sampl or interpol , or reduc the number of sampl , refer to as down sampl or decim .
we analyz in thi segment these oper in the discret frequenc domain .
we see , for exampl , that down sampl introduc alias , and the wai to minim the effect of alias is to robust filter the imag first with an appropri filter befor deduc it special resolut .
similarli we show on of the possibl wai to perform app sampl us discret frequenc domain field .
sampl grade convers is an import oper with mani applic , for exampl in e merg and video compress .
multi rate signal process is an import sub area of signal process .
the rate convers in gener can be perform by a non integ factor .
so , we ar touch the tip of the iceberg in some sens in thi segment on thi veri import topic .
let us now proce and look at the detail .
sampl is an import topic .
and it from the continu world to the discreet world .
equal import is the process of resampl or chang the sampl grade in the discreet world .
it's often that we need to chang the size of an imag .
either make it larger , outsampl it , or smaller , downsampl it .
although thi is an interest and rather broad topic , that'll be revisit dure the cours , we want to mention a few idea here , as thei relat to what we've been cover so far .
again , i will not be show or deriv ani equat , but pictori provid some inform of what's take place .
for those of you interest to look further into thi , thei can find thi materi in ani standard book on imag process , or on dimension digit signal process .
so given an imag , i'm interest in reduc it size by two in each direct .
and here you see an eight by eight imag .
but i want to reduc it to a four by four imag .
we also show the spectrum of the thi imag here so thi is <num> pi  , <num> pi  , and let's call thi frequenc omega on maximum in the on dimens , omega two maximum in the vertic direct .
a simpl , or naiv wai to perform thi down sampl is to remov everi other column and everi other row of the imag as shown here .
so , therefor , i end up with a four by <num> wedg .
what happen in the frequenc domain is shown here .
the spectrum is squeez down .
the height is reduc .
i , of cours , don't show the height here .
i just show the support .
but also , we see that the maximum frequenc move to thi point , in the horizont and to thi point in the vertic direct .
so becaus of that , we see that alias occur .
high frequenc alia themselv as low frequenc .
and thi again , manifest itself in the special domain in the form of jag edg .
so , if thi is my form of down sampl , throw awai , in other word , everi other column of everi other row , in order to avoid alias , i should be robust filter the imag befor down sampl .
and i will , should , be robust filter with a filter with cut off frequenc pi  over m in the <num> , and pi  over m in the other direct where m is the down sampl factor .
so , you see an exampl here of the down sampl process we just describ .
thei origin imag is eh , <num> by <num> pixel .
it's too larg .
it's not shown here .
and thei show the result of down sampl with and wit , without , pre filter .
pre robust filter .
so on the left , you see the imag that result by just again throw awai everi ninth column and everi ninth row sinc the down sampl factor is ten in thi particular case .
and the alias effect as alreadi mention manifest itself here if we look at you know , edg or high frequenc compon , we see that low and high frequenc ar mix up it appear everywher in thi build , thi is a pictur of the chicago skylin .
while the flat region , like the region here don't show ani effect alias , as expect .
on the right , i show the down sampl to the imag the same size to the on on the left , but in thi case , befor down sampl , the imag wa robust filter by the gaussian filter of support <num> by <num> pixel .
and the gaussian mean that the impuls get some gaussian shade within thi origin support .
so in thi case , you see that the high frequenc avail preserv .
of cours , we lost some high frequenc with the robust filter , but we were abl to preserv some of them it's just , you compar all kind of differ region here you can easili see the differ .
so let us see what is a wai now for up sampl an imag base on what we have learn so far .
so , we're shown here in thi toi exampl a four by four imag .
and we ar interest in turn it into an eight by eight imag .
we show the spectrum here of thi imag , so thi is <num> pi  , thi is <num> pi  in the vertic direct .
the first step toward up sampl is to introduc column and row of zero in between the exist sampl .
so clearli now i have an eight by eight imag .
what take place in the frequenc domain is that i see frequenc scale version of the origin spectrum .
so i have a replica , a scale replica of the origin spectrum appear here at pi  , anoth on at pi  in thi direct .
and i onli have on replica between zero and <num> pi  becaus the up sampl factor is equal to two .
all i'm interest in is keep the base band of the spectrum of the imag .
and thei can do that by util the robust filter indic here .
so , what happen in the special domain is that i'm convolv the imag within thi fulli transfer of thi robust filter , which is refer to as the idea low pass interpol filter .
so , the zero valu that thei have introduc will chang now to specif valu base on the exist neighbor pixel .
let us look at the up sampl exampl .
and <num> by <num> imag is shown here .
and we would like to increas it resolut by a factor of two in both direct .
so , end up with a <num> by <num> imag .
we show here the spectrum of the imag .
it's a <num> by <num> spectrum , which wa obtain by zero pad the origin imag to the <num> by <num> size .
we want to show the spectrum so that thei can see how the result is after we follow the step of up sampl .
so , the first step toward up sampl is to insert zero column and zero row to the origin <num> by <num> imag so that the result imag now is a <num> by <num> imag .
if i look at the spectrum of thi imag , i see thi replica of the base bun appear here , thi is pi  , pi  for exampl , due to the insert of zero .
the final step is to low pass filter the spectrum so that i onli keep the base bun , while reject all other frequenc .
so , the blue area here repres zero valu .
now if i bring thi back to the special domain , i see the interpol imag as shown here .
an altern wai to up sampl the imag is to perform the convolut in the special domain with an interpol filter like the on shown here .
so thi the impuls filter of the filter .
thi is the h zero , zero point .
so first of all let see what thi filter is do so if i have in the low resolut imag let's sai four valu a , b , c , d .
as we saw the first step is to introduc row and column of zero .
and the idea of interpol is to chang these valu of zero to some other valu .
so , if i perform the convolut again of thi filter here , with thi imag we see that thi zero here will be replac by a plu b over <num> .
thi by b plu d over <num> .
while thi pixel here will be replac a plu b plu c plu d divid by <num> .
i just take the impuls puls of these .
it's symmetr , so even i flip it around , it will stai the same .
and i place it .
place the on , the center , the pixel locat i tri to find it valu .
and we see that thi is inde the case .
now what's happen the frequenc domain is that the spectrum of the low resolut , let's call it , the <num> by <num> imag the <num> by <num> spectrum , which again we find by pad with zero as i show earlier , is multipli by the frequenc respons of the filter .
and what's the frequenc respons of thi on ?
is by now , we should be abl to look at it and by observ we know that it's on plu cosin omega on , plu cosin omega two , plu on half cosin omega on , plu omega two , plu on half cosin omega on , minu omega two .
so thi filter will show actual the magnet of thi at an earlier point how it look like .
it's go to multipli the spectrum of the imag .
and thi is the result spectrum of thi up sampl imag .
so we see that what happen is exactli what i had befor .
in other word , thi is a low pass filter .
so , that replica here in the middl of the spectrum ar reject , and i onli keep just on replica of the spectrum , the base bun .
howev , now i am not us a sharp robust filter as in the previou exampl but the filter here is the shape that is express by thi , equat here , right ?
h omega on omega two .
and thi is a big fit here is an imag .
so , thi bring us to the end of the third week .
by now , when we look at an imag we do not onli see it's bright and dark region , or it differ color , but we can distinguish between high and low spatial frequenc .
region where thei decid the valu transit in a fast wai or region where the transit slowli expect it .
dure thi week , we learn that there exist computation effici wai call fast fourier transform .
that allow us to repres ani given imag in the discret frequenc domain , and therefor distinguish between high and low and intermedi frequenc .
we also learn that we can now implement an lsi system or perform filter in the discret frequenc domain .
for filter with life support variabl respons , thi is inde a much faster wai to carri out filter .
we final learn how the fourier tool can help us in analyz sampl or sampl grade convers .
the fourier tool , ar of the most fundament and us tool , on interest thing , work in discret signal can get equip with .
thei ar actual the same tool whether we ar interest in process speech , or audio , imag , video or video of three dimension object .
i'm certain that the tool you've acquir in these last two week will serv you well for the rest of your signal process relat career .
we will actual cover next week anoth tool , you might call it so , motion estim , which is of the utmost us when we process video .
we'll also cover , next week , some of the fundament notion of color imag process .
so , with that , i'll see you all next week .
hello and welcom to week four .
i hope you enjoi the last three week .
we cover dure them fundament materi and tool that will serv you well for the purpos of thi cours and beyond .
as i mention earlier , do not discourag if not everyth is crystal clear at thi point .
if you're comfort with these home work problem , you'll be in good shape .
and you'll be abl to appli these tool to real life problem in your work or school environ .
thi week , similar to the last two week we will cover a tool , you might call it so , which is need almost alwai when we deal with the process of video .
the tool consist of the techniqu of estim the motion in a video of a dynam scene .
in other word , in find how each and everi pixel in the scene ha move over time .
thi is a fundament step in a number of applic like for exampl track .
thi is a problem of follow an object over time like a player let's sai in a basketbal game .
someth which is done automat by us human but it is rather challeng task for the comput .
or human comput interact .
that is interact with a comput , not with a tradit mous and click anymor , but by assum that the comput or , sai , a robot ha ey that can see us and understand , for exampl , our motion and our action .
as we will see when we cover in detail video compress in a few week , motion estim is an integr part of ani video compress algorithm or standard .
we'll talk primarili about the so call direct method for estim motion .
that is , face correl , block match , and special tempor gradient techniqu .
we will also talk about color .
we will cover some of the basic inform about it , we'll describ some space for repres color , and we will also discuss some basic consider when we process color imag and video .
in thi first segment we will distinguish between 3d and 2d motion .
and also between true motion and optic flow .
we'll then provid some exampl of the applic of motion .
we will be encount motion in differ part of thi cours , especi when we talk about video compress .
so let us proce with thi materi and enjoi week four .
the world we live in is three dimension .
i therefor need the three dimension axi system .
an x , y , z system is shown here to describ the motion of object , or their trajectori in thi three dimension world .
so what we see here is thi ball at time t t plu on , t plu two , t plu three and so on .
now if i onli have avail on combin here when we talk about monocular vision .
all i am abl to acquir is the project of thi three dimension motion onto the two dimension plane , let's call it x y plane .
if the camera's not calibr , i'm not abl to correspond , for exampl , size from the imag plane to the world .
so if for exampl thi diamet of the ball is <num> pixel here and the imag i do not know what the size of the ball in the rear well is equal to how mani centimet for exampl thi diamet is similarli we see that intention you know at time t <num> here the ball is smaller than the ball at time t on the imag plane and thi is becaus the depth , the distanc of the ball from the imag plane ha chang .
so although i'm interest in estim the motion of object in the three dimension world all i'm abl to do with on camera is estim the motion of the object in the two dimens world .
again , if a calibr camera were avail , and thei also knew the geometri of the scene , then i would be abl to go from the 2d motion to the 3d motion similarli , if two or more camera were avail , i would be abl to find the depth in thi scene with an escap factor , and so on .
howev , for the better part of the cours , we'll onli deal with on camera , as shown here .
and therefor , we'll deal with the estim of the two dimension motion .
so the basic form of the motion estim problem is depict here .
given two or more frame i am interest in find out how an object such as thi on move from on frame to the next .
so from frame k minu <num> to frame k .
and how to move from frame k to frame k plu <num> .
similarli , i might defin a region such as thi on , and be interest in find out how thi stranger move from on frame to the next .
or , i might be interest how a singl pixel move from on frame to the next .
and these vector denot the motion in thi two dimension plane , of thi particular object , or region , or , or pixel .
as far as notat goe , time will be denot as subscript here , as shown here , or altern i can us the notat i x y t minu <num> to denot the imag frame , the intens is i , coordin x , y and t <num> and here becom x y t and so on .
diffus of the optic flow is the chang of the light of the imag or on the retina of the ey or on the camera sensor .
due to the rel motion between the camera and the scene .
so in gener , by estim the optic flow in an imag , we ar obtain an estim of the motion in the scene , or as we discuss , the two dimension project of the three dimension motion on to the camera .
there ar howev two case that i want to discuss here .
on when the optic flow is zero although there is motion in the scene and two when the optic flow is non zero but there is no motion in the scene .
the first case , non zero through motion at zero optic flow is demonstr by thi video .
thi cylindr water bottl here is rotat on a vertic axi .
and sinc the reflect properti on the surfac of the cylind is constant the gener optic flow is zero .
you might see actual some displac of the cylind here sinc i wa hold it and rotat it while film it and it's rather hard to hold it steadi while rotat it .
so let me plai the video for you , so it is hard to observ ani motion sinc the optic flow is zero , there is no no chang in the optic flow in thi scene .
i want to demonstr the second case by thi video .
the case of zero through , motion non zero optic flow , due to the chang in the ambient light the optic flow in non zero .
if you focu for exampl on thi statu or the , thi busi card holder howev , noth move in thi scene .
so let me plai thi video for you .
so if the ambient light is constant , we don't have to worri about the second case .
and therefor with the except of thi issu that wa describ here , the estim of the optic flow would provid us with a good estim of the motion in the scene .
there ar numer applic in comput vision , video process , robot , anim , where motion is estim and us to perform variou task .
some exampl of such applic ar list here .
in object track , the object is to determin the locat of an object at ani given time instanc .
in human comput interact us visual input the object is to commun inform to the comput with the us of a camera captur the motion of the bodi , arm , hand of a person , as well as the express of a person .
in tempor interpol , the object is to creat or estim miss frame in between exist frame .
video rate up convers is a primari exampl , in the stop .
in remov nois from a sequenc , we ar interest in us both the spatial neighborhood of a pixel in a frame , as well as the tempor neighborhood .
in thi case , we want to filter along the motion trajectori .
final in video compress , we ar predict the valu of each and everi pixel in the current frame by util their motion as determin from the previou frame or the previou frame then encod the predict paramet , the motion as well as the predict error , or the , displai veri differ .
clearli we want to perform as accur motion estim as possibl .
thi is inde the case with the first four applic mention here .
for the video compress applic howev , accur motion estim is also import .
but we can trade accuraci of the motion with reduct in comput com , complex or speed of estim the motion .
we can afford thi becaus we're given the chanc to correct for the inaccuraci in the motion estim by encod the predict due to motion error or the displac frame differ .
in ani case , don't worri , thi is not crystal clear right now , sinc we'll cover video compress in consider detail in later week , we show next some exampl of the first four applic .
object track is a veri challeng problem , with consider research and develop in academia , and industri alik .
we us here a micro program to demonstr the basic idea .
the name of the program is type in thi command window .
the name bip traffic of_win and thi window pop up .
if we press plai , then we these four individu window show up , so the block diagram of the system is shown here .
the , the raw traffic data ar input into the system , and the raw data ar shown in thi window .
actual thei go out thi wai , and thi is the video that is displai .
the , the frame ar <num> by <num> , and the frame rate is fifteen frame per second .
then the color video is convert to intens to grai scale , and base on the grai scale the optic flow is estim us a particular algorithm .
algorithm by the name of hor , horn schunck .
we're go to talk about optic flow later in thi present .
so these motion vector , veloc here ar displai in thi window .
you can see those yellow motion vector .
then base on thi veloc threshold is take place and it gener thi binari imag shown here .
so , if there is a veloc vector in an area in a pixel , then thi is after the threshold shown as white , while the stationari part is shown as black .
and final , base on thi segment here , a bound box appear around the object .
and thi is realli what we ar after , we want to know at each time instanc the locat of the object .
so it is a motion base segment of the object , the segment , again , is shown here in thi binari imag .
is not extrem accur , for exampl , you see that you have two car here , and on and there ar , you know , stationari part in the car while the car is move as , as a complet object , so these ar error in the motion base segment , howev as long as the , the bound box is correctli identifi around the move object , then our object ha been accomplish .
so let me continu plai the video here .
you see that again in thi for win window origin video the motion vector field super impos on the video the binari imag due to thresh hold the motion field and final the bound box around the move object .
so if i kind of stop it here you see that there is a bound box here , a green bound box around the move object .
so thi is a program you can also run on your own and pai closer attent to it , but it clearli demonstr rather straight forward approach toward object drag base on the motion vector .
we show here an exampl of a vision base interfac system or visual panel which util a panel such as an ordinari piec of paper and a tip pointer , for exampl , a finger tip .
as an intuit , wireless and mobil input devic .
the system can accur and reliabl track the panel and the t point .
the panel track continu find the project map between the panel and the displai which in turn map the tip posit to the correspond posit on the displai .
by detect the click and drag action the system can perform mani task such as control a remot larg displai .
and simul the physic keyboard .
user can us their finger or other pointer to issu command and type text and in addit by write the three dimension posit and orient of the visual panel , the system can also provid three dimension inform .
and can therefor serv as a virtual joystick by which on can control three dimension virtual object .
so thi is anoth exampl of how motion can be util in develop these human comput interact system .
motion compens tempor interpol is anoth problem where motion plai a , an import role .
thi is the problem encount in frame up convers .
for exampl , you're go to convert the <num> frame per second movi up to a <num> frame per second video that would be us for broadcast .
so the problem depict here , i have the frame at time t on and the frame at time t two .
and i'm interest in gener a frame typic the middl of these two ar an ident distanc between these two at time t .
on approach toward thi tempor interpol is to duplic frame t on into frame t .
so in thi case , if for exampl i look at the block such as the on show here i'm go to reproduc thi block at exactli the same locat .
so if thi is , thi point here is n1 , n2 .
then thi point here is also n1 , n2 .
so thi is <num> order hold .
now thi is of cours a , we have a veri straightforward wai to gener the miss frame , howev , it can gener jag motion , becaus dure go from t to t two , we see that the , the person here ha consider move .
so , anoth approach which provid gener speak a much smoother motion is base on , on , on motion compens .
so i find the motion between thi block at frame t and frame t2 .
and therefor , the locat now of thi block is here at let's sai n1 prime and two prime along the motion trajectori .
so then i'll take the intens of that block and reproduc it here .
so thi is the basic idea of motion compens tempor interpol and again .
by and larg , it produc a much smoother motion than the zero order hold .
and here in thi exampl again , the , the frame we interpol is in the middl of the two frame .
it can be anywher between the time t1 and t2 , and we can have more than on frame , so we can just introduc two or three new frame between frame t1 and t2 .
let us assum we ar given three noisi frame , and our task is to reduc the nois .
we assum that the same type of nois with the same strength , the same varianc wa ad to all three frame .
then if there's no motion among the frame , if the frame , let's sai , ar ident in that respect , if i take a small region as indic here , and then averag it across time .
the meta effect is that the varianc of the nois is reduc by the number of frame i'm oper .
so in thi case , it ha been divid by three .
in video of point of interest , dynam video there is motion between the frame , but i want to reproduc the same oper and in do so i have to be abl to find the motion and perform thi averag thi filter along motion trajectori .
so what is , thi is what is shown here in the second row of imag i have track the motion and therefor thi block here is not the same at on and two locat , but it move from frame to frame by follow the motion .
so then i'm go to averag the three frame here the three other block shown in red but thei ar locat in differ locat becaus again i am smooth along motion trajectori .
so thi is the simplest possibl idea on can perform when deal with tempor filter but the gener idea is that i want to be abl to find the motion .
and then perform a type of filter , spacial tempor filter along the motion trajectori .
clearli the problem becom more challeng , the motion estim problem that is simpli becaus the data ar noisi and therefor i have to invent robust motion estim techniqu robust to nois .
welcom back .
we cover in thi segment the motion estim techniqu , phase correl , which is suitabl for estim the global motion an imag frame is undergo .
it is therefor also refer to as an imag registr approach .
the algorithm is rather intuit clear , and it is base on a simpl properti of the fourier transform that we cover in week three .
so , we see that we make us of the import inform we cover last week right awai .
we describ the properti in term the of continu fourier transform first , but we also discuss the actual implement of the algorithm in term of the discreet fourier transform which is the comput transform as we know by now .
so , let us proce with the segment .
we will describ , next , some of the most commonli encount method for estim motion , motion estim method .
thei ar group into direct method , and indirect on .
with direct method we comput the optic optic flow in the scene .
thei come under differ name , phase correl .
we try to find the shift between two frame by estim the phase compon that result due to the shift in the frequenc domain .
block match method , as the name impli , you take on block in on frame , and try to match it to the most appropri locat in anoth frame .
then there ar the method that comput the spatial and tempor gradient in the scene .
and thei come in , under two name .
the tradit name here is optic flow algorithm .
it give us the optic flow equat , which i can us to find the motion .
and then pel recurs method , which also estim the optic flow , but in such a wai so as to , to allow recurs comput of the vector field .
with indirect method , i first find the featur in the two frame and i match the featur directli which , of cours , will result in an estim of the motion .
let us explain the phase correl method with the us of an exampl .
consid the imag shown here , nois ha been ad to thi imag and also a translat version of thi imag shown here .
it should be clear that if i translat the first imag in approxim the diagon direct , i should obtain the second on .
let us denot by x n1 , n2 the first imag , and the second on by x n1 minu m1 , n2 minu m2 , the two translat in the horizont and vertic direct .
base on what we have learn about the fourier transform , if x omega <num> , omega <num> is a fourier transform of the first imag , then the fourier transform of the second on equal e to the minu j omega <num> m<num> into the minu j omega <num> m<num> x omega <num> omega <num> .
so , the magnitud of the fourier transform of the two imag is the same , howev i have thi linear phase compon due to the shift in the spatial domain .
my object clearli is to estim m1 and m2 .
if i manag to isol thi phase compon , thi complex exponenti .
and take them back to the spatial domain .
then i know that thei will give rise to a delta at m1 , m2 .
so , if i do everyth right , i'll obtain an imag as shown here .
so , there is inde a delta here .
it's approxim at <num> , <num> , so these ar the shift in m1 <num> and <num> <num> .
so , if i shift the second imag by minu <num> , minu <num> , i should obtain the first imag .
so , let us now look at the algorithm detail that will allow us to obtain thi phase correl imag that will give us an estim of the shift .
let us now look at the algorithm detail behind the phase correl method , which is also categor a registr method .
we ar given two frame from a video sequenc , at time t minu <num> and time t .
and the first step is to take the discret fourier transform of these frame shown here correspondingli as x t minu <num> and x of t , k1 , k2 .
now , in the previou exampl , i us the continu fourier transform to describ the method .
but we know by now that the continu fourier transform is not the comput transform , so therefor when i need to take an imag to the frequenc domain , i us the discret fourier transform .
all , of cours , through , it's on of it fast implement , so i us an fft .
the model assumpt is that the on frame is shift with respect to the other frame , so the frame at time t equal the frame at time t minu <num> , shift by m1 in the on direct , and by m2 in the other direct .
these shift , howev , ar not linear shift , but circular shift , or modulo n1 , modulo n2 shift .
if you recal , on wai to understand , explain circular shift , is to take an n1 by n2 imag , period extend it by n1 in the on direct and period n2 in the other direct and then .
perform a linear shift , but onli keep extract the base period , the period in on direct between <num> and n<num> minu <num> , and the period between <num> and n2 minu <num> in the other direct .
now , in most case , the imag ar not relat by a circular shift , like the exampl we show , but by a linear shift .
so to , to , to account for that , we first window with a two dimension window both imag befor comput the dft .
there ar a number of differ window on can us from digit signal process , like the triangular window , kaiser window and so on .
so , the reason for thi window is to downweight the contribut of the pixel around the bounder of the imag .
sinc , again , the imag ar not relat , necessarili , by circular shift .
then , base on the shift properti of the discret fourier transform , we know that the two imag ar relat in the frequenc domain , as shown here .
so the dft of x of t equal the dft of x of t minu <num> , and the shift , circular shift in the spacial domain give rise to thi phase compon here .
right ?
thi linear phase compon ar by the spectrum , so again , the two imag have the same magnitud of the dft , but thei , the phase of the second on i have ad thi linear , phase compon .
so , have comput the dft of the two frame , the next step is to comput thi correl imag , c of k1 , k2 , so it's the dft of x of t , time the x of t minu <num> and thi is the complex conjug of the complex number .
so , it leav a magnitud and chang .
and chang is the sine of the phase .
and the denomin , i take the magnitud of these two term .
so , if i substitut , from the equat abov , x of t in here .
then you'll see that thei have x of t minu <num> time x of t minu <num> complex conjug , which will give me the magnitud of the dft time the phase compon .
so , in other word , i'm go to get thi express .
and we see here , that the magnitud cancel out , and all i'm left with is these complex exponenti .
thi , thi phase compon .
the third step i have to take , is to take now thi imag back to the spatial domain .
and we do know that , the invers discreet fourier transform of these complex exponenti is just , delta .
so , thi imag here is zero everywher except at the pixel with coordin m<num> and m2 , where the valu's equal to <num> due to the exist of thi delta .
so , the follow , these three step i just describ would be abl to see where thi delta is locat in the c n1 and <num> , and obtain an estim for the shift m1 , m2 which will allow me to regist the t minu <num> frame back to frame t .
welcom back .
we cover in thi segment the most celebr , and the most intuit motion estim techniqu , block or region match .
it is us wide , if not exclus , for video compress , but also for a larg number of other applic .
we describ the approach and then also look into variat of it which trade accuraci for speed of implement .
the actual humbl implement techniqu ha also been investig extens .
sinc motion estim is on of the most computation expens subsystem in ani video encod .
it is inde interest that although the approach is so intuit , block match actual still continu to be an activ research and develop topic .
if on open for exampl ani gener video process , most probabl there will be some paper on thi topic in it .
we'll also show some experiment result , demonstr the variou approach toward block match .
so , let us proce with thi veri import segment .
let us discuss now the block match motion estim method .
thi is probabl the most intuit method out of all the method we ar go to discuss .
the step ar inde conceptu veri simpl .
we see here two differ frame from a video sequenc , the form of the video sequenc .
so thi is a frame x of t minu1 , and frame x of t .
the two frame can be consecut or can be further apart in time .
we then consid a block in the current frame .
the on shown here in siam .
i overwrit it in red .
we move thi block to all possibl posit in the previou frame .
we move it for exampl here , or here , and we try to find the best match of the block in the current frame with the block in the previou frame .
but let us assum that the best modul , the cyan block in the current frame .
wa with a yellow block in the previou frame , base on some match criteria of , that we will discuss a bit later .
after the two block ar found that provid the best match , a block from frame t and the yellow block from frame t minu <num> .
i util a vector here to denot that rel displac between these two block .
and thi is the motion vector associ with thi block .
now thi vector can point block at time t to block at time t minu on as shown here .
and in that case it's in fact as a motion and compens vector and that's how it's handl typic in a video compress scenario or it can point from time t <num> to time t and that's what i get if i revers the direct of the vector .
so thi might look like a trivial oper , revers the direct of the vector but it ha implic sinc now i'm not look for a global motion between the two frame .
but instead i'm look for a local motion base on these block and becaus of that if i consid all the pixel in on frame there's not on to on map between the pixel in the two frame .
also the wai it's depict here for frame x of t i divid into block and then i associ on vector for all the pixel insid the blog .
howev , i could associ the motion vector i found just to onli on pixel in the blog , let's sai the pixel in the center .
in that case , if i shift the blog by on pixel , find anoth vector and keep go that wai i am go to end up with a dens field , motion field that correspond to each and everi pixel in the frame .
let's look at what some of the underli assumpt in make thi approach work out .
the first on is that there's no chang in the ambient light , which is , of cours , the assumpt in all of these method , so that , the optic flow correspond to the motion in the scene .
we also assum that the object ar rigid .
thei don't undergo transform , like , for exampl , the lip here of foreman that ar elast , object , so that a match can be found between the two block .
we also assum that the object have translat , thei don't undergo ani more complic motion , and then more than that , thi translat in the three dimension world is on a plane that is parallel to the imag plane so therefor the object do not chang size from on frame to the next .
and final we assum that no object appear or disappear from the scene in go from on frame to the next and therefor a good match can be found .
the discuss so far about block match method we have not address the match criteria on can us and thi is what we would like to do now .
we have been us block as the unit we've tri to match , but it should be clear i can us other regularli shape region , such as diamond , for match , or in gener ani arbitrarili shape region for match .
and in thi case , gener speak these block match method ar also refer to as region match method .
now ani similar or dissimilar measur between these region can be us as the match criterion .
so what we see here is a function phi , it's a function of the block at time t and the block at time t minu on .
the block is anchor and n on and two .
and then i look at pixel around n on and two indic by m on and m two .
which belong to thi origin indic by calligraph n .
so , xt minu <num> is at the same locat , but i'm look at the displac , d1 d2 , that will make these two block at t and t minu <num> either similar , in which case i try to maxim thi function , or dissimilar , in which case i try to minim thi function .
so thi function again we map the intens valu into an arrow here which is a function of the displac d on d two .
what ar some exampl of thi function fie .
i can us a correl function as a measur of similar between block or regent .
and then again in that case i try to max the correl , or i can us an error function , such as the min squar error .
or the min absolut error , or , or min absolut differ .
in the latter case , the function look like thi , right ?
so i have again the error function of d1 , d2 .
and i'm just look at the differ between the block .
and i just take the absolut valu of thi differ .
clearli if i us the m a e or m a d criterion it's simpler from a comput point of view sinc i don't need to perform the squar of the arrow .
the requir accuraci of the estim motion depend on the applic for exampl , for most of the applic , we mention thei'll give track , filter , interpol , human comput interact .
the accuraci of the estim motion should be as high as possibl .
if , howev , the motion is us for compress , then we can trade accuraci of the motion for comput of time .
we'll see all these aspect in detail when we talk about video compress .
motion estim is actual computation intens part of ani video encod .
so the first step toward trade accuraci for comput is to restrict the cell's region in the refer frame .
as you recal , block match consist of take a block in the current frame , and try to match it to a block in the refer frame .
we show the locat of thi block .
so here is the block in the current frame and let's assum that the center of thi block is at locat n1 and <num> .
and we show the locat of the block in the the refer frame so the center of thi is n1 and <num> .
so if i consid possibl locat of the blue block in the current frame in the refer frame shown here in yellow , then we refer to thi as exhaust search .
so if the frame sai m by n pixel , then i need to perform m time n match comparison and find the best match of the blue block in the current frame to ani of the locat .
shown in yellow in the refer frame .
it is reason to assum that the motion of the object in thi scene as compar to the frame rate is such that the object can travel onli so far .
or in other word the motion vector can be arbitrarili so long .
so it the video is at <num> frame per second then within on thirtieth of a second the distanc between two frame , the object can travel , so mani pixel in the scene .
we therefor constrain the search within a search region as shown here .
the search region is clearli a function of the resolut of the frame .
so , if the search region is k by l pixel , then the number of match comparison is now k by l and again depend on the size of the search it can result in major comput save .
even after we restrict the search within the search region , we would like to further reduc the number of comput by not perform comparison at all possibl posit on the the search region .
so , on wai to do so is shown here and will show addit wai , exampl of addit wai in the slide that follow .
so show here the search region , which is of cours in the refer frame .
and with on we show the center of the block in the current frame , and thi is the point n on and two as indic in the previou slide .
so if we were to consid all locat of the search region , we would need to bring the center of the block of the current frame that we tri to match at all these vertic and find a match crit , base on a match criteria , find a match metric and we can assum for the time be that we us anoth criteria .
instead of do thi , we first consid the grid locat number on here , so the center of the block again , of the current frame will be brought here at on and thi error will be evalu .
after that i would consid the eight neighbor of on , also number on and shown here in blue .
and i would evalu the error at these eight addit locat .
and let us assum that the minimum of the error wa found at the locat here , indic in red .
after that , i'll consid the eight neighbor of the pixel number on where the mean wa found , so i'll consid the eight neighbor number two and let us assum that the mean wa found at thi locat .
at which point i'll repeat thi step , i'll consid the eight neighbor of two , which ar number <num> i'll look for the minimum , assum the minimum wa at thi locat and therefor the motion vector associ with the block center at n on and two in the current frame is the on shown here .
let us hit now why thi search is call logarithm search .
so let's denot here the ax like thi , and let's assum that the size of the search region is from thi point here minu b zero .
to p <num> , and from <num> minu p to <num> p .
so the cell's region ha size two p plu on by two p plu on and then let's denot by k the log of p , log base two , and let's take the ceil here .
so for thi specif exampl i show here , p equal <num> , therefor thi is a <num> by <num> pixel search region .
and also k equal <num> .
so if we follow here the step that were shown the first pixel we consid were at thi distanc d<num> , and d<num> is equal to 2k minu <num> .
so , it's k equal <num> so thi is four pixel d on right ?
so , follow the step that i describ the distanc , here after the first on wa found .
let's sai thi is d <num> .
d <num> is d on over two is therefor is two k minu two .
thi distanc here is d three and d three is d two over two therefor is two k minu on .
and we stop at the point where the distanc is equal to on pixel .
so , therefor we take k step in thi process , and sinc k is the logarith of p , where p again is half the dimens of the search region , thi is call the logarithm search .
the 2d logarithm search we just describ is meaning , sinc at each step we ar look at the direct of reduc the error , so we ar descend on the error function .
the step we take in thi descend direct ar half at each step .
so it's inde a smart wai to visit the pixel locat in the search region .
and if the error function were convex then we would obtain the global minimum within the search region .
so we show here the match arrow as an on dimension function of the displac .
and with a big here convex function it ha a global minimum at thi point , and again thi tubular logarithm search would attain thi point shown here .
in practic of cours we have no no idea of how thi match area function would look like and most probabl it's a non convex function and here's an exampl of a noncomplex error function , match error function .
and if that case , clearli , we mai get stuck in on of the local minima .
and therefor we won't get the best possibl solut , the smallest margin error within the search region .
anoth wai to reduc comput is instead of us all the pixel insid the block to find the error , be it the mean squar error or the mean absolut error , we onli us on fourth , <num> of the pixel at each place .
so here for exampl you see an eight by eight block we tri to match .
and in on locat the red pixel number on ar us and the next locat the blue pixel number two ar us and so on .
again thi method intuit make sens .
but on can alwai come up with exampl for which thi method will fail to obtain the global minimum .
and thi method can be us with a search region , or without a search region .
so in other word , when a global search is perform .
and yet as a final exampl of a method for reduc comput is shown here , again for an <num> by <num> block we would like to match .
instead of us all <num> pixel valu in the evalu of the match error , the project of the row , as shown here , so the sum of the invest valu in each row , as well as the project of the column , the sum of the valu along the column i us .
so , in thi particular exampl instead of compar sixti four number for find the error .
we compar onli sixti number , and clearli there's some major reduct comput .
so we saw with the previou techniqu that on can us fewer search locat and all of your pixel in comput the match error .
a scheme that combin these two featur is refer to as the hierarch search method .
so , we make sever lower resolut version of both the current and refer frame .
as shown here .
the frame is first low pass filter .
then down sampl by a factor of <num> .
we continu with anoth low pass filter , anoth down sampl by <num> .
and we can keep go thi wai .
so here we see a three level represent of estim .
so , we start perform motion estim at thi lower level us ani of the techniqu that we have cover so far .
sinc the resolut at thi level is consider reduc we could perform global search , for exampl in order to obtain an accur estim .
the estim vector is here multipli by in each direct , in the x and y direct .
and it is defin at thi higher level .
the estim vector is multipli by <num> again , and serv as initi condit for the estim of the highest level here , of thi three level , again the present of the frame .
and then from thi highest level , the motion vector , the overal , the final motion vector is , produc .
thi approach is be us quit often .
sinc it provid improv motion estim result .
it might suffer from the illumin of small object , due to the down someth .
on the other hand , the lopu field ring provid some immun to nois .
conceptu , also the lopu field ring filter not onli the intens , but the dfd , the displac frame differ or the error , base on the compens so that the error function is forcibl convexifi at the lower level .
and therefor , a global minimum can be found at thi lower level , even , with on of the first method .
it should be clear by now that the block match method we describ in the previou slide provid pixel or pel accur motion vector .
so here's an exampl of such a vector and thi mean that both the tail of the vector and the head of the vector ar locat on the locat of the view point .
veri often we ar interest in motion vector with sub pixel accuraci .
for exampl in compress sub panel motion estim is provid sizabl compress improv over full panel motion estim .
so a wai to obtain halfwai accur motion vector is shown here .
after the best vector at full resolut is found as shown again here by thi exampl , thi vector , we consid the <num> neighbor of thi pixel here at half pel resolut .
so these x's here ar locat for which the intens valu of the imag is not known .
the intens valu is known onli at these squar locat .
and therefor in perform now block match at thi half the locat the intens divid of the imag , of the two imag both of the refer and the current frame need to be interpol .
and on can us bi linear interpret or ani interpol kernel to find thi non exist valu .
so with half pel interpol , if the minimum is found at thi point , then thi is now the half pel accur motion vector .
clearli want to continu with thi process to obtain quarter pel accur motion vector , on eight pel .
i could motion vector and so on .
it's also mention here that the optic flow techniqu that would be present next provid real estim of the mushroom vector .
so real accuraci not integ , not integ valu sinc the result of solv a set of linear equat .
we show here an experiment comparison of some of the block match techniqu we've discuss so far .
after some current frame ar shown first , both of which ar seven twenti by four eighti pixel .
we then show that the displac frame differ which is , can be thought of as the motion compens error when the motion vector ar equal to zero .
it's note here that in the frame differ , the dynam rang of the imag doubl , so the intens in the origin frame rang from <num> to <num> , sinc eight bit for pixel ar us .
and the intens and the frame differ rang from minu <num> to plu <num> .
and what is shown here , thei have been map linearli into the <num> to <num> rang .
so minu <num> is repres by black , like , for exampl , here .
zero is repres by grai valu , and plu <num> by white .
it is clear from thi imag that there is energi , there ar non zero valu , where the object ar move .
these ar tempor edg , so the ball is move , for exampl , the arm and hand of the player ar move there is howev non zero energi , non zero valu also where it come to stationari object , such as the tabl here .
you see that the edg of the tabl here is non grai , is non zero valu as well as the calendar on the wall .
and thi is becaus there is a pan motion motion of the camera with respect to the scene .
so there's global as well as local motion in thi particular scene .
us a block match algorithm with <num> by <num> block and full search we obtain the result shown here .
we see that most valu ar equal to zero grade valu as expect .
thi is , by the wai , the best result we can obtain under the specif motion model we ar us .
we see , howev , that not all valu ar zero .
especi around the move arm and hand of the player .
so full search should have given us a zero compens or predict error .
howev , the result ar as good as the motion model we ar us .
a main compon in thi , motion model is that all the pixel in the block un , un , undergo the same motion .
and thi model assumpt is clearli violat at motion boundari , mayb for exampl here , where part of the block belong to a move object while the other part of the blog belong to thi stationari background .
we see the result next .
the displai frame differ when logarithm search is us .
the displai frame differ is now greater as expect .
sinc we have trade comput speed for accuraci .
final we show the result of the three level hierarch search , the displai frame differ is .
now as almost as good as full search and better than result we obtain with logarithm search .
appar the lobi filter that is perform ha been offici effect as alreadi mention .
if the motion estim is perform for track applic or filter applic then full search under thi model should be the search of the approach of choic .
if howev , we ar perform motion estim compens for video compress applic , then we can afford trade accuraci of the motion for speed of implement .
and in that case , becaus in that case we have to send the , the displac frame differ shown here , as will becom clear when we cover video compress , so the other approach , such as the logarithm search , or the three level hierarch search , ar definit , some of the choic on my exercis .
in differ part of the cours , we will be make us of the softwar packag name vcdemo .
with thi , we'll be abl to explor the possibl of compress for both still imag and video .
the packag can be download at thi url here and it is the result of the work of the inform of the commun theori group at delft univers of psycholog in the netherland .
you see here a snapshot of the user interfac .
thi demo is complet manual driven so no program experi is necessari .
through the user interfac , the user can control the variou paramet that will control the variou compress scheme that we will be studi .
so again we make us throughout the cours of thi packag and right now we would like to us it to demonstr the result of block base match motion estim .
there is no us vc demo to demonstr block match base motion estim .
so after we start the softwar we can go here to open an imag sequenc .
we see quit a few yub sequenc .
let's sai we pick thi on .
so here we see the freez frame of the sequenc .
here we have a video player modul so if i press plai we'll see all twenti on frame of thi video sequenc .
each frame ha resolut , <num> by <num> .
and again , there ar <num> frame in the sequenc .
so go here we can invok the motion estim modul .
and then thi interfac come up .
we have quit a few choic .
the first is whether we're go to us hierarch motion estim or not .
not so .
either we pick origin solut onli or a two level or three level hierarch .
when then have a choic of the search method .
we can do full search or on time or n step logarithm search .
we have a choic of the block size , it can be two by two all the wai to <num> by <num> .
let's sai we pick eight by eight .
then we choos the size of the search region , so it's <num> by <num> that's the maximum displac that we will allow and final we can step through the motion estim frame by frame or we can let the system run on it's own .
so if we press appli , we see here four in total window so the upper right on show us the frame differ the bottom left show us the vector field on it's <num> by <num> block and the bottom right show us the displac frame differ .
again grai repres zero , black minu to <num> white plu to <num> , clearli the motion compens frame differ bottom right is is closer to zero than the frame differ .
and actual , thi also can be seen here by the statist on the right .
you see the frame number , and then the varianc of the origin frame , the frame differ and the motion compens frame differ .
so by and larg the , there li the varianc decreas when i look at the frame differ , and it further decreas when i look at the motion compens frame differ .
thi is the predict error , of thi , the whole idea behind predict error that the varianc decreas .
the last column show the entropi of the vector field .
we'll spend quit some time talk about these these , these issu and by and larg the entropi is proport to the number of beat i would need to repres the vector field .
so i can press here show again .
and see thi short video repeat and demonstr the effect .
by the wai , it should be clear here that i have both global as well as local motion to do the motion of the car .
and thi is reflect by the motion vector .
ideal , it should be a veri smooth motion field but due to the reason that the model break down we see that it is probabl not as smooth as can be desir .
so thi hopefulli demonstr to all of you these idea we've just been explain here in differ word and differ wai and of cours you ar encourag to just download thi packag and experi at your own time , at your own leisur and just pai attent to all the valu aspect we detail here .
welcom back .
we describ in thi segment motion estim techniqu which reli on the comput of both spatial gradient within a video frame , and tempor gradient across frame .
thei repres in some sens the confirm that in order to be abl to estim the motion of an object across frame we need both strong spacial edg , that will defin the object as well as tempor edg , that will indic that there is inde motion in the scene .
imagin an object of a solid color move in a background of the same solid color , clearli no motion can be perceiv or estim in thi case .
we deriv the optic flow equat , and discuss variou form for solv it .
we see that we need the assumpt that the pixel in the neighborhood ar undergo the same motion .
an import assumpt that we also made when we discuss block or region match algorithm .
we investig two form of the algorithm .
the non recurs , and the recurs version .
with the second approach , in principl no motion vector need to be transmit from the encod to the decod in a video compress scenario .
but instead , the coder would regener the motion vector that were estim by the encod .
special tempor grade techniqu ar wide us , especi when advanc motion field is requir .
so , let us proce with the coverag of thi interest and import materi .
although all the method we have been discuss so far ar base on the estim of the optic flow , we look here at anoth approach to estim it , that is tradition refer to as the optic flow equat .
we start with the same assumpt as befor .
that is , the bright of a pixel or an object , it remain the same in go from on frame to anoth frame .
so if i observ a certain intens of a pixel at the current frame , at time tau , i expect to find the same intens at the refer frame , at time zero .
translat , howev by u in the on dimens , and v in the other dimens .
so , thi is the constant bright constraint and the q translat assumpt .
without lack of gener i arbitrarili move the time mark to the refer frame , so here i start at time zero .
i also chang the visual notat so intens's now denot by i , and i us thi three variabl notat for the spatial and tempor coordin .
the object clearli is to estim the translat compon , u and v .
so the step i take ar to expand the intens at the current frame around the point x y in the refer frame .
and here i show that taylor seri expans us onli the first order term , while omit here the higher order term .
sinc thi two term ar equal , due to the constant bright constraint , thei cancel out , and therefor what i'm left with is thi equat , where i have substitut the partial deriv in the x direct by ix , the partial in the y direct by iy and the tempor partial by it .
if i divid everyth by tau , then i end up with thi form of the optic flow equat , where now v of x and vy denot veloc , veloc .
so thi is a special tempor gradient equat .
it relat , spatial deriv , ix and iy , to a tempor deriv .
and the object , again , is to solv for vx now and vy .
i have two unknown and on equat .
and therefor i have infinit mani solut in gener .
so i need to take an addit step to be abl to find a mean , a meaning solut .
in order to avoid the problem i just mention , which is have two unknown and onli on equat .
i do a similar thing to what we did when we talk about the block match , origin match .
that is , we assum that there is a neighborhood of pixel .
that thei all undergo the same motion .
so the pixel locat is indic here by q1 , q2 , qn .
so littl n pixel in thi neighborhood .
then for each pixel locat i write optic flow equat .
so thi is the spatial deliveri at the x direct at the pixel locat q1 .
spacial deriv of the intens deriv in the y direct again at pixel q1 .
and thi is the tempor deriv at pixel locat q1 .
so i do thi same thing .
these ar the optic flow equat for the locat q <num> , all the wai to the locat q n .
if n is equal <num> , then i have two equat in two unknown .
and if n is greater than <num> , i have an undetermin system of equat .
typic i choos n greater than <num> so that i accommod nois issu and i get the more robust solut that wai .
i can write thi system of equat in matrix vector form , that is i can stuck here .
the spatial index of q1 , spatial index direct of q2 , spatial index direct of qn , spatial in the y direct q1 , y direct q2 , y direct qn , so thi is the matrix .
it's an n by <num> matrix that will multipli the unknown vx , vy , and thi is equal to the templ deriv , q1 , q2 , all the wai to qn .
so n by <num> , <num> by <num> , and thi embr <num> .
so if i call the matrix of special deriv a the vector unknown x , and the vector of tempor deriv is b .
i have the equat ax equal b .
thi is a standard invers problem .
we know a .
we know b .
and try to find x , or , invers problem in the sens that , i have a system that describ by a , x is the input , b is the output .
and know the output i try to invert the process and go back and find the input .
so it is a problem that ha been studi extens in the literatur , and we will be studi it also in quit some detail when we cover imag restor .
so for exampl , on solut to thi problem is the minimum norm least squar solut .
also call normal equat if a transpos a is an invert matrix then i can find my solut , the displac vector field as x equal a transpos a invers , a transpos b .
if not invert i can then us the gener invers .
if a transpos a is not invert we add thi term here , lambda c transpos c , thi is refer to as a regular solut .
and the net result is that now thi whole matrix is invert .
so therefor thi a solut .
and anoth wai to look at it is that through thi regular we pose a smooth constraint .
on the vector filter on the solut we ar after .
thi is , if thi is not clear at thi point don't worri we ar go to spend quit some time analyz thi constrain squar solut when we talk about imag restor .
i'd like also to mention here that if we ar in a flat region and try to estim the motion , then these spatial deriv ar go to be zero , as well as these tempor deriv .
so in flat region the matrix a and the vector b ar <num> , veri close to <num> , and therefor it's hard to find a solut , ani solut would satisfi the a x equal b equat .
therefor it's veri import when you do motion estim that edg , ar present and edg mean that the special deriv ar definit not go to be <num> .
and thi is the same comment can be made actual when we talk about block match .
in match two perfectli flat region that can be match everywher thei ar seen .
and strong gaug is there for a veri import , for motion estim .
there ar differ version of the so call pel recurs algorithm .
let us discuss on version of them here .
thei also us the optic flow equat and therefor , spatial tempor deriv ar comput as you'll see , right awai .
the notat we us here in thi light is slightli differ than the on i us befor .
the main characterist of thi algorithm is that thei have a predict and a correct part of the displac vector field that i'm after .
so start again with a constant bright constraint , that is , the ambient light ha not chang .
and therefor a pixel of a given intens can be found in both frame under consider .
so at time t , i'm consid a pixel here at thi locat r .
the intens of thi pixel is i r t .
and i tri to find the locat of thi pixel , at the previou frame .
the frame at time t minu <num> .
and the locat of thi pixel is go to be at r minu d as shown here .
so the pixel denot by x at fry , at frame t can be found at frame t minu <num> , it's also denot by x .
and it's thi vector d that i'm interest in find , becaus it will , again , tell me exactli where thi pixel can be found at , at the previou frame .
i will denot r minu d , by r bar here , and therefor the equat is go to look like thi .
so r , i of r t , is go to be equal to i of r bar t minu <num> .
we assum that we have an initi estim of , of the displac field which we'll denot by d of i .
and thi is shown here .
so somebodi gave us thi initi estim , and of cours we'll discuss how we can find thi initi estim .
and then , sinc i have d of i the object now is to find the correct .
the differ between the true d and my initi estim , which i denot by u here .
becaus if i know u , i can go from my initi estim , i can correct .
it is a correct term , u , that will allow me to go from my initi estim to the true solut d .
so we have convert the initi problem of solv for d here , to the problem of solv for the correct term u , that will correct my initi estim d of i , and bring me again to the true displac which we denot here by d .
we form now the displac frame differ delta , which is a function of r .
thi is the point at which you ar interest in find the motion vector , and u , thi correct term , base on the initi estim of the motion d of i .
so the displac frame differ is the tempor deriv between the intens at thi point , and the point over here , which is denot like thi .
and it's base on the initi estim of the motion vector d of i .
so the displac frame differ again , is the tempor deriv along the motion trajectori , base on the initi estim of the motion .
we perform now a taylor seri expans of thi point we just indic around thi point , which is indic like thi .
here the first order term and the high order term ar model as an arrow term .
now sinc u is smaller than d , base on a good initi estim of the motion vector , then by keep just the first order of time here , i provid the better approxim to thi intens .
as compar to the case we cover when we discuss about the optic flow , that the taylor seri expans wa done with respect to d .
base on the constant bright constraint , thi term here is equal to i r , t .
and then if we look at the displac frame differ which equal thi if i combin these two term .
take the differ .
thi will give me the displac frame differ .
we end up therefor with thi form of the optic flow equat .
here is again is the tempor deriv along the predict motion trajectori .
these ar the special deriv and thi is again the arrow term .
so as discuss previous when you're deriv the optic flow equat i have here on equat and two unknown .
and therefor i need to us addit equat in order to be abl to provid an estim for the unknown the , the vector field .
as done previous the wai to address thi is to assum that the pixel in the neighborhood of the pixel under consider ar undergo exactli the same motion .
so i can therefor deriv thi equat here , optic flow equat for all the pixel in thi neighborhood .
in thi case , howev , the neighborhood i'm consid contain onli past pixel .
pixel for which i have estim alreadi their motion , base on a particular order to , to scan imag .
so , if i assum that i us a raster scan of the imag , i go on row then i return .
i cover the second row , and so on .
then the neighborhood i us , here an exampl of thi neighborhood is shown here .
thi is refer to as a non symmetr half plane .
clearli again , assum a raster scan of the imag , for these pixel here shown as solid dot , i have alreadi estim their motion vector .
so we can assum that that's how the motion vector that i have estim for these pixel look like .
so us these alreadi estim motion vector , i can provid an accur initi estim for the motion vector for the pixel under consider at locat r .
for exampl , i can us the averag of the motion vector in thi neighborhood to find d of i .
or i can us a weight averag , or a model base , an auto regress model that model these vector and provid a good initi estim , of the motion vector for the locat r .
so there ar two import differ in deriv thi form of the optic flow equat as compar to the on we deriv a few slide earlier .
the first on is that the neighborhood that a model to be undergo the same motion now , allow a recurs , here's the shape , it's such a shape that it allow the recurs comput , of the motion vector .
and , an exampl is shown here through thi , we call it nonsymmetr half plane .
and thi allow me to obtain a good initi estim d of i of a vector field , which then form an optic flow equat here that will solv for the updat u of the , of the vector field .
and clearli , we see from the equat here that u equal d minu d of i .
such a pel recurs algorithm is us in case such as video compress when the motion field , need to be encod and transmit from the encod to the decod .
clearli , if a pel recurs algorithm is , is us , the decod can perform the same oper in estim the motion as the encod doe .
and therefor , the motion vector do not need to be encod and transmit from the encod to the decod .
we show here on the left , the frame differ .
for thi sequenc that's in effect with the trebl white sequenc .
and to the right we show the displac frame differ obtain , with a pel recurs algorithm we just describ .
again , sinc the frame differ , or the displac frame differ have doubl the dynam rang of the origin imag , <num> is repr , repres minu <num> , grai repres <num> and wide repres cluster <num> .
so we see that the displai frame differ most valu ar grai therefor equal to zero , except for the boundari of move object or these ar the tempor edg .
which repres the difficult part in ani motion estim .
that's were the model of assum that all the pixel in the neighborhood is move the same is violat .
thi howev a veri good result becaus again thi dfd is veri close to zero .
we show here two differ version of the dens motion field .
that wa obtain us the pel recurs algorithm , and thi motion field wa us to gener the displai strain differ that wa shown in the previou slide .
so thi is dens , which mean there's on vector per pixel .
and the gener observ here is that the , the motion vector on the right , by and larg ar smoother than the motion vector shown on thi imag on the left .
we also see that these motion vector captur well .
thei see , again thi is the zoom version so here is the , the head , part of the head of here ar the shoulder .
and we see that the motion vector clearli , clearli delin the , the motion boundari , the background is stationari , so these vector should all be , out here should be ideal exact equal to <num> .
while the torso and the head of the person is move and therefor we have non zero motion vector .
the strategi with featur base method is to concentr the comput on area of the imag , where it's possibl to get good correspond .
and then from thi , an initi estim of a camera geometri is obtain .
thi geometri is then us to guid correspond in region of the imag where there is less inform .
so here's an exampl of two imag .
the motion between the view is a rotat about the camera center .
so featur ar extract , shown here in yellow .
and thei're us to comput the imag mat , match relat .
these relat ar due to the camera motion alon , not due to motion in the scene .
so about <num> featur point ar detect in each of these two imag .
there is consider work in the literatur on extract good featur point in an imag .
we want featur point that ar of low dimension , inform , robust transform , such as translat , rotat and degrad .
harri corner , ar on type of featur point , and these ar the on that we will us for the exampl shown here but also sift , surf ar some of the other name of featur point .
featur ar also us for the imag queri base retriev .
where an imag is present to a databas , and the problem becom either the determin of whether the imag is in the databas or the retriev of similar imag .
so , final here you the establish correspond between these two imag .
but about half the featur point that were extract in thi imag , about <num> point out of the <num> featur point that were extract .
welcom back there ar too mani reason we ar consid color .
the first on is that color is a power descriptor that can be us for variou task .
such as segment , object detect , track and identif .
the second on is that human can distinguish thousand of color shade and intens as compar to about onli two dozen shade of grai .
in thi segment we first discuss the characterist of light .
base on the absorpt characterist of light , we defin the color red green blue and the secondari color of cyan magenta and yellow .
we also discuss the primari color of pigment , which ar cyan magenta and yellow , and the secondari color of pigment , which ar rgb .
we defin the color distinguish characterist of bright , hue and satur .
after that , we discuss color model , which allow us to specifi color in some standard and gener accept wai .
we describ the most commonli encount model of rbg , smy , hsi , and ycbcr .
we also briefli address the independ versu joint color process approach .
for the variou aspect of our discuss , we also show some explain the exampl .
so let us proce with thi last excit and color segment of week four .
the us of color in imag and video process is motiv by two primari reason .
the first on is that color is a power descriptor .
which can be us for variou task such as segment , object detect , track , and identif .
you will see exampl of these as we move along .
the second reason is that human can distinguish thousand of color shade and intens as compar to about onli two dozen shade of grei or grei scale imag .
for these two reason color is an import attribut in imag and video process and we just want to cover some of the basic properti and basic wai to present color in thi segment .
issac newton in the mid 17th centuri discov that when a beam of light pass through a glass prism .
the light that come out is not white but consist of instead of a continu spectrum of color , rang from violet and the on end to red at the other end .
so , i show in thi figur that the color spectrum mai be divid into six broad region ; violet , blue , green , yellow , orang and red .
no color in the spectrum end abruptli , but instead each color blend smoothli into the next on .
the color you perceiv of an object ha to do with the natur of the light reflect by the object .
if the object , for exampl , appear green .
then the object absorb the energi in all region of the visibl part of the electromagnet spectrum except in thi rang <num> to <num> nanomet .
in which the light is reflect by the object .
light can be character as achromat , without color .
in which case the onli attribut of achromat light is intens or the amount of light .
or it can be character as chromat .
with color .
in thi case , the characterist ar the radianc , which is the total amount of energi that flow from the light sourc , and it's measur in watt .
it's also character by lumin .
which is the perceiv amount of energi , and the unit is lumen .
so , for exampl , if energi is emit in the far infrar region , it might have a lot of energi , a lot of radianc , but it is hardli perceiv by the viewer , and therefor it lumin is zero .
and it's also character by bright .
thi is hard to measur and it includ the achromat notion of intens and by and larg bright is us to describ color sensat .
cone in the ey ar respons for color vision .
there about six to seven million cone .
it ha been found experiment that the cone can be divid into three principl sens categori which correspond roughli to the rgb .
categori .
so , <num> of the cone ar sensit to red .
<num> of the cone ar sensit to the green light .
and the remain <num> ar sensit to look at thi new categori of light .
although the blue cone ar the most sensit on .
so thi figur show the averag experiment curv that deal with the absorpt of light by the rgb cone in the ey .
due to these absorpt characterist of the human ey .
color ar seen as variabl combin of the so call primari color , the lgb .
for , the purpos of standard , thi bodi cie , which stand for .
commiss intern de l'eclairag design in <num> the three primari color .
for the blue at <num> nanomet , for the green <num> nanomet and for the red <num> nanomet .
the standard wa set befor the experiment gap that ar shown here becam avail and thi is why thei're thi discrep .
we see here that the absorpt of the blue peak at <num> .
while the design by cie wa at <num> and so on and so forth .
so rgb ar the primari color , but if we think of thi standard color at these fix frequenc either thi on or thi on it doesn't matter these fix frequenc cannot gener the visibl color .
the interpret of primari color is correct if we allow the wavelength also to vari as shown by the gap here .
the three primari color we just mention , rgb can be ad to produc the secondari color which ar the cyan , magenta , and yellow .
if we mix the three primari color we'll obtain white .
we'll also obtain white if we mix a secondari color with it opposit primari color .
so , magenta is the secondari color , and the opposit primari color is green .
so , thi is again the intersect between magenta and green .
it's the white color .
so thi is the addit model of the color .
and it us for exampl in color televis , when we us crt or a flat panel .
thi is an exampl where we have separ gun for rgb and it that combin .
that will allow the gener of more possibl of color .
the primari color of pigment is defin as on that subtract or absorb the primari color of light and reflector transmit the other two , so .
for exampl , cyan equal <num> minu red , we assum here that all the valu ar normal in the zero to <num> rang .
so if we have a surfac that is coat by pure cyan , then thi surfac it reflect light that doe not contain red so red is absorb .
so the primari color of pigment ar the magenta , cyan , yellow and the secondari color ar red , green and blue .
a proper combin of these three pigment primari , gener black .
and black is also gener if i combin a secondari such as green .
with it opposit primari , which is magenta .
and thi is refer also as the subtract model of color .
here the distinguish characterist of color .
the first on is bright which we also show a coupl of slide earlier .
as we said there it is hard to measur but it's us to describ color sensat .
the second characterist is hue .
it indic the domin wave length in thi mixtur of light wave and the third on is satur .
it tell us about the rel puriti of the color or the amount of white light that is mix with the hue .
the pure spectrum color ar fulli satur color such as pink , which is a combin of red and white is less satur , and in gener the degre of satur is invers proport to the amount of white light that is desend .
so if we add a littl bit of white light then it's .
quit satur you had a lot of light that the grei separ is much less .
the amount of rgb to follow particular color ar call the tristimulu valu and ar denot by capit x , y , z .
the color is then specifi by it's trichomat coeffici in order by lower case x , y , z .
we can obtain the trichromat coeffici accord to these relationship .
so littl x is the proport to big x with respect to the sum of the tristimulu valu .
realli if we adopt the trichromat coeffici thei add up to on .
so given a wavelength of light in the visibl spectrum .
the tristimulu valu that ar need to produc the color that correspond to thi wavelength can be obtain direct either from curv or from tabl that can be combin from extens experiment result .
anoth approach is to us the cie chromat diagram , shown here , which show that chemic composit as function of x in the horizont axi .
which repres red and y in the vertic axi which repres green .
clearli the valu of z which repres blue is can be found from thi relationship is often the relationship down here .
the point mark green here is about <num> green , <num> red and the remain remain <num> blue .
the variou spectrum color from the violet down here , at about <num> nanomet to red at <num> .
nanomet ar locat on the boundari of thi tongu shape diagram here .
these ar the pure color in the spectrum as we discuss earlier and ani point not of the boundari but within the diagram repres a mixtur of spectral color .
the point of equal energi here correspond to equal fraction of the three primari color repres the cie , standard for white light .
ani point of the boundari of thi chromat chart is fulli satur .
as the point leav the boundari and approach thi point of equal energi , more white light is ad to thi point and therefor it becom less satur .
and the satur of thi point of equal energi is equal to zero .
the purpos of the color model which is also call a color space or a color system , is to facilit the specif of color in some standard and gener accept wai .
so a color model specifi a coordin system and a subspac within that system where each color is repres by a singl point .
the lead model in imag and video process ar the rgb , red green blue model , which is suitabl to describ color monitor and video camera .
the cyan magenta yellow , and cyan magenta yellow and black .
cmyk for black which is suitabl model for color print .
the hsi hue satur intens model , which correspond close with the wai human describ and interpret color , and also the yuv and ycbcr model which is us primarili for beta compress applic .
the actual model is base on the cartesian coordin system .
the algebra primari color ar these corner , red , green and blue .
the secondari color ar these other corner , cyan .
and magenta , yellow , white is at thi corner and black at the origin .
the point of equal rgb extend from the black point to the white point so these ar the grei scale valu of equal rgb .
here is the <num> bit color cube the surfac of it .
<num> to the <num> is equal to <num> , <num> , <num> differ color .
as alreadi discuss cyan magenta yellow ar the secondari color of light or the primari color of pigment .
so when for exampl a surfac is coat with cyan pigment and is illumin with white light , no red light is reflect from the surfac , and cyan is <num> minu .
spread in thi equat we assum all the valu ar normal in the zero to on rang , right .
so cyan equal on minu red .
so in principl equal amount sod cmy should produc black but in practic thei produc a kind of muddi look black .
so becaus of that a fourth color ha been ad the black color we note by k and thi give rise to the cmyk color model .
the hsi model the coupl intens compon from the color carri inform .
it's an ideal tool for develop imag process algorithm base on color descript that ar natur and intuit to human .
there non linear express which allow us to go from rgb to hsi and back .
it can be found in most text and imag process , such as the on by gonzal and wood .
instead of us the equat here let's try , let's try to get the feel about the exercis space .
in thi figur we see the primari and secondari color .
we've seen thi figur actual multipl time alreadi .
while thi figur , we see the hue , the ag compon of the first on .
the grai valu in thi figur correspond to angl , so red , for exampl , correspond to <num> degre angl and therefor is black .
so here's the red and it correspond to angl zero degre and it's in all black .
in thi figur we see the satur compon of the origin imag here .
clearli the primari color ar fulli satur shown here in white .
all the valu here ar critic map in the zero to <num> rang .
and final here we see the i compon , the intens valu which ar actual these valu on third of the sum of the rgb valu , ye .
so with a model like thi on can manipul directli and independ the h or s or i compon and thi wai on can chang the individu color .
thi is a famili of color model .
where the lumin compon y is separ from the chromin compon .
yub is us by the pal , ntsc and secam color video standard .
so y is again the lumin compon .
relat to that is the y iq .
y the lumin i the int phase and q the quadratur compon come from a modul scheme .
iq ar linearli relat to uv , and then ycbcr y get the lumin and these ar the differenti chromium compon . thi is combin out of itu bt . <num> and it is scale and offset version of yuv .
the linear relationship relat these three color model , and each on of them to the rgb color model .
here ar the equat for the ycbcr bt <num> recommend .
we see that the luminesc compon is <num> due to the green channel .
channel , <num> to the red and <num> to the b and again these ar the differenti blue and red channel .
clearli sinc there is a linear relationship between ycbcr and rgb , i can solv for rgb in term of ycbcr .
these ar the , the formula us by jpeg convers .
and , in gener , the rgb valu for an eight bit imag ar in thi rang , and the chromin and lumin compon ar forc in thi rang .
so due to the fact again that lumin is separ from chromin veri often when process an imag that isn't preserv by thi model we might carri the process .
in , with respect to the y compon , while not process the chrominu compon , and just ad them to the process y compon .
for exampl , when we prefer motion estim , we util the y compon onli , the lumin compon .
and the motion vector that ar found ar also util to motion compens the chrominu compon .
we consid here , a color imag , and chose the composit or represent util the differ color space we just cover .
thi is sun rise over lake michigan here in a cold winter .
thi is just south of the north western campu .
we see here the rgb compon of the color imag .
there is a lot of red here where the sun is rise .
so you see high intens valu .
the green channel come veri close to repres the intens imag or the grai scale version of the color imag .
we see here the cyan , magenta , yellow compon of the origin color imag .
these compon ar the neg , so the rgb compon so for exampl cyan is equal to <num> minu red .
so where the sun is rise , zing we get high red valu and we get veri low close to zero cyan valu .
we see here the hsi compon of the origin color imag .
so thi is the intens , it's the grai scale version you might sai of the origin color imag , while the hue and situat ar the the color element or the color compon of the origin imag .
so we have thi separ between lumin intens and common .
and here we show the lumin y and the differenti color compon cbncr .
so thi is again the grei scale imag it relat to the i imag of the previou slide and also to the green of the rgb the composit .
thi is a differ wai to separ lumin and chromin then the hsi represent system .
the advantag you might sai of ycbcr is that there's a linear transform between rgb and ycbcr .
while the transform from hsi to igb is a nonlinear on .
in process color imag and video , the first step is to choos the appropri color space is base on the analysi and the discuss in thi segment .
the second decis is whether to process each channel , thi represent independ or jointli .
most of the work in the literatur , it's perform by process is each channel independ and thei call channel the rgb or yuv for exampl plane or represent of the color imag .
and therefor there is no distinct you might sai between grayscal imag process algorithm and the color imag process algorithm .
in the sens again but when we deal with color we appli the same algorithm to us for the grai scale imag three time independ to each of the three channel .
altern on can util a multi channel now process so , in mani case gain ar to be held by capit of the correl and complementari inform convei by the variou color compon of the variou channel .
so for exampl , in imag compress , the standard approach is to find the motion by work with the white compon .
out of the video in the ycbcr re composit .
then the same motion is appli to the chrominu compon .
work ha been done and show that on can formul a motion estim problem by work with the three by on vector , where the rgb for exampl , compon from thi three by on vector .
and by enlarg , more accur , motion estim can be found thi wai .
anoth exampl and to touch a bit of that when we talk about restor when we do multi channel process again .
we try to capit on the between channel correl and the pose for , for exampl the cross channel smooth as well as within channel smooth .
we show here simpl exampl where rgb and hsi filter is compar .
so thi is a bled version of the origin .
you show earlier a <num> by <num> flat filter wa us in embed thi imag and each of the channel the rg and b channel wa filter separ .
here is the imag you obtain when we consid the hsi side of present and onli the i compon born in the intens compon wa filter by thi same filter .
while the h and s compon were unalt and and just wa were combin with the i compon .
thi two imag look indistinguish and we try to quantifi that by find i think the differ between the two , and thi is the error , grai , is equal to zero and it's almost ident , the two imag .
so thi is simpl exampl clearli which demonstr that if thi filter in a similar oper is what we ar interest in .
then it would make sens to util the hsi represent and feed it on , the i channel instead of three channel the rgb channel .
so , we have reach the end of week four .
dure thi week we learn some of the basic techniqu for estim the motion for each pixel or a group of pixel in a video frame , and also wai to repres a color imag in video .
some of the motion estim techniqu ar more intuit and easier to explain than other .
so for exampl the block match or origin match techniqu which is wide us if not exclus for video compress .
might be the first idea that come to everybodi's mind if you spend a few minut think about the problem .
the fine implement of detail can alwai be work out later the phase correl or the registr approach is ar rather intuit clear and thei ar base on a simpl properti of the fulli transform that we cover in week there .
the special tempor gradian method on the other hand seem to stem from mathemat manipul take the approxim , and ar not intuit straight forward , at least at first .
at the end , howev , similar consider with the block match techniqu ar take place , that is the model assumpt that origin pixel is experienc the same motion sinc techniqu ar also us wide , especi when a dens motion field is requir .
we also talk about primari and secondari color of light , and pigment .
and , we also discuss variou model to repres color .
we describ the most commonli encount on , that is lgb , cmy , hsi , and .
yuv , y the vcr .
we know now that there ar differ choic brought in repres as well as process in color video .
the materi of thi week is by in larg , not as demand as the materi from week two and three .
if howev you do not feel <num> confid about absolut everyth cover thi week , do not worri .
we can still us the final motion estim algorithm we deriv in a rather straight forward manner or perform a transform from on color space to anoth .
clearli we'll be make us of motion estim in variou part of the cours .
especi when we cover video compress .
similarli , most data we process nowadai ar inde in color .
next week we'll cover an easili explain and understand and fun to plai with topic in imag and video process that of enhanc .
so , see you all next week .
hello , and welcom back .
it's hard to believ we ar alreadi done with <num> 3rd of the cours .
on of your classmat suggest in the forum that i welcom you onc or at least onc i guess in greek .
so carlo thi is go to be a fun week .
imag and video enhanc is a fun topic .
on of the challeng part of the cours is over and you might sai there will be smooth sail move forward .
while some topic mai be more mathemat than other most of the topic we will follow ar applic driven and probabl not as demand as the materi of week two and three .
it ha been a fun a topic becaus we learn a set of tool , but we can util right awai .
and which will allow us to in a sens with imag and video .
on top of that , we will be the judg of how good and pleas the enhanc imag is .
so , base on the tool we learn thi week , we can carri out and try your favorit enhanc techniqu on an imag .
and if you ar not happi with the result , you can chang or kill the paramet which control the perform of the techniqu .
or just try anoth compet enhanc techniqu altogeth until you ar satisfi with the result .
it's a fun topic becaus it's veri intuit and rather straightforward to understand , or at least the better part of it .
enhanc is certainli on of those process , that it is us everywher at all time .
you don't like how an imag look .
well , let's enhanc it .
actual , all imag process softwar packag includ a good number of enhanc modul in their repertoir .
so , dure thi week .
we'll introduc the topic of enhanc and distinguish it from the topic of restor , which you will cover dure week six and seven .
we will then first cover point wise transform of the intens of an imag .
thei're base on a gener object such as dredg the contrast of an imag .
or by analyz the imag and more specif it histogram .
impos an object on the histogram .
such as equal it and then , deriv the pointwis inform of intens valu .
after that , we'll cover transform of the intens valu of the imag base on the properti of the neighborhood of a pixel .
perform both by an elastic system that we discuss in week two and three .
but also by an origin filter .
we will then cover techniqu which allow the imag to look sharper .
a specif techniqu for reduc the dynam rang .
while at the same time increas the local contrast of an imag through homomorph filter .
the notion of ad color to a black and white imag , and final some simpl notion of enhanc a video sequenc .
so , let us start thi excit week with an introductori segment where the distinct between imag enhanc and recoveri is made .
we'll cover thi week imag enhanc , but in the follow week we'll be cover imag recoveri .
it is therefor worthwhil draw the distinct between these two relat topic .
with enhanc , the object is to manipul or transfer an imag so that it's us or visual appear is increas .
no explicit determin is made of how thi increas in us or visual appear will be measur .
with restor or recoveri , we ar model the degrad the imag is subject to .
and our object is to remov thi degrad .
and therefor recov some of the inform that wa lost base on an optim criteria so there ar two import step that ar involv .
the model and the determin of an optim criterion base on which the degrad is remov .
let us now look at some exampl .
the first on is the modif of the intens valu of an imag so that the contrast is increas .
sinc no model of the degrad is involv , at least explicitli .
and no optim criterion is determin , base on which the quanta will be increas .
thi is definit an enhanc approach .
the second exampl is deconvolut .
in thi problem the degrad is model as the convolut of the origin imag with impuls respons of the degrad system .
so in other word the degrad system is linear and spatial invari as we learn earlier .
and the object is to undo thi effect of the degrad system or deconvolv the imag base on an optim criteria .
so thi is there for certainli restor problem .
the third exampl is inpaint .
as you'll see , the degrad in , in the thi case , remov the intens valu of the pixel in the part of , of the imag .
and the object is to estim these miss valu .
so , if thi estim is done without determin and optim criterion , just do an oper that simpli make sens .
then we have an enhanc problem .
if , on the other hand , the impaint procedur depend on an optim criterion .
then we have a recoveri problem .
so , thi would be either enhanc or recoveri .
in thi class , we'll present , talk about inpaint as a recoveri problem .
and the final exampl is the smooth or remov of nois in an imag .
thi problem also can be either an enhanc or a restor problem .
depend on whether the nois characterist ar model and also whether a specif comput criteria is defin .
we'll cover actual nois smooth in thi class both as an enhanc and as a restor problem .
it should be note here that thi distinct between enhanc and restor is here to guid our present of the variou oper .
and also to guid our thought process when we're try an imag process problem .
is not here to somehow erect solid wall between these two topic .
and somehow penal somebodi , if enhanc techniqu is call a restor techniqu or the other wai around .
here is a summari of some of the main characterist of imag enhanc algorithm .
there ar no theoret guidelin in approach an enhanc problem .
each enhanc problem and the criteria for enhanc ar typic subject .
we want to increas the visual qualiti of an imag , for exampl , but each viewer typic ha a differ qualiti norm in their mind or in their ey .
each of us , most probabl we have a differ prefer when we're present with process version of an imag .
and led us to find which on ha the best qualiti .
thi criteria might even be to complex to convert them to us object criteria .
becaus of that , the enhanc algorithm ar qualit and ad hoc .
thei kind of make sens and in most case thei work well , but thei ar also applic depend .
a differ transform of the intens might be perform if a user is to evalu the imag .
or if thi imag is input to an object detect or an object track or classif system .
final , coupl with the previou comment , the evalu of the effect of the enhanc algorithm should also be applic depend .
again , if the enhanc imag is intend for a human viewer , or for a classifi the the criteria for evalu it effect should be fair .
so enhanc techniqu in gener ar easi to understand .
and thei've been veri us and veri wide us .
and the larg number of them ar actual implement in softwar packag .
so we will present a number of techniqu next .
and show exampl of where after enhanc the imag is more pleas to look at .
or it provid addit inform to a classifi or an object recogn or write system .
we'll also see exampl where featur or object in an imag that were not not visibl befor enhanc ar now visibl after enhanc .
so let us now look at some of these enhanc approach .
the imag enhanc topic we'll be cover of thi class ar point wise intens transform .
that ar defin ahead of time to suit our purpos toward enhanc an imag .
point wise intes transform , that result from object we impos on the histogram of the imag .
spatial filter , both linear and spatial l variant , and non linear .
we'll see exampl for filter for nois smooth , sharpen , homomorph filter .
applic of psuedo color and some exampl on video enhanc .
let us proce now with the first topic on the list .
welcom back .
what we will learn in thi segment is how to defin the appropri function or map that will take each and everi intens valu of the input imag , and map it onto an appropri intens valu in the output imag , at the same spatial locat .
so that our object of an enhanc imag is fulfil .
we will discuss , for exampl , how to take the neg of an imag , or for what object we might need to appli the logarithm transform to an imag or it discret fourier transform or appli the power law transform .
on applic of the latter is gamma correct , which we will discuss in some detail .
we'll also discuss how to stretch the contrast or increas the dynam rang of an imag .
final , we will discuss how to slice or extract a rang of intens valu in the imag , which if done appropri will better highlight the import featur in the imag .
we'll actual perform the slice not on the intens valu , directli , but on the bit plane of the binari represent of each intens valu .
the materi of the segment repres simpl tool , which , howev , can prove to be veri power in visual an imag or provid the enhanc imag as input to anoth process step , such as pattern match or recognit .
so let us then proce with the coverag of thi fun materi .
so let us look first at point wise intens transform .
we ar oper directli on the intens valu of an imag , but we ar process each big cell separ and independ of the valu of the neighbor big cell .
so the gener express for thi transform is shown here x n1 and <num> is the intens of eight pixel at the input imag and y n1 and <num> is intens of the output imag at exactli the same fixtur locat .
for emphasi with the subsequ point here a distanc format here to again indic thi fact that i onli need on intens valu , on pixel locat at the input to find the intens valu at the correspond pixel locat at the output .
a more gener case , you might sai , is when now x and y ar not scalar , but ar vector .
so thi is the case for exampl when i deal with the calori much .
so x is a vector , with three by on vector , for exampl , the rgb channel of the input imag and the rgb channel of the output imag .
actual here we might have case where let's sai x is a vector but y is a scalar .
so i transform on color imag into a grai scale imag and the other wai around , x is a scalar and y is a vector .
so i'm do pseudo color .
i'm turn a black and white imag into a color imag .
the gener you might sai of both these express is shown here .
so first of all , n here is a vector .
three by on or four by on vector , if i'm deal with a three dimension or four dimension imag .
and also x and y ar shown here as vector .
we're understand as alreadi explain , that not both of them need to be vector .
on of them can be vector and the other a scaler to cover the case i just describ .
now thi point wise intens transform can be linear or piecewis linear or in gener can be non linear .
and we ar go to see exampl of all of these case in what follow .
let's look at some exampl of point wise transform here .
first of all , on the horizont axi , we have the intens valu of the input imag .
thei rang from <num> to <num> .
assum that we're us <num> bit per pixel .
thi howev without lack of gener if more bit ar us then their rang chang .
on the vertic axi similarli we have the intens valu of the output imag also rang form <num> to <num> .
so the first transform we see here is the ident transform , indic by thi diagon .
it doe absolut noth to the intens valu of the input imag .
thei ar map exactli the same into the output imag .
the second linear transform is the neg transform , it map the valu <num> to <num> and the valu <num> of the input imag to <num> .
so it give us the analog between a neg film and the print for those of you that ar old enough to rememb film .
then i have the log transform in red and the nth root transform in thi solid blue .
what digit transform that lie abov the diagon ar do is thei expand the low intens valu of the imag while thei compress the high intens valu .
so if we look at the log transform for exampl , then clearli thi rang of input valu , low intens valu ar map into much larger rang of output valu .
therefor , we have thi expans .
the remaind of the valu here , the higher valu ar map into the much smaller rang of valu of the output , therefor we have thi compress .
let's look now at the two transform non linear transform that ar below the diagon .
we have the invers log here .
and the nth power transform indic by thi curv .
so , the transform below the diagon do the revers of the transform abov the diagon .
in other word , thei compress the low intens valu while thei expand the higher intens valu .
and thi can be seen , let's sai with the invers log here thi rang of valu of the input imag is map into a much smaller rang of valu of the output imag .
while thi small rang valu , high intens valu of the input ar map into a much larger rang of valu at the output imag .
so , low intens valu ar compress , high intens valu ar expand .
let us now look at some exampl of these transform .
here is an exampl of the neg transform of the intens of an imag .
here is the posit imag and here is the neg imag .
thi is a ct scan , of the ruptur abdomin aortic aneurysm .
so it's ruptur aaa , as it's typic refer to .
so the aneurysm is thi balloon , thi dilat of the aorta .
if it exce a certain diamet it's call an aneurysm , so here it's a ruptur aorta shown here , while the second arrow here indic the free flow of blood .
so for the specialist , the neg imag might provid a better visual of the condit , or be more us in the sens that certain condit can be easier to be diagnos .
let us look now at an exampl of the applic of the logarithm transform to an imag .
here is the mathemat express of the transform .
i take the log of the input intens and y of n is the output intens .
we ar ad thi valu of on here , so that the log is defin .
sinc log of <num> is minu infin , by ad <num> for that case when x of n is <num> log of <num> is equal to <num> .
in addit clearli now the output of the log is a non neg number .
we have also thi multipl factor here , c , to kind of adjust thi transform .
on of the import applic of thi log transform is when we want to displai fourier spectra .
here is a endoscop imag .
and here is the magnitud of it discreet fourier transform .
we can hardli see anyth , there is onli a non zero point here .
thi is actual the center of the spectrum , so thi is the <num> , <num> point .
so what happen clearli is that there is a larg valu or a few larg valu around <num> , <num> , while the rest of the valu of the spectrum ar , ar veri small .
so when i map thi rang of intens linearli into the <num> to <num> rang , so that thei can displai it here the small valu becom veri , veri small , veri close to <num> , and the larg valu map to <num> .
so , it's the wide spot i see here in the center .
so , instead of displai the magnitud in a linear fashion as i explain , if we take the log of the magnitud of the dft , we see the imag here .
so clearli there's consider more inform of cours i see the <num> , <num> frequenc here in the center is still displai , but due to the fact that the low intens were expand , thei're now visibl .
and the high intens were compress now so thei can know now all these intens can feed into thi <num> to <num> rang .
i us the output imag for displai purpos and clearli visual there is consider more inform in thi imag than in thi on .
medic speak the same valu exist in both imag , but again for displai or visual purpos , thi log transform improv the qualiti of the imag consider .
the power law transform is depict here again on the horizont axi ar the intens valu of the input imag .
thei rang from <num> to l minu <num> , so if k bit per pixel us to repres the intens valu , then <num> to the k equal l .
similarli on the vertic axi we show the intens of the valu of the output imag .
the mathemat express for the power law transform is shown here .
so the output valu equal a constant time the input valu rais to a power , to the expon there is denot by gamma .
the graph shown here ar for c equal <num> .
so therefor gamma is equal <num> , and you have a straight line here along the diagon .
so thi is the ident transform , it map the intens valu of the input imag to the output imag with absolut no chang .
for gamma less than <num> we have the curv abov the diagon gamma greater than <num> becom below the diagon .
for gamma less than <num> , we have the similar behavior we had , let's sai with the logarithm function .
that is small intens valu of the input ar expand , while high intens valu ar compress in go from the input to the output imag .
the revers take place for gamma , greater than on .
if a right of devic is us for imag captur , print and displai respond accord to thi power law .
sinc , by convent , the expon of the power law is a gamma is denot by a gamma .
the process us to correct the power law phenomena is refer to as the gamma correct .
so for displai devic , the relationship between the input voltag or current and the intens follow thi power law .
so , we can have intens that's a displai intens equal the input voltag rais to the gamma power .
sinc the gamma is in gener , differ for each devic thi is the reason that the intens and the color of an imag might look differ on differ monitor or on or when it is project on a screen .
we show here an exampl of gamma correct .
here is an origin imag , it's , it's an intens ramp .
so the intens increas as you go from left to the right , that you would like to displai on a monitor .
the gamma of the monitor is <num> and therefor the displai imag look like thi .
rais each valu to the power of <num> compress the rang of small valu and expand the higher valu , so the end result is thi darker look imag .
our object is that the displai imag on the monitor look veri similar , exactli the same ideal to the origin on .
so , if befor send it to the monitor we correct the imag with a gamma which is equal to <num> over <num> which is equal to <num> , <num> .
then , thi imag go to the monitor will appear as shown here .
thi is the correct imag and in thi particular case sinc we know exactli the gamma of the monitor we're abl to perfectli correct for thi gamma and therefor the origin here and correct imag , imag ar ident .
the challeng clearli in practic is to find the exact valu of the gamma of the monitor or the displai devic in gener , or the project devic .
here's anoth exampl of the applic of the power law transform to an imag .
thi is an imag obtain by the hubbl space telescop of the ring nebula .
thi imag is rather dark and in some sens it should remind you of the specter that we talk about earlier .
so we would like to transform it , so that more inform is visibl .
and if we appli the power law transform with a gamma equal to <num> , then as we know the low intens valu will be expand and the high will be compress and here is the result of thi transform , so clearli , a lot of the small intens valu ar now visibl .
and thi , again , should remind you of the log transform we perform to the spectrum of an imag .
thi is yet anoth exampl of the applic of the power law transform to an imag .
we see , here , an imag that ha thi appear of be too bright , or too light .
therefor we would like to transform it and make it look darker .
thi by the wai the engin build here at northwestern back in the 40s when the , when lake michigan wa come all the wai to the front of the build .
we know therefor that to make thi imag look darker the gamma we should appli should be greater than <num> , and if we us gamma equal to <num> then the transform imag look like thi .
so thi is an imag that probabl is more pleas or it balanc the intens better than the origin on , but again , thi is an enhanc problem .
we have no object criterion that we're optim and obtain the enhanc imag .
we're given an imag like thi and would like to enhanc it .
so what's wrong with thi imag ?
it's too dark .
it's hard to see bright spot .
it seem like detail ar hidden under thi dark .
so i want to stretch it contrast , and we want to do that in a linear wai .
i just want to us a linear function , a straight line to do so .
so what on can do is just , take the input , the imag thi input imag and find the minimum and maximum valu .
so xmin and xmax and then map thi to the full rang of the output imag , so the output re imag will have intens from <num> let's write it in gener <num> to the b minu <num> , so b bit per pixel ar us .
so <num> bit , thi is <num> to <num> .
and then we would like to map the maximum valu of the input imag to 2b minu <num> and the minimum valu to <num> .
so therefor we would like to map accord to thi straight line here .
the equat of thi straight line is given here .
it's straight forward to defin thi equat .
and , if i us thi linear map on the input imag , what we obtain is thi output imag .
so , clearli the xmax of the input is now map to <num> , thi is an <num> bit imag , so the highest possibl valu .
so , you can see clear white now .
and you have stretch , you've map a smaller region of the input here to a larger rang of output valu .
so we have stretch the dynam rang or the contrast of thi imag .
so , certainli , visual there is consider more inform that can be observ in the process the imag over here , the enhanc imag .
here is yet anoth exampl of imag enhanc it come under the name of dynam rang expans .
we call the previou on contrast stretch .
thei all express that the same idea .
so again , what's wrong with thi imag , it's dark , it's hard to see detail .
it's hard to see chang , differ between black and white .
so in thi case i'm allow to us a transform that it is piecewis linear .
so if i us thi transform of thi imag , so it ha three piec , thi transform linear piec , and we see that i compress the low intens valu , as well as the high intens valu .
while i expand the valu in the middl , right ?
so the rang <num> to <num> wa map to the rang of intens valu <num> to <num> in the output imag .
so if i appli thi transform i obtain thi imag here .
so it's clear that the definit of the cloud in the sky is much more pronounc and clear now , the wave here and the wide wave and so on , it's a much more inform imag as well as more pleas to see .
so a piecewis linear transform like thi i have two control point thi on and thi on , and by adjust them appropri i can observ the effect of thi transform on ani input imag .
ideal you'd like to have a , an interfac here that will allow you to dynam adjust again digit control point and for each posit , see the output imag and of cours keep the resolv that it is the most inform , the most pleas to the viewer .
anoth piecewis linear transform is intens level slice .
in thi case we ar interest in highlight or enhanc a certain rang of intens valu of the input imag .
applic mai includ enhanc featur in satellit imageri such as mass of water , lake , river or enhanc the flaw in an x rai imag .
two approach to do so ar shown here .
so here on the left we map a rang of valu of the input imag into a specif level , thi level let's sai a here which could be equal to <num> .
while the rest of the input intens ar map to thi valu b , which could be <num> as well .
so clearli in thi case a binari imag is gener .
with the second approach shown here , a similar approach is taken when it come to the rang of valu of interest .
that , these , these ar rang of valu we want to enhanc or highlight .
howev , for the rest of the valu we keep them unchang .
so thi is the ident transform that suppli to them .
we shown exampl of the intens level slice enhanc techniqu on thi angiogram imag .
so with the transform as shown here in how the imag is normal between <num> and <num> , and then the rang of valu between <num> and <num> . <num> .
let's sai thi is <num> , thi is <num> . <num> , these valu ar go to be map to <num> and the rest will be equal to <num> .
so thi is the transform that wa appli to thi imag and the result is thi on .
it can be argu that some of the blood vessel ar easier to pull out , to pick up in thi intens level slice imag .
we can also obtain thi imag by appli the same transform , but now the background valu remain , remain unchang .
so , so thi is the <num> , <num> , point , then , we pull out the valu between <num> again , <num> . <num> .
but the remain of the valu remain unchang .
and again , the same comment can be made here , but for the spacial is possibl addit inform can be perceiv by look at either thi or thi imag than that the origin on .
instead of highlight intens level rang , we can highlight the contribut made to the total imag appear by specif bit .
so if we consid an <num> bit imag , it can be consid as be compos of <num> <num> bit plane .
bit plane <num> here form by the least signific bit , all the wai to bit plane <num> form by the most signific bit .
clearli each of these plane be in on big plane is a binari plane .
it onli ha two valu .
let us now see an exampl of how these differ bit plane manifest themselv .
we show here an <num> bit grai scale imag of an <num> bill .
the <num> binari plane that can be deriv from thi i have shown here .
so thi is the bit plane on , bit plane two , three , four , five , six , seven , and eight .
it should be clear that the two or three higher order bit plane contain a signific amount of the visual import inform .
on the other hand , the lower order bit plane contribut to more subtl intens detail in the imag .
we can actual obtain thi bit plane <num> here .
by binar directli the origin imag , by map the intens valu from <num> to <num> to <num> , and the valu <num> to <num> to <num> , if we do solv thi binari imag will dissolv .
thi decomposit also ti to compress , that we'll be discuss later .
in the sens that it demonstr which of the bit ar import toward preserv the origin appear of , of the imag or which plane ar import in reconstruct the origin imag .
so , for exampl , and let's look at the next slide .
so we show here the construct by us the bit plane <num> and <num> , the construct is done by multipli the big cell of the nth plane .
so nth plane is multipli by <num> to the n minu <num> , so big cell in bit plane <num> ar multipli by <num> .
bit plane <num> then multipli by <num> and then the result ar ad up to obtain thi imag shown here .
let's compar it to actual to the origin imag .
so it's clear that the main featur of the origin imag ar restor .
howev , the reconstruct imag look rather flat , especi in the background .
and also there's thi fals contour appear in it .
thi is not surpris becaus the two plane that were us can onli produc four differ intens valu .
so if we add on more plane , so now we're us plane <num> , <num> , and <num> , we see that now the reconstruct imag look consider closer to the origin on .
and by ad also bit plane <num> we can sai that these two imag ar almost indistinguish .
actual ad more plane will not help and from that we can conclud that <num> bit in the imag convei all the us inform about the origin imag and then sinc we were us <num> out of <num> bit we ar achiev a <num> compress .
welcom back .
the histogram of an imag repres a distribut of the intens valu of the imag .
a normal histogram actual can be thought of as the probabl densiti function of a random signal .
by look at the histogram of an imag , we cannot deduc the structur of the imag , but we can infer whether the imag is dark or light or it ha a small dynam rang .
in mani applic the imag is design to have a histogram of a certain shape so as to , for exampl , be more easili be compar to anoth imag .
the most frequent encount shape of the histogram is that of a flat or equal histogram , which mean that all intens in the imag ar repres equal .
such an imag should also definit have a more pleas appear .
what you will learn in thi segment is how to deriv the point wise oper that we need to perform on the intens valu of the imag .
so that the enhanc imag ha a flat or equal histogram .
we'll also discuss local histogram equal .
so , let us proce with thi interest topic .
we proce next with histogram process , focus specif on histogram equal .
an import quantiti for an imag is it's histogram .
is defin as h of k equal the number of pixel with valu k .
so , if i have an eight bit imag , the valu rang from from <num> to <num> .
i can go and count how mai pixel have the valu zero , how mani pixel have the valu <num> , that would be <num> of <num> , how mani have the valu <num> and so on .
so , given an imag such as thi on , here is it histogram .
the horizont axi is k .
the rang of the intens valu , thi is an eight bit imag so <num> to <num> and on the vertic axi a , the valu of h of k .
the histogram clearli tell me how the intens valu of the origin imag ar distribut .
so , for thi particular imag , there ar no small intens valu .
then there is a peak , a lot of intens valu around , let's sai <num> .
there's anoth smaller peak here , let's sai at <num> .
and there ar no intens valu higher than about thi point , let's sai it's <num> .
and thi is no surpris .
look at the imag , it's a dark imag .
a lot of small valu and veri few high valu .
so , again , the histogram give me the distribut of the intens valu of the imag , and as a matter of fact , if i take h of k and divid by the number of pixel in the imag , then each valu is less than on .
the sum of all the valu or the area under thi curv here is equal to <num> .
and we can think of , therefor , the histogram as the probabl densiti function of the intens valu .
so , with respect to enhanc , the idea now is not to manipul the intens valu directli , but to manipul the histogram directli .
i'm bring thi exampl , thi contrast stretch exampl back to put thing in context , now that we talk about the histogram .
if you recal , we start with thi imag on the left and then we realiz that thi is a dark imag and we defin the transform shown here .
we found the minimum and maximum valu of thi imag on the left and then we map them from <num> to <num> in the output imag , so the transform , we appli the liner transform is given by curv .
and thi , again , is the output imag .
now , while oper on the intens on at time , independ of the neighborhood , we were also clearli modifi the histogram of the imag indirectli .
so , thi is the histogram of the first imag , again , it's a dark imag , so most of the intens ar concentr around low valu , and there ar almost no intens here of high intens valu .
and with thi transform , clearli we expand the rang of intens valu , so there ar more bright valu here .
so with the , we'd expect that the result histogram of the process imag is spread out somehow .
and inde , if we look at it , it look like thi .
so , while the intens valu were stop around <num> or so here , we see that there ar now high intens valu that were gener in the process imag .
so , with the point wise oper that we cover so far , on ha some evalu of the imag , like again , thi on is dark and then defin the transform to be appli on the imag , independ of the specif valu of the imag .
with histogram process , we ar look at the histogram of the input imag and then we ar place an object on the histogram itself .
we ar sai , for exampl , that thei want to transform the histogram of the input imag to anoth type of histogram , or , as we'll see , what is most commonli done , i want to equal the histogram .
i want to turn the histogram of the input imag into a flat histogram .
and then thi object will determin the transform here that i should be appli on the input imag to obtain the output imag .
so again , now that transform is defin , indirect in some sens , by process the imag through the evalu of hi , of it histogram .
and it's not set kind of a priori by okai , i want thi straight line to be appli to the input imag .
so , thi is a major differ between histogram process and intens point wise transform .
at the end , with histogram process , i'm also go to appli a point wise transform to the input imag , but for exampl , let's sai thi transform is the result on that i need to appli to the input imag to get , the output on .
so , with that in mind , let's proce with some exampl of , histogram process .
of the histogram process approach , histogram equal is the most commonli encount on .
the object , in thi , in thi case , is to obtain an imag with a flat histogram .
thi wai , all intens in the imag ar equal repres .
or in probabilist term , all intens ar equal probabl .
there mai be variou reason for requir a , an equal histogram .
on is that we expect that an imag with an equal histogram it will look better , it will be more pleas .
all intens , again , will be equal repres so there'll be low intens , and middl intens , and high intens in the imag .
anoth reason is that when i want to compar two imag , it make sens to first equal them .
equal the histogram so that then the , the comparison will becom , will be on an equal foot , will be , becom meaning .
here ar , we ar go through step we have to take toward thi object .
the first step is to normal the histogram , by do so , as alreadi mention , the valu of the histogram becom probabl .
i chang the notat slightli here , so p of x of i is the probabl that the intens x is equal to i .
and thi is equal to the number of pixel that have intens i , divid by the total number of pixel in the imag , m time n .
so , thi number is clearli less than <num> .
and more than that , if i add up all these probabl , their sum is equal to <num> .
i sum up over the rang of intens here .
these intens rang from <num> to l minu <num> .
so , thi is the probabl densiti function .
then , the algorithm step i have to take ar , the first on is , i have to form thi capit p of x sub i function , which is the sum of the probabl from intens <num> to i .
so the valu of p of x at i is thi sum from <num> to i .
thi is actual a cumul distribut function .
and thi is the function i will us now to perform thi point wise transform of the intens valu of the imag .
so , the transform is shown here .
x of n is the input imag , so thi is on intens valu .
the intens of the input imag at locat n .
n1 and n2 , thi is a vector .
so , for a given intens , through thi again , cumul distribut function transform , i will obtain the valu of the output imag y tild at the same pixel locat n .
and sinc thi map will give me valu between <num> and <num> , there is on more step , accord to which i take the y tild here , there is an extra parenthesi .
and multipli by l minu <num> , so that again y of n now , the imag with equal histogram , will rang from <num> to l minu <num> .
let's try to get some intuit of why thi transform will work out .
so , let's take the first case when the histogram of the imag is inde flat , so here ar the intens valu rang from <num> to l minu <num> and thi is the probabl of each intens valu i , so all intens ar equal probabl .
so , if form the cumul distribut function for thi p df is go to be a straight line .
and thi is zero , thi is l minu on .
and thi is zero and thi in on .
right ?
and after i multipli the valu here , y tild by l minu <num> , then the valu , again , of y of n ar go to rang from <num> to l minu <num> .
and therefor , the overal transform will be the ident transform .
so , as expect , if the histogram of the imag is alreadi equal , i should not chang anyth , and therefor , i should perform a ident transform .
now , let's look at an imag that ha a histogram that look like thi .
is again , the normal histogram or the pdf .
so , thi mean that thi is a dark imag .
it ha high concentr of low intens valu and no high intens valu .
thi is the maximum valu .
and if i form the cumul distribut of thi .
it's go to roughli look like thi .
thi is on .
thi is l minu <num> up here .
so , sinc there is , there ar a lot of valu here , it's go to rise pretti fast and is go to approach on and stai there becaus there ar no valu of high intens .
so , clearli , a transform like thi will take small intens valu and spread them out over all possibl intens valu .
so , if i appli thi transform to the input imag , then the result imag , base on thi transform , is go to be obvious , an equal imag and it's go to be brighter in term of where i start .
and final , if i have a , an imag that ha normal histogram that look like thi .
thi is go to be a bright imag , it ha a lot of high intens valu and veri few low intens valu and in thi case the transform , the cumul distribut function will look , so let's sai , l minu <num> is here , roughli speak , it will look like thi .
so , it's zero down here and then rise to the valu of on .
so , accord to thi transform , high intens valu here ar map to low intens valu .
so , if i appli thi transform again to the input imag i'll get , then , equal imag .
sinc i deal with discreet valu , i am not guarante that the result histogram is go to be perfectli flat .
thi is the result , howev , that if we were to us continu intens valu , we can prove then , in a rather straightforward wai , that inde , us the cumul distribut function as the point wise transform , on end up with an imag that ha an equal histogram .
now that we cover histogram equal , let's revisit again contrast stretch and histogram equal .
so , we start with thi imag here .
we realiz it's dark , we arbitrarili , in a meaning wai decid that a transform like thi is go to help enhanc thi imag .
so , in , out , <num> here , x min , x max of these imag .
so , we appli thi transform and thi is the result imag .
i see more high densiti valu here due to thi expans , due to thi transform .
now , while thi is happen at the intens domain , the stori at the histogram , let's sai , domain is that thi is the histogram of the imag you start with , and the histogram of the process imag is thi on .
with histogram equal , we start , again , with thi dark imag .
we first look at it histogram .
and then we place an object that the process imag should have a histogram that is flat .
so , we sai that the process imag should have a histogram that look like thi .
base on thi requir , as we alreadi explain , i'm abl to find here the appropri transform .
which is through the cumul distribut function , as we saw , so roughli speak , it will look like thi .
so , thi is <num> here .
and after we appli thi transform , here is the result imag .
thi is a transform defin by us in an intuit wai , and thi is a transform that is defin by the data , the actual data of the imag through thi requir that the histogram is equal .
and there's where the dimens , sinc we deal with discret data , we cannot guarante that the histogram is go to be perfectli flat but it's a close approxim flat .
as anoth exampl of the applic of histogram equal , let's consid the follow imag shown here , thei could be character as dark , light , low contrast and high contrast .
here ar their correspond histogram which agre with the character i gave to these imag .
so , for the dark imag , we see most intens valu ar low , ar concentr at low valu .
for the light on , most intens ar at high valu .
the low contrast on ha a small dynam rang from here to here .
and the high contrast extend the valu from all the rang of intens valu .
after histogram equal , that's how the imag look like .
thei're almost ident .
thei have , ideal their histogram should be perfectli flat , as we mention thei're not perfectli flat , actual thei're shown here and thei just spread the valu all over the rang of valu .
but again , sinc we deal with discret intens , discret signal , we cannot guarante perfectli flat , perfectli flat histogram .
we see that for the last imag , the on we character as high contrast , the histogram wa almost flat .
and therefor , veri littl chang occur to the histogram .
and veri littl chang occur for the intens themselv .
these two imag look veri , veri similar .
so , if we look now at the cumul distribut function , or the transform that wa appli in go from these imag to these imag , then here ar the transform .
so , thei're number .
on correspond to thi imag .
two , three and four .
so , start with four and in accord to the comment thei just made , thi is almost the ident transform .
thi is <num> to <num> here and <num> to <num> , so it's the complet transform , right ?
the histogram , the histogram wa almost flat .
therefor , veri littl chang took place .
with on is the case i describ earlier .
so , it's , a dark imag .
and thi is the transform that will spread the low valu to higher valu .
with the light imag is what i describ earlier as well the histogram is concentr in , at high intens valu , so is thi transform as as the second imag .
and the low contrast is pretti much an exampl we had done earlier that goe through thi transform .
it increas the dynam rang .
it map thi rang of valu over here to the full rang of the output valu <num> to <num> .
so , these transform do not look that differ from what we were appli befor , howev again , the main differ here is that befor we would defin thi transform directli .
we would provid some argument that i need on to expand or to stretch the valu , or to compress them , but now thi transform result from the object of equal the , the histogram and therefor thei're imag depend .
thei cannot , thei ar not defin independ of the intens of the imag but ar function , in essenc , of distribut of the intens valu of the imag .
there ar instanc in which is desir that we enhanc the detail of an imag over a small neighborhood and in that case we can adopt the global histogram equal that we describ previous to a local version of it .
so , as an exampl , here's the origin imag .
and here is it , the imag with it histogram equal , the global histogram equal we have been describ in there so far .
in thi particular case it's not clear if someth ha been gain by equal the histogram of thi imag .
if howev now , we , we equal the histogram local , we obtain an imag like thi .
so , local histogram equal entail the process of three by three neighborhood .
so , we take a three by three neighborhood .
we find the map that will equal the histogram in that neighborhood , but we onli process the pixel in the center of thi three by three neighborhood .
then we move thi three by three window to the next pixel , and we repeat thi process .
so , we see , for thi particular case , there's quit a lot of inform that is reveal , that is not visibl in the origin , or the global histogram equal imag .
so , under each of these kind of squar rectangular patch , you see that there ar specif structur that ar now reveal when i do thi histogram , thi logic histogram equal .
so , thi is someth to keep in mind , thi is a straight forward extens of the histogram equal we just talk about .
it is , again , adapt to the local characterist of the imag .
welcom back .
nois in an imag can origin from the acquisit , process , transmiss , and storag step .
remov nois from an imag is a desir object encount almost everywher imag ar us .
without us an explicit model for the nois other than it is addit and broadband , we can us linear .
and also often special invari filter to remov it .
nois remov is an import topic which can be cast either as an enhanc problem , as we will do in thi segment .
or as a recoveri problem , as we will do in week six and seven .
treat it as an enhanc problem , we ar not provid neither a model for the nois .
nor an explicit metric of optim , base on which a filter is deriv .
so , in thi segment , we'll make us of the materi we cover in week two and three .
and describ and analyz linear and spatial invari filter suitabl for remov nois in imag .
we'll also show a number of experiment result demonstr the effici of such filter .
we will also discuss an exampl of especi vari nois move filter .
so with that , let us proce with thi veri import and us materi .
we'll move next to spatial filter approach toward enhanc .
start with the us of both linear and non linear filter for nois mute .
under the head of smooth special filter , we consid techniqu for enhanc an imag by reduc the nois that might be present .
we assum that the nois is addit .
but sinc these ar enhanc techniqu , no model of the nois is take place .
other than the basic knowledg that the nois might be broadband or , and the salt and pepper type of nois .
which is special case of impuls nois .
in some applic , the nois depend on the imag intens as is the case for exampl in nuclear medic imag .
but thi is not someth that we'll consid here right now .
we will be revisit nois filter when we also talk about recoveri .
so , we'll studi next both linear space invari , as well as nonlinear spatial smooth filter .
let us look first at the us linear and special invari system for perform nois smooth .
the underli model is that the origin imag x is corrupt by addit nois w to give rise to the observ data y .
thi model , howev , is not explicitli us in choos the filter that we will be talk about .
so we want to us an lsi system to feed the nois .
the system will accept y the noisi imag input and will provid an estim of the origin imag x had in it's output .
so h , n1 , n2 is part of a system and base on what we have learn .
the output is simpli the convolut of the input with a impuls respons of the system .
we also know by now that thi oper can be taken to the discret frequenc domain .
in other word , hk1 . k2 is the dft of the input process of the system .
similarli , thi is the dft of the input .
and the dft of the output here can be form by multipli the correspond dft as shown here .
so convolut becom multipl .
we also know , of cours , that if i multipli dft thei have to be of the same size .
what happen in the space shuttl domain is not the linear convolut here .
but the secular convolut between the input and the impuls respons of the system .
we also have learn that if we take the appropri size dft of all the quantiti involv here .
the result of the linear and secular convolut will be the same .
so , in my conclus , we have all the knowledg to perform these filter oper .
either , in the spatial domain or in the discret frequenc domain , correctli choos the appropri size dft .
now if we deriv the form the impuls respons here , h n1 and <num> , base on the optim of an object criterion .
then we're solv a restor problem .
if on the other hand , we try valu form of h n1 and <num> base on our intuit and decid which of those provid with the best result .
then clearli you ar solv an enhanc problem .
at thi point we ar approach the nois smooth problem as an enhanc problem .
so , therefor we'll be look at variou filter at variou type of h n1 and <num> that can provid us with meaning answer .
let us first explain with some , simpl draw what take place in the frequenc domain .
when we ar perform nois smooth with a linear and special invari system .
let us assum here that the signal of interest is the spectrum that look like thi .
so i just show on period of the spectrum i show contin here .
of the signal , i show it in on be it easier to draw .
then , nois is ad to thi signal and the spectral densiti of the nois .
look like thi .
so it's , it's flat from minu pi  to pi  .
and thi is refer to as white nois .
all frequenc ar equal repres insid a signal .
so the nois is ad to the signal .
and , therefor , the result observ noisi signal imag ha a shape like thi .
we take the spectrum and it's kind of put on pedest .
so clearli the object is to work on thi spectrum here , and recov as much as possibl from the origin spectrum of the imag , of the signal .
howev , clearli the nois ha been embed now in the signal so , therefor , we cannot just pull out the nois onli .
so what we do with thi nois smooth filter is to util some shape , some low pass filter in natur .
that will again , allow us to go from here to here or as close as possibl .
so as we'll see , depend on what filter we us , the magnitud of the frequenc respons of the filter ar low pass filter look like thi .
it might have some simpl lobe , so thi is minu pi  , pi  .
and that thi is typic <num> , no gain or loss .
so when i filter , i multipli thi spectrum here with thi frequenc respons of , of the system .
so , if i multipli the two , then , at low frequenc , i will preserv the shape of the signal as much as possibl .
at high frequenc , i will bring the signal closer to <num> to just look as close as possibl to the origin on .
but , by and larg there's a trade off .
i just remov some nois but , the same time , i smooth the signal out .
so , it would be hard to draw freehand here , how exactli the spectrum is go to look like .
but it's , let's sai , go to look someth like thi .
so thi is the spectrum of the estim , signal .
which is the result of the multipl here of the spectrum of the observ signal with the frequenc respons of the signal .
so let's see now in realiti how thi spectra look like when i us a specif imag .
and exampl of thi low pass filter here to smooth out the nois .
and again , sinc thi is an enhanc problem , i do not deriv the shape of the low pass filter here .
base on ani specif model and optim .
but i just us trial and error .
i try thi filter and look at the result .
if i don't like it , i try a differ filter and look at the result .
again , by trial and error i try to converg as to what the best possibl enhanc is for my purpos .
let us look now at the nois filter exampl with a real limit imag .
the cameraman imag is shown here .
it's a <num> by <num> , <num> bit per pixel imag .
the spectrum of the signal is shown here .
so thi is a discret fourier transform of the imag .
we show that <num> log <num> of the magnitud of the spectrum of the vertic axi .
while the other ax show that continu frequenc here from minu pi  to pi  .
so we show the basic period of the dft .
we also show a slice through thi fulli transform , a slice go through here at omega <num> equal <num> .
and the main characterist as alreadi mention that is that thi is the gain spectrum .
the maximum valu found here at <num> .
and do we see that here at high frequenc there ar almost four order of magnitud differ .
let's look now at at the similar situat with a noisi imag .
so nois ha been ad to the camera man imag as shown here , and the correspond quantiti ar show here .
so if i go back and forward between these two slide , you'll see that inde the spectrum is kind of lift .
it's sit on the pedest creat by thi white nois .
so , the object is to oper on thi nois imag and obtain an estim of the origin on .
but again , we don't pose here in , in the optim criteria we just ar go to try differ low pass in natur filter and see what ar the result we're obtain .
for the purpos of thi exampl , we're go to look at flat filter .
thei're call so becaus all the valu in the input support of the filter ar equal .
so here we see a three by three such filter .
so that's the support , three by three , and then again , each valu is the same , is equal to <num> 9th .
so actual there is no gain or loss when thi filter is us .
we can look how thi filter look in the frequenc domain .
so we can take the fulli transform of h1 and h2 and i've done quit a few exampl like that at earlier point .
so the frequenc respons is <num> 9th due to thi term in the middl .
plu these two term , the first here come from the combin of these two sampl .
the on is , will , will give rise to minu j omega <num> .
the other into the plu into the j omega <num> .
i combin them .
i can get the cosin .
then the second term is due to these two sampl , and then there ar two more term .
that result from the combin like thi on .
if it consid these diagon sampl , thi and thi , and so on .
again thi is someth at thi point you should be abl to deriv with not too much effort becaus we studi thi again in an earlier point .
actual there's no surpris that the frequenc respons h omega <num> omega <num> ar the fulli tran form of h n <num> and <num> is real .
becaus h n <num> and <num> is symmetr .
we also see that h <num> <num> here is equal to <num> .
sinc all the cosign of <num> ar equal to <num> .
and then i add up all these term <num> <num> plu <num> plu <num> <num> plu <num> <num> will give me equal to <num> .
so let see how thi and other flat filter with differ region of support .
and what thei look like and what the result we'll be obtain by util them in smooth out the nois of the imag you start with .
we show here the magnitud of the frequenc respons of three flat filter three by three , five by five and seven by seven filter .
and at the bottom , we show the slice of thi transfer through the omega <num> equal <num> posit .
at <num> thei're all equal to <num> .
the log is equal to <num> .
and then we also see that as the support increas , the width of the main log decreas .
so it becom more and more low pass , but qualit speak , as the support of the figur increas .
we show here the filter imag by the three by three flat filter .
the nois as been reduc , but also the imag ha undergon some bleed .
thi is the spectrum of the imag and thi is the slice of the spectrum at omega <num> equal <num> .
so the dc valu here's not chang , howev the higher frequenc have been reduc here .
but also there ha been some chang in the spectrum at lower frequenc .
to better understand exactli what's happen , let's look at the frequenc domain .
so we have here the spectrum of the noisi imag and the correspond slice .
the frequenc respons for the filter and the correspond slice .
the same locat .
in the frequenc domain , i multipli these two spectra .
and what i obtain is the spectrum of the filter imag .
again , thi is equal to <num> .
it log is equal to <num> .
so thi valu ha not chang .
but if you look at the higher frequenc of the nois imag thei have been reduc due to the oper of the filter .
and the mid frequenc here have been alter due to the shape of the filter .
so if thi is the frequenc domain oper of , of , of the filter .
howev thi doe not impli that the implement of the filter should be done or is done in the frequenc domain .
as a matter of fact , sinc thi is a three by three filter here .
rel modest support it make more sens if i implement thi filter through convolut in thi spatial domain .
thi is the result of the five by five flat filter .
the nois ha been further reduc , but the imag is also alter alter is blur .
the correspond spectrum , the correspond slice , now the energi or the valu at high frequenc ar further reduc .
thi is the result of the seven by seven filter .
the imag now look rather blurri .
it spectrum is here , the slice is here .
at the veri low frequenc , the signal is preserv , but certainli ha been out of the mid frequenc .
and ha been out of consider at higher frequenc .
we show here all the filter imag here on the same slide for easier comparison .
so thi is the origin imag the nois imag and the three filter version , and three by three , five by five , and seven by seven flat filter .
so it should be clear that support of the filter increas it becom more low pass , qual , qualit speak .
which mean that the nois is reduc as we move again along thi axi here .
but also the imag becom more blurri .
so , if on were to choos from thi experi the imag to us , the imag that provid the better resolv .
then mayb the on in the middl here would be a good choic .
but , mayb thi on would be fine , as well .
becaus , inde , the imag look the sharpest here , of cours .
but not thi on sinc the imag is rather plain .
so thi again summar thi enhanc nois move approach .
the nois is broadband .
i do not have ani particular descript about it characterist about it probabl densiti function other than that it is broadband .
and therefor , a low pass in natur filter is go to reject the nois , especi at high frequenc , where it domin over the signal .
and then the step ar to try variou filter .
and simpli choos the imag that is more suitabl .
more us when someon look at it or provid thi as input in anoth process step such as classif recognit and so on .
we've shown in previou exampl that while us the nois a desir effect .
we were at the same time blend the imag and undesir effect .
a wai to address thi is introduc spatial adapt to the filter .
so now the filter is not process each and everi pixel the same wai , but it adapt to the local behavior of the imag .
so it chang and ha a differ process , let sai at the edg than in the flat region of the imag .
so an exampl of an especi adapt filter is shown here .
x is an input , the nois imag , and y is the output , the nois to reduc the imag .
x bar here , denot the mean valu or the averag valu , or the result of appli the flat filter .
all these ar synonym , thei express exactli the same thing .
sigma squar of n is the nois varianc , while sigma squar of x l is the local imag varianc .
how is thi evalu ?
we can find the local varianc by process the imag , so for n <num> n <num> in a neighborhood .
we've perform thi .
where the mean again , we know the express .
but i'll write it again here is over <num> over the number of pixel in the neighborhood or the cardin of n .
so again thi is the flat filter or , the mean filter and the exampl we had like if i had a three by three region .
then , thi cardinolog over the number of pixel here is <num> .
so , for the exampl , for it right to solv a three by three flat filter .
so it's <num> over <num> , the sum of the big in it .
i can comput the local imag varianc , sigma of x l squar .
and thei assum that i know the nois varianc .
and of cours , the wai to evalu that as well you can go to the flat region and the mean is due to the imag .
and then we can find the varianc of the nois that wai , for exampl .
so let's see what thi filter is do by look at two situat .
if i'm at an edg , if i'm in an edg neighborhood , then clearli the local signal varianc is much larger nois varianc .
which mean that thi ratio is veri small , goe to <num> and in that case we see that the filter imag .
it's simpli the input imag .
so we did noth to a pixel that belong to an edg becaus we don't want to smooth out averag .
we don't want to smooth the imag .
and actual thi agre with properti of the human visual system accord to which , nois is mask by high frequenc element of the imag .
edg present high spatial frequenc and therefor , nois is not visibl at the edg , while it's visibl in the flat region .
now if , if i'm in the flat area of an imag , of the imag , then the revers is true .
but the signal variant the imag , the imag variant is smaller than the nois variant .
in that case , i have to constrain that thi ratio doe not go doe not greater than <num> .
so we just have to constrain it to be so , put thi equal to <num> .
and in that case , the output of the imag is just the local mean .
so thi spatial adapt filter , it goe from the two extrem case at the edg is the ident filter .
it doe noth to those pixel go through the edg .
while , at the flat region , it perform averag in , local averag in .
and , of cours , in between , it's a combin of a mean filter and the ident filter with the gain here in the , in the front .
so conceptu , what thi filter doe again , it remov nois in the flat region .
while it let , it let's high frequenc inform , let's the edg pixel go unchang from the input to the output of thi filter .
so let's see how a filter like thi perform on a real imag .
here's a noisi imag you would like to enhanc by smooth the nois .
we see that the nois is visibl , especi in the flat region , such as the cloud here , or the sky .
if i appli a three by three flat filter , thi is the result we obtain .
the nois ha been reduc .
if we look again at the same flat region here .
howev , at the same time , if we look at an area like thi , or at the antenna here of thi build .
it's clear that the imag is blur or the resolut ha been decreas .
if i , if we now appli the specialti adapt filter thi is the result we obtain .
the mean filter in thi spatial adapt flat filter wa still a three by three filter .
we found the varianc of the nois in implement the special adapt filter by find the varianc of a flat region in the noisi imag .
like thi area for exampl sinc the signal is flat , the nois is addit .
the varianc i measur is the varianc due to nois .
so here , we have manag to accomplish both object .
on , to reduc the nois .
if we look again at the flat region , it's reduc with respect to the nois imag .
but at the same time , we have manag to preserv the sharp of the imag .
by look again at thi region or thi region it's clear that the imag , thi imag is not blur anymor like thi process imag .
and it reflect veri close the origin , we might just have to do it .
the spatial adapt filter can be adapt in the straightforward wai .
it doe not increas the comput consider .
certainli , we have to evalu the local varianc , which is the extra comput we perform howev , by look at thi it is out , it's definit worthwhil sinc the result of the adapt process is consider improv .
consider better than the result on the non adapt process .
welcom back .
when the nois in an imag is addit , but not broadband , but instead it's impuls , also refer to as data dropout or , and spike nois , then the lsa filter we cover in the previou segment ar not appropri .
if appli , the result imag look wors , sinc the impuls nois is spread out .
a specif form of impuls nois is salt and pepper nois , call so sinc it resembl granul of salt and pepper randomli spread over the imag .
for impuls nois , a class of non linear filter , refer to as order statist filter , ar appropri .
a specif exampl of such filter is the median filter .
we discuss median filter , on dimension , two dimension , multi dimension , and gener , in thi segment and show a number of result of it applic to imag degrad by impuls nois .
we'll also discuss other order statist filter , such as the alpha trim mean filter and non linear filter with mean in their name , but not the arithmet mean filter , which is an lsa filter , and we cover thi in the last segment , but for exampl the geometr mean or the harmon mean filter .
we also show some experiment result when addit broadband and addit impuls nois ar combin .
so let us proce with thi excit materi .
a commonli encount filter in imag enhanc is the median filter let's see how it is defin .
let x be the input imag , y the output imag .
so , the valu of y at locat n1 , n2 can be found by consid a neighborhood around the pixel n1 , n2 of the input imag .
then , take the valu insid thi neighborhood and order them in increas or decreas fashion .
and then pick the middl valu if the number of pixel is odd or the averag of the two middl valu , if the number of pixel is even .
so it's a rather straightforward oper in , in figur out the , the median filter .
let's look at some of the properti .
the filter is non linear .
and thi is straightforward to confirm by util the definit of linear that we gave earlier .
becaus of that , clearli i cannot describ thi filter in the frequenc domain , as wa the case with the min filter we studi earlier .
thi filter is veri us for reduc impuls , or also refer to as salt and pepper nois .
by the wai , thi is also refer to as data drop out or spike nois .
so it's gener if i take a valu of the input imag consid all the valu so that the valu of n1 , n2 .
if it chang to a valu a with probabl p of a and the valu at n1 , n2 chang to valu b with probabl p of b , then if both p of a , p of b ar non zero , we talk about the bipolar type of nois , and salt and pepper is anoth name for that .
typic when a equal to <num> and b equal to zero , and clearli resembl throw salt and pepper granul randomli over the imag , if on of the p of a , p of b is equal to zero , then it's a unipolar nois , and then it can be refer to as salt or pepper , just salt or just pepper nois .
so the median filter , as we'll show right wai with a toi exampl , is again suitabl in remov thi type of nois , while preserv the spacial resolut , not introduc blur , and also preserv the edg .
the filter howev is not veri good if the nois is broadband , as were the case in what we studi earlier , with respect to the min filter .
final , as we'll show with a toi exampl there , the on dimension median ha a better perform in preserv edg in an imag than the two dimension median .
and veri often we'll , we'll implement the two dimension median as a separ oper to on dimension median in the vertic and the horizont direct .
let us look at the applic of a three point on dimension median filter , filter to a simpl signal .
so first of all to find the locat of the output at n we'll consid input valu at locat n , n <num> and n <num> .
so for thi simpl signal here , by look at it we can sai that thi particular valu is noisi .
it doe not fit well with the neighbor valu .
so to find the output of the median filter at thi locat , i consid the valu of the input , <num> , <num> , <num> .
their median is <num> .
so therefor , the nois is elimin .
if i keep process , also i see easili that thi perfect edg here of the input imag's signal is final preserv .
so here is my y of n .
nois is elimin , sharp edg preserv , and thi is the main characterist of the median filter .
we show here a simpl exampl of the applic of a two dimension , now , three by three median filter .
so here is the imag i want to process .
so the solid dot have a valu of on , and the thin dot a valu of zero .
so thi is a perfect three by three squar sit on the zero level around it .
so if i consid the process of thi pixel of the input , then i have to find the median of these valu .
and the median , the valu in the middl , is equal to zero .
so we see that that edg pixel there of the input imag ha been elimin , and thi squar imag of the input will end up be thi cross shape pictur in the output .
so the corner ar distort , ar not preserv , and therefor , we typic prefer to us separ median filter .
so first filter the imag in the vertic direct with a on d median , and then the result imag is filter in the horizont direct by anoth on dimension median .
we see here an exampl of median filter .
here is the origin imag .
here is the noisi on , corrupt by salt and pepper nois .
thi is the result of the applic of a three by three median , and thi is the result of the applic of a five by five median .
in both case , the nois ha been complet elimin , howev , with a five by five median the imag ha been consider blur , and therefor , for thi particular experi the choic , our choic , should be the three by three median .
let us look now at some addit exampl of the applic of median filter .
we show here a color imag .
it's corrupt by salt and pepper nois , and thi nois ha been ad independ to the three color channel , the r , g , and b channel .
<num> of the pixel ar corrupt by salt and pepper nois .
if we first us a nois smooth filter that ha gaussian shape , a five by five filter , then we obtain thi result .
clearli the impuls , the impuls nois ha been spread out by thi nois smooth filter .
and thi doe not seem the appropri filter to be util in thi particular case .
if we now us a median filter , a three by three median filter , then thi is the result we obtain .
clearli , most , if not all , of the spike of the impuls have been remov , while the sharp of the imag ha been maintain .
so we compar the previou result with thi on , it's certainli a major improv .
in thi exampl , we util the same imag again , but the nois is heavier now , <num> of salt and pepper nois .
so if we appli the gaussian filter , thi is the result we obtain .
again , the impuls ar spread around , therefor thi is not the appropri filter to us .
i should mention here that , on on hand , the nois is ad on each color channel separ , and the filter's appli on each color channel separ .
so if i appli now a three by three median filter , thi is the result we obtain .
the nois is almost remov , howev there ar still impuls that can be seen in the process imag .
so in thi particular case we appli the median filter a second time , and thi is the result , further improv , although there ar some impuls around , for exampl here .
and we can appli it on more time , so after the third pass thi is the result .
the impuls nois is almost complet remov .
howev , in each applic of the median filter , there is some blur that occur , that's to , to the imag .
so the , the motiv for thi exampl is just to show the simpl fact that the median filter can be appli multipl time .
if the nois is heavi and is not elimin to a satisfactori degre by the first pass , we can keep repeat it as it wa demonstr through thi exampl .
in addit to the median filter , which you studi in some detail , there ar a number of other filter under the group of order statist filter suitabl primarili for handl impuls type of nois .
thei're call so becaus thei're base on the order of the pixel valu in the neighborhood .
so here's again the express for the median filter , written slightli differ .
so x is the input imag , y the output .
so the valu at n1 , n2 is the result , is the median , of the valu of the input in a neighborhood n which is center at n1 and n2 .
anoth filter in thi famili is the max filter , which find the brightest , the maximum valu , the brightest intens in the neighborhood .
sinc pepper ha low valu it's reduc by thi oper .
it's replac by the maximum valu in the neighborhood , so thi is therefor good for handl pepper type of nois .
the min filter find the darkest point in the neighborhood , the minimum valu , and therefor , thi is good for reduc salt nois .
the mid point combin order statist and averag .
so it is the averag of the maximum and the minimum valu in the neighborhood .
and thi work best for randomli distribut nois like gaussian or uniform .
and final , the alpha trim mean .
so from the , all the pixel in the neighborhood , we delet the alpha over two lowest and alpha over two highest valu .
and then for the remain valu , which number the number of pixel in the neighborhood minu alpha , which i have delet , we find the mean .
so clearli for alpha equal zero we obtain the arithmet mean filter .
while for alpha equal the number of pixel in the neighborhood minu on , we obtain the median filter .
for the other valu of alpha , we obtain filter which ar us for situat that involv multipl type of nois , such as a combin of salt and pepper and gaussian nois .
there's a famili of filter that have the term , mean , in their name .
the first on is arithmet mean filter , which you've studi extens .
we've also been refer to it by the name of averag or flat filter .
x , again , is the input to the filter , and y is the output .
so to find the output valu at n1 , n2 , i'm consid the pixel in the neighborhood n which is center at n1 , n2 .
and then i sum the pixel up in thi neighborhood and divid by that number .
i find the arithmet mean .
so thi here denot the number of pixel in the neighborhood , or the cardin of the set of pixel in the neighborhood n .
the geometr mean filter find the geometr mean of a set of number , so it take the sampl in the neighborhood and multipli them , and then thi is the nth root , where again , thi is the number of pixel in the neighborhood .
the geometr mean filter ha perform compar to the mean , but by and larg tend to lose less detail in the process .
the harmon filter is shown here .
thi doe well with gaussian type of nois and also for salt type of nois but not for pepper type of nois .
the final filter is the contra harmon mean .
q is the order of the filter .
thi filter for q greater than zero elimin pepper type of nois .
and for q less than zero it elimin salt , but not clearli abl to elimin both at the same time .
it is verifi that for q equal zero , i obtain the arithmet mean .
while for q equal minu on , i obtain the harmon mean filter .
with the except of arithmet mean filter , the remain ar non linear filter , and therefor , i cannot realli describ them in the frequenc domain , see their shape in the frequenc domain .
let's look at an exampl now where the imag ha been corrupt by two type of nois .
so thi circuit board imag is corrupt by addit uniform nois , as shown here .
and then on top of that , salt and pepper nois is ad with the result shown here .
so it's a <num> salt and pepper nois .
so we want to appli some of the filter we just discuss to the imag again that ha a combin of these two nois .
and if we us an arithmet mean filter of five by five , we obtain thi result , while a five by five geometr provid thi result .
both result ar realli not that good , not mayb accept , and certainli the on by the geometr mean is not good at all .
now if we appli a five by five median we obtain thi imag , while a five by five alpha trim mean with alpha equal five provid thi result .
so in thi case , both result ar consider better , and quit good .
and on might even sai , by look at the fine detail , that the alpha trim mean is slightli better than the median filter .
again , thi is be an enhanc problem , there ar no guidelin sai which filter and with which paramet is go to provid the better , the best result .
instead we try the variou filter that we have in our ammunit .
we also chang their paramet appropri .
if there is a lot of nois then the support , for exampl , becom larger until we find the result that is accept , either for human appreci or as an input to a followup process step .
welcom back .
veri often we go to concentr the enhanc of an imag at it edg .
we want to leav the rest of the imag unchang , but onli make the edg look sharper .
a sharpen imag typic convei more inform , more detail to the human viewer .
therefor , such class of enhanc techniqu is refer to as sharpen techniqu .
thi is a topic of thi segment in which we'll describ a number of such sharpen techniqu .
we will start with unsharp mask or high boost filter .
the idea is veri straight forward and ha it root in analog photographi .
a blur version of the imag is form , the abstract mask .
which when subtract from the origin imag would provid the high frequenc inform of the imag .
if thi inform , typic , amplifi is ad to the origin imag , a sharpen imag result .
of cours , ani high pass filter can extract such high frequenc inform from an imag .
an exampl of such a high pass filter is the laplacian .
we'll talk about the laplacian with more detail in week <num> , when we talk about segment .
we show , also , the result in which , vari sharpen techniqu ar combin .
so , let us proce with thi veri visual topic .
we'll discuss next the us of spatial filter toward sharpen an imag , which result in an enhanc imag .
thi techniqu ha been us for mani year by the print and publish industri to sharpen imag .
so given an origin imag here or origin signal , we blur it , and thi blur version is the unsharp version of the signal .
subtract it from the origin imag give rise to the unsharp mask .
then thi unsharp mask is ad to the origin imag , result in the sharpen signal .
as describ in the previou slide , in the block diagram of the previou slide .
if x is the origin imag , i blur it and i find what i denot here as the low frequenc part of the imag .
i subtract it from the origin and thi give rise to the mask , the unsharp mask .
the the next step is to add the unsharp mask it's multipli here by coeffici a .
so it's multipli a ad to the origin imag and thi is the sharp imag .
if i write the origin imag as simpli the sum of the low frequenc part of it , plu the high frequenc compon of the imag .
then the previou equat look like thi .
so with unsharp mask , i keep the low frequenc , but the high frequenc ar multipli .
the booster multipli by on plu a and actual a is greater that on thi is fail to as high boost filter .
if a is less than on then the mask is de emphas .
so if we put thi to practic here is an imag of thi quarter coin and thi is the sharpen version of thi imag us thi unsharp mask method .
a equal <num> wa us for thi particular exampl .
here is anoth exampl of the applic of unsharp mask to sharpen an imag .
here is the origin imag <num> by <num> pixel .
here's a blend version of it by <num> by <num> gaussian .
i subtract the blend version from the origin on and obtain the unsharp mask shown here .
the unsharp mask is ad to the origin with alpha equal <num> .
to give thi sharpen imag and with alpha equal <num> to give thi sharpen imag .
so clearli , the edg ar sharpen or the high frequenc in the imag ar boost .
the main idea behind these sharpen techniqu is to add to the origin imag , high frequenc inform , edg inform .
we saw that with unsharp mask we found the unsharp mask , the high frequenc , by take the differ between the origin and the blur version .
anoth wai to obtain high frequenc inform is by find the deriv of the imag .
and specif find the second deriv of an imag , which is refer to as the laplacian of the imag .
we're not go to get into ani detail at thi point .
sinc we'll start the gradient and laplacian the first and the second of an imag when we talk about segment .
so for the time be assum that i can find the high frequenc through the second order of deriv .
i can then add them to the origin sharpen imag that wai .
so here's an exampl of the moon's north pole .
and thi imag is actual a mosiac , it wa put togeth by <num> imag taken by galileo's imagin system back in <num> .
so if we look at thi imag , it look kind of blurri and , again , would like to sharpen it .
so if we find the secondari version of thi imag , the laplacian , it look like thi .
the laplacian rang from minu <num> to , to plu <num> , assum the origin imag is a eight bit imag .
and what we see here is the posit valu , sinc the valu below <num> were clip , were set to <num> .
anoth wai to show the laplacian is by rescal it , by scale the minu <num> to <num> rang , map it into <num> to <num> and then thi is what we see .
so clearli , the secondari contain the edg format of the imag .
so , if i add the laplacian to the origin imag , then i obtain thi imag .
and if we compar thi sharpen to the origin , it should be clear that inde the edg ar enhanc the high frequenc ar boost .
there ar differ wai as we'll see to comput the laplacian , so if i comput it in a differ wai .
by the wai in thi exampl the laplacian goe comput as shown here .
and more specif thi is more like a two dimension impuls point minu four in the middl and then on on here on here and on here .
here .
so thi laplacian , laplacian wa us to comput thi here and to comput thi imag .
so if i comput the laplacian a differ wai .
and the differ wai is show here so the impuls respons now is minu eight in the middl and then on at all .
of the locat in thi three by three mask , then i obtain thi result .
which by the wai , is definit sharper than the on we , i had with the first version of laplacian .
so thi is the basic idea of sharpen .
take the origin imag here .
at the high frequenc inform as convei here by the laplacian here .
and we have these beauti result down here where you can see , consider more detail .
when it come to edg of thi imag of the moon .
we see here a combin of some of the sharpen and enhanc techniqu that we have cover so far .
so let's consid thi whole bodi bone scan shown here .
by look at thi it look rather blurri .
so base on what we've learn , we can find that laplacian , the second order deliv of thi imag .
then if we add the laplacian to the origin imag we start with , we get the sharpen imag , as shown here .
we can also take the first order deriv .
it's call sobel gradient .
on of the wai to implement the first order deriv , and again , we'll cover these in more detail when we talk about segment .
now , i can take the sobel , the first order deriv we just saw and smooth it out so it's averag with a five by five filter .
then i take the product of the sharpen imag that i had obtain by ad the laplacian with thi smooth sobel gradient .
so thi give me a mask , the , there product .
and then i can add thi mask to the origin imag and the obtain thi sharpen imag .
and final , i can us a power law transform to further enhanc the appear of thi imag .
so we do have valu version of enhanc right ?
thi is an enhanc version of thi and thi is a sharpen version of the origin and so is thi on a sharpen version of the origin .
so thi also illustr the fact that i mention multipl time that i want to talk about imag enhanc .
there is not just on specif object that will give us the optim wai to enhanc an imag , but instead i have a set of tool in my bag .
but i can util them appropri and thei can try differ tool .
and at the end , i can choos the on process that is most suitabl for my own purpos .
hello and welcom back , in thi segment we will discuss homomorph filter .
it is a concept develop in the 60s by oppenheim schaefer in stockholm , accord to which a nonlinear map is first appli to a signal , then linear filter is perform with thi new domain .
and final , the signal is transform back to the origin domain by appli the invers transform .
the concept is gener , and can be appli to the process of ani signal .
for exampl , speech , audio and , of cours , imag .
thi concept is util here with the object of decreas the dynam rang while increas the local contrast of an imag .
base on a model of an imag , as the product of a slowli vari illumin term , and the fast vari reflect term , after take the logarithm of the imag , the two term ar now addit .
thei can then be separ by lsi filter .
then , in the frequenc domain , the illumin term is reduc while the reflect term is boost , exponenti is then perform , the invers of the log , so as to bring the imag back to it origin domain .
we will explain all these step in thi segment and also show an imag sampl .
so , let us proce with thi topic .
and , i hope you find it interest and excit .
the interest concept of homomorph filter , as appli specif to an imag enhanc task , is present next .
we'll introduc homomorph filter in the context of solv a specif enhanc problem that we will explain right awai .
howev , it should becom clear with homomorph filter is a more gener framework that can be us to solv variou problem .
so , the problem at hand is that we have a imag with a larg dynam rang , such as a natur scene on a bright dai .
and , such an imag is record on a , on a medium with a small dynam rang .
and the result is that there is a signific contrast reduct , especi in the dark and bright region .
so , therefor , the object is , given an imag , how can we reduc the dynam rang while increas the local contrast .
we model given imag x as a product of two term , the illumin term i n1 and <num> , which is assum to be slowli vari .
a low frequenc term and contribut mainli to the dynam rang .
and thi is multipli by the reflect , which repres the detail and is therefor rapidli vari , and is the primari contributor to the local contract .
so , with thi model , the problem we set out to solv is to decreas the dynam rang , therefor decreas the term i n1 and <num> , while increas the local contrast as express by the reflect .
clearli the difficulti here , the challeng is that i have the product of these two term , the illumin with the reflect and i would , therefor , like to separ them befor be abl to process each on separ accord to my object .
homomorph process come to our rescu .
the main idea behind homomorph process is to take the origin signal , the origin imag , and through the logarithm oper , map it onto anoth domain .
then we perform our process , our desir process in that other domain and after we obtain the signal , we want to undo the oper of the logarithm , therefor , the end result , that oper is the exponenti .
so , i exponenti here the signal and it bring me here to the nativ domain .
so , base on the model we us for the imag as the product of the illumin term with the reflect term .
if i take the log of the imag , it will give me the sum of the log .
so , it's the log of the illumin , the first term here , plu the log of the reflect .
thi first term is a low frequenc term , and my object is to decreas it while the log of the reflect is a high mid frequenc term , and my object is to increas it .
so , i want to decreas the dynam rang here while i want to increas the local contrast .
so , start with the origin imag , take the log , then we take the output and low bu filter it , thi will isol the first compon .
the log of the illumin .
i want to decreas it , therefor i multipli it with a gamma on less than on .
at the other hand , i high pass the signal y1 .
thi will let the second compon , the high frequenc compon , go through .
that's the log of the reflect .
i want to ampl , amplifi that , therefor , i multipli by gamma <num> greater than <num> .
i add up the two term .
i just exponenti them , and come back to the origin domain .
so , for thi particular , again , imag model is the product of the illumin with the reflect .
homomorph process is the natur framework to be appli .
and that would allow us to achiev our object , which is to decreas the dynam rang while increas the local contrast .
so , here's again , the block diagram of the overal system , and summar y2 n1 n2 as the output of the filter oper here , so it's approxim equal to gamma <num> , the log of the illumin plu gamma <num> the log of the reflect .
and after exponenti , my output , i call here x0 is the illumin compon rais to the gamma <num> power , time the reflect compon rais to the gamma <num> power and gamma <num> is less than <num> while gamma <num> is greater than <num> .
so , here is the overal filter oper result in realli filter y1 here by a filter which is readili symmetr and ha the shape , low frequenc multipli by gamma <num> , while high frequenc multipli by a gamma <num> .
so , we ar do our filter in the log intens domain , which is also refer to as a perceptu domain .
sinc it reflect some of the properti of the human visual system , accord to which intens ar modifi at the peripher level us some type of non linear such as the logarithm oper .
here's an imag weu would like to enhanc through homomorph filter .
the local contrast seem to be low in the dark region , for exampl here , mayb back here as well .
so , here's a result we obtain by appli the procedur i just describ .
actual , the valu were gamma <num> equal to <num> and gamma <num> equal to <num> .
and on can see that inde the local contrast ha increas in a region like thi , mayb back here , but also the number seem to be sharper on the face of the clock .
hello and welcom back .
pseudo color and color of a grai scale imag ar cover in thi segment .
the two topic close relat sinc with both a black and white imag is turn into a color imag .
the object howev of the two problem differ .
a number of object drive pseudo color , such as to place normal object in strang color for attent , color a normal scene to match the color sensit of a human viewer , exploit contrast , produc a natur color represent of a set of multi spectral imag of a scene , and enhanc the visual qualiti of the imag in gener , and reveal detail and structur in it that were not visibl befor .
color of black and white imag , on the other hand , ha as it object .
in most case the recoveri of color that exist in the scene but wa simpli not captur by the sensor .
it is a techniqu that wa made popular in color old black and white movi , which were film when color wa not avail .
we will discuss some basic inform of both pseudo color and color approach .
we will describ a specif color exampl , that of color a black and white photograph of a famou paint by matiss , reveal valuabl inform about the process the famou master wa appli in hi work .
let us then proce with thi excit topic .
some of the motiv , along with some exampl of turn a grai scale imag into a color imag imag ar discuss next .
pseudo color or fals color is an enhanc techniqu of assign color to grai scale valu .
it is done primarili for human visual and interpret of grai scale event .
more specif some of the reason ar , we might want to place object in strang color for attent sinc human will notic odd color object more than other .
we want to take advantag of the color sensit of the human viewer .
the lumin respons of road and cone the retina pick in the green region of the visibl spectrum and we want to account for that .
we want to exploit the contrast sensit of the ey to chang in the view light .
so we map normal color of object with fine detail into shadow of blue .
and we want to produc natur color present of multi spectral imag of a scene .
and some of these imag mai not even be , obtain by sensor whose respons is within the visibl wavelength rang , such as infrar and ultra violet .
i've also includ here the color of black and white imag and video .
although , there , in mani case the object is to reproduc the true color that were there in exist , although , all we have avail is a black and white imag .
by and larg the color of black imag and video depend on initi select of color and therefor it's look upon as an enhanc techniqu .
so color is import becaus also human by and larg can discern thousand color shade and intens , compar to onli a few dozen or so of shade of grai .
we show here the seven band of a landsat multi spectral imag .
thi imag actual wa shown earlier in the introduct of the cours .
so thi is the blue , green , and red band , and the other four ar infrar band .
thi is actual the landsat imag of the citi of amsterdam .
instead of look at the band on at a time as shown here as a , as a grayscal fashion , we can combin the band and produc color imag such as thi on .
these ar actual from a differ area .
these ar from the citi of london .
so combin the three visibl band , on obtain an imag like thi .
the color ar kind of natur look .
the citi show here in grai .
the water is blue and veget is in green .
combin the , <num> <num> <num> band , <num> <num> <num> ar the visibl on .
so there ar two visibl here and on infrar .
on is abl to better see the veget , if red is reflect differ .
and here's a combin of two infrar and on visibl band .
and in thi case , thi is suitabl for geolog , agricultur , purpos .
we see here a beauti pseudo color imag of the great lake area , taken by thi modi , which stand for moder resolut imag spectroradiomet , aboard the nasa satellit , aqua satellit .
so thi is lake michigan .
and chicago is around here .
lake superior is up here .
huron , thi on and so on .
so , for thi first color imag , a combin of a shortwav infrar , a near infrar , and the red channel were us .
and with thi pseudo color we're abl to distinguish ic from snow and water from cloud .
we see lake superior up here is complet frozen , and thi wa taken in the recent winter of <num> .
we describ here some of our own work on color .
thi addit pictur of the masterpiec by matiss , bather by a river which is own by the art institut of chicago .
thi is an impress paint , which measur almost four by <num> meter .
it is consid to be on of the five most beauti work of hi career .
he work on it , on and off for almost nine year .
the exact period ar shown here .
sometim around the begin of novemb <num> , matiss arrang for the photograph and dealer by the name of druet to record the state of the paint .
so the black and white photograph he took , is shown here .
the artist kept work on the paint after the photograph wa taken for anoth four year .
so , the photograph is veri differ from the current state of the paint .
so the problem at hand is to reproduc the color inform of the paint back in novemb of <num> , as if druet wa us a color camera .
or in other word , we want to color the grayscal imag .
color techniqu have been util for movi sinc the 1970s .
howev , the requir for paint color ar differ , sinc high accuraci and fidel ar need .
and the imag format model differ significantli from the natur or cartoon type of imag that we us primarili for color .
in our color algorithm , some initi condit ar need .
pixel for which the color is known , and then thi color is propag through the rest of the pixel in the imag .
these initi condit ar typic refer to as scribbl .
in find thi condit for the problem at hand , we found the correl between the intens valu of the direct pictur and the intens valu of the paint in it current state .
we show the maximum of these correl valu .
so , for thi locat shown here , where the correl is , is larg , we can borrow the color from the current state of the paint to util , to color the , the drab pictur .
in addit , microscop hole were drill into the paint .
and here we see a cross section of the paint at <num> time magnif .
so it's , sinc , sinc matiss wa ad or scrape awai , paint while , just work on thi paint for nine year , it's not straightforward to identifi which layer correspond to which year .
howev , the curat were abl to sai , for exampl in thi case , thi grai layer here belong to the <num> , novemb , <num> period that , the pictur , the great photograph wa taken .
so thi addit inform from thi investig , thi forens here , wa util as well to gener scribbl , and at the end these ar the scribbl we ar go to us , we us in color the druet photograph .
so the basic principl of the algorithm we us to color the druet photograph ar discuss here .
so , chang in color correspond to chang in intens and therefor base on that , if two pixel have similar intens thei will be assign similar color .
we work in the yuv color space .
we have the y of cours , the intens of the lumin .
and to solv for the two chromin compon , u and v .
so in solv for u , for exampl , we have the valu of u at locat r , as shown here .
then you consid the neighborhood , such as the red window shown here .
and you're solv for the intens in these neighbor locat .
so we're try to minim thi squar term , but the , intens ar weight by thi factor which is depend on the differ in intens .
so if thi pixel and thi pixel have similar intens then thi weight is go to be close to on .
if the intens is similar then , that is go to be small .
so by do so we form a system of equat , linear equat , sai x equal b , and solv that we just propag the color from the known scribbl to the rest of the pixel imag .
so final we see here the black and white photograph again , the druet photograph taken novemb <num> , and here ar the result of color of thi photograph base on the algorithm that i just briefli describ .
the color result is smooth .
he ha limit color blend , and is consist with conserv and art histori research .
it reaffirm that he start color count of how the paint appear at that time period .
thi work help support research that ha for the first time uncov how matiss begun the work as a highli chromat , more naturalist scene , but it chang it to ex , to explor new artist direct on on hand , while at the same time , reflect the graver nation mood due to the first world war .
furthermor , the color version help curat and art historian visual the process by which matiss compos and transfer thi complex work to reach it final form , and also help them to identifi other work by the artist reflect a similar process .
welcom back .
in thi segment , we'll address some basic concept of video enhanc .
clearli , when we deal with video , we can alwai treat each and everi frame of the video independ , and appli a two dimension enhanc , or process in gener , techniqu .
howev , in do so , the tempor correl of the video is ignor .
take thi correl into account , on can typic obtain improv result .
on of the wai for us to take thi correl into account is through the us of the motion in the video sequenc .
we describ in thi segment some of the basic idea in perform nois smooth in a video sequenc .
we describ three dimension spacial tempor filter , which either ignor the motion or take the motion into account explicitli or take the motion into account implicitli .
we know from last week that motion estim's a challeng task .
it's clearli exacerb due to the presenc of nois .
ideal , a prefer solut would be on which take the motion estim error into account when perform intens estim and the other wai around .
we also put some of these idea to test with video anim from the movi fantasia .
due to the process that wa follow for film ani , anim earli on , there's a plethora of artifact , in addit to nois , such as scratch and blotch and flicker .
we demonstr how some of these simpl idea can consider improv the visual qualiti of the video .
so , let us proce with thi excit topic .
first of all , ani of the imag enhanc techniqu we've cover so far can be appli to video if we process each frame independ .
in mani case , the result will be satisfactori .
howev , with such an approach , the inter frame correl or the tempor correl in the video ar not taken into account .
by consid such correl , improv result can be typic obtain .
in some other case , a two dimension enhanc techniqu can be extend to 3d .
we can , for exampl , consid a group of consecut frame and perform histogram equal in the result 3d volum of pixel .
we'll discuss some basic concept for the problem of nois filter .
again , we can filter each frame independ us a two dimension spatial filter , or we can look at each and everi pixel over time and filter the result on dimension time signal .
so , if we look at a set on consecut frame .
frame k , k minu <num> , k plu <num> , k plu <num> , i can consid the pixel at the same locat .
and then t , a time domain , on dimension signal result thi wai .
so , both of these approach to the spatial filter or 1d tempor filter were tri first in filter nois in video .
we will discuss here three dimension spatial tempor filter which have a as special case 2d spatial and 1d tempor filter .
such filter can be classifi into three group , the on that complet ignor motion , the on which take motion into account implicitli and the on which take motion into account explicitli .
as a specif case , we will look at an exampl from anim video .
in addit to nois , other artifact ar present which need to be remov as well .
similar problem ar encount in process digit motion pictur in gener .
the degrad model assum addit nois is shown here .
so , we want to oper on the observ video g , i , j , k .
and obtain an estim f hat of the origin video f i , j , k .
in do so , we can ignor the motion , take it into account implicitli , or explicitli estim as shown here .
for estim the motion , down here , the noisi blur frame can be us come from thi direct .
but also the nois smooth on can be us come from the output here .
so , the past nois smooth frame can be us and the current noisi frame can be us thi wai to estim the motion , which will be util by the intens filter .
a desir solut is if the estim of the nois smooth intens signal and motion ar done simultan instead of sequenti or independ .
by take the motion estim error into account when find an estim of the intens valu .
and the other wai around , by take the error in estim the intens into account when estim the motion .
we show here the form of a three dimension finit impuls respons fir filter .
a neighborhood s is defin .
which can contain onli past valu of the current pixel but also futur valu .
then , the filter valu at locat i , j , k , is the weight sum , base on the weight provid by the valu of the filter , the weight w p , q , l of the pixel valu in the neighborhood s .
a prime exampl of thi is the three dimension flat filter or the averag filter , in thi case all big sourc can equal weight doubl .
anoth exampl , is the three dimension wiener filter .
we will be talk about the wiener filter in week seven , for two dimension imag .
the main idea is that the weight will be defin base on the three dimension auto correl function of the video .
we have also not talk about auto correl , we'll do so in week seven .
with such approach , the motion in the video is not taken into account .
thi clearli will result in smooth tempor edg .
the motion can be indirectli taken into account by make the weight a function of the tempor activ or edg due to the move object .
so , for exampl , after the tempor edg ar detect , the pixel belong to them ar not consid by the fir filter .
anoth class of non motion compens spatio tempor filter ar infinit impuls respons iir filter .
thei have the form shown here .
the filter valu f hat is the convex combin of a predict , f hat of b , which is carri out base on process valu belong to the past of the pixel be process , and the noisi observ g .
thi convex combin is determin by the coeffici alpha .
an exampl of a predict is shown here .
the import point is that thi neighborhood s includ onli past pixel valu .
that is , the filter structur allow recurs comput of the result .
so , if i consid here the current frame k and the previou frame k minu <num> , consid the pixel here at locat i , j .
i'm interest in find the filter valu of the pixel i , j here denot by x .
so , if i consid thi neighborhood or the current frame and thi can be thi neighborhood for the previou frame then thi shade region form these two region .
the union of them form the region s here base on which the predict would be carri out and again all the pixel valu in these shade region have alreadi been comput and therefor thi is a recurs comput structur .
the three dimension kalman filter , here's the form shown here , where specif express exist for the gain alpha .
anoth form of spacio tempor filter ar order statist filter .
we talk about them for two dimension signal dure thi week in an earlier segment .
the express for a multi stage medium filter is shown here .
it consist of four unidirect medium filter in the spatial domain .
and on , along the tempor direct .
so m1 , <num> , <num> , <num> ar the output of the unidirect filter in the spatial domain .
while m5 is the output of thi unidirect median in the tempor direct .
so , the final result here is the median of the maximum of these five output , the minimum of the five output , and the observ , g .
the fir version of the motion compens filter is shown here .
the motion is now taken explicitli into account , on can us ani of the techniqu we cover last week in estim the motion in carri out thi spatio tempor filter .
so , the region here , s , that tell us which pixel we should util to carri out thi filter oper is not fix , is not rigid like a parallelogram in the three dimension space , but it chang shape base on the motion paramet .
so , for exampl , if i consid here the current frame and the previou in time frame k minu <num> , i'm interest in find the filter valu at locat i , j .
and if i consid the valu p equal <num> , q equal <num> , and l equal <num> .
so , i'm look at the i , j , locat of previou frame .
in , in find thi filter valu , i will not consid thi pixel here , but instead , it motion compens version .
so , in the i direct , we will us the vector d hat x k , k minu <num> .
so , thi is the x compon of the estim motion vector , while in the y direct i'll us the estim motion vector , d hat y , k , k minu <num> .
so , the two of them will give us the compens locat of thi pixel .
so , it is thi pixel that will be multipli by the weight <num> , <num> , <num> , accord to thi .
and will contribut toward the estim of the pixel , i , j , at the current frame .
the iir version of the motion compens spatio tempor filter is shown here .
thi express is ident to the non motion compens iir filter .
howev , the , the diction now is done along the motion projector .
so , the neighborhood here decid that it allow the case comput , gamma ar the weight but again , i util their compens in the x direct accord to thi vector , the y direct accord to thi vector and therefor thi neighborhood that i util to carri out the predict is , again , chang , accord to the shape of the motion .
we show here a specif applic .
we'll show a few frame from the walt disnei anim , fantasia .
a number of anomali ar observ in thi short video .
in addit to nois , flicker is present , flicker is defin as thi unnatur tempor fluctuat of intens that doe not origin from the origin scene .
you can also see , on the upper left corner , there a , a blotch or two blotch due to dust particl .
in other part of the video , there ar scratch and fingerprint , and these all origin from the wai that anim wa film earli on .
so , the anim scene were paint onto clear sheet of polyest call cell .
which then were place on a , an anim stand and photograph three time .
each time us a red , green or blue filter , an innov by walt disnei produc the effect of dimension or depth by lai cell on top of anoth and photograph them then togeth .
each cell contain a differ pictur element and the glass plate wa then us to hold these cell in place .
howev , these plate often contain particl of dust or dirt , which wa then captur onto the film .
as alreadi mention , differ amount of light intens caus a flicker effect between frame .
and for duplic frame and sever illumin chang ar often characterist of anim film .
so , it's therefor highli desir befor the re releas of , of movi , anim alik to remov thi artifact and enhanc the video .
in deal with the enhanc of motion pictur , we deal with a number of artifact .
the first on is our dimens that ha the genet name of blotch .
and thei're due to dirt , sparkl , film abras , scratch and fingerprint .
there's also the intens flicker , refer to also as boil effect , as it wa clearli demonstr in the short anim video i just show .
and final , there's anoth artifact due to the so call vinegar syndrom .
so , for content that wa store on acet base film roll , thei progress deterior and these roll can be affect by a number of artifact , or film artifact .
on of the major problem of all film archiv is thi vinegar syndrom .
the syndrom appear when , in the cours of the chemic breakdown , the acet base film base start to releas acet acid , which actual give the characterist vinegar smell .
the vinegar syndrom ha variou appear .
it mai show up as a partial loss of color , bright or dark , tree like branch , non uniform bled imag and so on .
some of the anim characterist ar mention here .
the imag size ar larg .
so , for fantasia , for exampl , each frame is <num> , <num> by <num> , <num> pixel and each color is <num> bit , therefor <num> bit per pixel .
to do that , we ar interest clearli in simper and computation effici algorithm .
in anim , there is typic unnatur motion .
the constraint that dynam of natur object ar subject to do not appli to anim .
and we have arbitrarili larg and complic elast motion take place and therefor , when motion estim is perform , addit care need to be paid .
we mention that these artifact ar present in older anim in the wai thei were gener .
thi is not the case , let's sai todai , sinc anim is done digit .
and final , the , the issu of duplic frame , which might be due to frame of convers and sever illumin chang .
we outlin here a blotch detect algorithm that we util for the fantasia anim movi .
the assumpt is that the blotch appear onli in on frame .
so the blotch ar on the frame f of k .
and an estim of the frame f of k is obtain through g of k , which is clearli the averag of the next and the previou frame , the f of k .
then the differ between the estim g of k and the actual frame is found , and that's d1 .
so , those region with high d1 compar to the nois varianc , ar classifi as belong to an artifact .
howev , move edg will also be detect by thi test .
therefor , more test ar need to filter out , in some sens , these move edg .
by find d2 , the absolut differ between the previou and the next frame , the move edg as well as the anomali will be detect between these two frame .
similarli , by find d3 , the differ between the next and , or the current and the next frame , edg and anomali will be detect .
now , given these three differ frame , d1 , d2 , d3 , a binari mask , indic the presenc of the anomali , is obtain in the follow manner .
for each of these differ , the mean mu and the varianc sigma squar ar found .
and base on these , these threshold tau of i ar estim , which ar base from thi paramet eta of i .
eta of i is an integ and control the number of pixel which ar classifi as an artifact .
the higher it's valu the fewer pixel will be classifi as an anomali .
so , on thi , onc thi fresh coat have been found , a binari mask is obtain accord to thi formula .
a pixel at a locat m , n is classifi as an anomali if b of i is equal to <num> for all three valu call b<num> , b2 , and b3 .
so , the inclus of b2 and b3 effect account for the presenc of motion becaus move region will show up in either b2 or b3 but not in both of them .
so , here's the frame of the fantasia video here is the , the blotch or the artifact that we want to pull out , and accord to the algorithm that i just describ , here is the detect blotch or the three valu of paramet eta , but it util to set the threshold base on which the bino , binari mass is creat .
after the blotch is detect , base on the algorithm i just describ , then we util an algorithm to remov the blotch .
the algorithm distinguish between two case , whether the blotch belong to a move area or a non move area .
in the former case , a simpl averag along time , util the next and the previou frame is take place , while if the blotch belong to a move area , then a motion compens averag is take place , follow the principl that we have cover alreadi in thi particular segment .
so , util such a blotch remov algorithm , here is the result .
clearli the blotch here ha complet disappear and blend with the background .
for the remov of nois for fantasia , ani of the filter that we cover in thi segment can be util .
a form of the filter is shown here .
so , thei predict the filter valu rather of the intens at frame k at locat m , n is given by thi express .
so , thi is the observ valu and thi is the mean .
it's a spatio tempor mean which can be motion compens or non motion compens .
an import factor is alpha here , which is a function of the mask .
a mask that can distinguish between move region and non move region .
us some techniqu similar to the on we us for the blotch detect , we can obtain a mask , such as thi on , so white it show move pixel and black non move pixel .
actual if a pixel is move but it is detect that as non move then burst so call artifact appear , so it's in mani case advantag to increas the size of the mask , so thi is an expand mask .
so , for case , for region that there is no motion , alpha is set equal to <num> .
so in thi case , realli , we perform some spatio tempor smooth treat here through thi averag oper , sinc the first term drop out .
and for the region that there is motion , alpha is set equal to <num> , in which case , we just reli on the actual observ .
so , here we show the enhanc version of our fantasia .
it should be appar that the flicker ha been consider reduc and also the blotch that had appear in the earlier version of the video is also complet remov .
but we show them now , actual side by side , so these differ ar crystal clear .
so , here is a side by side comparison .
clearli , some of the claim that were made can be substanti .
the flicker is reduc .
the blotch ar remov .
nois is also filter out .
it should be clear , by and larg , that the enhanc video is an improv version of the origin on .
thi ha been actual a quit success project becaus also special attent wa paid so that the result algorithm ar computation effici .
thi bring us to the end of week five .
we learn quit a few thing thi week .
we learn how to manipul each and everi pixel in an imag independ from it neighbor .
we defin a function , or a map , that will take the densiti of each pixel in the input imag and map it into an enhanc intens at the same locat in the output imag .
thi map can be linear or non linear .
we defin thi map by look at the imag and assess it qualiti .
of cours , we can chang the paramet that defin the map or try a differ map altogeth until we ar happi with the result .
we also learn about the histogram manipul approach , in thi case , our enhanc object is defin in term of the histogram of the imag , a term that we defin in class .
we desir our enhanc imag to have a specif histogram .
such a requir will then defin the map we need to appli to each individu cell in the input imag .
we also learn how we can reduc variou type of nois in the imag us both linear and non linear system or techniqu .
if the linear system is also spatial invari , then we have alreadi learn how to describ and implement such system , both in the spatial and frequenc domain , but in week two and three .
we also learn how to make an imag look sharp or how to decreas the dynam rang , while increas the local contrast .
final , we saw that ad color to a black and white imag can increas it appeal or help resolv some interest question in our applic .
we dedic the last segment on video enhanc .
a consider amount of the materi we cover so far can be extend to three or higher dimens .
so , even though we do not explicitli address video , implicitli we've cover quit a bit of materi about it .
of cours , now that we have cover motion estim techniqu in week four , we ar in a better posit to address , for exampl , motion compens spatio tempor filter techniqu .
we also discuss a fun applic , that of enhanc the anim video of fantasia .
start next week and for two week , we will focu on anoth fun topic , the cousin of enhanc you might sai .
that of imag and video recoveri , so i'm look forward to see you next week .
welcom to week six .
we will cover thi and next week anoth excit top in imag and video process , the topic of recoveri .
it's a natur continu of imag and video enhanc that we cover last week .
there's an import distinct between the <num> topic .
as we saw last week , the object of enhanc is to improv the visual qualiti of the imag or improv it us in perform a certain task , base on some subject criteria .
for imag and video recoveri problem , inform is lost , either in the spacial tempor or the frequenc domain , and the object is it's recoveri .
unlik enhanc howev , where also inform is lost in some case , in recoveri a model of the process that result in thi inform loss is first establish , and then an object optim criteria is determin , base on which an estim of the origin imag is sought after .
dure thi week , we provid exampl of imag individu recoveri .
depend upon the applic domain , recoveri come with differ name such as restor , deconvolut , , in paint , block artifact remov , super resolut , pansharpen , and so on .
all these recoveri problem ar invers problem .
we will then discuss some of the import restor approach that ar us wide in practic .
there's probabl no applic area where imag and video ar acquir that doe not have either activ or potenti work in imag recoveri .
the materi therefor of thi and next week will be veri valuabl in thi regard .
in thi modul of the cours , we will first show exampl of imag recoveri .
then we will focu on imag restor and more specif imag deconvolut approach and we'll group them into the determinist and stochast .
and final , we we're go to show the formul of other recoveri problem .
i us the term recoveri as the umbrella term , ani problem in which inform is lost and need to be recov .
as we'll see recoveri problem assum specif name base on the applic , restor typic and the convolut as a special guest of restor , it fail to a specif model of the input output relationship of the degrad system .
we show here a blur imag due to defocus .
thi is the situat where the automat focus system of a camera fail or the manual focus wa not success .
so what is acquir is thi blur imag , it's hard to deciph what's in it , so appli a restor algorithm .
we can obtain a restor imag that look like thi .
thi is by the wai , a grayscal imag , not a binari imag .
so on the left wa the imag of eec depart at northwestern befor i join , and on the right is the imag after i join .
the hubbl space telescop name after the astronom edwin hubbl , wa place in orbit in <num> by a space shuttl and is still in oper .
between <num> and <num> , <num> differ repair mission repair , upgrad , and replac system on the telescop .
now after it wa place in orbit , it wa discov that it's main mirror wa not cut to specif , and therefor the telescop wa myopic , it would observ imag such as thi on of saturn and thi is a blur imag , the ring ar not clear .
so these imag would be beam down to station down to earth and peopl would try variou restor algorithm like the on we will discuss later in class to obtain restor imag .
base on some work we did , here is a restor of saturn .
the ring ar now much sharper and accur flux measur can be made on the restor imag .
here's anoth observ by the telescop of a galaxi and here's the restor version of thi particular imag .
i should mention that in carri out the restor , the impuls respons of the degrad system , which is the myopic telescop , need to be known .
and in thi case either thi impuls bond will be obtain base on geometr optic or would be obtain by point the telescop to a distant star and measur the respons to that .
so the star repres an impuls therefor thi is the impuls respons .
the telescop actual ha been extrem success .
it ha acquir beauti imag of the heaven , and major scientif result have been obtain due to it's observ .
here's a color imag , and thi color imag is undergo degrad that is three dimension , so in distort on channel the other two channel have error in it .
so , due to thi three dimension degrad , the degrad imag look like thi , it ha been subject to color alter , so therefor a three dimension deconvolut is requir and here is an exampl of the restor imag .
when the degrad is 3d , then the deconvul is certainli 3d .
but in mani instanc , the degrad can be two dimension , but still we might choos to do a three dimension deconvul by take in other word , the other channel into account .
thi could be thought as multi channel restor .
and that is the number of applic in microscopi for exampl , fluoresc microscopi while 3d deconvolut is requir .
here's an exampl of a blur imag due motion between the camera and the scene .
it's an aerial pictur taken by a plane and the motion compens system on the plane fail and therefor thi blur imag wa acquir .
thi is real imag of a toi train , move toi train due to motion again , there is blur on the train , while the background and foreground ar , ar not blur .
so in thi particular case , a small algorithm is acquir to first identifi the part of the imag , the pixel in the imag that ar blur and restor onli those pixel while the remain of the imag stai untouch .
here's an imag of a so call auto radiograph microspher ar attach to a specimen and then thi radiograph imag is acquir , it certainli blur .
appli some of the algorithm , we will be discuss in thi class here ar the restor version of these imag .
so the blur imag , the restor imag .
clearli , a lot of inform ha been recov .
we can see the fine detail of aerial imag .
there's a river there and the bridg .
we can see the micro sphere well defin , and we can see the imag of the train be now sharp , we can read the letter on the side of the train , white foreground and background ar also sharp , have not been modifi , have not been degrad by thi oper .
we show here an imag acquir by a hand held camera .
dure exposur time the camera shook , and thi is the result blur imag .
we show some sub imag here blown up to , to pai attent to .
the , the gradat is not known .
and therefor a blind spatial vari restor algorithm wa develop by us and appli to thi imag to obtain thi restor .
we see here the shape of the degrad , of the impuls respons for the degrad , and we also look specif at the sub imag .
so it's , the improv is crystal clear , and you can see the three peopl here walk .
thei're not distinguish at , at all in the origin observ but after restor , there's a veri good represent of them .
as you will see when i discuss later in the cours in detail imag and video compress techniqu , in hear out compress we take each still imag or frame subdivid it into block , and then each block is compress independ from the remain of the block .
so due to thi specif type of process , especi at high compress ratio , if on look at the compress imag , on can see those annoi block artifact .
you can see here the boundari of each individu block thi imag wa divid into .
so the problem at hand is to devis a recoveri algorithm that will bring back some of the lost inform and result in remov thi block artifact .
so here is on result we obtain with on of the algorithm .
by and larg , the block artifact have been reduc or complet elimin .
mayb if on pai attent to the forehead of the ladi , and mayb the hat here , and some other region of the imag .
thi is the same problem as in the previou slide .
here we deal with video , not just a still imag .
so the block artifact ar visibl in thi frame of the video .
and base on the techniqu , we also develop thi is the process imag .
in thi particular case when video is involv , on can util not onli the spacial inform but also the tempor inform base on the motion inform you can find .
the similar block , the similar agent in previou frame and util that inform to remov some of the block artifact .
here's anoth exampl of a recoveri problem .
when imag and video ar transmit , row of micro block ar typic place into packet , and these packet ar transmit .
if some of these packet ar lost dure transmiss , then the receiv imag can look like thi .
thi is a frame of a video , and thi black here , rectangl indic packet which were lost and therefor the intens inform is lost .
so we try to recov the lost inform .
thi is a recoveri problem that is typic refer to as error conceal problem sinc we try to conceal the error that were introduc by the channel .
sinc we deal with video again , on can us not onli the spacial neighborhood inform to recov thi lost inform but also the tempor inform .
base on some of our work , here's an exampl of the conceal frame .
it's a satisfactori result , especi for thi packet here sinc a lot of structur wa lost but we see that it is recov nice .
thi particular packet did not convei probabl as much inform but still , it , it's a satisfactori conceal .
here's anoth exampl of a still imag .
so the , these block were lost , the black block .
thi would repres the best type of error .
so base on a differ algorithm , recoveri algorithm we develop , here is the recov imag .
it's almost perfect .
if on pai close attent , there ar some issu like here for exampl , or here which might be part of the hat and so on but by and larg , it's a veri satisfactori conceal imag .
the last exampl we saw transit nice into the inpaint problem .
so here we're given an imag like thi , thi is actual an old movi and thi wa suppos to be sub titl , but back then when peopl were not as skill reader and these sub titl were rather larg , so thi is the onli copi of movi avail and we want to remov the letter , so that the origin inform is avail .
so thi problem is again refer to as in paint , we want to paint the miss valu in , insid the imag .
it's veri similar to the error conceal problem .
on differ is in error conceal , the miss region ar nice structur and their locat is known .
with an inpaint problem , on ha to identifi the region in which inform is miss .
so in thi particular exampl we have to identifi the , each and everi letter and realiz that whatev thi is white here , it's a letter is inform lost , but there's white shirt here and the inform is not lost there .
so thi is not the easi problem that ha to first be solv befor inpaint .
so here's an exampl of a not veri skill and success inpaint but nevertheless it give you an idea of the problem , the letter ar remov .
again , inpaint can be appli to still imag or video .
when video ar avail , then there is both spacial and tempor inform that can be util toward in paint .
anoth recoveri problem is the imag super resolut problem .
we observ a set of low resolut imag , and the object is to combin them to in order to obtain high resolut on .
so these ar imag of the same scene and there is a transform connect them .
the transform could be a simpl sub pixel shift among the frame or a rotat compon can be there or ani gener transform .
so base again on some of our work here is an exampl of a super resolv imag .
none of the number is visibl in the low re imag and clearli a lot of inform wa recov sinc the number can be read and the imag is sharp and of high resolut .
here's anoth exampl for lower resolut imag ar observ and combin judici result in thi high resolut imag .
actual the dimens of these imag here is the same , the low and high but thi wa done just for displai purpos .
the super resolut of the compress video is anoth recoveri problem .
so the degrad model is shown here , which start with a video of the origin resolut , a short segment is shown here .
thi is down sampl by a factor of two in both dimens of thi particular case .
and then thi down sampl video is compress us the mpeg4 video compress standard that on megabit per second us thi specif rate control .
so here is the compress down sampl video .
so the object is to , where would thi compress down sampl video and come up with an estim of the video , the origin resolut .
so , here is the two result .
on the left is the result base on bi linear interpol and on the right , on an algorithm that we develop .
so by compar them side by side , it should be clear that a lot of the artifact ar not there with the so call propos algorithm here .
and it repres , by and larg , a veri good present of the video at the origin resolut .
anoth recoveri problem is the dual exposur restor problem , a more recent problem .
accord to it , two imag ar observ , a long exposur imag and the short exposur on and thei ar actual cell phone in the market that do that .
thei take simultan two imag a long and a short exposur on .
so the long exposur on is subject to blur due to motion , shake of the camera and so on .
the short exposur on doe not have thi problem , but it is noisi and also the color have been out .
on approach would be to work with the short exposur imag and smooth the nois and if we do so , we obtain an imag like thi .
it's brighter , the nois ha been reduc , remov , howev , the color ar not the color of the origin imag .
if we combin now the long and short exposur base on some of our recent work , we can obtain the restor imag shown here .
so thi definit an improv version of the observ , it a sharp imag while maintain the color of , of the origin scene .
blind restor wa perform and thi is the estim point spread function impuls respons , so the degrad system that gave rise to the long exposur imag .
anoth recoveri problem by the name of pansharpen is encount in multispectr imag , in remot sens when imag that ar acquir for exampl by lancer .
so in that case , instead of have an ideal sensor that would gener high resolut multi spectral imag , instead there is spectral decim as well as spatial decim .
so the spectral decimat result in high resolut imag but the the frequenc format ha been lost , it's a great scale unchormat imag .
while the spatial decimat will give each and everi band of thi multi spectral imag but at the reduc resolut .
so the problem at hand is to combin the pan chromat high resolut imag and the low resolut spectral imag , and try to increas the resolut of the spectral imag , bring them to the resolut of the pan chromat imag .
it's a super resolut problem , but in thi context of multi spectral imag is refer to as a pansharpen problem .
so here is an exampl of pansharpen .
we're given the low resolut spectral , the panchromat place scale and combin the <num> , here's a pansharpen imag we obtain with on of our algorithm .
so it ha the same resolut as the panchromat and ha all the spectral inform here shown clearli in pseudo color of the spectral band .
anoth recoveri problem is that of demosa .
most modern digit camera acquir imag us a singl imag sensor overlaid with a color filter arrai .
the most commonli us on is the bayer cfa shown here .
accord to it , <num> of the pixel ar green , and <num> ar red and blue , so equival out of the three plane , the r , g and b plane , <num> of the pixel ar miss here , <num> in the green channel , and <num> in the blue channel .
so , demosaick is the digit imag process recoveri problem us to reconstruct a full color imag from the incomplet color sampl that is shown here .
with thi final exampl , i want to make the point that the degrad such as motion blur is not onli import to be remov so as to visual the distort imag , but it need to be taken into account when anoth task is perform such as track .
so we see here a popular and success tracker by the name of mean shift fail to perform realli well when the there is motion blur .
the red window show the the track result , so the red window stai with the object most of the time but the number of occas doe not coincid with the object .
so the tracker lose track of the object of interest .
but by take the motion blur into account with some of the work we did here , we can see that now the track is more success .
thi red squar , rectangl rather , stai with the object most of the time .
we tri to demonstr with the previou exampl , that there ar variou sourc of degrad which result in loss of inform and therefor a recoveri problem need to be solv .
it's probabl safe to sai that whenev imag and video ar acquir there is either activ or potenti work in solv a recoveri problem .
draw from the previou exampl , here ar some exampl of degrad .
the degrad can be due to motion between the camera and the scene , either unintent motion or when a motion compens system fail for exampl due to atmospher turbul .
whenev we imag for exampl with ground base telescop , the object in the sky , we have to imag through the turbul atmospher .
due to out of focus , either becaus the auto focus system fail , or when we manual focu , we don't do the best possibl job .
gener speak due to the limit of a , acquisit system , the final resolut for exampl impos by the optic , constraint impos by physic of the object of interest , we're go to imag and cost consider .
veri often , we go on with softwar to increas the capabl of hardwar .
so we want to make for exampl , a <num> camera perform like it's a <num> camera .
the finit resolut of sensor and thi resolut is depend on the frequenc of the electromagnet spectrum at which we're imag .
doe to quantiz error when for exampl , compress is perform on a signal through transmiss error , error introduc by an unfriendli channel and of cours , the ever present nois .
we show here a list of the recoveri problem we describ through the exampl we just show .
so there's the ever present nois smooth problem , restor of the convolut in <num> or <num> or <num> dimens .
the remov of compress artifact , super resolut in it variou incarn such as pansharpen or demosaik .
the two cousin problem of inpaint and conceal , dual exposur imag , reconstruct or project , and these two topic that we did not show ani exampl but we will visit them later .
i'd like to mention here that some of these problem ar combin .
for exampl , i might be interest in solv a super resolut problem with compress imag or video when of cours nois is alwai present in the data .
anoth comment is that in some applic , we observ just a singl imag or frame of a video .
but while in other applic that ar multipl observ involv such as dual exposur or the super resolut .
the exampl of discoveri problem we describ and addit other can be count in a number of applic , for exampl , in space explor or imag acquir by the hubbl space telescop , remot sens , surveil , medicin , neuroimag , nondestruct test , commerci and digit photographi , video print , print on frame from a video , microscopi , molecular and cellular imag and multimedia commun .
and of cours , thi is not an exhaust list of either the applic or the type of recoveri problem or the list of degrad we just mention .
so thi is veri , veri rich field and what we try to do is just demonstr and describ some the veri basic principl that on can take then and appli to all these again incarn of the recoveri problem in the veri mani applic that such recoveri problem could be encount .
in thi segment , we introduc the classic restor problem .
accord to it , there is a system between the origin and the acquir imag , which introduc some type of degrad .
the system can repres the hubbl space telescop , or the turbul atmospher .
or be a combin of the motion of an object in the scene , and the motion of the camera .
when the degrad system is linear and spatial invari .
the both the model of the degrad and it remov , ar , rel speak simplifi problem .
we show the mathemat model for the system , introduc some of the common encount lsi degrad , of cours there's almost alwai the ever present nois in the data as part of the degrad .
we show how is the sever of nois typic measur in imag restor .
as well as an object metric us for estim the improv in the restor imag .
when a synthet experi is conduct .
of the recoveri problem we describ , such as conceal and paint , resolut .
thei have a common structur , thei're all invers problem .
so , we assum there is a system , which you denot here by h , that take an imag at the input f , and produc an imag g at it's output .
and it could be a singl imag or multipl imag or a video .
when we observ g , and or solv for f , it's a recoveri and invers problem .
if onli g is known , and still the object is to recov f , and of cours h along the wai , then becom a blind recoveri problem .
and the in between situat is when g is observ , and h is partial known .
so the shape mai be of ag is known , and but the , the but the width of the is not known , so there's a paramet i need to estim .
and in that case , it's refer to a semi blind recoveri problem .
although the main object is again , to estim f as we'll see in a number of exampl .
there ar a number of paramet that ar introduc and thei need to be estim , as well .
if f and g ar known , and the object is to find h .
then thi becom a system identif problem and if f and h ar known , and .
the motion estim problem is an invers problem .
the dispar estim , i just mention it in pass at some point , it's also an invers problem , and the bound detect through differenti can be formul as an invers problem .
so invers problem ar encount ar all over the place .
it's a topic in appli math that he ha seen a lot of activ for the long past and it's a veri rich literatur .
there ar numer techniqu that can be util to solv such invers problem .
the adapt on restor wa a result of the space race between the us and former soviet union in the 50s and 60s .
so for exampl , the <num> imag produc dure the marin iv flight to mar in <num> , cost them million dollar so thi were is the case with most area the activ come in wave .
it's driven , for exampl , by mishap , such as the hubbl space telescop mishap , new applic , such as the super resolut of imag and video for these huge ultra high definit displai .
and , by new mathemat develop , and sparsiti of cours the on that stand out and we'll talk about it at a later point .
restor ha seen some not all right in the media .
there's a brother field of the assassin of jfk , underw a number of restor .
and then in a number of movi such as no wai out and rise sun , the whole plot reli on the success restor of some surveil video .
let us look now at the compon of a degrad restor system .
f is the origin input , imag .
is input to the degrad system h .
nois is ad to the output of a system , and thi give rise to the observ y .
so , here's how the input look , it's an aerial shot , and here's the blur version of thi by h , plu the addit of nois .
so the object of restor is to design a system r , which will oper on the observ y , and give us an estim , of the origin imag f hat .
that will be as close as possibl to the origin on , subject to the optim criterion .
in carri out thi restor step , we assum that we have perfect knowledg of h thi is the nonblind version .
then we also need to know the nois statist , and here there's a doubl side arrow , or arrow go in and out from our .
to indic that these statist can be updat base on the partial restor imag , for exampl .
and anoth compon which is extrem critic when it come to restor , is prior knowledg on f , on the origin imag .
and thi prior knowledg can be express in variou wai and we'll see exampl of that as we proce here .
but it's also import that we ar abl to incorpor such , such prior knowledg in a rather straight forward wai into the restor filter .
wnd again there ar two arrow , .
go , toward and awai from thi prior knowledg box to indic again that thi prior knowledg can be updat as the iter progress .
now , the nois statist can be given to us which is idealist or in most case we measur them , let's sai the nois varianc under a gaussian assumpt from the avail data y .
similarli if h is not known , then it need to be estim from the avail data y .
thi is refer with a blur identif problem and in carri out such a step , it's also import that we have some prior knowledg on the properti of h .
so you do see here all the compon that ar involv in design a restor system .
again , prior knowledg is of the utmost import sinc it restrain the solut set .
and produc an estim here of that is as close as possibl to the origin imag f .
as it becam clear from the previous slide in carri out the striation , that blur is need and knowledg estim is need if thei're not known , then .
there the step of blur identif , nois estim , and restor that that involv .
and these three step can be done independ , us ani techniqu of choic .
howev , at least conceptu , it should be clear that if their done at the same time , simultan .
and by that i mean that an error in identifi the blur is taken into account when the nois is estim , and thi error is taken into account when the restor is carri out .
then on should expect improv result .
stochast method , we'll talk about them a littl bit of their , an advantag of that natur , that all these step can be .
taken , simultan .
and again , repeat here , prior knowledg on all the unknown .
h , f , and n is of the out most import in provid a solut here , f hat , that is , as , as close as possibl to the origin imag we're after .
so translat the oper shown by the block diagram into an equat here we have the observ imag y i j is the result of the applic of thi oper of thi system h onto the origin imag plu the nois that ha been ad .
so thi is a veri gener , gener model that can be found in veri mani differ applic .
so the problem at hand is , given y , and given knowledg of h , we try to find an estim of f and , of cours , know the statist about the nois .
so thi is the restor problem .
now , in mani applic , thi system can be well approxim by linear and spatial invari system and nois of cours addit , and signal depend .
and then as we know by now , in thi case , the oper of h on f is given by the familiar two dimension convolut .
so the output , the observ imag is the convolut of the input with the impuls respons of the lsi system plu nois , and here is the express for the two dimension convolut .
so in thi particular incarn , solv for f , given the impuls respons of the system , and the avail data , becom now a deconvolut .
deconstruct problem .
the system convolv , and the invers problem we're solv is to deconvolv the oper of the system , undo what the system did .
so restor is a more gener term , appli to thi gener equat , if the system again introduc degrad is lsi , then i'm solv de convuls problem .
we show here that impuls sponsor some of the most commonli encount degrad system .
so if the degrad is due to on dimension motion between the camera and the scene , so the object in the scene move on a plane that is parallel to the camera plane thi is a d plane .
and then thei move in a horizont direct , then here is the impuls respons of thi degrad system .
so here's thi shape .
and here we assum that l is an even number so l over two is an integ .
the extens of thi is if the motion is at an angl , not along the horizont direct but at an arbitrari angl theta , and that's also someth that can be handl with not major difficulti .
if the distort is due to atmospher turbul , then the long term exposur through the atmospher is model like thi .
thi impuls is respons for the degrad system , so thi , thi ocean here control by the variant of the ocean .
if it's an out of focu degrad , then thi disc , in two dimens , i , j , is , repres the impuls respons of the system , so it's a function of the sever of a , the focus is a function of the radiu of thi disc .
and final the pill box distort is kind of the extens of the on demot so it squar here from minu element two clone .
two in both dimens and again l in thi particular case is assum to be an even number so that l over two is an integ .
so well be make us in some exampl so some of these degrad .
but there again can be found in the literatur there rather wide us .
in the imag restor commun , in assess the qualiti of the degrad imag , we util not the signal to nois ration , but the blur , signal to nois ratio instead .
so here's the model we've been us , the degrad model , the observ imag is the convolut of f with impuls respons of the system plu nois .
so if we call the blur imag here gij , then in the num , numer you see the varianc of g bar is the mean or expect valu of b .
we assum the imag ha m time n pixel .
therefor , the numer is the varianc of the blur signal and then the denomin is the varianc of the nois .
in assess the qualiti of the restor imag for simul situat where the origin imag is avail we us thi isnr matrix improv in signal to nois ratio .
so in the b term log base <num> in the denomin of thi fraction we'll put the differ the squar there between the origin f is the origin .
which , again , in a simul environ is avail and f hat is the restor , so the distanc between the origin thei restor .
so , that's the error in the estim and in the numer is the quantiti f , the origin minu y , the observ .
so thi arrow squar .
so these ar two quantiti that we will be util for the rest of thi present restor , blur signal to nois ratio and improv in signal to nois ratio .
in thi segment , we introduc a mean to repres all pixel in an imag as a vector .
thi then introduc an altern wai for repres the degrad equat in the restor problem .
it becom a vector matrix equat .
if the degrad is lsi .
then thi degrad matrix ha a specif form .
it is a block circul matrix .
it is straightforward to describ thi matrix in the spectral domain , by find it eigen valu and eigen vector .
we studi thi properti which allow us to take the degrad equat to the frequenc domain , someth of cours we know we can do , base on the materi we cover in week three .
the reason of cours we devot thi lectur to studi thi altern represent of imag and the matrix vector version of the degrad equat .
is not to just do some math , but becaus thei provid the flexibl represent of imag and system that cross them .
and thei're also us sinc we can now easili borrow tool and the result from linear algebra optim theori , in provid solut to these invers problem we ar interest in .
befor we proce i would like to introduc a vector notat for imag and then make thi vector notat for the convolut equat .
so let's assum we have an imag , of dimens n by m .
so thi is the imag here .
the standard wai we've been us , so far , to repres an imag is xm1 and <num> .
where n<num> rang from <num> to n minu <num> and <num> , from <num> to m minu <num> .
we would like to repres thi two dimension arrai .
thi imag as a <num> dimension vector .
so i'd like to write thi imag as a vector x .
and now vector can be shown in bold face , or sometim with an underbar or an overbar .
it should be clear from the context that a vector is involv .
so on wai to do it , is to take each row of the origin imag , so here's row <num> , row <num> , row n minu <num> .
and turn each row into a column vector , so thi is row <num> transpos .
so it come here .
row <num> transpos all the wai do to row m minu <num> transpos .
so the n by m imag is now convert into an nm time <num> vector .
so thi is the process of stack an imag into a vector .
and if the stack is , shown here .
i stack by row .
then it's also refer to as lexicograph order .
so it should be clear .
from now on , that thi function represent x function of n <num> and <num> , and thi vector represent can mean the same thing , mean the same thing in what follow .
let us consid the on dimension convolut of two on dimension signal , x of n convolv with h of n .
let's call the result quot y of n , and we know that thi is equal to the sum of the k , x of k h n minu k .
let's assum for simplic that x of n , here support from <num> to n minu <num> .
and sampl in other word .
h of n is support from <num> to l minu <num> .
and as we know , the result of the convolut will have support the sum of the limit of the support .
so from <num> to n plu l minu <num> .
i would like to consid all the valu of a signal y , and stack them into a vector .
so i'd like to form the vector y <num> , y <num> , all the wai to y n plu l minu <num> .
so thi vector .
is , n plu l minu <num> by <num> vector .
so thi will be equal to matrix here , that will multipli the signal x , so here is x <num> , x <num> , x of n minu <num> .
so x clearli ha dimens n by <num> .
and therefor , thi matrix ha dimens n plu l minu <num> time n .
so , if we follow the step of the convolut , we take ag , we flip it around , find h of minu k and then shift it by n .
you can see that y <num> is equal to h <num> time x <num> .
y <num> is equal to h <num> time x <num> plu h <num> time x <num> .
then i'll have here , thi row of h's .
and the rest of the valu here not shown , thei're all zero .
so if i call thi a vector y , and call thi matrix h , and then a vector x , i wrote .
in matrix form , is out of the convolut , becaus then all the valu of , of the signal .
i can , kind of combin them all into thi matrix vector form again , y equal hx .
we observ at h , here's thi specif form that is the valu along each diagon ar equal .
and thi is refer to as a matrix .
we will see next that by modifi the signal and the matrix , we can write inde that the matrix vector form for , for the central convolut and then thi matrix h is go to have anoth form which we call circul matrix .
i would like to perform the circular convolut of x of n with h of n .
so that the result of the circular convolut equal that of the linear convolut .
in order for thi to be the case , i should carri out the circular convolut with period n plu l minu <num> .
let's call thi y of n again .
so if thi mean i should pad x of n with l minu <num> 0s and then carri out the convolut .
so , if i do the same thing here now , which is to put all the valu of y into a vector .
thi will be equal to a squar matrix .
it's now multipli x .
and x i'll have the origin valu of x .
<num> , <num> , all the wai to n minu <num> .
and then i'll add it with zero .
and the number of zero is equal to l minu <num> .
so if we look at the structur of h here thi matrix .
it will have h <num> on it main diagon .
h <num> on the diagon below it .
all the wai .
<num> h l minu <num> .
would be <num> here and then , in thi corner would be h<num> , h2 , h l minu <num> .
and i'll have let's sai here h , at minu <num> .
and z everywher els .
it is to verifi that inde that the valu you ob , obtain here by get out thi matrix vector multipl ar equal thi y valu to the valu you obtain from the linear convolut as shown in the previou slide .
so again , i can write y equal h x .
h now ha also a special structur .
the structur now is that if i take ani row of h , and i circularli shift it by on to the right , then , and circular mean that the element that leav the matrix due to thi shift to the right , wrap around and appear at the other end .
of the , of the row at the begin of the row .
and i'll do , i can do thi for all row includ the last row .
so if i set to receiv the last row , i'll obtain the first row .
so thi matrix is call the circul matrix , and here's some us properti that we , we will talk about next .
we found in the previou slide , that if i us a matrix vector present of secular convolut , i end up with a secular matrix .
here's a simpl exampl of a <num> by <num> , secular matrix .
so the element of the first row ar these , a1 , a2 , a3 , a4 .
i gener the 2nd row by circul shift the first shift the first on .
so thi is a1 , a2 , a3 .
a4 wrap around and come thi place .
a1 , a2 , a3 , a4 wrap around .
and final , a1 , a4 , a3 , a2 .
so clearli for thi <num> by <num> matrix if i know the element of it first row , i can defin the whole matrix , sinc again .
qundro ichero is gener by the secular shift of the row abov it .
so if i look at the gener matrix h it's a circular matrix .
the element of the first row ar h <num> to h .
m minu <num> i don't write the remain of the row in again secular shift of the first on .
for ani secular matrix find it's hegan valu and hegan vector which is by and larg a difficult problem , is rather straight forward .
and thi is so .
becaus , let me first denot by lump in w , it's e convector or the ws and .
and lambda , the eigenvalu .
so the eigenvec , vector of ani circul matrix ar known in advanc .
the nth eigenvector is equal to thi .
and on should recogn right awai that these ar the basi vector of a discret fourier transform , these complex exponenti .
and the set of eigenvalu , ar simpli , the discret fourier transform valu of the first throw of the matrix .
so again a veri straightforward and import properti of circul matric .
so the singular valu composit of the origin matrix , is simpli equal to thi .
i put the eigen vector here as column vector of the matrix .
the eigen valu becom the diagon .
element of a diagon matrix .
and thi matrix is the first on , actual should be <num> here , on the first on .
minu <num> , it's an invert matrix .
so i can write ani secular matrix h as wdw minu <num> , but again these thi diagon matrix that ha it at it's diagon .
the discreet fulli transform of the first row of the matrix .
base on what you've seen , let's assum i have the secular convuls of x of n circular length n with h of n .
let call thi y over n .
we know from the studi of the discret fourier transform that thei can take thi equat to the discret frequenc domain , where the convolut becom multipl .
so these ar the discret fourier transform of the correspond quantiti and thi is an endpoint dft .
so k goe from zero to n minu <num> .
now we saw that i can take thi equat here and write it as a , matrix vector form .
where h is a block circular matrix .
and we did see that h can be written also , it singular valu composit is equal to thi .
therefor from here , if i multipli by w minu on both side thi becom equal to thi .
it can be easili shown that w minu on signal is the discreet fulli transform of the signal .
so , thi is the dft .
of y , all the valu .
and thi is the dft of x .
so thi give me , thi is a vector clearli , so thi vector give me all the valu of the dft of y .
and d is a diagon that ha as it element the dft of h , so thi is h <num> to h n <num> .
and here's the tft of x .
so we see whether we're wait with a point wise here version of a circular convolut or the matrix vector form of the circular convolut .
by either take the d f d here , in a straightforward wai , i end up with a point wise relationship in the discret frequenc domain shown here , or by consid the spectral decomposit of the matrix ag , which is second , i end up with the matrix vector represent of the discret fourier transform .
so thi is someth veri import to keep in mind that we will be make us a multipl time .
base on what we have discuss so far , if i , if i have a linear system h that accept f as it input .
and the nois is ad that it's output to form the preserv y .
i can repres thi system in the matrix vector format shown here by stack lexicogrhaph more specif stack the imag into vector .
now the system in addit to be linear is also special invari .
then the input output relationship ar repres by the familiar by now two dimension convuls .
in thi case the matrix h ha a special structur , it's now block circular matrix .
which mean that it is circular circular at the block level , so you see if i take the first row of block .
and shift circularli , i will obtain the second row of block and thei keep go if i take the last row of block and secondli shift .
i will obtain the first row of block .
but each block is also a circul matrix .
and that's a definit of a block circul matrix .
if let's sai for simplic , h here , ha a first quadrant support .
and thi is the 0th row , thi is the 1st row of the impuls respons , thi is the n minu <num> row .
then the zero'th row would be us to form the sub matrix h zero .
the first row of the sub matrix h <num> and all the wai to the sub matrix h n minu <num> .
so thi simpl respons that i show here .
is all that's need to form thi block circular matrix .
becaus for each block i need it first row , and then , that's all i need , becaus it's circular at the block level .
the stori with block circular matric is the same as with circular matric i mention earlier .
so if h is a block circular matrix .
it can be decompos as shown here .
w ha as element , the eigenvector of ag , which ar the two dimension complex exponenti , also the two dimension dft .
and d here is a diagon matrix .
with element that stack valu of the two dimension dxd of hij , so then if i start with the observ equat as shown here , i substitut the valu of the decomposit of h here and then .
i pre multipli with w minu <num> to , to obtain thi .
so w minu <num> y is , repres the stack valu of the two dimension dft of y .
and similarli , w minu <num> f repres the stack into a vector valu of the .
that could be measur of dft of f .
so in anoth word , thi equat is equal to y equal d , f plu m , where again here , i have start the two dimension dft of the imag y .
i have stuck in the vector here two dimension dft valu of the imag f and these ar diagon matrix that ha the dft of h .
if i look on element of y sinc thi diagon is go to give me on element of the discret fulli transfer of the imag y .
so each entri of thi vector y y repres the point ys here , frequenc u , v .
these , these ar the discret frequenc , of , of the dft .
in what follow we're go to need some veri basic element of linear algebra that i would like to mention .
so given a n dimension column vector , x , the l2 norm of the vector squar is simpli x transpos x .
it's a scaler .
and thi is equal to the sum of xi squar .
so , appli thi to a term like thi , the definit of the norm that is , thi is y minu hx transpos .
y minu hx .
and if i carri out all the cross multipl thi is equal to thi right these ar all scaler these ar inner product .
and the on is the transpos of the other therefor thei're equal and thi becom equal to y transpos y minu <num> x transpos h transpos y plu x transpos h transpos h .
h x .
we'll also need the notion of the gradient over function all over norm .
thi is , by definit , thi is a vector , intim of vector that ha .
the partial respect for x <num> of the norm squar , all the wai to the past with respect to x squar of the norm squar .
and if i us the express for the norm , i just show in the begin it's the sum of the a x of y squar .
then clearli if i look at ani of these partial deriv onli on term that depend on a particular x or y .
so the first term , there's onli on term depend on x <num> .
so thi is <num> x1 , down here it's <num> xn , so thi equal to <num> x .
so appli thi definit you should be abl to verifi that the gradient with , gradient with respect to x of x transpos y is equal to y .
y , the great , in respect to x of the quadrat term here is equal to <num> time h transpos h x .
we discuss in thi segment the simplest restor filter on can deriv , the so call invers filter .
the invers filter ha tradition been develop for an lsi system , and it can therefor be implement in the discret frequenc domain .
in thi case , you just invert the degrad oper , at least for the frequenc it is invert .
we present actual the invers filter as the solut to a least squar problem which result in the gener invers filter even when that the degrad is not linear especi invari .
we demonstr the perform of the filter in restor an imag which is blur due to motion .
we're go to us the same exampl for the materi present dure thi and next week so as to be abl to make direct comparison among the variou restor feeder .
the main drove of invers filter is that it amplifi the nois present in the data .
so even if the nois is not visibl in the observ imag , it is greatli amplifi in the restor imag .
due to thi main drawback , an improv version of the filter will be present next .
the simplest possibl restor filter on can devis is the invers filter .
here's the degrad equat we're us , y the observ imag .
h , the known degrad , and f , the origin imag we try to find , and the addit nois .
with a model like thi , the onli constraint dure possibl degrad , is that it is linear .
so given the degrad model , the simplest possibl solut approach is to minim thi squar error between the observ and hf .
a necessari condit for thi function to have a minimum , is that it's gradient is equal to <num> .
and by the wai , thi is the same gradient that i denot like thi earlier on .
so we do know that the norm can be expand as follow .
so thi term is independ on f .
it can go awai , and then as i show earlier , the gradient of thi term is minu <num> , h transpos y .
y's the gradient of the quadrat term is <num> time h transpos h f .
so thi should be equal to <num> , and therefor we obtain the so call normal equat .
so the solut f is equal to the gener invers .
thi is thi plu here .
so gener invers .
if h transpos h is invert , then that's the regular invers .
so thi solut , again , is for just ani matrix with no particular structur .
now , if the degrad system is linearli special in variant , we then know that h is a block circul matrix and we furthermor know that thei can take the solut .
equat to the discret frequenc domain , and if we do so we end up with thi solut .
so accord to thi the restor imag had frequenc discreet frequenc uv is equal to <num> when the frequenc part of the system as those frequenc is equal to <num> .
otherwis , it's given by thi express here .
thi express actual can be rather simplifi becaus i have h transpos , i'm sorri , h cong , conjug uv , yuv , and then the magnitud in the denomin , is h complex conjug , time h .
so these gui cancel out and thi is just the observ of the frequenc domain over the frequenc respons of the system in the frequenc domain .
and clearli you can obtain thi express by just look at the convolut equat , and take it to the discret frequenc domain , and divid by thi sinc convolut becom multipl .
clearli the main disadvantag of the invers filter is the fact that the nois is ignor as mention , and if we look at thi express here right , y is equal to h u v f u v divid by eight uv .
so thi will give me the through solut plu the nois , then , divid by huv .
now , the nois ar assum to be broadband and , therefor for those frequenc that huv is small .
i have , cours divid by someth veri small .
so , thi give me a larg number that's the nois of litig .
i can try to control the nois amplif by introduc a threshold here .
so i'm not look for exact 0s of the frequenc respons here , but for valu that ar smaller than a threshold t , otherwis for valu greater than t i us the other express .
so let's see how thi invers filter perform through some exampl .
so here's an exampl would be us , kind of , throughout thi present to compar differ restor approach .
there's the origin imag , cameraman .
it's blur by a system h here which introduc motion blur over eight pixel in the horizont direct .
and then nois is ad so that the blur signal to nois ratio is <num> db , so thi is clearli blur .
the nois is hardli visibl , but through the restor , when it's amplifi it will be realli visibl and bothersom .
so with thi set given thi imag here thi is our observ again y with no h .
thi is the descript of h and we try to get an estim of the origin limit .
well let's at the impuls frequenc respons of the degrad system .
it's introduc on dimension motion , blur along the horizont direct .
so , thi is a point spread function , the impuls respons .
it's normal therefor the height of each of these sampl is on over eight .
so in in two dimens if from left to right h n on and two it's equal to h n on which is thi on if i renam it time delta at m two .
so it take if i take the fulli transform of thi signal here we do know that the sink function .
and so thi is the discriptfulli transform .
let's call thi the u domain .
so i show the magnitud of h u , v discret frequenc for ani v .
so thi is independ of v so it will be the same for everi v .
so it center .
so thi a <num> point dft .
thi is therefor <num> .
the height is <num> , sinc thi is normal .
and then it wa chosen carefulli , thi motion blur over eight pixel becaus the 0s ar at integ multipl of <num> over <num> .
let's sai time l .
so thi is equal to 32l . l so the space in between the zero is <num> , therefor thi is at <num> plu <num> , so thi is at <num> .
the next on is at <num> , and the last on is a <num> .
right and similar in the other side thi is zero at <num> , <num> at <num> and a <num> at <num> .
so there exact 0s at these discret frequenc .
so if i look at the two dimension frequenc respons , the magnitud squar .
it look like thi , it's thi sync function so thi is u , thi is v , axi .
so , the shape chang along u but it doe not chang along v .
it's independ of v , all right ?
so thi is the , the frequenc respons of the system that is introduc the <num> dimension motion blur and thi is what we want to invert .
that thi is all about , right ?
the restor .
i want to , to invert in the frequenc domain thi shape and thi will give me the invers filter .
we see here two result .
that ar obtain by thi threshold invers filter for the case under consider .
motion blur over eight pixel plu <num> db blur signal ration .
so , two differ threshold ar util here <num> to the minu <num> and . <num> .
the main observ is that both restor , thei look veri similar actual , and thei're both buri in nois .
so thi is not an accept result .
we show here also on slice of the frequenc respons of the restor filter , which is equal to on over the frequenc respons of the degrad system .
we see that the at the locat , frequenc locat of exact <num> , the gener invers is also equal to <num> .
without do , us thi gener in thi idea , on of the 0s should blow up .
thei should be infin valu .
at <num> the frequenc is on .
right , it's normal while anoth on is on .
and then at higher frequenc , becaus the frequenc respons becom , of the degrad system is smaller .
when i invert it , i see larger valu of the restor filter at high , higher frequenc .
let's see now how we can control the result by modifi the threshold us a higher threshold .
we show here two addit restor , by thi threshold invers filter for the case on the cours of iter .
so the threshold ar increas to thi valu and thi valu .
and we see now that there is some distant control of the nois amplif .
as a mat , as a matter of fact , thi might be a .
accept restor result .
we also show the frequenc respons of the correspond restor filter .
sinc there ar small , smaller valu in the frequenc respons of the gradat system at higher frequenc these ar the on that ar fresh when i look at the invers filter down here .
the main characterist is that the high frequenc ar taper off .
the valu ar , ar increas , decreas , with high frequenc in both these , restor .
i've kept the vertic axi intention at , the same kind of length here , so that it's clear it's easi to compar the valu .
restor filter , so while at low frequenc the invers filter is , is faith .
at high frequenc the invers filter is , is alter due to thi threshold , but thi is a desir effect , sinc the nois simplif is control .
that wai .
we increas the valu of the threshold even further to these valu .
and we see that as t increas , the nois is further control , so we see less nois at the output of the restor imag .
the frequenc respons of the filter is out , out of consider .
i feel for thi threshold here that you see it's onli at low frequenc and these mid frequenc that the that there restor filter ha some valu , and everyth els is <num> .
we see some of the so call rind artifact here that we'll talk a littl bit about later .
so these ar artifact , undesir effect in the imag .
so mayb thi is also an accept restor .
so we do see here that the invers filter by itself is not do an accept job becaus primarili it amplifi nois .
through the introduct of thi threshold , we're abl to control the nois amplif in an ad hoc fashion .
we don't know .
what the proper valu of t is .
howev , on might experi around , as we did here , and choos a restor that is suitabl for their purpos .
thi cl filter and it's variant is probabl on of the most common util restor filter .
it simpli turn an unconstrain least squar of optim problem into a constrain on .
it restrict the solut space of the least squar approach .
by incorpor into the problem prior knowledg about the solut .
a meaning solut , therefor , result thi wai .
the mechan of find the solut to the constrain problem ar not a challeng .
thei present some standard optim step .
the real challeng is how to best repres thi prior knowledg .
and the determin of the signific or the weight of thi prior knowledg toward the final solut .
thi weight is typic refer to as a lagrang multipli or a regular paramet .
and control the rel import of the fidel to the data term , and the prior knowledg term toward the final solut .
we will explain all these aspect in detail in thi segment .
a wai to improv upon the solut we obtain through the least squar filter .
or the english filter , that we just describ is to impos a constrain on the solut .
so as befor , we minim thi error term .
with respect to f but subject to the constraint shown here .
c's an oper that need to be chosen .
it's by and larg a high pass filter or oper .
in which case thi constraint tell us that the energi as impos by the norm .
of the restor imag at high frequenc is below a threshold here .
which mean that we don't allow arbitrari high frequenc fluctuat in the solut .
or put it differ , thi impos a smooth requir on the solut .
so i have thi term that reserv the fidel to the data .
and thi standard express prior knowledg .
and so the wai to solv the constrain problem is to relax it , and turn it , turn it into an unconstrain problem .
through the introduct of a paramet , alpha here .
which is refer to as either a regular paramet or lagrang multipli .
the regular is the process accord to which you try to have the solut depend continu on the data .
or not allow the nois amplif that we saw in the previou exampl .
so now we have to minim the function insid the parenthesi .
we take the gradient of it , with respect to f , we set it equal to <num> .
someth that you can do now , sinc you've done it for the least squar .
plu i've given you all the formula that you need to carri out thi gradient oper .
and if we do so , we'll see that the solut is given by thi express .
so f is the restor imag , here's a matrix that , again , i find it's gener invers .
if it's invert , that's a regular invers .
time thi vector here .
anoth wai to interpret thi introduct of the constrain is by look at thi matrix .
if h dispos h , is not invert , then the addit of thi term might make the matrix invert .
or by and larg , the condit number base on expos h is larg that's an express of thi repos as it's refer to .
and the addit of thi term make the condit number smaller .
and therefor , the problem behav better .
on choic for c is to be a high pass filter such as the 2d laplacian , and thi is the impuls respons of the 2d laplacian .
we did mention it when we talk about enhanc and we're go to studi it a bit more , actual , carefulli when we talk about segment .
so if both c and h ar block circul , then i can take thi express to the discret frequenc domain .
and thi is the express of the constrain least squar filter , under thi case , again , of h and c block circul .
and therefor i can bring everyth into the discret frequenc domain .
clearli , if alpha equal <num> , then cl , constrain least squar becom least squar or invers filter .
by and larg the solut f is a function of alpha , clearli , right .
as can be seen from here .
and alpha should be chosen in such a wai that c of f of a , the norm of these squar should be less than epsilon .
so , assum that we know epsilon , we have to adjust alpha appropri so the constraint is satisfi .
so let us see now how thi filter perform and how it compar with the , the least squar filter .
so again for the exampl of in consid .
thi is the magnitud of the frequenc respons of the degrad system , is just , the frequenc respons of thi on dimension motion blur .
we've seen thi befor .
thi is u , thi is v .
and thi is the frequenc respons of the constraint filter .
so thi is the magnitud of the 2d laplacian .
it's a high pass filter . there's <num> here at the center .
it's the actual it's <num> at <num> if you look at the impuls respons .
and the just grow to high frequenc so if you look at you know the variou frequenc like pie pie or minu pie pie .
it's achiev it's largest valu which is equal to four .
okai , so thi is the filter we us to carri out the constrain least squar filter .
so , we see here that the denomin of the constrain least squar filter .
thi is the valu of alpha , <num> .
so i add the magnitud of the low pass degrad filter to the magnitud of the high pass regular filter .
so thi is the shape here , and the main characterist is now .
i don't have small valu anymor , veri small valu .
actual , i don't have the exact 0s that i had befor in , right , that thi , thi function ha .
and at high frequenc , you see that the valu increas , right ?
so , when i'm go to invert thi now accord to the least squar filter , i'm , i'm not go to have <num> over veri small valu .
that will just amplifi nois and , and thing of that natur .
so actual , thi is the magnitud of the least squar filter for thi particular choic of alpha .
and of cours for thi particular c , we're talk about here .
so again thi <num> , <num> is in the center so thi is on over the sink with alpha equal <num> .
and we see that the restor filter's taper off at high frequenc , right it doesn't get amplifi at high frequenc .
so it ha kind of larg valu at mid frequenc and then drop off as you go to , to high frequenc .
so thi doe not allow , again there the nois amplif that we've seen befor .
as in the previou slide , we show , here , the denomin of the constrain least squar filter .
for a differ alpha , alpha is <num> . <num> , an order of magnitud smaller than in the previou case .
so becaus of that , the shape of h u , v ha not been alter that much .
howev i don't have the exact 0s that i had befor .
so the addit of c ha made the denomin of the constrain least squar filter better behav .
so now the magnitud of the constrain least squar filter look like thi .
again the main characterist is that the high frequenc have taper off .
thei don't go up to high valu and is respons for nois amplif .
we show here three differ restor by the constrain least squar filter for three differ valu of alpha , the regular paramet .
so the gener observ is that , as we explain alreadi , as alpha becom smaller and smaller , we move thi direct .
we move closer to the invers filter and therefor we see more nois present in the restor imag more nois of the fixat .
or go thi wai the as alpha increas the solut is a smoother solut becaus we have those two term .
fidel to the data and smooth of the solut .
so a higher alpha give more weight to the smooth of the solut .
when i minim it , therefor , i have to make the norm of cf much smaller now as alpha increas .
and therefor , thi result to a smoother solut .
so i have thi knob , i have thi paramet alpha that now i can adjust and control the smooth of the solut versu the nois amplif .
and if epsilon again is given in the constraint .
if epsilon is given , then i have to adjust alpha so that thi constraint is satisfi .
if epsilon is not given to us , then we just either pick alpha by trial and error , similar to what we show here .
or util a number of techniqu that exist , such as cross valid techniqu that will let us , choos the appropri alpha .
let us now have a closer look at the effect of the regular paramet , which you call alpha , on the qualiti of the restor imag .
base on constrain least squar filter .
so it ha been shown in thi work shown here .
that , the error between the restor imag , which is a function of the regular paramet .
and the origin imag is given by thi express .
don't worri about thi expect valu .
thi is an express that hold through on the averag .
so there ar two term .
a bias term , which is a function of the restor imag .
and the varianc term , which is also a function of the restor imag .
actual , the exact express for the varianc and bia ar shown here .
all the quantiti in these express have been defin previous .
sigma of n squar is the varianc of the nois .
and the imag dimens ar n by n .
if i plot these two quantiti , the varianc of the bia for a specif imag , actual linear wa us .
the degrad wa due to a <num> by <num> flat .
impuls respons , the 2d laplacian wa us for c .
and the signal to nois ratio wa 20db .
we see thi plot here .
so , on the vertic axi , thi error is shown .
while on the horizont axi , the valu of alpha ar shown .
there's actual a veri wide rang of the valu of alpha go from <num> to the minu <num> to <num> to the 4th .
so there <num> order of magnitud .
and actual the vertic scale goe from <num> the minu <num> , to then <num> to the 12th .
so the main observ here is that , the bias term , thi term here , increas as a function of alpha .
so the larger the alpha , the larger the bia in the solut .
while the varianc term decreas as a function of alpha .
we show here in solid line the sum of these two term becaus thi express the error .
our object clearli is to minim thi error between the restor and the origin imag .
therefor , we're interest in find the minimum of thi solid curv .
a point around here .
so then , the correspond alpha should be the optimum on might sai alpha with respect to mean squar error that on would like to us .
thi function here could be rather flat for a rang of valu .
so it mai not be a singl point , but a rang of valu of alpha .
let's sai thi on , for which the function of the error is pretti flat , achiev the , the , the smallest valu .
so thi then show that the solut is robust with respect to alpha .
seem there might be a coupl of other magnitud of valu of alpha that will give , the smallest possibl error .
so let's see how these term , the varianc of the bia man , manifest themselv with a specif exampl .
so let's look at the effect of the regular paramet on the cl solut , with the us of an exampl .
so , us the same exampl throughout thi lectur .
so the blur imag is due to motion over eight pixel .
blur signal to nois ratio is <num> db .
and here is the restor imag for alpha equal <num> . <num> and here is the error the absolut valu of the error between the origin and the restor .
and sinc thi is small , but in larg it's map linearli into thi rang <num> to <num> for visual purpos .
there's the smallest alpha we'll us .
so , the imag is rather noisi .
and then is we look at the arrow , it give the appear of nois .
so if you recal from the previou draw we had there .
the figur at the small let's sai valu of alpha , the varianc is rather larg and the bia is , is small .
and there's alpha increas , the bia increas , and the varianc drop .
so , look again at thi error here , we can sai that it it look again like nois .
it ha a larg varianc .
it doesn't reveal much about the structur of the imag mai be a littl bit .
so if we increas out for now and to look at the restor , we see as we know by now a smoother imag .
the nois reduc , but look at the error the varianc of these error imag is reduc but the bia ha increas .
and by bia it mean that now the error ha ha some structur .
it tell you someth about the origin imag and actual what it tell you is the error is domin at the edg of the imag .
at the region of high frequenc .
becaus what happen , as alpha increas .
you give more prefer , more weight to the smooth .
you prefer the smooth solut , which mean you filter out some of the high frequenc of the imag , as well .
the imag becom smoother .
and therefor , the error show here .
it largest show the , the edg configur of the imag .
if you consid even a high alpha equal on , then the restor is even smoother .
and thi is the error term .
no nois in it , you might sai , but the edg ar pronounc .
the , the bia of thi imag is , is greatest out , out of all the restor we had .
the choic of the regular paramet alpha is of the utmost import .
sinc as we saw , determin the tradeoff between nois amplif and smooth of the solut .
we briefli discuss here some of the method to determin it .
so if the nois varianc is known then thi problem is solv .
we minim the stabil function subject to the constraint that , thi , discrep is equal to epsilon squar the nois varianc .
then , we choos alpha so that y minu h f , which is a function of alpha , squar is approxim equal to epsilon squar .
so on can deriv here iter wai to adjust alpha so that thi is satisfi .
now if the nois varianc is not known , on can us visual inspect that is the human the loop approach .
the human oper assum that he or she ha some knowledg about the structur of the imag .
sai it's an imag of a natur scene , can choos alpha so as to produc the most desir or us solut .
now if an iter algorithm is us , to implement the cl filter , then , as we saw , the number of iter can be us as a mean of regrad .
so a second method , if the nois varianc is not known , is the l curv .
if we plot here , in a log log scale , the fidel to the data term .
and the log of the stabil term then as a function of alpha thi curv is go to have a shape like thi .
so here alpha is two small and therefor , it's under regular solut .
while at thi end so as alpha chang i travers thi curv here .
alpha is too larg which mean that we over regular the solut .
so thi point here , thi look like an l curv .
and thi point , therefor , is a transit between and under regular and an over regular solut .
and therefor it seem like a reason choic for , for alpha .
so thi is the alpha star that we ar after .
and the third approach i would like to mention here , where again the nois varianc is not known .
so for all these approach .
nois varianc unknown is the gener cross valid approach .
the gener idea behind it is to minim the set of predict error .
that is to choos alpha so that the regular solut obtain with a data point remov predict thi miss point well .
when averag over all wai of remov a point .
specif express result in the , is quit some detail in thi refer here about it .
so here is a repres list of wai of choos the regular paramet .
and when we cover bayesian techniqu , we'll see that thei provid a mean to estim the regular paramet as well .
we want to briefli discuss here , extens or gener of the constrain least squar filter , we discuss so far .
we show the express for the filter here .
we minim the sum of these quadrat term .
the fidel to the data term , and the destabil function of it .
so , both of these ar l2 norm , or quadrat term .
and as we saw in the case , we can obtain a close form express for the solut that minim thi sum of quadrat .
in gener area restor can be obtain by minim thi function up here .
where j <num> repres the distanc measur between the data and the restor imag after it ha been process by the system .
and j <num> is the gener stabil term .
so in gener both j <num> and j <num> mai be non quadrat function of , of f .
in thi case , no close form express for the solut can be found .
as wa the case with cl .
and in thi case , on ha to result to iter optim solut .
the success approxim iter we just cover might present on possibl choic .
but of cours , there ar a number of method avail from optim theori .
we will not discuss ani of them here sinc thi is outsid the scope of thi cours .
so here's some exampl , and rather popular choic of these j1 , j2 function .
so the first on is the maximum entropi regular term .
so thi is the express for the neg of the entropi .
and instead of maxim the entropi , we minim the neg of the entropi .
we'll talk about the entropi concept when we cover compress .
but in gener is a measur of the uncertainti or the random in the imag .
therefor an imag with maximum entropi is a smooth imag .
the entropi's a non quadrat term and therefor a non linear optim problem result that need to be solv iter .
thi is a regular term or an an approach that maximent be approach that ha been util quit wide .
the t tv or total variat equal is anoth popular approach .
delta of f here is the gradient of the imag .
and is is the ith compon , or the gradient of the ith pixel .
so we assum that the nth pixel is veri much , as wa previous the case .
and therefor , the total variat of the signal , is the total amount of chang the signal goe through .
and is therefor a measur of the signal variabl .
we want to control such variabl and therefor a smooth requir is import to solut by minim the total variat .
the result problem is also non linear and therefor either of the optim method need to be deploi .
the main idea of the non quadrat function is to be such that thei do not penal larg valu of their argument as much as the quadrat .
the l2 penalti doe .
a regular with such properti is the lp norm , that's shown here .
so p is between <num> and <num> , and we take the ith element of the vector z , we rais it to the p power .
and with some of the old reentri of the vector of the pixel of the imag .
so if p is chosen between on and two as shown here , these function ar still convex function of their argument .
and therefor , the optim is rather straight forward rel speak .
thi lp norm can be us both for the j1 , and the j2 function here .
we're go to revisit actual these norm when we talk about sparsiti in the last week of class , sinc these norm promot spars solut .
we present in thi segment a gener framework for solv estim problem .
like the recoveri problem we're address dure thi and next week .
the framework is rather intuit and quit power .
and it ha been appli toward the solut of variou signal estim problem .
of cours , we appli it here specif to the imag restor problem .
accord to it , we ar interest in estim a signal that belong to a number of set of signal .
each set repres the collect of signal that possess a certain properti .
for exampl , can defin the set of all smooth imag or the set of all imag that onli accept non neg intens valu .
which is a veri reason request given the natur of light .
if the set ar convex , then the problem we ar ask to solv is simpl .
on wai to obtain a solut in later section of the set , assum it is not empti , is to altern or project onto these set .
it's a rather intuit and smart framework , as we will see .
i would like to briefli discuss anoth approach toward solv recoveri problem or estim a signal .
under the name of set theoret approach .
and you'll see that , if we appli to the specif problem at hand , the imag restor problem .
we can come up with anoth version of the constrain least squar filter .
thi approach is rather intuit .
accord to it , we ar look for a signal , an imag , but ha a set of properti .
so , each properti defin a set , such as the on shown here .
so , all the signal , all the imag that belong to thi set , have a specif properti .
the set of signal have the second properti we're interest in defin anoth set , such as thi on .
and there could be a third , a fourth properti and so on .
so for the problem at hand , the imag restor problem , the exampl of the first set is a set of signal that satisfi thi inequ here .
so thi is the set of the imag that have high frequenc , that have energi at the high frequenc , less than absolut squar .
sai again , a high pass filter and therefor thi is the energi of high frequenc .
and thi is the smooth constrain , as we explain earlier .
so all these signal that belong to thi set ar smooth .
by the wai , thi set is shown as an ellips here in the n dimension space is an ellipsoid , the gener of an ellips .
and is therefor a convex set , an import properti of such set .
the second set you can defin base on our restor problem is , is shown here .
so , it's the set of imag that have thi differ y minu hf be less than e squar and thi is the fidel to the data constraint .
so , we ar look for an imag that ha both of these properti , it's smooth and satisfi the fidel to the data .
therefor , we ar look for an imag that belong to the intersect of these two convex set .
and thi intersect is go to be convex as well sinc the set ar convex .
so thi is the gener setup of a set theoret approach .
and the question now is , how can on obtain a solut in the intersect of these two set .
by the wai , these two set , mai have a non empti intersect , or mai not .
so typic , after we find the solut , we do a posterior test .
and we test if , inde , the solut satisfi both constraint .
belong to both set , as we would be interest in .
so , on approach to find the solut is to bound the intersect by anoth ellipsoid , as shown here .
and choos the center of thi ellipsoid , of thi bound ellipsoid as the solut .
we'll see that thi approach can result in a constrain least squar filter .
so i have again two set , a set c <num> and c <num> , each of them repres a set of imag with desir properti .
thei intersect , c <num> is the intersect of the two set .
and i'm interest in find a solut in the intersect of the two set .
an intuit , veri clear approach is to util project onto convex set , approach algorithm .
so accord to it , i start from an arbitrari initi condit f <num> and i project imag of <num> into the first set .
so there's the project p<num> on set c <num> of f <num> .
then i take thi point and project it onto the second set .
so thi is now the project two , on to set two , on the set c <num> of the point p1 of f <num> .
and thei call thi f <num> .
and i keep repeat thi process .
i now take thi point , project it to c1 .
and then , i'll take it and project it back to c <num> and so on .
so , the theori tell us that , in gener , if i have m , such convex set .
if i repeat thi project onto convex set or altern project algorithm , right .
i start with an f <num> arbitrari and project onto the first , the second , the m set .
thi give me the new updat , f of k minu <num> becom f of k .
and thei keep repeat thi wai .
then , in the limit , after so mani iter .
the solut of star here is go to be in the intersect , c <num> , of thi m , in gener , convex set .
so thi should be a veri , again , intuit clear algorithm .
of cours , these project , depend on the descript of these set , might be a rather straightforward wai to find these project .
or it might be terribl com , complic .
so the theori of , set theoret estim follow then ani of the two solut approach i mention .
ha been appli to a number of problem successfulli .
and if i appli it now to the restor problem at hand , i will see what express we obtain .
so for the imag restor problem , we're look for an imag that belong to both of these set .
thi is the set that repres the to the data .
and thi is the set that repres the smooth constraint .
so accord to the first approach we discuss , we'll find a ellipsoid bound the intersect of these two set .
and then it can be shown that the center of thi ellipsoid , the bound ellipsoid , is given by thi express .
so thi is the express for the constrain least squar filter that we deriv earlier .
the differ be that now the equal paramet alpha is given to us .
becaus we assum that we know thi two bound e and epsilon .
it should be clear that by pick e and epsilon a certain wai , these two set mai not intersect .
if thei both ar , for exampl , chosen to be veri small .
and therefor , i need to check if inde thi solut i find , it belong to both of these set that it should belong .
the second approach we discuss is the project onto convex set .
so if i follow thi , i have two set .
the first on is set on .
so , thi is c <num> .
thi is c <num> .
and thi is the project of f of an f of an imag onto the first set p <num> is given by thi express .
and lambda here need to be chosen appropri .
soo that p<num>f belong to set c <num> .
or anoth word , p1f satisfi thi first express .
it is the project of the second set , the set of smooth imag .
and similarli lambda <num> need to be chosen appropri so that p2f belong to the second set .
so it keep altern the project so to thi two set i'm go to converg to a point in the intersect .
so again thi is a specif applic of thi set's theoret approach to the imag restor problem .
howev now that hopefulli you do , have a grasp of the basic idea .
you can search and see that thi approach , estim approach , ha been appli to the solut of addit problem of interest .
hello .
iter algorithm provid solut to non linear , but veri often to linear optim problem as well .
exampl of such algorithm that you might be familiar with ar the gradient descent , or the ascent algorithm and the newton iter .
thei're typic cover comprehens in ani optim cours .
it is howev outsid the scope of thi class to cover such iter algorithm .
although we'll sai a few more thing on the topic dure the last week of class .
in thi segment , we discuss the potenti advantag of iter imag restor .
we'll then describ a simpl iter algorithm , we refer to it as the success approxim algorithm .
which can be us in a straightforward wai in imag restor .
the formul also allow for the us of constraint dure the iter process .
which incorpor prior inform about the origin imag into the solut process .
us a straightforward analysi , we also deriv a suffici condit for the converg of the algorithm .
continu in some sens with a iter algorithm of project onto convex set we just discuss let us look at other iter algorithm that can be us for imag restor .
befor we proce , let's discuss some of the advantag , in gener , of iter algorithm .
the first on is that clearli , we ar not implement the invers directli but instead in an iter fashion , step by step .
the process can be monitor as it progress , and therefor , we can us the number of iter as a mean of regular .
in other word , we can termin the algorithm at ani point that the result is satisfactori for our purpos .
coupl with the abov is that the effect of nois can be control .
the more iter , the higher the nois amplif , therefor , termin at , at some desir point , the nois amplif is control that wai .
and final , iter algorithm can in gener be appli to case that the degrad is especi vari or nonlinear , and also when we do blind restor we have to resort to an iter algorithm .
there ar a number of avail iter algorithm , typic cover in ani optim cours .
algorithm such as the gradient descent , or the variou newton method .
we will talk here about the simpl form of an iter algorithm .
that ha found applic , ha proven to be effect in imag restor .
but also other imag process problem , such as the face onli or magnitud onli reconstruct problem .
so , we start by formul the problem of interest as that of find the root of a function phi of f .
so f is , the imag repres as a vector and phi is , is a function that i want to find it root .
so accord to the success approxim iter , shown here , i start with an f of <num> equal <num> .
and then at the k plu <num> iter step , the imag is equal to the imag that we obtain at the previou iter step k , plu beta , a relax paramet , thi phi of f of k .
and the com , combin everyth into thi function psi of f of k .
thi intuit should make sens .
if i have an f of k for which the phi f of k is equal to <num> , then clearli f of k plu <num> equal f of k plu beta phi f of k .
and sinc thi is <num> , thi is f of k .
so we see that thi f of k is a stationari point .
i cannot move awai from it at the next iter step , i find exactli the same answer .
of cours thi doe not prove that , even if phi ha a root , that i'm guarante to find it by us thi iter algorithm .
becaus thi algorithm mai or mai not converg .
and inde , find the suffici condit for converg of ani iter algorithm is on veri import element .
so we're not go to discuss the , in gener , the converg of an algorithm like thi .
there ar notion such as contract map , so if psi , for exampl , is a contract map , then i'm guarante to find a uniqu solut of thi optim , in essenc , that i'm perform .
but we ar go to look at the converg properti of an algorithm like thi when it take a specif case of interest .
when i start imag restor .
the algorithm can also incorpor addit knowledg you might have about the imag we ar restor .
and thi can be done with a form here of a constraint oper or a project oper .
so , again , we start f of <num> equal <num> , then the f tild at the k'th iter step is the result of take the imag that you obtain at the previou iter step and project it into the set of signal that have thi desir properti or impos thi constraint .
and then the f at k plu <num> , i us here the f tild , the constraint signal that i obtain at the previou iter step .
so in essenc here i have thi , now function , psi , that accept as input the c f of k , the constrain f of k .
and here i show for on constraint oper , but you can concaten multipl such constraint oper .
some exampl of thi oper is the posit constraint .
or can think a set of signal that ar non neg , and then i project into that set , or an oper that doe , half , rectif , it clip all the neg valu of , of a signal , or impos some finit support constraint , or some amplitud constraint , and so on and so forth .
these constraint by and larg ar non expans map .
so we want to , start the primari thi iter .
and then i'll show an exampl later .
with thi iter we'll see is the posit constraint .
for the imag restor problem we ar work with , here is the degrad equat we've been us all along .
so the simplest possibl wai to try to find an f here , is to form a phi of f that equal y minu hf .
so we want to find the root , we want to find an f so that hf is equal to y .
the success approxim iter take the form shown here .
it's a rather straightforward iter to implement .
thi is independ of the iter , so is thi matrix .
so at each iter , i find the restor imag f of k , multipli with thi matrix , add beta y , and thi give me the result of the next iter step .
thi is a consider here , without take into account ani properti of h .
h can have ani structur .
we know by now that if the system is linear , especi invari , then h is a block circul matrix , and therefor , i can take thi iter to the discret frequenc domain as shown here .
so all the correspond quanti , quantiti ar the dft of the signal shown in thi equat .
i should mention here that in implement an iter like thi , the implement could take place in the discret frequenc domain , or in term of matric and vector .
or , if it's inde , an lsi system , i can carri out convolut in the spatial domain , or us ani other implement trick , you might sai , that make thi effici .
we would like now to look at thi frequenc domain iter and obtain suffici condit for the converg of the algorithm .
we would like now to start in the frequenc domain iter we show in the previou slide .
we would like to write the restor imag at the k'th iter step at discret frequenc u , v as the product of the restor filter at the k'th iter step with the dft of the observ nois in blur imag .
so , if we follow the step here of the iter , we start with an f of <num> equal <num> , i drop here the u , v's for simplic .
then f1 , will be simpli beta y .
f2 is equal to beta y plu <num> minu beta h f<num> .
and clearli equal to beta y plu <num> minu beta h beta y .
and f3 can be easili found to be equal to thi , plu <num> minu beta h beta y plu <num> minu beta h squar beta y .
so it's like solv a first order differ equat , and thi is inde a first order differ equat with respect to the index k .
so we can easili see that the restor filter is the k'th iter step is equal to thi .
sinc k will go to infin , for thi infinit sum to converg , i have to have that the magnitud of thi term here should be strictli less than <num> .
so thi is inde a suffici condit for converg .
h here is complex , so if i write h as it real plu j imaginari part and find the magnitud , i see that h should we have valu insid the circl here , the shade circl .
it's a circl at center <num> over beta and radiu <num> over beta .
so thi is equal to <num> over beta .
if h is real and non neg , then thi condit becom that beta is bound by thi <num> , and <num> over h max .
actual , h max is equal to <num> , typic , becaus the degrad is normal .
on the other hand , it's clear that if h , let's sai it is real , but it goe neg .
as is the case , for exampl , for the frequenc respons of the filter that introduc the on dimension motion blur .
it's a sync function therefor it goe neg .
thi quantiti cannot be satisfi .
if i look at the limit po , limit valu of the filter , then , as shown here , again , when k goe to infin , thi term here will go to <num> , becaus it magnitud is strictli less than <num> .
and then i have for those frequenc that h is differ than <num> , i obtain the invers filter , while if h is equal to <num> , i obtain k time beta .
with a gener invers , thi is <num> .
thi , but therefor , thi is on of the differ with the gener invers filter .
a point i would like to make here is that thi restor take place per frequenc compon independ .
so it is conceiv that the algorithm converg for some frequenc , and mayb not for other .
in ani case , thi is a suffici condit for converg , which tell us that , if satisfi , i'm guarante converg .
if it's not satisfi , we do not know what will happen .
so , again , the restor take place per frequenc compon .
for those frequenc that thi term <num> minu beta h is small , thei will , the converg will be fast .
and for those frequenc that thi term is larg , the converg will be slow .
so for those frequenc that h is small , i will have slow converg .
these ar the high frequenc .
and for those frequenc that h is larg , low , low frequenc , i'm go to have fast converg .
so low frequenc will be restor faster than high frequenc .
hello .
in thi segment , we util the success of approxim iter approach toward the solut of the least squar and the constrain least squar filter .
it's a gradient descent method in essenc , sinc we ar util the gradient of the object function .
although we're util a fix step size .
we deriv suffici condit for converg of the two iter us the same approach as in the previou segment .
as demonstr experiment , an import benefit of the iter restor algorithm .
of a , a direct implement of thi restor feat when thi is an option .
is , that , the number of iter can be us as a mean of regular .
that is , to control the tradeoff between sharp of the solut , and nois amplif .
due to thi , the choic of regular paramet also becom secondari .
that is the valu of the regular paramet can be chosen base on some gener guidelin .
and then , the most desir solut can be chosen after an appropri number of iter .
if we choos as phi of f on half the gradient of respect to f of thi error norm , then the iter take thi form .
thi is the , gradient of the norm here .
and thi is realli the , iter , iter implement of the least squar filter that we start earlier .
so if h is block circul , then i can take thi to the frequenc domain and the iter take exactli thi form .
let's look now at the converg properti of thi algorithm .
follow exactli the same step , we , we took in the previou case it's straightforward to show .
that the restor filter now with the kth iter step in the frequenc domain , u , v discret frequenc , ha thi form .
and the summat is equal to thi .
so , for converg of thi seri when k goe to infin .
the condit is that the magnitud of thi term here is strictli less than <num> .
but sinc , now , i have the magnitud of h insid the magnitud , thi is a real number and it's non neg .
so with the except of the frequenc for which h is equal to <num> thi condit can be alwai satisfi .
actual , the <num> frequenc don't caus a problem if we look at the restor filter .
at those frequenc for which h is <num> , is go to be <num> .
therefor , the restor imag is go to be <num> at those frequenc .
so from here , then , it's easi to find thi .
and sinc h u , v is normal with the maximum valu to <num> .
then thi condit realli becom that beta should be between <num> and <num> to guarante converg of the algorithm .
actual the closer to two the faster the algorithm converg .
so if i look at the limit condit there of the restor filter , as k goe to infin is equal to the invers filter .
for those frequenc that h is differ than <num> , and it's exactli <num> for the <num> frequenc of h .
and thi is exactli the solut we obtain with the least squar filter or the gener invers of the matrix h .
although the on pass least squar filter and the iter least squar filter in the limit will give us the same answer .
there ar certain advantag that data figur offer that thei mention earlier on and therefor it's worth look in to it's behavior .
so here , for the same experi that we have been work throughout thi present .
we have a blur imag .
motion blur over eight pixel , horizont .
but there's no nois in thi experi .
so here we show the residu error , which is the f of k plu <num> minu f of k , norm squar , divid by f of k .
thi is the standard converg criterion is us when either of the algorithm ar deploi and we set the threshold .
and when thi error becom smaller than the threshold , then we declar converg .
so , the threshold here for thi experi wa at <num> minu <num> .
so the algorithm converg at thi point and it's exactli <num> iter .
so we do want to look at thi point of converg , but also want to look at these two earlier point after <num> and after <num> iter .
so let's see how the restor look after <num> , <num> and <num> iter .
we see here the familiar motion blur imag over eight pixel horizont , no nois ha been ad .
thi is a slice of the magnitud of the frequenc respons of the degrad system .
it's a sync function rectifi .
and thi slice depend onli on on frequenc , it's independ of the other on .
we show here the restor by the iter squar filter after <num> iter .
and thi is the improv in signal to nois ratio .
i call your attent to the maximum valu here of the spectrum , it's three .
and by look at the , the gener comment would be that the low frequenc of the restor filter .
sinc thei converg faster thei're closer to the shape of the least squar filter .
while the high frequenc of the restor filter sinc thei converg slower , ar far awai from the valu of the the squar filter .
we show , here , the restor imag by the iter least squar filter , after <num> iter .
and after <num> iter at converg , base on thi threshold that we util .
so the imag on the left ha isnr <num> db the imag on the right isnr <num> . <num> db .
so the gener statement base for the isnr valu , but also in the visual qualiti that the more iter the sharper the restor imag .
and thi agre with the descript we've been make that the low frequenc ar restor faster than the high frequenc the edg .
so as the iter progress you see shaper and sharper edg in the restor imag .
i should also call your attent to the fact that the scale here chang .
it's <num> here , it's <num> here , point to the fact that again , thi restor filter approach the least squar filter .
at differ rate for low and high frequenc .
so you see more activ at high frequenc as the iter increas .
we show here and compar the histor imag obtain by the iter least squar filter , after <num> iter at converg .
and by the direct invers of the , degrad .
the imag on the left ha improv in signal to nois ratio , <num> . <num> db .
while the imag on the right ha <num> db .
so , base on thi metric , thi imag is closer to the origin on than thi on .
by look at the imag howev , it can be argu , i would argu that the so call ring artifact .
and we'll talk about them a bit later , ar more pronounc on thi imag than on thi on .
and therefor , i would argu that thi ha a wors qualiti than thi imag over here .
so thi also point to the fact that error base object metric of qualiti do not realli alwai repres the visual qualiti of imag .
thi differ can be attribut to the shape of the frequenc respons of the restor filter .
the on shown here , the on shown here .
again call your attent to the fact that the maximum valu here is <num> , while the maximum valu here is <num> .
actual , the exact 0s of the frequenc respons of the degrad system do not caus ani problem with thi gener invers .
the restor filter will be <num> as well at those frequenc .
but it's realli the small valu of the frequenc respons degrad system that caus problem .
and these small valu give rise in the restor filter to valu like <num> here .
while thi same frequenc in the iter restor imag in the iter restor filter there is onli <num> .
so it is thi taper off at the high frequenc of thi , again , iter implement restor filter that result in thi visual qualiti .
and actual , thi is the properti that realli provid advantag to the iter restor filter when nois is present .
so here is a situat in the presenc of nois .
on the motion blur over eight pixel plu <num> db bmsr .
we show three restor by the iter least squar filter , after <num> iter here .
<num> iter .
and the converg after <num> , <num> iter here .
and the last on is the direct invers .
so as it wa argu earlier , the iter implement of the filter is just do a better job when it come to nois amplif .
although on might argu that both these imag ar unaccept .
howev if on were to pick , you would pick , i guess , the lesser of the two evil .
thi on here is , again a better qualiti rel speak than thi on .
howev , the real advantag come from the fact that in get to thi restor after <num> iter of converg .
we can pick ani of these two restor .
and most probabl after <num> iter , we have a , an accept , decent restor that might serv our purpos .
so thi nois amplif restor and nois amplif thei , thei , thei go hand in hand .
i restor high frequenc of the imag , but at the same time the nois is amplifi .
it take place gradual , iter by iter .
and therefor , as it wa argu earlier on , the number of iter provid a mean of rigor .
the nois can be control thi wai .
and if a human is in the loop then ani intermedi result befor convers can be us as thei restor the imag .
the isnl's shown here and some of them ar neg even at <num> durat is neg <num> .
which mean that the denomin in that express is larger than the numer .
and it's consider larg for the last two restor .
although in thi particular case base on isnr minu 90db is a better qualiti , versu minu 12db .
we show data implement of the constrain least squar filter least squar filter here for complet .
onc we have gone through the structur and the analysi of these iter algorithm .
then , it should be crystal clear here , what happen with the cl filter .
so , the function , we try to find a root of is shown here , fi of f .
and then , here is the result iter .
the success approxim base iter .
so in addit to the fidel term , we have the smooth constraint , and alpha here is the regular paramet .
when both h and c ar block circul , thi iter can be taken to the discret frequenc domain , and thi is the result form .
when alpha equal <num> then thi iter becom the iter of the least squar filter we had .
as we know the cl becom the ls filter .
here is the result converg analysi and the discret frequenc domain .
so the suffici condit for converg is shown here .
now , i have the frequenc respons to the degrad system plu alpha , the magnitud of the frequenc respons of the constraint .
so , even when h is <num> at certain frequenc .
as long as c is not <num> , those same frequenc these unqual can be satisfi .
thi is mother of five thi can be a guid principl in choos a c .
we want the c that will be non <num> .
where h is zero and have some valu .
and also take the small valu of h awai from <num> .
as k goe to infin thi is the result form of the restor filter , the iter restor filter and as expect is the cl filter .
when the denomin is differ than <num> and is <num> otherwis .
so , it's a kind of gener again invers .
we show here , result obtain by the iter constrain least squar filter .
the degrad imag is the same on we will be us through out thi present .
due to 1d motion blur over eight pixel with bsnr equal to 20db .
for the cl filter , a 2d laplacian is us and here is the valu of the rigor paramet .
so on the left , we see the restor imag after <num> iter .
and on the right restor imag after <num> durat .
below it , we show the magnitud of the frequenc respons of the restor filter , which is a function of iter .
so again , <num> over here <num> over here .
now thi frequenc respons is the slice we show here is the on go through the origin .
becaus it's not independ of the second , variabl , as wa the case without the , the sequenc strain .
thi filter converg toward the cl filter .
but the rate of converg it's faster for those frequenc for which , the frequenc respons of the degrad system ha larger valu .
than for those frequenc that it ha smaller valu .
so in the low frequenc will converg faster and the frequenc close to <num> .
the <num> itself is not a problem , becaus thi is gener invers .
so h is <num> , the restor filter is <num> the same frequenc .
but around it there ar nonzero valu , veri small but nonzero valu which will converg slower toward the constraint least squar filter .
again , the scale is differ here , it's maximum is three .
maximum is five .
anoth , interest observ is that the isnr decreas with the number of iter .
so thi imag is closer to the origin on than thi on .
howev , by look at the imag .
i would argu that these probabl is a better restor than thi on .
of cours , the characterist is that as the number of iter increas , the edg becom sharper .
howev , along with that , nois magnif take place .
but still the amplif of the nois is kind of accept here .
and thi again , could be an accept restor for the , for our purpos , to serv our purpos well .
here is final the comparison between the iter cl filter and the direct cl filter .
so the result of the left wa obtain after <num> durat at converg .
in term of bia and now the imag on the left is better than the imag on the right slightli , close to the origin on .
by look at the imag mayb there's more nois in thi on then thi on .
and below , we see the magnitud of the frequenc respons of the restor filter .
it's veri similar for most valu .
it's over here , the maximum here is <num> , here is <num> .
it's around thi frequenc that we have thi larger valu for the direct implement relat implement .
and thi becaus again there ar some veri small valu in the frequenc respons from the gradat system .
and those ar the frequenc that ar veri slow to converg .
the converg criterion util all the pixel in the imag .
i could potenti devis a converg criterion per frequenc .
can see , and kind of , do not stop iter for specif frequenc , until a , a , a threshold is met .
so i could potenti run a differ number of iter per frequenc .
hello again .
thi is the last segment of a rather long week , i have to admit .
but it ha hopefulli been an inform on .
in danger of state the obviou , improv restor result can be obtain when the restor filter take the local content of the imag into account .
the filter , in other word , is not content agnost anymor .
thi should make sens conceptu .
but it is also strongli support by experiment evid .
so base for exampl on the local spatial activ , a differ restor filter is appli to each and everi pixel .
in thi segment , we describ on wai to introduc the spatial adapt of the restor filter with the us of weight norm .
we discuss on specif wai to adjust these weight base on properti of the human visual system .
we introduc special adapt restor algorithm in term of the iter implement , sinc now direct solut , for exampl , the frequenc domain , ar not feasibl anymor .
but more importantli , becaus the spatial activ of the imag need to be comput from the avail data .
sinc such data ar noisi and blur , it make sens conceptu to estim such activ at each iter step base on the partial restor imag .
we also includ in thi segment an exampl of the effect of the posit constraint in restor an impuls signal .
we also address the problem of the so call ring artifact , which appear in restor imag , especi with certain type of blur , such as the blur due to motion between the camera and the scene .
develop imag process algorithm which ar not content agnost , but instead take the content of the imag into account , and therefor perform a differ filter , process oper per pixel , is of the utmost import in imag process .
it ha been proven that such filter outperform non adapt , non spatial adapt filter in all applic that thei , that thei have been consid .
we actual show a spatial adapt nois smooth filter when we talk about enhanc , and we would like to do the same here when , that we're talk about imag restor .
so on of the wai to introduc spatial adapt for the constrain least squar filter is to consid thi function phi of f that we want to find it root , that is equal to what's shown here .
so i have the fidel of the data term again and the smooth constraint that we've talk about , but though thi norm ar weight by a w1 weight and a w2 weight here .
so let's see first how the weight should be interpret .
so if i have a weight norm of x by w , squar thi is simpli x transpos , w transpos , wx and can also be written as the sum , on , let's sai there ar capit n element in the matrix x , w of i squar , xi squar .
so here w is a diagon matrix , with entri w1 , w2 , wn , in thi particular exampl .
so we see that the weight assign differ import to the element of x .
so now , now when i find the norm , the contribut of each element in x is not the same , but again it's weight by the valu of wi .
and the wi's ar all non neg .
so with thi , then , definit , if you wish , of the weight norm , we should be abl to find the gradient with respect to f of the term insid the parenthes .
it's someth we did befor without the weight a coupl of time alreadi .
and if we do so , the success approxim base iter is shown here .
so thi is the iter algorithm that i'm perform now .
if w1 equal w2 equal ident , then thi is exactli the constrain least squar iter that we have talk about .
i should comment here that thi iter cannot be taken out to the discret frequenc domain even when h and c ar block circul simpli becaus the weight matric w1 and w2 ar not block circul and therefor , i cannot take it to the discret frequenc domain .
so implement thi iter , i could either implement it in the spatial domain or altern between spatial and frequenc domain .
the convolut ar perform in the discret frequenc domain , and then we take the result back to the spatial domain to implement the wai and go back and forth that wai .
for the sum of the choic of these weight , on possibl choic is to , is shown here , draw from some experi that were done to demonstr the mask properti of the human visual system .
accord to it , high frequenc inform in the imag mask high frequenc nois .
and , put it differ , the nois is not as visibl at the edg as in the flat region in an imag .
therefor , when we perform restor , we can allow nois go through at the edg , and the wai to accomplish thi is by set the entranc of the w matrix here veri small , close to zero , at the edg locat and allow them to be larger at the flat region .
so if w is small , then we disabl the smooth constraint .
and that's what we want to do at the edg .
so thi visibl matrix is calcul accord to a formula like thi .
it's made proport , or rather , it's made invers proport to the local varianc of the imag , sigma squar of f .
so at the edg the local varianc is high .
therefor , v therefor , w small therefor , c of f is disabl .
we can then choos w<num> is <num> minu w2 , becaus we want with that term to kind of do the revers .
so we want to perform deconvolut at the edg .
and we don't enforc that much deconvolut in the flat region .
actual if i have a perfectli flat part of the imag , then blur it will not chang anyth .
it will be exactli the same signal .
so thi is just on choic of w1 , w2 .
peopl have experi with all kind of other differ choic .
but the concept when it come to deconvolut that we ar discuss here is again , to not perform smooth at the edg , therefor sharp edg will be restor .
and it will be noisi but that's fine .
the nois will not be visibl while we want to smooth out the nois in the flat region .
now a question is how do we calcul the v here , for exampl , the local activ .
all we have avail is y , which is a noisi imag .
so we can work with that and try to remov nois and then find the local activ .
or altern , we can updat these matric as the iter progress .
so in other word , we can make thi matric function of k .
so i could put a k here , a k here and all the weight .
which exact , which , again , all thi mean is that at each iter , i appli my estim of the local varianc , and then the visibl function , then w1 , whatev the formula is to updat these matric .
so let's see , now , how thi filter perform in restor an imag .
so here is on implement of the special adapt cl filter that i just mention .
so thi is the nois blur imag i've been work with .
thi is the adapt restor imag .
thi is the cl imag that both ar , ar implement in an iter fashion .
by compar the two , we see that there's a finer control between nois amplif and sharp in the adapt restor imag .
the edg ar consider well restor , while the nois ha been suppress .
in the cl imag i , we don't have thi control .
the edg ar sharp , but there's a lot of nois amplif .
here we show the visibl function , comput by find the local varianc in the imag .
it's like an edg detector so black ar the small valu , so at the edg , the weight for the smooth term is small .
therefor , the smooth term is , is disabl and it's , it's high valu , wide valu in the flat region .
and here final we show the differ , the absolut differ , between the two restor , the spatial adapt and the non spatial adapt .
we see that thei differ at the edg , which is also someth we can visual , visual confirm , but also there is a lot of nois in the , in the differ , which is the nois that we see amplifi in the cl restor .
actual both the visibl function and thi differ ar mark in the <num> to <num> rang linearli for visual purpos .
so the , the spatial adapt filter is a rather power framework , you might sai , but it's success depend on the appropri choic of those w1 , w2 matric .
thei can be done onc at the begin , or thei can also be updat as the iter progress .
of cours , as the issu of prove the converg of the algorithm when the weight ar updat .
but there is work in that direct , as well .
you try to linear thi non linear function .
you try to optim .
and there ar some converg result as well .
we want to demonstr here with a simpl exampl , that the posit constraint that we mention earlier can be a power constraint when it come to restor .
so here is a toi on dimension signal .
it consist of three impuls .
it is blur by thi on d motion blur over eight sampl that we have been us .
and thi is the observ .
clearli sinc these two impuls ar close togeth , thei ar not distinguish anymor , after blur .
and also the intens here , the valu rather , ar small becaus the motion blur is normal .
if i run the iter squar algorithm with the posit constraint , which mean that at each iter step , the neg valu of the restor signal ar set to zero , ar clip , then i'm abl to obtain a perfect restor , perfect recoveri of the three puls as shown here .
if i run the iter least squar without the posit constraint , then thi is the result we obtain .
the three impuls ar still pick out but their height is not the correct on , and then clearli there's a lot of activ in the rest of the signal that should have been equal to zero .
it should also be clear that appli the posit constraint at the end after the algorithm converg to a result like thi , is not the same as appli a digit iter step .
becaus clearli here if i set the neg valu equal to zero at thi signal , i'm not go to obtain thi signal .
you recal that in a number restor exampl we show , these so call ring artifact ar present .
so an edg here , a sharp edg propag as shown here for exampl .
so you see a coupl of artifici , nonexist edg .
if we look at these imag and measur thi distanc between these replic of the edg these ar equal to eight pixel , which is the length of degrad , the motion blur .
and as expect , the ring artifact ar a function , should be a function of the impuls respons of the degrad system .
so here's a simpl analysi of what take place .
h i , j is the impuls respons of degrad system r i , j the impuls respons of the restor filter , the convolut , we call it s all .
and in essenc , s all is convolv with origin imag to give us the restor imag .
so if thing were ideal , then h should be the convolut invers of r , and therefor s all should be just a delta .
if we take thi to the frequenc domain , then s all u , v should be equal to <num> .
so the ring artifact ar due to the fact that there ar deviat from the delta , as we'll see in a simpl exampl next .
so for the the degrad we've been us throughout the present , on d motion blur over eight pixel .
we show here the frequenc respons of the overal system when direct invers is us .
so it can match in the restor filter exactli the invers of all frequenc valu of the frequenc respons of the degrad except at the locat of the zero , sinc the invers filter is zero at those locat as well .
i perform here a gener invers .
so thi frequenc respons is on at all frequenc exact , except exact zero .
if i take thi signal now to the spatial domain , i obtain thi .
it's a delta almost equal to on here , but we also see we have thi train of smaller impuls that ar eight pixel awai .
so as alreadi mention , it's thi impuls respons that will convolv the origin imag to give us an estim of the origin imag .
so if i'm eight pixel awai from an edg , i will find the exact valu of the intens of the imag at that locat .
howev , i will have a replica of the edg due to thi littl impuls .
if i move <num> pixel awai , i have a second replica , the second impuls , and so on .
the good new , you might sai , is that these impuls ar small , and therefor the ring artifact will not be realli pronounc .
the bad new , of cours , is that such a direct invers amplifi nois .
so if we look now at the frequenc respons of the overal system when a least squar filter is perform iter , here's what we see .
it's exactli zero at the zero of the sync function .
howev , close to those frequenc , we see that the valu ar not exactli equal to on .
becaus , as we mention , those , the valu of those frequenc close to zero , thei will not be fulli restor .
would not be equal to the direct invers sinc also is a low rate of converg toward the invers field at those frequenc locat .
so if i take thi back to the spatial domain , i see thi pictur , so the impuls is not exactli at on now .
but also , thi train of impuls i had befor , it taper off , but the valu of these impuls close to the big impuls ar now larger .
again the space is eight pixel .
so , if i convolv now thi impuls respons with the origin imag , i do see that , eight pixel awai from an edg , i will have a pronounc edg due to thi impuls .
<num> pixel , i will have anoth replica to thi impuls , and after two or three impuls , the ring artifact will fade out .
and thi is exactli what we observ in the imag i show in the previou slide .
so with an iter least squar filter here , we deviat from the delta or deviat from on here , and thi give rise to ring artifact , but at the same time thi wai we can control the nois amplif .
so there's thi import engin trade off that take place when i compar the variou filter .
so we reach the mid point of the cours .
you've just complet <num> of the materi .
my warmest congratul to all of you .
dure the sixth week , we learn that the recoveri problem encount in practic , which come with differ name such as restor , super resolut , and sharpen ar all invers problem .
we had actual discuss in detail anoth invers problem , that of motion estim , earlier in class dure week four .
we establish a notat for be abl to repres imag as vector and the degrad equat in matrix vector form .
thi represent allow to model and provid restor solut to a larger class of problem than the restor to convolut problem .
it provid us also with the flexibl of util a number of optim techniqu from the literatur .
we then discuss three wide us approach for solv the imag restor problem .
the simplest possibl on is the least squar approach , also refer to as invers filter .
the extens of least squar is constrain least squar , with which prior knowledg about the solut is incorpor into the solut process .
thi is also an applic of the theori of regular .
final a gener fro , framework wa also present , the set theoret estim approach , which is applic to solv variou other recoveri problem in addit the the restor problem .
thi is of cours the case with the other method we've discuss , such as least squar and constrain least squar .
a specif synthet imag wa us throughout the present , so as to easili demonstr the rel advantag and shortcom of each method .
as you saw , the topic of recoveri is rather mathemat , draw materi from linear algebra , estim theori , optim ect .
again even if not all the deriv and algorithm detail ar crystal clear to you , you still can have some good basic understand of the approach and be abl to make immedi us of them in your work and studi environ .
although equip a knowledg acquir thi week you should be abl to provid the solut to ani invers problem , we will continu next week on the same topic sinc it is a rich and import on .
so , see you next week .
welcom to week seven .
as i mention at the end of last week , we'll continu thi week with the excit topic of imag and video recoveri .
last week we cover determinist restor approach .
that is , the unknown imag is treat as a determinist signal .
given a specif observ , we ar interest in obtain the best restor imag that gave rise to the observ data .
of cours , we also saw that in order to restrict the set of all possibl solut , prior inform about the imag wa incorpor into the restor process .
such as the inform that the origin imag is smooth .
as we'll see thi week , thi prior knowledg is incorpor into the restor process in a differ wai , by assum that the imag is a sampl of a random field .
thi mean that , it belong to a class of imag , so call exampl , which share sever characterist .
the topic of recoveri is rather mathemat , as everyth's by last week materi .
thi will be the case thi week as well .
thi week we'll need knowledg about two dimension random process , also call random field .
now , probabl in random process is a rather broad and challeng topic in it own right .
it is typic cover in an engin scienc curriculum by at least on undergradu and on graduat level cours .
clearli it's outsid the scope of thi class to cover thi materi in ani depth , if you've alreadi heard thi materi then you know much more then we'll us here .
howev , if you had not had ani such materi befor you can still be in good shape .
by that i mean that i'll just briefli cover what we need , but more importantli , even the if the deriv detail of a field ar not crystal clear .
you'll still have a us framework you can appli to solv other problem , and also a specif restor algorithm you can us right awai to restor a distort imag of interest in your oblig .
with the abov in mind , we'll cover specif the wiener restor filter , the wiener nois smooth filter , maximum likelihood , and maximum a posteriori estim .
the gener framework as well as the deviat of specif imag resolut result for certain prior model .
we'll also briefli describ in word the so call hierarch infer approach .
final , we show the formul of some of the recoveri problem we briefli talk about at the begin of last week .
let us proce first with the deriv of the celebr winner restor field of .
as you'll see , in order to defin the filter we onli need the other correl function of an imag .
and the cross correl function between two imag all the fourier transfer , which i refer to as the power specter .
we'll defin and explain such function and also show how thei ar alter by lsi system .
so with that , let's start with the materi of week seven .
in thi segment of the cours , we ar go to look into stochast restor approach .
with such approach , the origin imag f is not treat as a determinist signal , but instead of a sampl of the random field .
so , more specif , we ar go to look into the wiener filter and then under bayesian formul , we're go to deriv for special case , the maximum likelihood and maximum a posteriori estim .
and we're go to sai a few thing about hierarch bayesian approach .
so , let us proce now with the wiener restor filter .
random variabl in random stochast process is a rather challeng topic .
typic , in a scienc or engin curriculum , there is at least on requir cours on probabl random variabl , follow by at least on graduat cours on random process , and mayb a special cours of random field .
these ar two dimension stochast process , random field like the on we're interest in here when we talk about imag .
then of cours there ar cours which make heavi us of probabl , random process such as estim theori and spectral estim .
we'll be cover stochast restor field at some high level .
for complet on on hand , but also becaus thei plai an import role in the field of imag and video recoveri .
if you go ahead and hear that cours on probabl and random process .
then you know more than we will need here .
i also chose to cover stochast restor filter to demonstr that we will onli need certain aspect of random field , which ar not terribl complic in that most step could be carri out base on what we have cover in the cours so far .
in ani case , at the end of the dai you'll end up with some us restor filter that you would us right awai even if not all the mathemat detail of how these filter were deriv ar crystal clear .
so here the element need to deriv the winner restor figur .
i'd like to explain them in plain english term if you wish , keep in mind the student who mai not have had thi materi befor .
for the rest of you , just bear with me , we will need the notion of auto or cross correl as well as stationari field .
so , here is the definit of autocorrel of a random field f .
as we see here , the autocorrel function is a function of four variabl , i , j , k , l .
and it's equal to date the imag f , the random field f , at , which is at locat i , j .
take the same field now to locat k , l .
so you might sai it's center at i , j , the first on .
the second is center at j , l .
thi star here denot complex conjug for the case of the field is it , it's , it's complex .
if the field is real then the conjug ha no effect the conjug of a real number is the number itself .
we then have to perform thi expect oper .
so , the idea here is that we have an imag that is model as a random field , and i observ on imag .
i have on imag avail , thi is on realiz of thi random field .
so , to perform thi expect oper , i need to have mani realiz of thi random field , which form a so call ensembl .
it's a collect of realiz , it's , it's an ensembl .
so thi is the expect valu , the mint valu you might sai , with respect to thi ensembl of imag .
so had i been abl to observ multipl , again , realiz of thi random field then i could perform thi expect .
a veri us notion when it come to correl is the notion of wide sens stationari .
so stationeri field ar easier to deal with .
more conveni , and the whole idea is that with stationari field , it's irrever where the ax ar locat , in the sens that , now , all i'm interest is the distanc between these shift of , of the imag .
so i mean thi , the , the distanc between i and k in the on dimens , and j and l in the other dimens .
so , the auto correl in thi case becom now a function of two variabl , which , is again the distanc between the origin after the shift of the imag , you might sai , all right ?
so it's independ of the locat of the axi .
so the correl ar us everi time we creat the imag as random field and ar peopl have us variou model to for for thi or the correl for exampl thi isotrop .
exponenti decai model ha been us .
so accord to thi , the auto correl function of a random field is equal to a constant .
time gamma , anoth constant with a minu absolut valu of n1 plu absolut valu of n2 .
so clearli , the larger n1 and or n2 , the smaller the valu of the , of the correl , so it's a decai exponenti , so the feather awai , two pixel thei ar the less correl thei ar .
it's anoth wai to sai that , and it's isotrop becaus it depend on absolut valu of n1 and <num> , it doe not distinguish .
which direct i'm look at in thi random field , so typic when a model is us for the other correl and then we're go to us thi model to process a specif imag we fit thi model to the data , so try to find the c and gamma here valu .
so , that thi particular model better again explain the data we're work with .
now , if we need to estim the auto correl from the avail .
data , if i do have an ensembl of imag , mani realiz , then in principl i could perform thi expect here , oper is shown here , but sinc in most case you onli have avail on imag .
on realiz , then we invok the notion of ergod , which tell us that sampl averag equal spatial averag .
so in other word , i can find thi expect by take thi spacial averag .
so i choos a 2n <num> by 2n <num> window and then with thi that , within thi window i form the product of g and g conjug shift by n1 and two and i sum up and thi will give me on valu a specif n1 and two on valu of the correl function .
final , on more concept to need in deriv the , with the restor field is the notion of the power spectrum which is defin as the fluid transfer thi is what the calligraph f show denot of the auto correl function .
it's note by p so the spectrum of f .
the power spectrum is just again the fourier transform as shown here .
i also talk about here cross correl .
everyth carri over when , i'm not talk about the same imag f , but an imag f and an imag g .
so then the cross correl , you know , r of g is the expect valu of f .
g complex conjug , everyth carri through as i explain here .
so , equip with all of thi knowledg , we ar readi to start talk about the weiner restor filter .
the wiener filter is attribut to norbert wiener .
who develop it in the 1940s and publish it in <num> .
a discret version of it actual wa publish by kolmogorov in <num> , and becaus of that it's veri often refer to as the wiener kolmogorov filter .
so , accord to it as we'll see , all we need to know is the signal and nois spectral characterist .
we assum that white stai stationari , and therefor we know the auto correl and cross correl of the signal .
it is the non causal version of the filter , becaus we assum that all data the nois and blur de modul tri to restor is avail .
so we start with the degrad model shown here .
so , we observ the imag y , i , j is the result of convolv the origin imag f with the point first function of the degrad filter or system , and w is clearli the addit nois .
so given y , and given h , the knowledg of the degrad system , .
and the model for f and w would try to find an estim of the origin imag f .
and again , f is a random process a random field and we know it autocoorel we know the autocoorel of the nois as well .
and we know the cross correl between f and w .
so the object is to find the restor imag f we've got here , which is the argument that minim .
that arrow here squar , and the arrow is just the differ between the origin imag and the estim imag .
so thi is the absolut valu complex squar .
we need the expect here , becaus again f is realiz of a random field , a two dimension random process .
so we observ an imag from thi collect , or ensembl of imag , but we want the estim error to be minim not just for the imag we observ , but for all the imag in thi ensembl .
so next time , anoth imag from thi ensembl is provid to us to be restor .
we ar guarante that we can provid the restor that will result in the smallest possibl restor error .
the addit requir impos by the wiener filter is that thi restor filter should be , is requir , is desir to be a linear , especi in variant filter .
so , in other word , the restor imag , f hat , will be the convolut of the impuls part of the restor field there , r , i , j , with the avail data .
so pictori , here is the degrad restor system , right ?
the origin imag goe through the degrad system , nois is ad , y is the observ imag , .
we want to oper on need with restor filter with input r i , j so that we obtain an estim of the origin imag here , so that the error between f and f hat , our estim , the absolut valu of thi squar in the expect sens is the smallest possibl on .
so , let's see what ar the step to obtain thi estim here which will repres the non causal wiener restor filter .
we saw in the block diagram shown in the previou slide that there ar random signal go through lsi system .
therefor , import us to seem gener quarter sum of the result that tell us how the autocorrel of the output of such a system relat to the autocorrel of the imput , and also what ar the cross correl between imput and output equal to .
so we have shown here an lsi system with impuls point h , i , j .
f is the input , y is the output , f is a random signal .
it make sens than y is also random , while h here is the mystic signal .
we know from materi we cover earli on that that output is simpli the convolut of the input with the impuls respons of the system .
we assum that the input is y set stationari with auto correl r of f f i j .
so the first question is , what is r of y y equal to ?
if i take thi express and substitut it into the definit of the auto correl , and keep in mind that h i j is a determinist signal .
therefor , it goe through expect .
it's rather straightforward to show after four or five line of comput here , but .
thi is how the autocorrel of the output relat to the autocorrel of the imput .
i have to take the autocorrel of the imput and perform the convolut with h , i , j , anoth convolut with h complex conjug minu i minu j .
i can take thi express to the frequenc domain , we mention earlier that the fulia transform of the autocorrel becom the power spectrum of the signal .
and thei'll us the convolut theorem , which tell us that convolut in the spacial domain becom multipl in the frequenc domain .
so , if the fourier transform of thi is h omega on , omega two , that's the frequenc respons of the system , then accord to on of the properti of the fourier transform , the fourier transform of thi signal will be h complex conjug .
omega on , omega two .
so multipli in the frequenc domain h with h complex conjug i'm go to get the magnitud of h squar .
so , date thi with the frequenc domain give rise to thi express .
so thi is on of those gener and us result that .
you'll find yourselv util all over the place , and tell me that the power spectrum of the output equal the power spectrum of the input multipli with the magnitud of the frequenc respons of the lsi system .
i can follow similar step and find now that the cross correl between input and output is given by thi express .
take thi to the frequenc domain , becom thi express , and then final can find the cross correl between the output and input , it's a similar express when take the frequenc domain give rise to the cross spectrum .
cross bar spectrum between y and f .
so , let's make immedi us of thi result in deriv the wiener restor filter .
so here is again the block diagram of the degrad and restor system we're consid .
the assumpt is that both f and w ar wide stand stationari , and therefor so is y .
the solut is base on thi orthogon so call principl , that state that the error is orthogon to the data , or the correl between error in data is zero .
and thi is the express for the correl we've been us and e is the error again , estim error , and y is the data .
so , if i substitut the , express for the error into thi i get thi express and i can break thi express down on more step .
so we have expect valu of f i j , y complex conjug k l equal the expect valu of f hat , which is .
well , we write it , f hat i j , y k l , right , but thi is equal , f hat is just y i j .
convolv with the impuls part of the restor filter , time y complex conjug k l .
so from thi , clearli , i have that the cross correl between the input and the output of the degrad system .
thi term here equal .
if i look at thi i have r is determinist , so it come outsid the expect .
and i'm left with the expect between y , y complex conjug , so thi the other correl of y , convolv with the impuls respons of the restor filter .
so if i take thi to the frequenc domain , i have the frequenc respons of the restor filter is equal to thi .
so thi is the cross power spectral densiti between input and output of the first system , and thi is the power spectral densiti of the output of the system y .
so , thi is realli the wiener filter , and now we want to see how can further express breakdown thi spiral spectral densiti that we have here .
two commonli us assumpt ar shown here .
the first on is that the imag , origin imag and nois ar uncorrel .
thi is the definit of the color of correl , and uncorrel mean that the expect valu of the product equal the product of the expect valu , as shown here .
in addit , it assum that both imag and nois ar zero mean .
which substitut to the equat abov make the cross correl equal to <num> .
so equip with these two assumpt , .
we can show that the cross power spectral densiti between the origin imag and the observ is given by thi express .
thi is actual exactli the same express we had befor , but befor , there wa no nois present .
howev , due to the assumpt abov , the cross term involv signal and nois .
cross out , sinc again thei're uncorrel , and thei're zero mean .
thi is the numer of the frequenc respons of the restor filter we found in the previou slide .
and thi is the denomin , so thi is the power spectrum of the output signal .
we had thi term befor , no nois wa present .
now we have the power spectral densiti of the nois .
no cross term again , due to the assumpt we had befor .
again , both of these express ar a few line of calcul util the assumpt zero .
so , thi is the numer thi is the denomin of the frequenc respons of the wiener filter .
and if we substitut , thi is the frequenc respons of the celebr wiener filter .
h , omega on , omega two , is the frequenc .
these part of the degred system is suppos to be known , and also the spectral densiti of the origin imag and nois ar suppos to be known as well .
hello and welcom back .
in thi segment , we compar the wiener filter , we obtain in the previou segment with constrain len squar filter we deriv last week .
we'll see that the mathemat express differ onli in on term , the so call stabil term .
so , if instead of measur the imag and nois power spectra from the avail nois and blur imag , we model them instead .
so , we us a specif model for the power spectrum of the imag as a function of the stabil term that wa select by the cl filter , and also we us a specif model for the power spectrum of the nois .
we assum it's white in then the result of the two filter , of the wiener and the cl filter becom ident .
we util the same simul degrad imag we us extens .
last week to point out the similar and differ between the wiener and the cl filter .
so let us proce with the coverag of thi materi .
here is the express again of the frequenc respons of the non causal wiener restor filter we just deriv .
i have divid numer and denomin by p of ff and thi is the form we end up with .
a common assumpt is that the nois is white , which mean it's power spectrum is flat and more specif , it's equal to the varianc of the nois .
so in thi case , thi is the form of the wiener restor filter .
let us compar it now with anoth filter , we deriv a bit earlier in the cours , which is the constrain least squar filter .
so , thi is now the frequenc respons of the cl filter .
by compar the two , it's crystal clear thei're veri similar and the differ , let look at thi for between thi term and thi term .
it can be shown that the power spectrum is real and more specif it's non neg .
so , p of ff , omega <num> , omega <num> is greater than or equal to <num> for all omega <num> , omega <num> .
so , therefor , c but if alpha is equal to the varianc of the nois , of the white nois and then the magnitud of thi filter here , thi smooth filter is <num> over the spectral densiti of the imag , then the two filter becom ident .
clearli , when alpha is <num> , and the nois varianc is <num> , both filter reduc to the least squar filter or gener invers filter that we talk about .
so , on wai to think about it , is that for the cl , i choos c and alpha is shown here and then cl give me exactli the same answer as would the wiener filter .
or go the other wai around , you might model the auto correl and therefor , the power spectrum densiti of the imag in such a wai that , at the end , thi equat down here , hold and you get then a cl filter .
conceptu howev , the , both filter strive to achiev the same result .
and by that i mean if you recal , c omega <num> , omega <num> is a frequenc respons is a here of cours of a high pass filter .
and the same is depict by <num> over p of ff , omega <num> , omega <num> .
the other correl for most imag ha thi decai exponenti shape that i discuss earlier and then the transform of that signal is also a low pass type of signal in the frequenc of domain , then <num> over thi is a high pass type of filter .
so again what we deriv here is at the high level sum equival , you might sai , between the wiener and the constrain least squar specif if the paramet involv is chosen in a wai shown here and explain then thei give us exactli the same result .
but in gener thei try to achiev the , the same object which is to regular and make the , the high frequenc of the invers restor filter be taper off and not becom veri high becaus thi will introduc nois amplif .
of cours we saw that the mechan , the path we follow to obtain the wiener and the constrain least squar filter ar distinctli differ .
let us look at some experiment result now .
we show here the power spectrum of the cameraman imag .
the <num> , <num> valu is quit high , and it's outsid the scale of the figur .
and it ha thi decai natur that we mention earlier .
and it's also non neg .
here , we show the spectral densiti of the nois is white nois .
therefor , it's spectrum is flat .
thi spectrum is not comput from the imag .
but , sinc it's a synthet experi , we do know exactli what the varianc of the nois is , and that's what we show here .
we show here , what is often call the stabil term .
so thi is the term of the denomin of the filter , the weiner of the cl that is ad to the magnitud squar of the frequenc respons for the degrad system .
so , well the wiener filter is the term of that power spectrum of the nois divid by thi power spectrum of the imag .
the nois in thi exampl is white , so thi is equal to the varianc of the noiseso it's the cost of the numer .
it's a rather , mayb hard to see exactli , the shape of thi filter here , but it's high pass natur .
it's a constant divid by the spectrum of the imag , so that it ha thi decai shape .
so , on over thi low pass will give me high pass .
so inde , thei have high valu at high frequenc , here , here and here , and it's , ha small valu at low frequenc .
the zero , zero is in the center here , as i indic of thi plot .
but , it's clearli not smooth , and that's the case inde everi time we work with real data .
thei don't behav as smoothli and as nice as synthet data .
to compar thi we show here the stabil term for the cl filter is thi term here and thi is here for a 2d applic .
so it's a high pass filter of cours and it's rather smooth and nice you might sai but both of them in shape ar high pass filter .
and thei're go to be ad to the low pass degrad filter , the denomin of the wiener filter over there left , and the cl on the right .
we're us thi exampl the same degrad system we'll be us throughout thi materi on imag restor .
so the degrad is due to horizont motion between the camera and the scene over eight pixel .
so what we show here is the magnitud of the frequenc respons of the degrad system .
it's a rectifi sync and it's constant along on of the frequenc axi as we show thi multipl time earlier .
we see here the frequenc respons of the wiener restor filter for the paramet of the problem we've been describ .
it's a bit hard to see the exact shape again due to fact that the power spectrum of the imag is base on , on actual data .
it is , howev , the invert sync function , but in the denomin of , ad that stabil term .
it's , here's small valu here at <num> , <num> frequenc , then it goe up a littl bit in the mid frequenc and then taper off at high frequenc .
we compar thi with the cl filter for thi valu of the regularl paramet .
so the structur is definit more clear sinc the frequenc respons of the cl filter is consider smoother .
to have a clearer view of the two dimension wiener restor filter , we show here on slice of it frequenc respons .
thi li at omega <num> equal <num> .
again , for the paramet , we comput the paraspectrum of the imag directli from the origin imag which , of cours , in a realist applic is not avail .
and also , sinc we ad the nois , we have exact knowledg of it varianc , and we util the exact nois varianc .
so we see here the invert sync that is taper off at high frequenc due to the stabil .
so the valu is <num> .
here , it's <num> , <num> and then you can see the shape of the center that ar exact 0s of these locat and then it taper off nice at high frequenc .
we compar these with the same slice of the frequenc respons of the cl filter which wa implement in an iter fashion and here it shown after <num> iter and thi is a valu of the iteraz paramet that wa us thi scale is the same , so , we have the same high valu here .
so the filter site ident here , and their veri veri similar at , at low frequenc .
howev at higher frequenc , the cl filter ha higher valu .
like here , i guess it's around five while the same frequenc's around two .
we also show the slide of the frequenc respons of the cl when it's implement directli .
the same , again , valu of the laplacian paramet in both case that the laplacian wa us .
so now the scale here , the high valu is <num> , so i have thi higher peak here .
and also the valu , similarli to the previou comment , ar higher at high frequenc .
so again , thi is five while it's two with a wiener filter .
so by and larg , base on thi qualit comparison , we expect , both these and thi filter to produc noisier restor than the wiener filter .
but of cours , with a constrain least squar filter , we have control over the regular paramet and increas it or decreas , increas it we can chang the valu of the filter as high frequenc , chang the , the shape .
so we show here on the left the noisi blur imag is the same exampl we've been us throughout thi segment of the cours 1d motion blur over eight pixel and the blur signal to nois ration is 20db .
on the left you see the restor imag util thi non causal wiener restor filter that we have analyz and develop in thi segment of the cours .
and again , these ar the spectra that were util either us the origin imag or from exact knowledg of , of nois .
so thi is in some sens , the upper bound of the perform of the weiner filter , becaus we have exact knowledg in thi synthet experi of these paramet .
in practic , we have to find mean to provid good estim , obtain good estim of p of f and pww .
the improv in signal to nois ratio for thi particular case is <num> . 9<num>db .
by and larg is a , is a , is a rather good restor .
the nois is not terribl amplifi snd some of the sharp of the imag ha been restor .
we show here again the result of the wiener restor filter .
we're go to compar it with the restor imag obtain by the iter cl filter .
thi is the paramet of alpha and thi shown after <num> iter .
we did show the frequenc respons of thi filter in earlier slide .
as wa argu there , it's expect that thi restor imag by thi filter wa go to be noisier than the result of the wiener restor , and thi is inde the case by compar the two imag .
of cours , nois simplif is trade for sharp in the imag .
so , thi imag here is sharper than the wiener restor .
we also compar it with a result of the direct cl restor .
thi now is even noisier than .
thi is noisier than thi and in both case , the ismr is neg .
of cours , with the csl filter , i have differ mean to control it's perform .
on is through the valu of the paramet through the select of c .
we'll be us the laplacian here .
three is through iter implement .
and in that case , we can us the number of iter as a mean of regular .
and four of cours is the introduct of adapt that we talk earlier .
the wiener filter is a veri celebr filter , it ha found mani applic in addit to imag restor .
and with respect to imag restor , for a long time wa somehow the golden standard that everybodi wa compar their result against the wiener restor filter .
hello , in thi segment we consid the nois smooth problem .
that is the case when the impuls point of the varianc system is equal to the dimension delta function .
in thi case if we said the frequenc respons of the vari filter equal to on and the express of the winner restor filter .
the wiener nois smooth filter result .
thi doe not becom an enhanc problem howev , sinc the wiener smooth filter wa deriv base on a model of the degrad and the optim of a specif object function .
therefor , under these condit , it is an optim nois smooth filter .
we also deriv a special adapt version of the nois smooth filter .
each pixel now in the imag is process differ , base on the special activ of the neighborhood it belong to .
so , let's proce with a materi of thi segment .
i can us the wiener filter to perform nois smooth .
so , in thi case the impuls respons of the degrad system is a delta .
a delta convolv with f will give me f , i , j here , so therefor the degrad model now is sigma plu nois .
i observ an imag , which equal the origin merg plu the nois that wa ad to that .
so under the same assumpt as befor , that is f and w ar wide and stationari .
f and w ar correl and thei ar both zero mean .
i can obtain now the form of the wiener nois smooth filter .
sinc here , h i j is a delta function , we know from what we have learn befor that the frequenc respons of the filter is equal to on .
so substitut thi in the express we had for the wiener restor filter we obtain just the frequenc respons of the nois smooth wiener filter .
so thi exactli the point that wa made earlier on when we talk about enhanc .
we have again the signal plu nois problem here , and when we talk about enhanc , we'd argu that a low past type of filter would remov some of the nois .
and then we would try differ shape of the filter and differ extend of for a given shape , and visual evalu the result and pick the on that would just be more suitabl for our purpos .
instead here we have a specif object which is the minim of the mean squar error , mean squar estim error .
and thi object give rise to thi express for the wiener nois smooth filter .
have a dual us the weiner nois smooth filter .
here's anoth interpret of the weiner restor filter .
we show again here the degrad model .
we call g i j , the imag at the output of the lsi degrad system , nois is then ad to it , and we observ y which therefor is equal to g plu w .
so y is the signal plu nois now model where the signal g is not the origin signal but instead the blend signal .
now , we know that the power spectrum of g equal to thi .
thi is on of the first express we show there , standard express when we have random process at the input of an lsi system .
okai , now with that , here is the frequenc respons of the wiener restor filter that we saw a coupl of time alreadi .
clearli i can multipli thi by on , so i multipl by h omega1 omega2 divid by h omega1 omega2 .
thi is ident , well the except of well h is zero , the frequenc for which is zero , but we'll assum that's perfectli fine .
and now i can combin thi h complex conjug with thi h .
and the product will give me the magnitud squar of h omega1 , omega2 .
so then what i obtain i see here .
here that h magnitud squar time p of ff is p of gg , so that's the numer and i can substitut in the denomin , so i have thi express now .
right ?
again , i combin thi h complex conjug with thi h , and with thi p of ff and i got p of gg .
and then thi down here is also p of gg , omega1 omega2 .
so we see that i can think of a wiener restor filter as the product of two filter .
the first filter is just smooth the nois .
not with respect to the origin signal but with respect to the blur signal .
so first , we take care of get rid of the nois .
and then , the nois free signal is invers the convult here .
i appli an invers filter for the deconvolut .
so thi is an interpret that justifi again first get rid of the nois and then get rid of the blur , but in a veri specif wai within the context of the wiener restor filter .
actual peopl introduc all kind of modif to thi concept here , which of cours , here is mathemat equival to do the wiener restor filter .
but i can alter the nois smooth and the invers filter and end up with combin of of other filter .
let us look now at the deriv of a spatial adapt wiener nois smooth filter .
thi is the degrad model , it's signal plu nois .
the observ imag y equal the origin imag f plu the nois w that ha been ad to it .
we assum that the nois is zero mean and that it is y , therefor it's spectral densiti equal it's varianc .
so , as we have seen for thi model , the frequenc respons of the wiener filter is given by thi express , where i have alreadi substitut the spectral densiti of the nois equal to sigma w squar .
we ar go to develop a filter that ha thi step shown here .
so , the observ imag y , from it the mean m of f will be subtract , then the filter will develop the wiener filter with impuls respons r i j will be appli .
the mid will be ad back to the imag and therefor the smooth imag is denot by p i j .
mayb , motiv by the exact result we show that got into which the weiner restor filter is the concaten of weiner smooth filter and then invers filter .
on can find in the literatur a number of result where two restor filter ar combin in differ wai .
on such result is shown here .
it's refer to as the geometr mean filter , and we see that is the combin of the gener invers filter and the weiner restor filter .
so alpha equal , a half is the geometr mean of the two but alpha in gener is between <num> into <num> .
for alpha equal <num> we have the wiener filter for alpha equal <num> if we have the invers filter , and of cours ani combin for the variou valu of alpha .
in addit if you notic here there's a gamma paramet .
weight thi stabil term in the denomin of the weiner filter .
so thi now start feel more like an enhanc problem , sinc these two paramet in thi particular case , alpha and gamma need to be specifi by the user base on the visual qualiti of the restor imag .
and again thi is just on exampl of the mani such exampl on could find in the literatur .
we want to modifi the wiener nois smooth filter so that it adapt to the local characterist of the imag .
toward thi task we divid the imag into stationari region .
and then for each region , we assum that the follow model hold for the imag .
so , f i j is equal to the local mean plu the standard deviat multipli by a nois term , and for thi nois term , we assum that it's mean is equal to zero while it varianc is equal to on .
empir evid suggest that it is a reason model for typic imag and typic process , imag process applic .
now for each of these region , i can write down the frequenc respons of the nois smooth filter .
p of f f base on thi model is equal to sigma f squar .
so , we see that the filter here is constant , doe not depend on omega1 , omega2 .
so , if i take thi back to the time domain , the impuls respons of the weiner nois smooth filter is equal to thi .
so , the constant gave rise to a delta in the special domain .
let's look now at the model we've been us toward thi nois smooth filter .
so we take the input imag , subtract the mean , process it through the filter , add back the mean to get the output .
so the equat therefor is that p of i j equal i minu the mean convolv with the impuls respons of the nois smooth filter and ad back the mean .
so if i substitut here for r i j equal to we have alreadi found over here sinc i convolv with the delta .
it mean that the signal goe through and therefor , thi is what i obtain .
so , thi the output of the nois smooth filter for a specif stationari region .
now , if i shrink the region to the pixel .
then the local varianc becom a function of i j and so doe the local mean , and thi give rise to the special adapt wiener nois smooth filter which you will see in the next slide .
so base on the analysi and the result we obtain in the previou slide .
if each region , the imag wa divid into is shrunk down to a singl pixel , then the local varianc of the imag becom a function of i j , and so doe the local mean .
after rearrang term , we find that the output of the nois smooth filter at locat i j is a convex combin of the input at the same locat and the local mean of the imag .
so , thi is the express of the special adapt wiener nois smooth filter .
it's a differ filter in essenc that is appli to each and everi pixel in the imag .
so , let's look at some special case of thi filter .
so first of all , if there is no nois ad to the data , then the output imag , it's simpli equal to the input imag , which make perfect sens .
the input imag is nois free .
therefor , there is absolut no need to do ani filter to the imag .
if i look at the edg ridg of the imag , at those locat , then the local varianc of the imag is much greater than the varianc of the nois .
and if i take thi into account and look at thi equat .
the first term here is approxim equal to on while the second coeffici is approxim equal to zero , and therefor the output of the filter is approxim equal to the input .
and thi also make perfect sens base on the argument i made at an earlier point that base on properti of the human visual system , the mask properti , nois is not visibl at the edg .
therefor , nois goe through the filter at the edg locat .
thi is not visibl .
and thi also allow us to leav the edg unfilt .
so therefor we obtain sharp edg , and the nois is not visibl , so thi is a desir result .
now if we look at the flat region , then the local varianc of the imag is much smaller than the nois varianc .
and then if i look at the coeffici , the first on is approxim equal to zero .
while the second on approxim equal to on , and therefor the output is a smooth version of the input and the output that , that pixel locat is equal to the local mean of the input .
i want to comment now on comput some of these paramet here .
actual i , i call m of f the local mean of the input , and thi is correct becaus the nois is zero mean , becaus of the model assumpt earli on , and therefor thi approxim hold true .
now , as far as find the varianc of the nois , if i first of all the , the model i've been us is that y equal f plu w .
i omit the i j here .
and to do the fact that signal and nois aren't correl .
i do have that sigma y squar equal sigma f squar plu sigma w squar .
so if i look at the flat region of the imag then at that region sigma of f is .
where it's approxim equal to zero and therefor , what i measur if i loc , measur the local varianc .
it's approxim equal to the varianc of the nois .
so , thi is on wai to obtain an estim of the varianc of the nois and then if i look at ani other region .
i can obtain the varianc of the imag as the varianc of the data minu the varianc of the nois .
so sinc i know the varianc of the nois i have alreadi calcul it .
i measur thi i can find thi wai the local varianc of the imag .
welcom back .
in deriv the maximum likelihood , and map estim of the origin imag , we need to statist model the origin imag , and the addit nois by defin the probabl densiti function .
these repres our prior knowledg about the origin imag and the nois .
and thei ar therefor , justifi , refer to as prior model .
then base on base theorem , our prior knowledg is modifi by the likelihood function .
it repres the most probabl imag that gave rise to the observ data , to form probabl of the imag after the degrad imag got observ .
justifi refer to as the posterior densiti function .
if the likelihood function is maxim .
in anoth word , no imag prior model is us , a maximum likelihood estim of the origin imag result .
if on the other hand , the posterior is maxim , then a map estim result .
we deriv the exact express for the maximum likelihood the map estim for a model and the so call simultan auto regress imag prior .
we see that familiar express result in thi case , that these , the express for the squar .
and the squar or winner filter .
so , let us now look into the of thi materi .
let us now discuss the bayesian formul of the imag restor problem .
we will deriv the maximum likelihood and map estim , and the specif prior model .
and we will sai a few word about the hierarch bayesian approach .
we show here in matrix vector form , the , the model we have been us all along .
so , y is the observ imag , h the known blur matrix f the origin imag and w the addit nois .
with approach , f is assum to be a sampl of a random field , and so is w , and therefor , y becom a sampl of a random field .
from here , clearli i can write that w equal y minu hf .
so the standard model that ha been us to model nois is the normal or gaussian distribut , name after gauss .
thi is the celebr distribut that ha found numer applic from imag process , we ar discuss here to econom and beyond .
so , thi is the express for the multi variat gaussian distribut .
so thi is the probabl densiti function of y , given f .
cww is the covari matrix .
and these vertic bar denot the determin of the matrix .
we assum that the imag ha n sampl .
we can , fail the simplifi thi model if we assum that in addit to be gaussian the nois is also white .
thi mean that the covari matrix is equal to a constant time the ident matrix therefor it's determin is equal to beta to the minu n sinc again the imag here is m pixel .
and from here of cours the invers of thi is just that ident .
so the form thi thi distribut take is shown here .
thi symbol denot that the left hand side of the problem is the densiti function of y given f .
is proport to the express on the right and clearli here , i have the inner product , y minu hf transpos time y minu hf , which give rise to the norm squar .
so , thi is the , the standard model that ha been us almost exclus , i would sai , for thi addit type of nois in approach and we ar go to proce with thi and see how it affect the calcul we ar go to undertak .
as we discuss earlier , when we were talk about the , the determinist restor techniqu .
prior knowledg is of the utmost import in solv restor recoveri type of problem .
sinc thei restrict the solut space .
so , with approach , we assum that the origin imag is smooth , and the wai you did that , we constrain the energi of the imag at high frequenc .
so we took a laplacian high , a high pass filter , and filter the imag .
we measur the energi at high frequenc and we tri to make that quantiti as small as possibl .
we can do a similar thing here by impos thi simultan autoregress as is typic refer sar imag prior .
so , the origin imag thi the function of the origin imag is proport to a gaussian here and exponenti with thi in the expon .
if we expand the norm then i have thi express here .
so thi is a zero mean gaussian with invers covari here equal to alpha c transpos c .
so , c again is a hyper filter , such as and on wai to , to tamper thi prior knowledg is if we look at thi again at the norm .
when the energi at high frequenc is small then i have e to the minu a small number so that's close to on .
so imag that ar smooth , imag that have low high frequenc energi ar more probabl accord to thi model .
we'll look at other imag prior model later on but let proce with these and see how we can find a restor imag base on these two model , for the nois in the previou slide and for the imag in thi slide .
we show here the joint distribut between f and y .
so , it's the probabl of f and y .
and accord to the product rule of probabl equal the condit of y given f time the margin of distribut of f or the probabl of f .
similarli the joint between y and f is shown here accord to thi product rule .
now sinc these joint ar equal the right hand side ar equal as well and thi give rise to base theorem .
so thi express , these , the express of base theorem .
so , thi is a posterior , the probabl of the unknown imag base on , on the data , so equal our prior belief or knowledg about the imag and thi is the likelihood function .
so our prior is alter by the likelihood to give the posterior .
and the likelihood is the most probabl f here origin wa that gave rise to the data .
so accord to the maximum likelihood estim approach , we find an estim of the origin imag which maxim thi likelihood function .
we find again the most probabl origin imag that describ the data we observ .
we also have the maximum a posterior or map estim .
which maxim the posterior , sinc the denomin here denomin of the posterior is independ of f , it's not includ in the optim .
so , it's the argument which will maxim the likelihood time the prior .
so both ar some of the commonli us estim approach the maximum likelihood and maximum and we'll see next .
under the model we introduc earlier , part of the estim we obtain , under these two condit .
let us see now what is the express for the maximum likelihood restor imag for the gaussian nois model that we introduc earlier .
it's shown here again , so thi is a condit of y given f , i onli keep the term that ar relev to the optim and therefor , i us here , the symbol .
cww minu on is the invers covari matrix of the nois .
so i do not us the assumpt yet but the nois is white .
so accord to the maximum likelihood , estim approach we need to maxim thi condit probabl here .
sinc there ar exponenti involv in these gaussian function a standard we do instead of maxim the likelihood directli .
we maxim instead the log of the likelihood , sinc the log is a increas function the maximum point doe not chang due to that .
so , i maxim the log of the likelihood , and if we take the log of the exponenti then the expon just come down and therefor i need to maxim thi express .
now , maxim a neg function equal to the minim of the posit function .
and therefor , we need to minim thi norm so , i've taken the invers covari and i just us it here as the weight of thi norm .
so i have to minim thi weight norm .
we look , we , we look what is the minimum of weight norm and if you follow the step , that we just explain earlier and us detect multipl time in these two week .
that we cover restor we can easili find that the maximum likelihood estim , is given by thi express .
so thi is the gener invers here .
in case the matrix is not invert .
now if the nois is white then the covari equal to beta minu on ident , so is actual the varianc of the nois .
and in thi case , if i substitut cww in the express abov , i find that the maximum likelihood .
estim is given by thi express .
so thi exactli the express we obtain when we cover thi squar restor in determinist fashion thi result call for ani matrix h .
if the degrad is due to the linear spacial invari system then we know that h becom block circular .
and further more we can take thi expir to the discret frequenc domain and thi is what we call the gener invers or the invers filter .
so we see that under the assumpt of gaussian nois , the result of the maximum likelihood restor .
equal the result of the , least squar estim in a determinist fashion and here is a weight list squar , and here is the unweight least squar or the invers filter that we develop earli on when we start talk about restor .
let us look at the express , we can obtain for the map .
base restor .
we will us the nois model that we introduc earlier , and us also for maximum likelihood , and for the imag prior , we'll us the sar model that we also introduc earlier .
i am remind you here that the invers covari of the imag , it's simpli equal to alpha c transpos c .
someth , you can see right awai if you expand thi squar norm here .
accord to the map estim formula , we ar look for f here , the restor imag that will maxim the log of the posterior .
thi is the numer of the posterior , the denomin independ of f , so i have the likelihood here and the prior .
so , if we multipli the exponenti and take the log .
the expon come down and also instead of maxim as befor i carri out a minim of the neg function .
i've us the nois covari here as a weight to thi norm .
so we have thi some of a weight norm and the l2 norm again have look at thi .
multipl time and in differ version .
we now that we have to take the gradient of what's insid the bracket and set it equal to zero , and if we do so , us what we have learn and us multipl time in thi class , we can obtain that the map estim is given by thi express .
so thi again the gener invers thi plu and do you see that both the , as expect , the nois covari is involv in thi paramet alpha .
now if the nois is white then thi is the nois varianc here .
and these ar , i substitut thi express in what we alreadi obtain .
we find thi form for the map estim .
so , we sai right awai thi is the familiar constrain least squar solut that we obtain when we talk about determinist restor , instead of alpha over beta here .
we had on paramet let call it lambda .
the paramet or the multipli .
we also know that the cl filter is equival to the winner filter base on the appropri interpret of the error covari and the imag covari .
and most specif , if i substitut here for the imag covari , thi express then from here , i , thi is a same express we obtain from the wiener filter .
so in summari , under these two specif model for the nois , and the imag ar prior knowledg about the imag .
we see that the map restor give exactli the same result as the constrain squar restor , and the wiener restor that we have cover befor .
welcom back .
with some of the more recent imag restor approach .
we ar interest in obtain an estim of the posterior , not just it maximum valu , as with map estim .
coupl with a hierarch paradigm , prior model for unknown signal ar defin , that is for the nois , the origin imag .
but also for the point function of the blur system for the blind restor case .
and also model ar defin for the paramet which defin such prior .
then the posterior for all unknown paramet is four .
sinc it estim is not directli feasibl an approxim of it is sought after .
with such an approach , the origin imag and pois function of the blur ar estim along with the unknown paramet , such as the nois variant , automat base on the avail data .
sinc , it becom a rather complic estim problem .
we do not show ani of the algorithm detail .
instead , we show some experiment result , which repres on of the state of the art result .
so , let us now proce with the materi for thi segment .
i would like to make a few comment base on what we have seen .
in the previou few slide , we saw that the result of the maximum like wood and map estim , result in some nice , close form solut .
thi clearli mai not be the case , and simpli depend on the nois model in the imag prior we us .
so , depend on these choic we mai have to address some challeng optim problem which ar outsid the scope of what we ar do here .
the second comment is that in all these deriv , we assum that the imag and nois covari .
in the gener case or the specif paramet alpha and beta , where assum to be known .
so , the , our techniqu to try to estim such paramet offlin but in gener .
we need to address the estim of thi paramet , as well .
also , we have been deal with the non blind restor problem , accord to which the blur function h .
the impuls part of the system , the matrix hr known ahead of time .
but clearli , veri often thi mai not be the case and therefor , on need to address the blind restor problem as well .
thi is a topic that ha seen quit some activ , and there ar techniqu that .
first , estim the blur and then perform the restor problem , so it's a separ and sequenti estim process .
howev , the last two point can also be address through the hierarch bayesian paradigm .
i would like just to give you a flavor of thi paradigm , just mention it , describ it at a veri high level simpli becaus we end up with challeng optim .
approach in mani case , and thi is someth , again , outsid the scope of thi cours .
howev have thi basic inform , i believ that you'll be abl , for those of you interest , to look into the literatur and , and dive a bit deeper in mm , look at some of these veri interest and excit result .
what we discuss here is an extens of the materi we alreadi cover .
so we're interest in form thi joint distribut shown here .
and the distribut of f the unknown origin imag we tri to estim h , the unknown impuls respons of the degrad system , so we ar address blind restor here .
thi set omega which incorpor all the unknown paramet , model paramet we introduc .
so omega refer to as the hyper paramet .
and y is the observ nois in blur imag .
now the hyperparamat ar treat themselv as random variabl , therefor we bring in inform about them through the probabl of omega .
thi is a hyperprior .
so accord to the product rule of probabl we have a disjoint equal the likelihood , function time the prior knowledg we bring to the problem , and the prior consist of a prior on the origin imag f , a prior on the unknown .
impuls respons of the degrad system h and the prior , on the hyper paramet .
so , if we look at a , for exampl , at quad hyperprior we saw that for the likelihood there wa the paramet beta as , as an unknown that a minu <num> is the nois varianc actual .
that imag prior involv the paramet alpha and let assum that we have a prior on h .
let move thi prior , for exampl , that involv anoth paramet gamma .
then the set of hyper paramet omega is simpli these three paramet , alpha , beta , gamma that also i need to estim .
so , we try to draw infer again base on the posterior .
the probabl of the unknown paramet , again , the origin imag , the impuls degred system and the hyper paramet given the observ imag .
accord to base rule , is equal to thi fraction .
and depend on the approach we follow , we can draw infer again from thi posterior function .
so , we have introduc two addit paramet , h and omega but other than that the framework is again an extens of what we alreadi cover .
it's call the hierarch paradigm , bayesian paradigm , becaus in the first stage we model the nois , the origin imag and the , the gradat system , and in the second stage we model the .
hyper paramet through these hyper prior .
the differ wai for draw infer from the posterior , we show in the previou slide .
on of which is again maximum likelihood .
we try to maxim the likelihood function here , with respect to the three unknown .
it's the origin imag .
the impuls is possibl the system and the set of the hyper paramet .
clearli now , there ar three unknown involv and their optim problem is more challeng .
on gener approach is to altern optim , so you fix two paramet , you fix each of the mega for exampl , optim with respect to f .
the result of the optim is fix on f then let's sai , h is also fix and to iter on omega and keep iter thi wai .
similarli , a map estim can be obtain by maxim the posterior .
it's shown here again , thi is the numer of the posterior , the denomin independ of the optim .
thi is now , even more challeng than maximum likelihood .
again , three unknown altern optim is again a gener approach that on can follow .
both these approach provid so call point estim .
just on answer for the unknown paramet .
on might be interest in obtain an estim of the posterior itself .
in that case , on can follow a variat or approxim approach to the posterior .
so as the name impli .
a function that is better behav is us to approxim the posterior and then thi other function is optim and provid the desir form of the , the posterior .
thi is advantag becaus now on can obtain addit inform about the estim process and possibl the differ point to repres the restor imag as well as the unknown impuls point .
altern on could sampl the posterior through some modicarlo approach , and that wai an estim of the posterior can also be obtain .
in all of these case , howev , the result optim is outsid the scope of thi cours .
but again , for those of you interest , i believ we have some basic understand here , of thi materi .
and you should be abl to quot the literatur and look deeper into ani of these approach .
as mention multipl time so far the amount and qualiti of the prior inform about the imag , the blur , and the nois is of the utmost import in establish the qualiti of the restor imag .
when it come to bayesian method , thi prior knowledg is incorpor into the algorithm through the us of prior model .
we discuss such prior model for the nois and the imag in previou slide .
anoth imag prior model is a total variat model shown here .
it ha becom veri popular recent in the restor literatur becaus of it's edg preserv properti , by not over penal thi continu in the imag while impos smooth .
z of alpha here is the so call partit function .
delta of i , h is the horizont gradient of the i'th pixel , while delta i , v is the vertic gradient at the i'th pixel .
thi actual repres a quadrat approxim to the tv prior .
and alpha is the hyper paramet that need to be estim .
when it come to model the blur , on of the model that ha been us is also a sar of the blur .
as we discuss , such a model impos smooth on h in thi particular case .
it's a reason model for a good number of the blur that we encount in practic , like the on i show at the begin of the restor segment of the cours .
so , here the hyper paramet is denot by gamma and it need to be model and estim through thi framework .
the literatur is rich with prior model for both the imag and the blur .
it mayb goe without sai that the more complic mathemat speak the model , the , hopefulli better the result , but also harder the optim problem , on ha to solv .
in the follow , i will show some experiment result , when these two prior ar us .
the tv for the imag and the sar for the blur .
i will not show ani of the mathemat detail .
thi variat or approxim .
approach that thei mention the previou slide is util .
but again the main point is just to give you a flavor of what is achiev .
i will show here in a synthet experi result blind and non blind restor result util the variat of bayesian algorithm that i just mention a few slide earlier .
the result ar fulli autom in the sens that all the paramet that ar need .
such as the nois variant and the imag and blur model paramet , ar estim automat from the data .
so , we show here the degrad .
the blur ha gaussian shape and varianc nine , and the blur signal to nois ratio is <num> db .
thi is the result of blind restor , when sar model ar us , both for the imag and the blur .
when now , a tv model is us for the imag , while the same sar for the blur , thi is result we obtain .
and if we perform a differ implement of the tv imag model , we obtain the imag shown here .
by compar the blind restor here .
most peopl , on would agre that the tv provid better restor .
the tv imag prior .
and thi is also reflect by the improv in signal to nois ratio number .
now , if the blur is known , and thi is a synthet experi so we know exactli the blur so it's a non blind restor .
then these ar the correspond result we obtain within thi three combin of model i show here .
let me switch back and forth a few time to see .
what is the addit improv on obtain by know exactli the blur ?
so , a similar comment can be made here that the tv imag prior provid .
better result than the sar imag prior visual and also by compar the isnr number .
actual you see here the piecewis smooth result when you look at the tv result that is the , is what the tv model realli promot .
we show here in red , the origin point script function of the system .
i draw over it , so that it's visibl and then below , you see three differ estim of , of the blur when the , the blind desol algorithm is run and the differ sar in paramet that .
on ha to choos in determin the hyper prior , the prior to impos on the hyper paramet that we need to estim .
so , by and larg , all these three estim shown here , do a reason job in approxim the real or origin estim function .
we final show a state of the odd blind restor result util the variat beta framework i just mention a few slide earlier .
a spars imag prior is us , a so call super gaussian prior .
sinc we ar model the edg of the im . ag which is spars .
we will be actual talk about sparsiti dure the last week of the cours .
so here is the acquir imag and some close up .
thi is an imag i also show at the begin of the lectur on restor .
it's actual the build outsid my offic at north western univers .
so , while the pictur wa taken , while the apertur wa open , the camera move or shook in an unspecifi wai .
appli thi fulli autom algorithm that is all the requir paramet , were estim from the data .
here is the restor we obtain .
so quit a lot of inform is reveal .
look also at the close up window down here .
we can see the peopl the peopl walk there and a lot , a lot of detail .
the estim blur is also shown here .
so , the shake of the camera did not follow a linear trajectori , as wa the case with the horizont motion blur we studi earlier .
in thi final segment , we show the formul , of some of the recoveri problem , we mention at the begin of the class last week .
most specif , we show the formul of the , imag super resolut , video resolut , pansharpen , and the dual exposur problem .
it should then be clear that these ar inde invers problem , and in principl we could us ani of the techniqu we cover in the last two week , to provid solut to these problem .
so , let's have a closer look .
we will show next the formul of these four , recoveri problem .
name .
imag , and video super resolut , pansharpen , and the dual exposur problem .
we will talk about in paint , anoth on of the , recoveri problem i mention earlier in the last week of class when we talk about sparsiti .
and then for some of the other , recoveri problem , such as the we do need inform that will start cover in next week .
name imag and video compress .
we explain here , the basic idea behind super resolut , or so call geometr super resolut , in somewhat ideal wai .
the first scenario shown .
a singl camera take multipl pictur , of the same scene .
the assumpt is that , there is a sub pixel shift between the acquir imag .
each of the acquisit is a low resolut imag .
the second scenario .
is that multipl camera take a pictur of the same scene .
the same underli assumpt hold , that these , there is a of shift among the imag .
the third scenario , is that the video camera is record a dynam scene .
due to the motion of the object in the scene , the , the pictur in each frame , is with sub pixel shift with respect to their locat in a neighbor frame .
so , in all these three scenario , low resolut still imag or video frame ar acquir , as shown here .
these frame ar relat by sub pixel shift .
global , as the the first two scenario , or local , due to the motion of the object , accord to the last scenario .
if we show the low resolut imag on the grid , for the first two case of a global shift , .
then the pictur shown here , result .
so thi is a , pixel shift here , on for exampl here , thi is a sub pixel shift .
so conceptu .
each low resolut imag , sampl the continu <num> dimension scene at differ point .
and therefor if we , estim the sub pixel shift we can then util all these observ and be abl to construct an imag frame at the higher resolut .
so thi is the object of super resolut .
so object of super resolut is to estim , the global , or local sub pixel shift and then gener a regular breed , either a still imag or video frame at a high resolut .
base on , the discuss we had in the previou slide we show here the imag super resolut acquisit model or degrad model .
x is the high re imag , and y of k , we'll sai y <num> , y <num> , y <num> where the low resolut observ imag .
so accord to thi model .
the high resolut imag is motion warp .
thi , could mean just sub pixel shift or rotat compon might be present or ani inform might be includ in thi motion warp oper , which is .
describ by the paramet s of k .
then thi motion warp high resolut imag is blur , by a system with point spread function h of k , and thi blur warp high resolut imag is final down sampl accord to thi oper a .
to gener the low resolut imag .
so all these oper can be , combin into , thi oper here .
so the problem is given the , low resolut observ , .
k equal <num> to <num> for thi particular imag , and knowledg of b of k , s of k , we tri to find an estim of the high resolut imag , given also mayb some knowledg about the nois .
now , the motion paramet need to be estim .
the blur mai or mai not be known so if it's not , known then we have a blind , imag super resolut problem .
so it's clearli , an invers problem .
a recoveri , problem .
and , ani of the approach we've cover so far could be potenti appli to solv thi problem .
on could follow a sequenti approach , accord to which first the motion paramet ar estim , mayb follow by the blur , and then , after both of them ar estim , thei're util here to defin , b of k and solv thi invers problem .
but , mayb ideal , as wa argu at an earlier point , we would like to estim all the unknown paramet , along with the high re imag simultan , so that error that were calv dure the estim itself , the motion paramet , ar , util in estim the high re imag .
imag .
we show here the acquisit model for the video super resolut problem .
as you'll see , is veri similar to the acquisit model for the still , imag super resolut problem .
so , accord to these , the high resolut frame denot by x , each of them is blur by b , down sampl by d , nois is ad to gener the sequenc of low resolut .
frame y .
so that , high resolut frame x of k is blur .
down sampl , nois is ad to gener the low resolut frame , y at time k .
now , the high resolut frame .
x at time k can also gener , addit , low resolut observ , at time , at differ time , instanc accord to thi formula .
so , the high resolut frame , x at time k is , motion , compens or motion , warp .
and map to a time i , lead down sampl nois that i did , and the low resolut frame at time i is gener .
that wai .
so , we see that , on high resolut frame at time k , here can gener as mani low resolut frame as we would like , at differ time instanc base on the motion field .
so , it's exactli the same formul as the previou case .
each case , the main differ is that , thi now , c of dik is shown here , is , doe not refer to a global motion or the global warp of the frame , x of k , but instead to a local on .
so , we need to find the motion of the move .
object in the scene , so we need to find the motion for each and everi pixel in the frame k , with respect to the frame at time i , and thi again , motion field is go to do thi map .
between the two frame , and the motion fill can be , just a pure translat of field , or also includ rotat or ani other transform that , seem to be necessari to model the particular data we're work with .
an interest and more challeng , video super resolut problem occur when the observ video is now compress .
thi is inde the case with mani low end video camera , that do not make avail the .
origin data or the sourc data , but onli a compress version of that .
i know we have not talk about video compress yet .
we'll actual start do so next week , but for the purpos of thi discuss , we onli need the , the , gener idea about it .
the notat is .
differ than the previou slide but , i will not be write equat .
i just want to , describ here the concept .
so in three we start with the high resolut , video here which , is acquir by a camera .
and base on an , acquisit model like the on we describ in the previou slide , thi low resolut video is observ .
now thi is input into a compress system , and the output of the compress system , ar the low resolut compress .
video .
but also , inform that is gener by the , the coder , the video coder .
and such inform is a , spars motion field .
as well as inform about the , quantiz that wa us .
the step size .
so then , the problem , in thi case , is to util the avail data , which is .
that compress low re video , but also thi , you might sai , auxiliari inform provid by the code scheme , motion vector and inform and we want to obtain an estim of thi high resolut video frame .
so clearli , in addit to , the acquisit system that we describ in the previou slide .
we also have to model the compress system , and util these two model , again , we want to revers that path and somehow from , low re go back to the high re data .
so thi is an , inde , an invers recoveri problem like the on we're describ here .
we discuss here the acquisit model for the pansharpen problem .
which is also , a super resolut problem .
so in remot sens applic , a satellit such as lansat .
is imag part of the earth , as shown here .
now , ideal the sensor on the satellit , would have gener these high resolut multi spectral imag , which we denot by y of b .
and let's assum that we have b channel .
but instead of gener thi higher re multispectr imag , a spectral decim is take place so , we ar , ad up the multispectr imag thi wai and a so call panchromat imag .
is gener , accord to thi model .
so , a panchromat imag x , is the weight sum of thi high resolut multispectr imag .
and we assum we have b of those big channel .
and the lambda ar obtain from the central spectral characterist .
in addit , a spatial decim is take place so each of these multispectr imag , is down sampl and here is an exampl color code .
low resolut multispectr imag .
and the model , of thi decim is shown here so , the high re multispectr imag b is blur and then down sampl .
nois is ad and thi low re .
multispectr imag is produc .
and again , we have capit b of those .
so the pansharpen problem is to , work with , the avail data which ar the low imag and the imag and to obtain an estim of the high re multispectr imag .
if h is known , it is a non blind problem .
if , howev , h is to be estim , it becom a blind pansharpen , or as we saw , a super resolut problem .
take high qualiti photograph under low light condit , is a major challeng .
a longer exposur is requir to obtain an imag with , low nois but ani motion of a camera caus blur .
so , the propos solut is to obtain both a long , and the short exposur imag , as shown here .
so , thi is the long exposur and thi is .
the short exposur imag .
clearli due to , the camera shake , blur is present in the long exposur imag .
on the other hand , in the short exposur imag , becaus there's not enough light .
the imag is noisi , although sharp .
and in addit , there is color loss .
so , the object is to combin these two imag , these two observ , and obtain an estim , of the origin scene .
on could , work with thi imag , for exampl , and remov the nois .
but the color loss .
it's still there .
combin the two and obtain an estim of the blur and then , work with , thi long exposur imag and remov the blur with ani of the method we coverd in class so far .
howev , do thi simultan , while estim all the unknown paramet is , by and larg , the direct to go .
the acquisit process can be model us two coupl linear , special invad system .
so the model for the long exposur is shown here .
why you want to observ the imag , h the , blur matrix that introduc the of the camera shake and x is , the origin imag .
due to the camera movement between , acquisit , the imag pair ha to be regist both .
photomat , and geometr .
so the short exposur , imag y2 , involv these two , lambda <num> lambda <num> paramet that ar respons for the , for photometr registr and , the matrix or oper c data count for the geometr registr .
lambda <num> , lambda <num> , and c can be a part of the problem or thei can be handl separ as a pre process step , in which case the observ short exposur imag y <num> equal the origin x plu nois .
so , the problem at hand in thi dual exposur problem , is to util the two observ , y1 , long exposur , y2 , short exposur , and obtain an estim of the blur and an estim of the origin imag , x .
in principl , the , techniqu we cover so far in class .
could be util to , solv thi particular problem .
so , yeah we've reach the , end of week seven .
i have to admit that the last two week were , rather intens .
overal , howev these ar not repres of the cours in the sens that thei're the most intens or dens .
two week out of the <num> week of the cours .
there is almost , four and a half hour of materi dure these two week and thi by itself is a mini , cours on imag recoveri .
we saw that the materi is rather mathemat , util result from linear algebra .
optim , and stochast process .
but , as i mention multipl time alreadi , do not be too concern if for some of you , not everyth is crystal clear at thi point .
you , have enough inform to further studi the topic , and us algorithm that you can util right awai .
the first week we cover determinist imag restor approach , obtain the solut in a direct or in an iter fashion .
thi week we cover stochast , restor approach .
we deriv the celebr wiener filter and also the commonli us maximum likelihood and map .
estimat , we also discuss the fulli hierarch approach , which result in some of the state of the art , result .
i hope you found , the materi interest .
i believ it will , prove to be of us in a number of recoveri problem .
but also , other applic , sinc we do not just discuss specif algorithm , but more gener estim framework .
next week , we'll start with anoth excit topic that of imag and video compress .
so , i'll see you next time and , it's promis to be a , lighter week .
hello and welcom to week eight .
thi is the begin of a three week coverag of the excit topic of imag and video compress .
imag and video compress repres on of the major topic in imag and video process .
compress is on of the enabl technolog behind the multimedia revolut we ar experienc .
without success algorithm and standard , we would not be abl to rent movi on a dvd , stream them on our comput , us facetim , share imag and video over the internet .
and us so mani other cool applic involv imag and video .
we divid compress techniqu into loss free , or lossless techniqu , and lossi techniqu .
as the name impli , in the first case we have a revers process .
no inform is lost and the reconstruct imag is ident to the origin on .
in the second case , inform is lost , which result in deterior qualiti of the reconstruct data .
howev , thi deterior is control by the person perform the encod .
and an imag or video of accept qualiti result , depend on the resourc and the requir impos by the applic .
the first interest question on might ask is , why ar imag and video compress ?
there ar two primari reason for that .
on is that most imag and video have some structur in them or thei ar correl .
or in other word , thei have redund , statist speak .
we can uncov thi redund and then remov it so that compress is achiev .
thi is a step taken by both lossless and lossi compress scheme .
the second reason pertain to loss of compress and ha to do with the fact that there is inform in imag and video that is not perceiv by human .
and therefor , it can be discard .
so thi week , we address lossless compress approach .
such approach result in algorithm or standard for encod imag and video , as well as other type of data .
equal importantli , howev , such sourc code techniqu , for exampl the huffman and arithmet code , ar part of ani lossi compress scheme as we'll see in the next two week .
we'll start in the first segment by introduc compress , discuss the need for it , and then list the lossless compress techniqu to be cover thi week .
as we'll see , such code techniqu have their root in inform theoret concept .
therefor , we review some of the basic concept for inform theori need for thi class .
the heart of the sourc encod problem is the represent of the symbol gener by a sourc by binari code word .
an import question aris is , what's the smallest possibl rate or the smallest averag code word length of the code for repres the sourc ?
the answer , due to shannon from <num> , is that the smallest possibl rate is equal to the entropi of the sourc .
a quantiti that measur the uncertainti of the sourc .
we'll discuss two import and wide us techniqu for gener code with perform close to entropi , the huffman and the arithmet code .
we'll also discuss a replic to the fax in code standard .
we'll discuss also the so call dictionari techniqu for encod data with repeat pattern , such as text .
final , we'll discuss the concept of predict .
the correl in the data allow us to predict the valu of a pixel base on past valu .
which then result in all thi send to the decod the unpredict part of the predict system , which is the predict error .
the inform theori concept ar rather mathemat .
but we onli need certain simpl result , and more specif , their applic to the lossless compress problem .
thei repres veri interest , intrigu , us and wide us result .
so with that , let's start with thi excit materi of week eight .
let us start thi lectur by defin what is compress , signal compress , also defin the sourc compress or sourc code .
it is the minim of the number of bit in repres a digit signal , at least the imag or video , the signal we're primarili interest in thi class .
while either be abl to exactli reconstruct the origin data , and thi is refer to as lossless compress .
or maintain an accept qualiti of the reconstruct origin data , and thi is refer to as lossi compress .
in thi class , we ar go to cover both lossless and lossi compress .
so thi week , we'll talk about lossless compress , the follow week about lossi compress of still imag .
and the third week about lossi compress of digit video .
as it will becom clear rel soon , lossless compress stand by itself .
but , it's also part of ani lossi compress scheme .
so , let's proce put togeth the piec of thi excit topic of imag and video compress .
the natur question is , why do we need to compress signal ?
an answer can be found by look at the raw data gener by variou sourc or the raw data util to repres variou signal .
so in thi tabl , there ar some repres signal .
so for exampl , if we look at the telephoni applic , the speech signal there occupi thi bandwidth .
we sampl at twice , at least , the highest frequenc in the signal , so we sampl at eight kilo sampl per second .
we us <num> bit per sampl , and the , row rate is <num> kilobit per second .
move down to wideband speech , do similar calcul , we ar now at <num> kilobit per second .
look at music , wideband audio , we've reach the rate of almost on and a half megabit per second .
if we look at the medium size still color imag , <num> by <num> pixel , three channel , eight bit per channel , <num> bit per pixel .
we ar now at the rate of <num> megabit .
and if we look at video , here is the ccir601 recommend .
so thi is the special resolut <num> by <num> pixel , thi is the lumin compon .
we us eight bit per pixel .
with the ntsc system , we have <num> frame per second .
and then for the two chromin compon , thei ar subsampl in the on dimens accord to thi recommend .
so each of the chromin compon ha <num> by <num> pixel .
again , eight bit per pixel , <num> frame per second , and we end up with a rate of <num> megabit per second .
if we go to a larger spatial resolut , hgtv , then here there's no subsampl , so there ar three channel .
thi is the spatial resolut , <num> bit per pixel , <num> frame per second , and we ar now at the gigabit per second rate .
so , compress address primarili two applic .
the storag applic , how much space doe it take to store a specif imag or video .
as well as transmiss applic , how long doe it take to transmit certain signal .
so , if we look at a simpl exampl here .
if we were to store ccir601 video that we just show over here .
and if we us a cd rom of <num> megabyt as the storag medium .
then , on on disc , we could onli store <num> second of video .
if we us a <num> gigabit dvd <num> , then still we could onli store four minut of video .
therefor if you , if you were to store a whole movi , you can do the calcul base on how long the movi is .
you need mani , mani of such cd or dvd .
similarli , if we look at the transmiss broadcast applic .
then for hdtv terrestri broadcast , thi is the transmiss rate , almost <num> megabit per second .
and therefor , we see that we need to compress the hdtv signal by a factor of about <num> in order to be abl to fit the hdtv signal into the six megahertz channel .
so , signal in their nativ domain gener tremend amount of data .
and without compress , we wouldn't , would not be abl to store them effici or transmit them effici .
on natur and import question is , why ar signal compress ?
there ar two reason for that .
the first on is that there exist statist redund or structur in the data in the spatial , tempor , and spectral domain .
if we're given , for exampl , an imag with no structur in it , such as an imag of white nois , then such an imag is not compress .
none of the exist algorithm would be abl to reduc the number of bit requir to repres such an imag .
thi redund manifest itself in the form of correl in the data .
on express of thi correl is in repeat pattern , such as in text data .
which we can captur , for exampl , by build short dictionari abl to describ larg string of data .
altern , we can us these correl to perform predict .
so in the spatial domain , if we look at ani imag .
we can predict the intens valu at thi locat by util , for exampl , the intens valu of these four neighbor .
we can build , for exampl , a linear model to do thi predict .
in compress , we ar interest in the unpredict part , or the predict error , when we perform thi predict .
becaus , the decod can carri out the predict as well , assum that the predict model is known .
and therefor , onli the correct term is need that when ad to the predict will give rise to the reconstruct valu .
similarli , when i look at two consecut imag frame , let's sai frame t , and t minu on .
then , i can predict the valu at frame t us the motion inform from t minu on to t .
and thi is a first order tempor predict model that is us extens in video compress .
thi statist redund or structur in the data is exploit by both lossless and lossi compress scheme .
now , for lossi compress scheme , we also have the exist of perceptu irrelev inform .
thi inform we cannot see , or we cannot hear , when we deal with audio .
therefor , thi inform can be thrown awai .
of cours , we need sophist model and techniqu to effici captur and remov such inform .
becaus , otherwis , we run the risk to throw awai perceptu relev inform , as well .
such sophist model do exist .
thei have been propos in the literatur .
and thei have also been incorpor in imag and video compress standard .
and thei're veri effect in captur and remov such irrelev inform .
on can gener thi in some sens .
and talk about the exist of inform which is extran to the intend us of the imag and video , in case that the human is not the recipi of the compress data .
by all account , compress is on of the enabl technolog behind the multimedia revolut we ar all experienc .
without the exist of success imag and video code algorithm and standard , we would not have been abl to store a movi on a dvd .
or stream a movi , or a video clip from a live concert , or from youtub .
or us video conferenc over skype , or us facetim , and so mani other cool applic that have chang the wai we live and work todai .
so it is certainli a topic worth the three week coverag we will provid in thi class .
there ar number of reason contribut to the prolifer of compress applic both lossi and lossless compress .
on such element is the extraordinari theoret result on compress , which ha been deriv in the last <num> or so year .
we will see some of these result here in the first week of class .
like for exampl the <num> year old , by now , sourc code result attribut to claud shannon .
a lot of advanc have been made in be abl to model and extract the perceptu irrelev inform in the signal , be it a video , or , an audio signal .
there have been , veri , success compress standard , such as jpeg and the variou mpeg and h . famili of standard to talk about .
it should be kept in mind that not all standard succe , and that there ar mani applic area for which there ar no standard .
the process speed and gener capabl of dsp processor have increas tremend .
so , that it's now possibl to implement , for exampl , a video coder , which is a rather demand task as we'll see , on a handheld devic .
and coupl with thi ar the technolog advanc , in gener , in comput , network , and telecommun .
that make so mani applic , like the few on i mention in the previou slide , feasibl .
let us proce with lossless compress .
as alreadi mention , the object in thi is case is the exact reconstruct of the origin data from the compress data .
in other word , lossless compress is a revers process .
we can move back and forth between uncompress and compress data without loss of inform .
an ever present question when we deal with signal compress is , how much can a specif signal be compress ?
the compress ratio quantifi thi .
it's defin as the ratio of the size of the input signal , over the size of the output signal .
the greater thi number , the more effect the compress scheme is .
for lossless compress , thi question is answer by the sourc code theorem due to shannon .
as you'll see , it tell us that no matter how invent we ar we , cannot compress a signal below it entropi .
thi is a quantiti we mention back in week six when we were cover non quadrat restor techniqu .
but , it's a quantiti we'll defin here more specif in thi , in thi week .
an import question , of cours , remain how precis can on measur the entropi of the signal ?
as probabl expect , the compress ratio , in thi case , ar low and certainli lower than when compar with lossi compress .
lossless compress ha a number of applic , such as the compress of text .
you don't want the report you wrote for school or work to read differ after it's decompress .
it ha also applic with medic imag .
sinc now the specialist is not interest in the visual qualiti of the compress imag , in gener , but instead in the diagnost qualiti of the imag .
so , with loss , lossi compress we run the risk that due to the artifact by compress , an oper , for exampl , is order when on is not need .
final , as i alreadi mention a coupl of time and we'll see start next week .
a lossless code or decod , it's call a codec , is part of ani lossi compress scheme .
now , when we evalu the compress scheme , certainli the code effici is of the utmost import .
howev , when we deal with actual implement of codec , then other factor such as the code delai , how long doe it take to encod the signal .
as well as the coder complex , which can be measur in term of memori requir , power requir , oper per second , should also be taken into account .
lossless sourc code techniqu can be group into statist method , when the sourc statist ar known .
the primari repres ar huffman code , and extend huffman code , that we will cover in thi class .
and you will see actual the applic of huffman into , the , encod of fax .
the second group includ so call univers method .
when the sourc statist ar not known but instead evalu from the data .
so i'll sai a few word about arithmet code as well as dictionari techniqu .
and then we'll see the applic of arithmet code when it come to jbig , on of the standard .
suppos we have a page of text , and we want to store it in the comput .
the comput understand zero and on , and therefor , we have to convert the letter and the word in the page of the text into zero and on .
how shall we do it ?
on wai is to us fix binari codeword for each letter , upper and lowercas letter , and for each punctuat symbol , the comma , period , quot , and so on .
thi is exactli what ascii is do , the american standard code for inform inter , interchang .
seven bit per symbol ar us by ascii , and therefor , if we count all the letter and punctuat symbol in the page of text , and multipli them by seven , we'll find out the total number of bit requir to encod the whole page .
can we do better than that ?
if ye , how can we do it ?
what inform do we need to know about the sourc that gener the symbol so that we accomplish thi ?
well , the answer is , ye , we can do better than fix length , length code with the so call variabl length code .
and what we need to know is the entropi of the sourc .
so we'll cover these excit concept in thi segment .
without further ado , let's begin .
we need some idea from inform theori , sinc thei provid the framework for the develop of lossless data compress scheme .
we're therefor go to briefli review them .
so the first idea is the construct of a sourc which ha a finit alphabet associ with it .
thi sourc emit a sequenc of symbol which ar chosen randomli from thi finit alphabet .
such a sourc can model ani inform gener process .
exampl of sourc ar natur written languag , such as the english languag .
in thi case , it alphabet ha <num> letter .
we can assum that thei're all , for exampl , capit letter .
anoth exampl is a sourc that gener an n bit imag .
then the alphabet ha two to the n symbol .
for eight bit imag , we have <num> element , symbol , in their alphabet .
now the simplest sourc we can model is on that is discret and without memori .
so it's a discret memoryless sourc , or a dm .
the success symbol gener by thi sourc ar i i d .
thei ar statist independ and ident distribut .
thi sourc of cours mai or mai not be a good model .
for the sourc , for exampl , that gener the word in the english languag or ani languag for that matter , we know that there is a depend among letter in form word , and also that certain combin of letter ar not encount in practic .
so for exampl in english , i don't believ on can have thi combin of , of four letter .
now thi dm sourc is complet specifi by the sourc alphabet and the associ probabl for each symbol in the alphabet .
we first address the question of how much inform is gener by the occurr of a certain event or by the admiss by the sourc of the certain symbol .
intuit , thi amount of inform , the so call self inform , should be a function of the frequenc of occurr of such an event or symbol , and even more specif , it should be invers proport to it .
out of a number of possibl choic , the function that fit the bill nice , and also ha addit desir properti , is the log function .
so more specif , the self inform is defin accord to thi formula .
so thi is the self inform of the symbol si equal the log of <num> over it probabl , which is also clearli equal to the minu log p of i .
so if i look at the log function , it look like thi .
it goe through on .
now , if i'm to show the self inform , if i want to plot p of i minu log p of i , then the probabl clearli ha valu between <num> and <num> .
and therefor , it's thi part of the curv i'll be us , so i'll take thi part of the curv and invert it sign , so it will look someth like thi .
i did not show the base of the log function .
the result is independ of the base sinc i can convert from on base to anoth on .
but , histor , if the base of log is <num> then the unit , the unit ar bit , if the base is e , the unit ar not , and if the base is <num> , then the unit ar refer to as hartlei .
from now on we'll be us a log base two , therefor the unit will be cut , will be bit .
so what thi formula up here is tell me is that the occurr of a less probabl event provid more inform .
so a certain event , an event with a probabl on over here , convei zero inform .
thi is , if in your convers you report on fact that everybodi in your group know , you convei veri littl or zero inform .
if somebodi sai that dai is follow by a night , thi is a zero inform event .
if , on the other hand , an event is , ha veri low probabl , down here , right ?
such as , there would be a solar eclips tomorrow , then the inform content is veri high .
now , due to the us of the log function , the inform of independ event taken as a singl event equal the sum of inform .
that's true , becaus if i look at the inform of two symbol , let's sai s1 , s2 , taken as a singl event , thi then , self inform of thi event s<num> , s2 equal <num> over the probabl of s1 , s2 .
and sinc the event ar independ , thi is equal to probabl of s1 time the probabl of s2 .
and well , thi is log of p s1 , p s2 equal minu log p s1 , but we call it p1 minu log p of <num> , therefor , equal the self inform of s1 plu the self inform of s2 .
in move awai from the inform convei by a sin , singl symbol and in character the whole dm sourc , which is complet character by the , by the , by it's alphabet and the associ symbol probabl , the entropi of a dm sourc is defin as the averag inform per symbol , as you can see here .
so , for the sourc s , we'll denot it entropi as h of s .
and then we us a definit of the expect valu , or the averag of self inform p of i , the self inform , or symbol si , and due to the definit of the self inform abov , thi is then the express for the entropi .
and the unit ar bit , sinc we have util the two as the base of the log .
we show here a plot of the entropi of a sourc that ha two symbol in it alphabet .
on is emit with the probabl p .
and clearli the other on is emit with the probabl <num> minu p .
so thi is the entropi of the discret memoryless sourc .
so again we show the plot of the entropi versu the valu of p .
we see that the entropi is posit , except at these locat where it's equal to zero .
and thi is the situat when on symbol ha probabl on and the other ha probabl zero .
and thi is a gener result that the entropi is zero , if and onli all the pi's , but on , ar equal to zero , .
and thi on is have a valu equal to <num> .
so thi is the case when we ar certain of the outcom , and that's the case when h vanish .
we also observ here that the maximum valu of the entropi is obtain for p equal <num> .
so , in other word , when the symbol have equal probabl .
and thi is a specif incarn of a more gener result .
if i have a sourc with n symbol , , then the entropi of thi sourc is maximum when the probabl of the symbol ar equal , and there for equal to on over n .
and in that case the maximum valu of the entropi is equal to log n .
thi is an import result to rememb .
we're go to us it in some of our argument to justifi some of the reprocess or some of the oper we ar go to do to imag and video so as to improv their code effici .
we describ here the sourc code problem , which is a problem of lossless compress .
we ar consid a sourc which gener symbol , s1 through sn .
we can assum that thi is a dm sourc , although the concept of code is not constrain by the model of the sourc .
so in thi case , the alphabet and the associ probabl defin the sourc .
we want to design a coder that will map the sourc symbol into binari codeword .
the codeword can have fix length , as shown here , in thi case all codeword have length four , or variabl length , as shown here .
so thi is a fix length .
and thi is variabl length code .
there is therefor , a length associ with each code word which we denot by l of i .
with thi setup , we can defin the expect valu or averag of the code word length , as shown here .
so the code problem is to design thi coder and find the code , the set of code word , so thi is for exampl code on , thi could be code two , so that the smallest possibl averag code word length is achiev .
regard an exampl of a fix code word length code .
we can proce to the sourc with alphabet the letter of the english languag consist of uppercas and lowercas letter and punctuat point .
the fix code word length code then can be the ascii represent of these letter .
so thi is how the letter ar repres into a comput .
so , for exampl , the ascii code for the letter a is shown here , while the ascii code for the uppercas a is shown here .
in design vlc code , the mors principl typic appli .
here we have mors principl .
i'm not sure if you know mors code .
i don't , but from what i've cover here is the mors code for the letter e , for the letter a , for the letter q .
so what is the mors principl ?
it state that frequent symbol should be assign short code word .
so that , when we form the product here , if the probabl of the symbol is high , then the length , the code word length , should be low , the product is kept low .
thi is clearli an intuit idea .
the discuss of code in the previou slide , we were refer to first order coder , in thi case .
each symbol is encod on at a time , independ from the rest of the symbol .
altern we can form block code .
in thi case , capit n symbol of the origin sourc ar combin togeth to gener a singl new symbol gener by thi now combin sourc , s of n .
sinc all capit n combin of the origin sourc symbol ar consid , the alphabet of thi new sourc s of n increas , and it's equal to n to the n .
it can be shown that in thi case the entropi of thi new , extend also thi is call sourc , is n time the entropi of origin sourc .
thi is actual a mechan to increas the effici of a code , as we'll discuss later and also demonstr through specif exampl .
final , you'll also have non block code .
and arithmet and lempel ziv code belong to thi class .
and will discuss briefli these code later in the class .
code and entropi of a sourc ar connect through the celebr sourc code theorem due to shannon and hi <num> semin work .
accord to thi theorem , given a sourc s with entropi h of s , we consid block code , that is , n origin symbol ar combin to form new symbol .
then , given a small posit delta , it's possibl to choos n larg enough , so as to construct code that will have averag code word length satisfi thi relationship down here .
thi express tell me two import thing .
the first on is that the entropi is the lower bound of the effici of the code .
no matter how invent we ar , we cannot beat entropi .
design a code or a lossless compress scheme that will have averag code word length or as call also rate , equal to the entropi is the holi grail and is the best we can do .
the second thing thi relationship is tell us is that we can keep increas the size of the block to have a code that perform veri close to entropi .
so when delta is veri small , then clearli the rai or the averag codeword length becom close to the entropi .
of cours , increas n come at the price , which is the increas in the dictionari size and also the loss of the instantan decod , as we'll discuss later .
by chang larger and larger block , in essenc we extract the structur in the data .
of cours , an import question is how accur of an estim of sourc entropi can we obtain ?
so let look at thi in the next slide .
hello , in thi segment we continu with the concept from inform theori we start with in the previou segment .
we see that it is not easi to measur the entropi or the uncertainti of a sourc .
there is typic structur or depend in the data , which mean that there is redund inform , which need to be acknowledg when measur the entropi of the sourc .
so if anyon just present to us and we ar ask to find it entropi , it's not a straightforward task .
we'll address thi issu with some simpl exampl in the segment .
we also look at desir properti of code , such as uniqu decod and the prefix properti .
we final look at the represent of code in term of binari tree , sinc these will becom handi in the next segment .
so , let's continu with the coverag of thi materi .
accord to the sourc code theorem , we cannot design a lossless compress scheme that will perform better than entropi , when we have a that is smaller than entropi .
the natur question , then , is , how well can we estim the entropi of a sourc .
given an imag for exampl , or a video segment , what can we sai about it entropi ?
the answer is that estim the entropi of a sourc is a veri difficult task .
shannon himself actual look into thi question in try to estim the entropi of the english languag in hi <num> semin paper and in other paper .
so if we assum a discret memoryless sourc model for the languag and we assum that all the letter ar equal repres , have equal probabl , then thi is the estim of the entropi we obtain .
it's actual about <num> . <num> , if we includ the space as the 27th letter .
we can do better than that .
we still us a dm model , but now we go and measur the probabl of appear of each individu letter .
and in thi case , the estim of the entropi becom smaller , <num> . <num> bit per letter .
we still know , howev , that thi is not a veri accur model , becaus there ar depend amongst letter .
there ar combin of letter that ar more probabl than other and combin that do not exist in the english languag .
so therefor , if on look at these depend by consid up to eight letter , then thi is the estim of the sourc , of the entropi of the sourc , that on can obtain .
so thi is the most accur or on of the most accur estim of the sourc of the english languag .
and therefor , thi is the number on should try to come close to in design effici code for encod the english languag .
in gener , the more we know about the structur of the data , the better our estim of the entropi is go to be .
we're go to demonstr thi with two simpl toi exampl .
so assum we have thi stream here of symbol .
so thi sourc ha six symbol in it's alphabet .
in thi stream we go and measur the appear of two and four .
so it's two out of ten .
therefor the probabl of two is <num> and so it is a probabl of four and so on and so forth .
we us the formula of the entropi for a dm sourc and we find that in thi particular case thi is the entropi .
we need <num> . <num> bit per symbol .
but the wai here , sinc thei have six symbol if i , if i were to us a fix code then i would need three bit per symbol becaus two to the third is eight .
so with three bit i can express eight differ codeword .
here i have onli six symbol but us a variabl length code , in principl , i could go closer to the entropi of <num> . <num> bit per symbol .
now , if we stare at thi particular stream here for , for a littl , we can possibl see some structur in it and to express the structur we propos a predict model .
so what thi tell me , so x of n first of all , the valu in thi stream at locat n .
so if thi n , then the on to the left is n minu <num> and so on .
so thi first order linear predict model tell us that i can find the valu of the signal at locat n by assum it's equal to the valu at the previou locat n minu <num> , plu the residu or the correct tell or the error .
so if we appli thi predict model to the data , then the residu you obtain is shown here .
so the residu consist onli of plu and minu <num> .
i measur the probabl of on , the probabl of minu <num> .
i util the dm formula for the entropi .
and we see that the entropi is <num> bit per symbol .
so it's more than three time lower the estim than the entropi we , we first obtain .
we're go to look at predictor of thi natur multipl time in thi segment of the cours .
we'll talk about compress .
and the idea here is that we build a predictor to predict , as here , the valu of x at locat n , and then all we have to encod is the unpredict part , which is the residu .
of cours , in decod it , i need to have the predictor model .
it's a static predictor , in thi particular case .
so given the predictor model of the residu i am abl to construct the origin sequenc .
a similar exampl is repres here .
so thi is now the gener messag , the stream of symbol .
i have here i see three differ symbol .
so i measur the probabl .
so the sourc gener onli symbol three , symbol four , and symbol five .
and i do see that i need <num> bit per symbol to repres thi , accord to the entropi .
now if we again stare at it for a second , we see that , in essenc , if i look at two symbol at a time , so it's like i'm extend the sourc , i now us a block code , you might sai , then i onli have the symbol <num> , and thi should be <num> here .
and , then in thi case sinc thei're equal probabl , the entropi's on bit per new symbol or therefor half a bit per origin symbol .
so again , we can , reduc the entropi estim consider by look into the structur of the data , exploit it , and capit on it .
let us look now into a simpl exampl of code .
in get a better understand of them and then also introduc and discuss some other properti of code .
we ar given thi toi sourc .
it emit on of four symbol and here ar the associ probabl of the symbol .
the sourc is model as a discreet memoryless sourc and therefor base on these probabl we can find the entropi of the sourc .
we substitut these valu into that express for the entropi , the minu sum , pi  log pi  .
and we can find that for thi particular sourc here is it entropi , <num> . <num> bit per symbol .
you ar given thi code , code <num> .
and we ar ask to figur out whether thi is a good code , a us code .
it take a quick second to look at it and realiz that if we ar given for exampl code word <num> .
it's not clear whether we should deciph it as symbol s1 or as symbol s2 .
so thi code is not uniqu decod or uniqu decipher .
we can find the averag codeword length for thi code or the rate for thi code .
it's <num> . <num> bit per symbol and sinc thi is smaller than the entropi , thi is alreadi a red flag that there's probabl someth wrong with thi code .
we ar also present with code <num> and we're ask the same question .
probabl take an addit second to also realiz that thi code is not uniqu decod .
if we ar given , for exampl , the sequenc of code word <num> , we could deciph them as s1 , s1 or we could deciph them as symbol s3 .
so thi code is not uniqu decod .
again , we look at the rate of the code is below entropi , the sourc code theorem is violat , it's not a us code .
we're given code <num> .
on of the observ about thi code is that thi is a prefix code .
the name might be a bit mislead .
it's actual a prefix free code , which mean no code word is a prefix of anoth code word .
as such , it's intuit clear that thi code is uniqu decod and more than that , the decod is instantan .
in other word , if we look at the bit stream , let's sai <num> , we start deciph it , so as long as , as soon as we see <num> , we know that thi should be code as <num> , becaus <num> exist .
is a code where there can find in code <num> .
then i see that <num> is a code that exist there , so thi is deciph as s2 .
<num> is deciph as three .
so thi is a prefix code and it's uniqu decod , ani prefix code .
and it's also an instantan .
we see actual that it rate , the averag code word length , is exactli entropi , so thi is an optim you might sai , code .
it achiev entropi .
we cannot do better than that .
we ar also given code <num> .
it take a bit more think now to see whether thi is uniqu decod or not .
actual , there is a specif algorithm test base on which you can test whether a given code is decod .
and thi is inde a uniqu decod code .
it's not a prefix code , becaus zero , for exampl , appear as a prefix to all other code word .
so not prefix .
and thi not instantan either , sinc it's not prefix .
so we see that uniqu decod and prefix code relationship goe on wai .
so prefix mean uniqu decod , but uniqu decod doe not mean that the code is a prefix code , as indic by code <num> .
we see that the rate of thi last code is a bit higher than entropi .
so if on were to choos on out of the four code , then code <num> would be the on of choic , becaus be a prefix and instantan is an advantag and also it rate is the lowest on among the four , although as we've alreadi discuss , these ar not us or accept code .
we can us binari tree to repres code .
thi help us to visual certain properti of the code , but also by transform thi tree , we can potenti obtain addit properti of the code .
so let's look at code <num> that we talk about in the previou slide .
we can repres it by thi binari tree .
so we start with a root node , thi on .
and then , arbitrarili , we assign , let's sai <num> or <num> to the left branch and the opposit to the right branch .
so here we assign <num> to the left branch and <num> to the right branch .
so clearli , to get to codeword s1 , i have on <num> , so s1 is repres by <num> .
s3 is repres by <num> .
and s4 is repres by <num> .
thi end node ar call leaf node .
and actual , the root is also a branch node , becaus the tree branch out at that particular locat .
so let's do the same thing for code <num> .
thi is the tree represent of code <num> .
so again <num> is assign to the left branch and <num> to the right branch .
so to obtain the code word for symbol s3 , we see that we have to go through a <num> here , a <num> here , and a <num> here .
so the code word for s3 is <num> .
now , an import observ here is that thi code <num> , if you rememb , it's a prefix code , which you can observ right awai by look at the <num> represent , in order to get to ani of the code word , we don't need to go through anoth code word , which wa the case for exampl with code <num> .
to get to s3 for exampl , we have to go through s1 .
so s1 is a prefix to s3 , but here thi is not the case .
so none of the code word is a prefix from anoth code word and therefor is a prefix code .
and equal importantli is that the leaf node here ar repres by symbol .
so the symbol , rather , ar repres by leaf node .
if we look at code <num> and it binari represent , it's clearli that it's not a prefix code .
to get to s1 , for exampl , is a prefix of s2 and s3 and s4 .
and therefor , the symbol ar not repres by the leaf node .
so , i put here also the variou term that i introduc .
so thi is an import point that we see here for prefix code and we'll see that when we talk pretti soon about the huffman code , that due to the construct i end up with a construct like thi .
in other word , the symbol ar repres by leaf node and therefor , we know that thi is a prefix prefix code .
we summar here some of the result and statement made about prefix and uniqu decod code in the last few slide for easi refer .
so , as mention , it's hard to tell if a code is uniqu decod .
howev , there is a systemat procedur , which , base on which on can determin in a finit number of step if , inde , the code is uniqu decod .
as mention , prefix code ar uniqu decod , but the convers is not true , prefix code ar instantan decod and prefix code ar by and larg easi to design and easi to decod .
now , the good new is that for ani uniqu decod code that is not prefix , we can find a prefix with the same rate .
the most celebr variabl length code wa deriv in <num> by david huffman , and it carri hi name .
it provid a straightforward methodolog base on the mors principl for design a prefix and therefor , a uniqu decod code .
in thi segment , we show the methodolog for design first order , as well as block huffman code .
in the latter case , group of symbol ar combin , to form a new symbol , gener by the so call extend sourc , with an increas alphabet size .
thi extens of the sourc can provid dramat improv in code effici in some case .
while in some other case , such as sourc with few symbol and skew probabl of symbol , the improv is not immedi .
that is , we need block code of larg size .
these ar some of the shortcom of huffman encod which ar address by arithmet code to be discuss later .
so let us now look into the fine detail of thi import materi .
the most celebr and wide us prefix code is due to david huffman .
it carri hi name and wa deriv in <num> .
it's quit straightforward to explain , understand , and util the code as we'll see right awai .
so the guid principl of the code is that symbol that occur more often will have shorter code word .
if you recal , thi is exactli what we call the mors principl earlier in the class .
and the second guid rule is the two symbol that occur least frequent will have the same length .
and thi is someth that will jump out right awai as soon as we explain the procedur of the code .
so the procedur step ar as follow .
we sort the symbol accord to their probabl , then we take the least probabl symbol .
we combin them to form a composit symbol , which is go to have probabl of the sum of the respect symbol probabl .
so with thi step , we'll reduc the size of the alphabet by on .
so , we repeat these two step for the remain symbol .
clearli if the size of alphabet is n , we're go to have n minu <num> step or stage of the procedur .
well , each stage involv these two step .
and final , after we combin the last two symbol , we're go to see the binari structur of the tree .
and assign zero and on to the left and right branch as we did earlier , the code is go to jump out .
so let's look at a coupl of exampl where we'll appli thi procedur and see that inde it's quit straightforward to produc a huffman code .
so here's a symbol sourc .
if that meet five symbol with the associ probabl .
so we want to build a huffman code to repres the symbol of the sourc .
accord to the procedur we just describ , i'll have to look at the probabl of the symbol .
and consid the symbol with the smallest probabl .
so the symbol with the smallest probabl ar s4 and s5 .
i'm go to combin the two to form a new symbol here that is go to be the , let's s4 , s5 symbol .
and thi go to have probabl <num> , the sum of the probabl .
so after stage on , i'm left now with four symbol s1 , s2 , s3 and s4 , s5 .
so i look at the probabl now and i want to combin the two symbol with the smallest probabl .
there ar three symbol with probabl <num> so i have to make a choic .
so let's assum i choos to combin thi symbol , with thi symbol here .
so the symbol s3 , s4 , s5 is form , and the probabl of thi symbol is <num> .
so i'm left with three symbol , s1 , s2 , and thi composit on .
i combin the two with the smallest probabl ar clearli the on with probabl <num> and on of the two that ha probabl <num> .
so let's assum i combin these two , so a new symbol here s1 , s2 is form .
and the probabl of the new symbol is <num> .
so , i'm just left with two symbol , i combin them .
and the overal composit symbol ha probabl on .
okai , so we see that follow thi process , i have here a binari tree .
so thi binari tree repres the code we've obtain .
thi is the root of the tree here .
and arbitrarili , let's assign on to the left branch of the tree and zero to the right branch of the tree .
so , there's go to be and on here and a zero here , and on here and a zero here , and on here and a zero here .
so , look for the code word of symbol s1 , i start at the root and try to reach s1 .
so , i go through n1 and the second on .
so , the code word for symbol s1 is on on .
the code word for s2 , i start at the root so i have an on follow by a zero .
the code word for s3 is , i start at the root so i go through a zero and then a on .
s4 is zero , zero , on .
and final s5 is zero , zero , zero .
so thi is the huffman code for thi particular sourc .
it's clear that it is a prefix code , becaus the code word ar the leav of the tree .
so , i don't need to go through on code word to reach anoth code word due to the construct , it's a prefix code construct and therefor , thi is a uniqu decod abl code .
we see that due to the specif construct , that two symbol that have the smallest probabl ar go to have code word with the same length .
also clearli due to the construct , the most frequent encount symbol , the on with the highest probabl ar the on that will be combin last .
therefor thei'll be closer to the root of the tree , and therefor thei're go to have shorter code word than , the on that have smaller probabl and , and thei were combin first .
natur interest import question is whether the huffman code is uniqu .
if we think for a second the answer is no , for a number of reason .
on of the reason is that at variou stage we had to make choic .
like we want to combin the two symbol with the smallest probabl , but we had three symbol with the same smallest probabl .
so right there we had to make a choic which of the two ar go to combin first , and becaus of the choic had we taken the other path we would have end up with a differ huffman code .
also when i assign zero and on to the binari tree arbitrarili i assign on to the left branch of the tree and zero to the right branch of the tree .
so if i revers the assign , so if instead of on there is the huffman code you replac the on by zero and the zero by on .
we're go to have thi complimentari code , which is also a valid huffman code .
so , becaus of these reason , the huffman code is not uniqu .
howev , in all case it's a prefix code and therefor uniqu decod abl , and in all case the averag code word length is exactli the same .
if you do the calcul you can find the the entropi of thi sourc is approxim <num> . <num> bit per symbol .
while the averag code word length of the result huffman code is about <num> bit per symbol .
so the huffman code is veri , veri close to the entropi , therefor it's a , it's a veri effici code .
we show here and discuss some properti of the huffman code without proof .
the first on is shown here .
i've been us rate , r , and averag code word length in distinguish .
thei mean exactli the same thing .
so accord to thi express , it's a , reiter of the sourc code theorem .
the rate is bound from below from the entropi and evolv from entropi plu <num> .
thi is actual an express i typic work out and show when i teach the , a graduat cours on the topic .
if now the maximum probabl of a symbol is less than a half , then the upper bound is becom tighter .
so instead of on there we have the pmax which in thi case is less than a half .
so it's a tighter bound , upper bound of under eight .
if on the other hand the maximum probabl of the symbol is greater than a half , then thi how the upper bound chang .
the best possibl result is achiev when the probabl ar power of on half .
in such case , the rate becom exactli equal to the entropi of the sourc .
now look at these express here , it's clear that if the alphabet size is larg then in gener pmax is small .
so the upper bound is tight and therefor huffman code perform quit well .
if , on the other hand , the alphabet size is small , and there's then a good chanc in that case that pmax is larg , the huffman code can be quit ineffici , so the upper bound is not as tight anymor , and that's the result .
let's look here at some of the properti of the huffman code when block code is us .
we mention block code earlier , so what happen in thi case , i consid n symbol of the origin sourc togeth to form an extend symbol .
and thi extend symbol is emit by thi extend sourc sn .
the sourc is call extend sinc it's alphabet increas in size from littl n to n to the nth power .
as alreadi mention the entropi of thi extend sourc is n time the entropi of the origin sourc .
so base on thi when i consid the extend sourc we know that thi express hold true , that i mention a slide ago .
so the rate of the extend sourc is between the entropi of the extend sourc and , entropi plu <num> as an upper bound .
now if i consid here a block that ha n origin symbol , and each symbol is repres by r , that's the rate per origin symbol .
then , sinc there ar n symbol here , altogeth r of n is equal to n time r .
so if in thi express i substitut r of n in here , and substitut h of s of n here and here , then i obtain thi express .
so if i divid now everyth by n , i end up with thi express for the rate of the sourc , the origin sourc that is , it's bound below by it's entropi as alwai , but abov it's entropi plu <num> over n .
so clearli as n increas , <num> over n vanish .
and therefor , us thi method of the extend , extend sourc kind of guarante that i will obtain a huffman code that will achiev entropi .
as everi thing in life and in engin , there ar tradeoff .
and what ar the tradeoff .
when we do thi , is that clearli the size of the alphabet here increas .
so , for exampl , if i start with thi tini sourc that onli ha three symbol .
but consid block of size eight , then we have <num> to the eighth or <num> , <num> codeword .
so becaus of that , i have an increas in storag becaus we have to , to store thi code book when we do the code .
in comput becaus i have to search now not just over three entri of the code book , but <num> , <num> entri .
and there's a delai also becaus i decod eight in thi particular exampl , n in gener symbol at the time instead on symbol at a time .
so let's see some exampl of what is achiev when the sourc is extend , and case for which the extens kind of work with small number n , capit n , and case for which it doe not work right awai .
let us look at the first exampl here of the effect of extend the sourc on the huffman code .
here is the exampl we'll work with , it's a sourc that emit three symbol .
here ar the associ probabl .
base on thi inform , we can follow the procedur we just describ and design thi huffman code .
us thi inform about the sourc , we can comput it entropi , as well as we can comput the averag code word length of the huffman code .
a quantiti that is typic us , is the redund of the code , in other word , how far awai is the averag code word length of the code awai from the entropi ?
so for thi particular exampl , subtract thi from thi , we see that thi is the redund .
and it's typic kind of normal by refer to the percentag of thi redund with respect to entropi .
so the redund is <num> of the entropi for thi particular exampl .
so thi is not a veri effici code .
and we'd like to extend the sourc and then redesign the huffman code .
so for thi particular exampl clearli n equal <num> .
we want to just extend it by us two symbol at a time .
and therefor the new alphabet is go to have <num> to the 2nd <num> symbol .
and these ar the symbol we obtain by all possibl combin of the three symbol of the , origin sourc .
so here is , the alphabet of the extend sourc , and here ar the associ probabl .
so , to form these probabl i multipli the probabl of the symbol .
so s1s1 is <num> time <num> , <num> . <num> .
s1s2 is <num> time <num> . <num> which is equal to thi and so on .
so have thi extend sourc .
we follow again the procedur and we , of the huffman code , and here is the result in huffman code .
so , if we comput now the same statist , for thi extend sourc , we see that the averag length of the code of thi code for the extend sourc is thi .
so mani bit per new symbol .
and sinc the new symbol ha two origin symbol .
i divid thi by two .
so the averag code word length of thi code , base on the extend sourc , equal thi .
bit per origin symbol .
so now if we compar thi to the entropi of the sourc , we see that we ar onli so mani bit awai per symbol from the entropi , or just <num> of the entropi .
so thi is a case that work by just consid just two symbol .
togeth , we see that we can bring the redund from <num> of the entropi , down to <num> of the entropi .
and now thi is an , effici code , there's no need to further extend the sourc .
here's a second exampl of an extend sourc .
of cours i'm give the stori awai with the titl , thi is a case that is not go to work veri well .
so again , here is the sourc we'll work with .
item is three symbol , here ar the probabl and here's the huffman code that we design base on these statist .
the differ between actual thi sourc and the on we us in the previou slide is that the probabl of s2 stai the same , but the probabl of s3 , with respect again to the previou case wa reduc consider , by <num> . <num> , so <num> . <num> wa ad to the probabl of the first symbol .
so therefor thi is a , a sourc with a skew probabl of it symbol .
so on symbol ha a veri high probabl and the other a veri small on .
so if you recal from a coupl of slide ago , thi is a case that for which you were argu that huffman can be an ineffici code .
it's the case of a small alphabet thi of cours the toi exampl is that if it's small and pmax greater than half .
so , if you recal in that case of pmax greater , equal than <num> the averag code word length of the rate , i us thi to .
indistinguish is between it's , i'm sorri , less than entropi plu pmax plu <num> . <num> .
so with pmax <num> . <num> thi here is greater than on so the upper bound becom a rather loos on .
and there's , you know , a lot of room for improv .
so for thi particular sourc and thi particular code , if we pull out the statist , we see that thi is the valu of the entropi .
thi is the valu for the averag code word length and therefor thi is the redund .
and percentag wise , we ar <num> awai from entropi .
so thi is a veri ineffici code and we would like to improv it perform by extend , extend the sourc .
so if we do exactli the same thing as in the previou exampl , and we consid n equal <num> .
then , here is the alphabet of the new sourc , the associ probabl , and here is the result huffman code .
if we , perform the statist again , thi is the averag code word length of the extend sourc , so , so mani bit per new symbol .
i divid by two , so the rate is so mani bit per origin symbol .
and the redund ha drop , but ha drop onli to <num> of entropi .
so again we went from <num> to <num> , so there's definit a benefit in extend the sourc , but <num> make it still a veri ineffici code .
and for thi particular exampl , you start get , you end up get to an accept level of redund by consid n equal <num> and as alreadi mention for thi particular exampl , the size of the alphabet is quit huge in thi particular case .
in thi segment we cover on of the earliest applic of huffman encod .
which is the transit of scan print materi over telephon line which is refer to as facsimil or fax applic .
the print text to be submit is scan and convert into a binari imag .
sinc these 0s and 1s repres the text ar not randomli scatter over the imag .
but instead , we have structur .
thi structur is exploit .
the structur result in a number of consecut 0s or 1s in a row , so call run , to be encod instead of the individu 0s and 1s .
thi result in the so call run length encod .
it is a demonstr of a theme that will appear in variou form over these three week we cover compress .
some of the ingenu in an exist algorithm standard .
come from thi reinvent of the symbol of the sourc .
the symbol do not have to be the origin pixel valu .
but innov combin of them .
as in round through or in triplet , which combin variou properti of the imag , as we'll see next week .
a lot of compress power come from thi .
so let us proce with the materi for the assign .
facsimil encod can be appli directli to the lossless compress of imag .
for an eight bit per pixel imag , for exampl , .
the sourc alphabet contain <num> symbol from <num> to <num> intens of an imag .
in thi case , compress ratio between on and two ar achiev .
it can also be appli to the compress of text , although we'll talk about dictionari techniqu which ar more suitabl for that purpos .
on of the earliest applic of lossless compress ha been the compress of facsimil or fax .
in fax transmiss a page is scan and convert into a binari imag .
a sequenc of black or white pixel .
then , thi imag is compress , is sent over the network .
and , at the destin , is decompress and print , typic .
the requir of how fast an a4 document must be transmit , have chang over the last two decad .
dimens of the a4 document .
and here is some of the recommend of the pixel and line resolut .
there's then the bodi ccitt .
the current name is actual itu t .
ha issu a number of recommend base on the speed requir at ani given time .
the ccitt classifi the apparatu for fax transmiss into four group , g1 to g4 .
so we're go to look at some of the techniqu that ar us to encod thi binari imag that result dure fax encod .
we mention here some of the characterist of group three and group four fax standard .
thei were establish for the compress of text document and therefor either tabl , and chart , and half tone imag involv .
and thei don't work as well .
g3 is for the digit oper with analog modem .
and the veri import concept here , that of run length code is us , both in on dimens and two dimens .
so we'll spend a few minut after that discuss run , length and code .
then , base on these run length , of 0s and 1s static huffman tabl ar util .
when 2d run length is us then , in addit to the current line , the previou line is consid .
and in g3 , we have a combin of 1d and 2d run length code to prevent error propag .
g4 is an all digit for digit network such as isdn and in thi case onli a two dimension run length is util .
so , we will look into run length and then show some static huffman tabl that ar util in these fax standard .
run length code is anoth straightforward concept .
if we look at the binari imag which result from thi scan over text document .
then what we see is sequenc or run of white and black pixel .
so when a black symbol of , of text is scan , then it gener a run of 0s .
so it scale z a round of three 0s , and when the white background , the white page scan , then we see round of white pixel .
and here we see a round of nine white pixel .
so the veri basic idea is that instead of encod 0s and 1s , black and white pixel directli .
instead we code the run , how mani black pixel i have in a row , how mani white pixel do we have in a row .
so thi becom now the symbol of the sourc .
and thi is a concept we'll be encount over , and over again .
when we talk here about compress .
so , we don't have to stick to a sourc that gener <num> and 1s , but now we have thi new sourc that emit run of 0s and run of 1s .
a two state markov model , shown here .
give rise to run length code .
the state sw and sb correspond to , like sw for exampl correspond to the case where the pixel that ha just been encod is a white pixel , and similarli for sb .
the transit probabl and the probabl of be in it state , complet specifi thi model .
so , for fax imag , these probabl ar not uniform , but thei're instead skew .
which mean that , onc a pixel take a particular color , black or white .
then it's highli like that the follow pixel will also be of the same color .
so therefor , instead of encod each color separ , we encod the run .
we can actual comput the entropi of thi two state markov model as the probabl of be in state y time the entropi of the y state , plu s b , hsb .
so know the transit , transit probabl , again thi is a transit probabl .
probabl of go to the black state or have a black pixel given that the previou pixel wa wide .
and thi is the probabl of , the .
current pixel be wide , given the previou on wa wide .
stai in the , in the same state .
as we discuss , in encod a scan document .
it make a lot of sens not to encod the 0s and 1s .
directli the black and white pixel directli , but instead to encod the strand .
how mani black pixel in a row and white pixel in a row we have .
so now we can build huffman code for the run of 0s and run of 1s .
these ar on dimension the sens of you're look at on scan line at a time without consid the correl with neighbor line .
in order build the huffman code , we need to estim the probabl of run of white pixel and run of black pixel .
so base on a larg volum of document , on can go and comput such probabl .
and then , follow the procedur step that we describ earlier we can build two huffman code .
on for the run of 0s and on for the run of 1s .
now thi is not exactli what is happen within fax standard , but instead the modifi huffman code is util .
the modif come from the fact that we want to constrain the number of possibl length .
for an a4 document the largest trunk can be <num> pixel .
therefor , we need to build two huffman code each of which would have a size of the alphabet equal <num> , <num> .
so these ar huge code , huge tabl .
so to address thi , issu .
the length is comput modular <num> , so rl is the the run length of zero or on , black or white pixel .
and it's here decompos that a multipl of <num> plu t .
and here is the rang of valu for t , and the rang valu of m .
so , with thi modulo <num> <num> composit , we build on huffman tabl for m and these ar call the make up code .
and on huffman tabl for t , and these ar call the termin code .
so we have two code per color , therefor four such code in total .
as i alreadi mention for an a4 size document thi is the maximum length of , of pixel or of a run .
but if we want to deal with wider document then the standard provid option code to be abl to do so .
so here ar the huffman code us by both g3 and g4 standard .
i'm not sure if you ar abl to read the letter and number clearli , thei ar rather small .
these code ar present in ani fax machin that is compliant with the standard .
clearli the code ar both need for both encod and decod a scan document .
record encod of the run length is done modular <num> , so r l equal <num> time m plu t .
so here ar the termin code .
thei encod t and thi is for the white run length and here is for the black run length .
as on would expect , the probabl of the variou run differ .
so run of two and three black pixel here occur frequent , right ?
the smaller the code word , the higher the probabl of the symbol .
similarli , the run here of two to seven white pixel ar frequent encount .
thei have small codeword .
here you see the makeup code .
so thi code in code that multipl of <num> .
actual i joke sometim when i teach thi class here .
and tell the student that thei have to memor these code in order to be abl to find out the grade in the class .
we see here that we have run of <num> white pixel and run of <num> black pixel .
and the question is , why do we need to indic <num> run ?
on reason for the <num> white run .
is that the first run in the line is alwai a white run .
so if the first pixel in the line is a black pixel , then we have first to encod a <num> white run and then the run of the black pixel .
also , after a make up code is us , we expect , to receiv a termin code .
so if we have run that is exactli in the integ multipl of <num> , then t is equal , t equal <num> and therefor we need a code word for that .
we also notic that there is an end of line .
code here for both the white run and the black run .
and thi is need to synchron the oper of the decod with that encod .
so here we have a run of <num> there for m equal <num> , the first line .
then , in thi particular tabl we go to m equal <num> .
so <num> time <num> equal <num> , shown here .
and <num> core respons to <num> so m equal <num> here .
so let's sai now we want to encod a run length of , let's sai , <num> white pixel .
then , sinc <num> is less than <num> .
we're look at the termin code here .
so .
<num> white pixel correspond here .
so thi is the codeword for thi particular symbol , the run of <num> white pixel .
if there's anoth exampl , we have a run length of let's sai , <num> black pixel .
thi is greater than <num> .
and <num> is equal to <num> time <num> plu <num> .
so <num> time <num> , thi is <num> .
so i go to the make up code and thi is the black run length , so <num> .
so the codeword is thi long on .
i could have chosen a simpler on , i guess .
on , two , three , four , <num> , <num> , <num> , two , three and then here's kind of the residu so i need to termin code .
so thi is we go now to the other tabl so thi is the code for <num> .
a run of <num> black pixel .
so to thi we add that code which is <num> .
so thi is the code that is us for <num> , for a run of <num> black pixel .
in two dimension code , instead of report their run length .
which , in term of our markov model , is the length of the time we remain in on state .
we report , instead , the transit time , when we move from on state to anoth state .
so if we look at thi figur , we can encod it in two wai .
the on , the on we just describ in previou slide .
so if we encod the first stroke , then if you recal we assum that the first pixel white so there's <num> run of white pixel .
then a run of two of black pixel .
a run of three , a run of tnree .
and then on of eight .
similarli , for the second row , , util the wai of the previou , is , again , a , <num> run of white pixel .
a run of on black pixel .
a run of eight , a run of three , a run of four .
altern , we can encod the posit .
when a transit take place , either from a white to a black pixel or from a black to a white pixel .
the first pixel , it's an imaginari white pixel to the left of the first pixel , so there's a white pixel here .
therefor , the locat of the transit actual is indic by thi dot .
so for the first row , there's a transit here .
the first peak of occas .
the second transit is here .
the third pixel locat , the six , nine pixel locat and the nine pixel locat .
similar for the first row .
we go from white to black in the first pixel locat .
again , a transit at two , a transit at ten over here .
and a transit at <num> .
now , sinc the row ar correl , it would be easier to encod these transit point in refer to the previou line .
or it distanc from the previou transit point .
instead of in term of it absolut locat , thi locat , as we just did .
and thi exactli the idea behind thi scheme .
thi so call read scheme , rel , element , address , design .
and , actual within the standard is a modif of these , so it's refer to as modifi read .
as , i alreadi mention , read exploit the correl of imag row .
and then , it code thi transit point in refer to either the previou line .
or the distanc from the previou point in the same line .
arithmet code is discuss in thi segment , which address some of the shortcom of huffman code .
accord to it , a uniqu identifi or a tag is gener for a particular sequenc of symbol .
without the need to gener all possibl code word for sequenc of the same length .
as were the case for huffman code .
we show how thi stack is gener , by map it symbol to the real line segment form <num> to <num> .
and , keep zoom in to the segment as more and more symbol ar observ .
arithmet code is also suitabl for deal with short dictionari , as is the case with binari fax imag .
and also for take context into account , therefor local chang the probabl of the symbol .
becaus of thi , if the code chosen by the join bilevel process group , jbig , a group of expert that establish the standard for bilevel imag .
the basic principl of jbig ar also describ in thi segment .
so let us now have a closer look at thi materi .
we saw that it is more effici to gener code word for group or sequenc of symbol .
instead of gener code word for individu symbol .
and we call thi , block code .
in term of huffman block code though , we saw that .
if we want to encod a particular sequenc of length m then we have to find the code word for all possibl sequenc of the same length .
and thi clearli ha a major disadvantag that the size of the alphabet grow tremend .
so if i have an alphabet of size n , and extend the sourc by m , then the new alphabet of the extend sourc is size n to the m .
we would like , clearli , to address thi and the wai to address it is through arithmet code .
so with arithmet code , we can assign a code word to a particular sequenc without have to gener code for all sequenc of the same length .
the wai it's done is by find a uniqu identifi or tag .
for thi particular sequenc we want to encod .
and thi tag correspons to a binari fraction , which becom the binari code for the sequenc .
so , we would like to separ the gener of the tag , and the gener of the binari code .
we'll just discuss , at some high level , how the tag is gener .
but we will not get into ani of the detail of how the code is gener .
it's a rather complic matter .
on possibl set of tag for repres sequenc of symbol ar the number in the interv <num> to <num> .
becaus there ar infinit mani real number in thi interv it should be possibl to assign a tag to ani sequenc where in thi interv .
in order to do so , we need the function that will map sequenc of symbol into the unit interv .
such a function is the cumul distribut function .
so we ar given enough of it here with littl m symbol .
and here ar the associ probabl .
we know that a random variabl map the outcom of an experi to the realign .
so we'll us thi random variabl here , x , that will map the outcom of the experi , the element of the alphabet here , the symbol .
into the index of the symbol i .
so now given the probabl of the sourc , we ar given the probabl function of thi random variabl .
so the probabl that the random variabl is equal to i is simpli the probabl of the symbol a i .
and of cours we can have the cumul distribut function f of x of y , the sum k on to i of thi probabl that the random variabl is equal to k .
with thi assign , the main idea behind the tag gener is to reduc the size of the interv in which the tag resid .
as more and more element of the sequenc ar receiv .
so we partit the unit interv into sub interv of thi form .
so thi is the line from <num> to <num> .
and symbol a of <num> .
resid in thi interv from the cumul at <num> , and the cumul at <num> , and more specif a y , a of i belong to thi interv so it's close at the lower side and it's open at the upper side .
so the appear of the first symbol in the sequenc restrict the interv contain the tag to on of the sub interv .
so let's assum that the first symbol is a2 .
then the tag will be in thi interv here .
and thi sub interv is partit in exactli the same proport as the origin interv .
so each succeed symbol caus the tag to be further restrict to a sub interv , that is further partit in the same wai .
so let's look at an exampl where hopefulli thi idea will becom even more clearer .
let us now look at the simpl exampl of a tag gener .
we're given a sourc with thi alphabet , and here ar the associ probabl of the symbol , base on what i just discuss in the previou slide .
through the assign of a random variabl , we can find the cumul distribut function of that random variabl .
and we have got f of x1 equal pa1 .
f of x2 equal pa1 plu pa2 , equal <num> .
and f of x <num> equal <num> .
so with thi valu of the cumul distribut function , we take now the segment between <num> and <num> .
and divid it , here is f of x <num> , here is f of x <num> , f of x <num> .
and therefor x3 .
so a1 resid in thi interv , a2 in thi interv , and a3 in thi interv .
let us assum that the first symbol we observ is a1 .
thi mean that ani number in thi interv between <num> and <num> can serv as the tag to uniqu identifi a1 .
i take the <num> to <num> sub interv , and sub divid it proportion to the origin probabl , so seventi percent of eight is occupi by a1 .
<num> by a2 and <num> by a3 .
if the second symbol we observ is a2 then the tag resid in thi interv .
i take the interv sub divid proport to the origin probabl , if the third symbol i observ is <num> , then the tag resid in thi interv .
i can further sub divid thi , and so on and so forth .
so if the sequenc we observ and we want to encod is a1 a2 a3 , then ani real number in the interv <num> to <num> can serv as the tag , to uniqu identifi thi particular sequenc .
it is clear that i'm look for an identifi .
just for thi particular sequenc and not for ani three symbol element as were the case with huffman encod .
typic , the middl point of thi interv is chosen as the tag .
and also there ar recurs wai to evalu the comput tag , as well as to comput the , the bound of each of the sub interv , each time i take a sub interv and further subdivid it and so on and so forth .
so , thi is the basic idea of how a tag is gener .
let us see with a simpl exampl how to deciph the tag and find out what is the sequenc that wa encod .
so we can see again the same sourc as shown here .
and we're given that the tag is equal to <num> . <num> .
so we want to find again what is the code sequenc .
we have , of cours , in addit to the tag the number of symbol in the sequenc , and we're given that there ar three symbol that were encod .
the main idea in deciph the tag is to mimic the encod so that we decod .
the , the , the tag , deciph the tag .
so , we take thi inform about the sourc , we take the segment between <num> and <num> and subdivid it proportion as we did befor .
now , clearli the tag resid in thi interv .
if you recal the step we follow while encod , the first observ symbol set the stage , in some sens , to where the tag is go to belong .
in other word , the tag cannot belong to a segment outsid the initi segment becaus in each step we ar subdivid the initi segment .
so the five that the tag , for thi particular exampl , belong to thi interv mean that the first symbol that wa encod is the symbol of a1 .
so , we mimic the encod .
take thi interv , subdivid it proportion .
and now we observ that the tag resid in thi interv .
therefor the second sequel that wa encod wa a2 .
limit the encod , subdivid thi .
we see that the tag belong to thi interv , and therefor the first symbol that wa encod , and we're decod it now , is a three .
so in summari and conclus the code sequenc a1 , a2 , a3 .
we like to briefli compar the perform of automat code and huffman .
as we alreadi saw , thi is the relationship the huffman rate satisfi as a function of the encod block size capit n .
the , relat relationship for arithmet code is given here .
by compar these two express , it seem that ac doe not have that good of effici .
as huffman code , sinc <num> over n here goe to <num> slower than <num> over n .
howev , as we discuss , huffman code suffer from the explos of the size of the dictionari , and in practic it is arithmet code that achiev rate close to entropi .
of cours we did not discuss how the tag is encod .
it should be clear that as the size of the messag n increas , the precis of the tag increas .
we need to repres the real number with a lot of decim point .
scale and increment code ar us to address thi issu .
if the tag is in the <num> to <num> interv , for exampl .
it's clear that it's restrict to stai there , therefor the <num> to <num> rang can be scale back to zero to on rang .
by do so , we lose the most signific bit , which howev wa alreadi sent to the decod by signal which half of the line we ar us .
and thi is call increment code .
i'm go to demonstr with a simpl exampl , the benefit of take the context of a symbol be encod into account when encod an imag .
and then us multipl code , there's each of them adapt to the statist of thi context .
the word , context , and content ar both us in imag and video process , but at time thei're confus .
by what i'm describ here , the content of an imag is taken into account .
but we ar adapt the code then to the context of the pixel or the symbol in gener be process .
so it's also content adapt the process i'll describ next , but to be more precis we ar look again at the context of the pixel be encod .
thi actual will becom much clearer in the next few slide .
we will also talk later in the cours about other exampl of content adapt process .
so we ar look at a document which ha these probabl of black and white pixel .
the white pixel domin , which typic is the case with a lot of document .
we know how to find the entropi of thi sourc .
and it's equal to thi , so , so mani bit per pixel .
so base on what we've learn , if the model here that wa us to find the entropi of a discret memoryless sourc is accur in describ thi document , then we know that we cannot find a coder than can have a perform below entropi .
now , we divid the document into two region .
region on is the larger on , it includ <num> of the pixel .
and region two includ the remain of the pixel .
region on is domin by white pixel , <num> of them ar white .
so if we find the entropi for region on is equal to the number shown here .
region two is domin by black pixel , and the correspond entropi is shown here .
now , the total entropi of the sourc is the weight sum of the two entropi of the region where the weight ar proport to the number of pixel in each region .
so in other word , the total entropi is <num> h1 , <num> h2 .
and thi is the result number .
so what we see , is that , by divid the document of two region .
the entropi ha been reduc almost a half of the origin entropi .
and therefor , the us of multipl coder , which adapt to the context of the symbol be encod is benefici and thi same idea ha been us extens , of cours in a more refin form that i will explain later when arithmet coder ar us .
i should mention here that that thi is the case .
of a small alphabet , of a sourc with a small alphabet , and skew probabl of symbol .
so we know that for thi case , huffman code ha low or problemat perform , while a sourc like thi is veri suitabl for arithmet code .
a case where context adapt arithmet code is us in the jbig standard .
jbig actual stand for joint bi level imag process group .
so thi is a group of expert that establish the standard for the progress transmiss of bi level imag .
jbig is therefor a combin of a progress transmiss and a lost list code algorithm .
medicod again is us for the lossless code part , and medicod is suitabl , for the us of multipl coder sinc thei all us the same , machineri .
thei simpli us a differ set of probabl .
so , jbig encod the pattern of big cell in the neighborhood of a big cell be encod .
that's the context .
to decid which set of probabl to us in encod a particular pixel .
so it us these two neighborhood .
each of these neighborhood ha ten pixel , so i'm interest in encod the pixel at locat x .
and i look at these ten neighbor .
here thei extend over three line .
or i us thi pattern .
so for encod thi , i look at these ten neighbor that extend onli over two line .
sinc there ar ten neighbor , there ar <num> to the <num> , or <num> , <num> differ contact .
or differ coder .
actual jbig is us as mani as <num> differ coder , when we deal with a , a high resolut imag .
a here , is a float member of the neighborhood and it can be place anywher in the imag to possibl uncov specif structur in a .
we also notic that the shape of the neighborhood allow the recurs comput , comput .
but as the neighborhood includ previous encod pixel , and therefor these pixel ar avail to both encod and decod , so that thei can synchron their oper .
so if we look at the particular exampl of thi first neighborhood , so we want to encod <num> , and we look again at these ten neighbor .
we see that , in thi particular exampl there , <num> of the pixel ar black , the <num>'s , and <num> of the pixel ar white , correspond to on .
so in arithmet code , that work with thi probabl of symbol is go to be util in a code the valu of the <num> .
similarli if thi were the situat of the neighborhood , so in encod the valu of on here , thi particular case <num> of the pixel ar black .
and <num> white .
so i've made a code there us thi probabl will be utilis in the code of thi particular pixel bite .
the idea behind progress transmiss is to present an imag at variou resolut .
so at low resolut the first valu of the imag is transmit to the destin .
if the recipi is interest in thi imag , might request a high resolut version of the same imag to be transmit .
it's same idea of the thumbnail we see on the web .
it's a tini imag .
if interest , we click on it and we see a higher version of the same imag .
now , on of the challeng when we deal with binari imag , is how to down sampl them .
jbig allow a <num> by <num> factor down sampl .
so , if we have four pixel here , we want to replac them by on pixel .
so if i take the averag of these four , the averag is clearli <num> 4th .
so on might think , okai .
we could compar thi to a half .
sinc thi is less than a half , then thi should be replac by a <num> .
but clearli , we have difficulti when we have thi situat .
becaus the averag of the pixel is half .
and therefor it's not clear how to resolv the situat .
if the down sampl version of thi <num> by <num> neighborhood should be a <num> or a <num> .
to address thi jbig is consid a scheme as shown here .
so the , we're interest in find the low resolut valu of x .
and instead of us just the four , enabl at the high resolut , right ?
we want to find how to replac thi for valu higher resolut by on valu .
we ar also util addit valu at higher resolut , these ar the small case letter , as well as the all readi previous comput .
valu of the low resolut will match the capit letter .
then the standard propos the evalu of thi formula here , where again all these label pixel at low and high re ar taken into account .
and if the valu of thi express is greater than <num> x is equal to <num> ; otherwis x is equal to <num> .
i guess it's alwai a question , where did thi express come from and veri often in standard .
there's a lot of think and experiment that take place befor someth is standard .
so , thi at the end , if on stare at it and tri to reason make sens and thi is how it's implement in the standard .
in progress transmiss , the decod ha alreadi receiv the low resolut imag , and of cours thi imag is avail at the encod , and therefor the low re valu can be us as context when we perform arithmet encod of the high re imag .
the advantag now is that the receiv low resolut valu ar in the past with respect to time .
but includ inform about the pixel that is be encod as well as futur volum with respect to space of the hight of the imag .
therefor , the context can be more inform in thi game .
here ar the four context templat that ar util by jbig .
x , again in red , is the pixel valu be encod .
we see that past valu of the high re imag ar us .
and these big o's ar the role resolut pixel valu .
and valu a again is thi float locat of the big so you see for a exampl that in comput thi o valu of the load as the valu we tri to encod of the high re wa taken into account , as well as futur valu , and thi is the case for all these four low resolut pixel .
so , in thi templat it's thi low resolut valu that ha includ the valu that we try to encod in the high resolut imag .
sinc we have to includ <num> bit to indic which of the four context templat we ar us , we have therefor us <num> bit and there ar four that ar <num> to the <num> , <num> , <num> differ context .
welcom back .
in mani applic , such as the encod of text , the output of the sourc consist of get pattern .
in such a case , a veri reason approach is to encod such sourc by creat a list or a dictionari of the frequent recur pattern .
then the pattern ar encod by their address in the dictionari .
so thi wai the input is split into two class .
the frequent occur and the infrequ occur pattern .
the former ar encod by the dictionari , and the latter by less effici method .
we describ in thi segment both static and adapt dictionari techniqu .
the static on ar rather straight forward to understand and implement , but thei have limit applic and local oper effici .
most adapt techniqu have their root in <num> paper by ziv and lempel .
the <num> paper , lz77 , and the <num> paper , lz78 .
we describ in thi segment , both such paper and approach .
so let's proce with the detail about these algorithm .
in mani applic , like text , the output of the sourc consist of recur pattern .
in such a case , it's reason to encod such sourc by make a list or a dictionari of the frequent occur pattern .
the pattern in the dictionari ar encod by their index , in the dictionari .
so in essenc the input is split into two class .
the frequent occur pattern ar includ in the dictionari , and the infrequ occur pattern ar encod with less effici method .
for thi method to be effect , the size of the dictionari must be much smaller than the number of possibl pattern .
there ar two type of dictionari techniqu , static and adapt .
most of the adapt techniqu ar base on these two paper by ziv and lempel , the <num> paper , refer to as the lz77 dictionari techniqu , and the <num> paper refer to as the lz78 techniqu .
we're go to describ both of these techniqu .
static dictionari techniqu ar quit straightforward to explain .
thei're suitabl for specif applic , like for exampl , encod the student record at the univers .
so in thi toi exampl , thi is the alphabet of the sourc , it contain five symbol , and here is that static dictionari that wa design .
fix code word length ar us , so we see that there ar the code word for the five symbol , and then there ar code word for combin , of popular combin of symbol , and these ar call diagram .
so with thi dictionari , we want to encod the sequenc here , abracadabra .
and in a straightforward wai , we see that the symbol ab's includ in the dictionari .
thi is the code word .
r is in the dictionari with thi code world .
a , c is in the dictionari with thi correspond code word .
a , d thi code word .
a , b , r and a .
so for thi particular toi exampl , we have <num> symbol in the sequenc , and without the diagram here , we would need time three <num> beat , while now we onli us seven time three or <num> beat .
in the lz77 approach , the dictionari is simpli a portion of the previous encod sequenc .
the encod examin the input sequenc , through a slide window , as shown here .
the window consist of the search buffer , that contain a portion of the recent code sequenc , and the look ahead buffer , that contain the next portion of the sequenc to be encod .
to recal the sequenc , in the look ahead buffer , the encod move a search pointer back through the search buffer , until it encount a match to the first symbol the look ahead buffer .
so let's assum that the pointer find a match at thi point .
the distanc of the pointer from the look ahead buffer is call the offset .
so , here , thi is the offset .
the encod then examin the symbol follow the symbol at the pointer locat , to see if thei match consecut symbol in the look ahead buffer .
so let's sai these symbol here match these symbol here .
the number of consecut symbol in the search buffer that match consecut symbol in the look ahead buffer , start with the first symbol , it's call the length of the match .
so , thi is the length here .
onc the longest match is found , the encod then encod the , thi triplet , where o is the offset , l is the length of the match .
and c is the code for next symbol .
the reason for send thi third element as a triplet is to take care of the situat where no match for the symbol in the look ahead buffer can be found in the search buffer .
in thi case both the offset and and match length valu ar set equal to <num> , and the third element is the code for the symbol it's self .
the bit need to encod thi triplet ar shown here , thi denot here a singl oper .
so the offset can be as long as the length of the search buffer .
to encod the length of the match , we notic here that we don't includ log <num> of s , but log <num> of w , becaus the match can exce into the look ahead buffer and we'll see thi in the exampl .
and final , to encod the code for the next symbol , thi is the cardin of the alphabet , the number of element in the alphabet and us fix length code , we need log <num> of thi cardin code , the symbol .
let us look at a specif exampl of the applic of lz77 .
so we assum that the length of the search buffer is <num> , and the length of the look ahead buffer equal to <num> .
were given to encod thi sequenc here .
and we know encod with lz77 mean the gener of thi triplet .
offset length of much and code word for next symbol .
so here's the sequenc again , and here's the current situat .
we assum that we have encod what's in the search buffer .
so we look at the first symbol here d , we look into the search buffer , whether we have a match for d .
sinc there is no d in the search buffer , then clearli the code word gener thi offset <num> length , and the code for the symbol d .
then we move the search box over by on posit , and now we try to see whether a match into the search buffer .
we have a march of a here , but it's just a singl match .
we'll move further back , anoth match of a , singl match as well .
further back , we match a here as well , but now in addit , we match b , we match r , and we match a .
so in thi case , the offset is equal to <num> .
so encod <num> for the offset .
the match equal <num> symbol , and we need the code for the next symbol which is thi symbol here , the code for r .
we'll move now the buffer over by five posit , and thi is the situat , so we try to see if r can match in the previou segment of the search buffer , so we have a match of r here , but it's a singl match .
i move further back , and i see can match r here as well .
and now , in addit , thi a match with thi a .
thi r match with thi r .
but i can keep go , sinc thi r match thi r , and thi a match thi a .
so , thi is the case i refer to earlier , wherebi , the match which exce into the look ahead buffer .
so in thi case , the offset is three , but the length of the match is five symbol .
therefor the code word is <num> for the offset , <num> from the length of the match , and the next symbol i need to encod is d , over here .
let us proce with a decod now of the stream .
so , we assum that thi part of the sequenc ha been decod .
and then , we receiv the first code word , which is <num> and the code for d .
so , <num> , offset <num> length of the match , and therefor , i need to add d to my sequenc .
then i receiv the second code word <num> and the code for r , so we need to move back <num> posit , so i move the pointer here , and <num> symbol ar match , so these <num> symbol ar match .
and , therefor the symbol so long with the code for r need to be ad to the alreadi decod sequenc .
so thi is what , now the decod sequenc look like .
then i receiv the next code word which is <num> , <num> , and the code for d .
so i move the pointer back three posit , so the pointer is now at thi locat , but thei have a modul five symbol .
i don't have five , i have onli three but i will gener the three first .
so , i gener the rar and now , look at thi point of locat , i can see the five symbol , that thei have been match .
that is , on , two , three , four , five .
so , the first three have alreadi been gener , so i need to add these two , and of cours the last symbol is d becaus i have the code for d .
so we see that through decod i can gener again the origin imag with no error .
an implicit assumpt with lz77 is that light particl will occur close togeth .
ani particl that occur over a period longer than what's cover by the code window will not be captur .
actual , the worst case scenario is when we have a sequenc to encod that is period , with period longer than the search buffer .
so there ar case where thi finit view of the past is inde a drawback .
and in lz78 the relianc on the search buffer is drop , and instead an explicit dictionari is gener .
sinc the dictionari need to be built .
both the encod and decod , synchron is veri import so that the dictionari ar ident .
so , with lz78 what's encod is the index here in the dictionari .
and when we have a new entri , then the index is equal to <num> .
and sinc the code for the symbol , after the match part , similarli to what we had in lz77 .
so let us look at a simpl exampl now .
so here is a sequenc we ar ask to encod us lz78 .
so we start with the first symbol , thi is a new symbol , actual there's noth in the dictionari so it's a new entri .
i equal <num> is the first entri of the dictionari , and i need the code word for b .
i look the next symbol , a doe not exist in the dictionari , it's also a new entri , i equal <num> .
that's the second entri in my dictionari .
look at w , similarli a new entri , the fifth element in the dictionari .
i look at thi w , well w exist in the dictionari , so i look at the next symbol as well .
so , w exist in the dictionari is , the index is <num> for w , and then thi is the code word for the next symbol a .
i move on , thi is let sai the symbol for space , it's a new symbol i equal <num> is the fifth , enter the dictionari , then b exist in the dictionari .
so it's actual the first element in the dictionari , the code word for a .
and now ba is my 6th entri in the dictionari .
similarli , w exist , so here ww becom a new entri in the dictionari .
a exist so a space is my new entri in the dictionari .
over here b exist , ba actual exist in the dictionari .
so therefor thi becom a new entri , baw , w exist , wa exist in the dictionari so .
w a space is my new entri .
thi is , the index of that is ten .
then i proce here , b exist , b a exist , b a w exist in the dictionari .
and therefor b a w w is my new entri .
right ?
so the index of b a w is <num> .
thi is the ninth entri in the dictionari , that's why i equal <num> here , and i need a code word for w .
so a exist , a space .
thi exist , so a space w is my , i'm sorri , a space b is my new entri in the dictionari .
o a new entri .
o space becom a new entri , and final b o is the final entri .
into the dictionari and the index is <num> .
so it's a rather straightforward procedur .
simpl i would sai than lz77 .
and as the encod proce , we're go to see larger and larger lengthwis entri enter in the dictionari .
i'm ad some final comment regard dictionari techniqu here .
there have mani variat of lz77 .
some of which ar that the variabl length to effici encod the triplet .
there ar version where the size of both buffer can vari , and also version where the third element in the triplet is elimin by ad a flag when a singl symbol is encount .
a variat of lz78 is the lzw version , the lempel ziv welch version , accord to which the encod onli send the index .
now , there ar numer applic of the famili of lz variant .
it's been us in the unix compress command .
the command to compress data file or text file .
it's also us in the gif , the graphic interchang format for imag .
and final , is us as part of the standard v <num> bit , that is us for compress over modem .
welcom to the final segment of thi week .
in thi segment , we discuss the principl behind predict in imag process .
it's a wai to captur the correl amongst imag and video pixel .
and it is util wide in mani signal process applic .
in the context of compress , we'll util predict in mani place these three week .
the idea is to encod and transmit to the decod the unpredict part in the predict process , which is the predict error .
then the decod , with knowledg of the predict model , perform the same predict as the encod .
and add that there's mayb a predict error to form the construct signal .
for lossless compress , the predict error is encod error free .
while for loss compress it is first quantiz and then encod as you'll see in the next two week .
base on thi principl there ar veri us lossless imag compress scheme , such as calic and jpeg ls .
we'll discuss briefli jpeg ls .
and , of cours , we'll talk more about the loss avers of jpeg next week .
so , let's proce then with thi final segment of week eight .
predict is us extens in signal process and certainli in compress , the topic of thi and the next two week's lectur .
so base on a predict model , we can predict the signal valu of the given pixel us valu from the past .
that is , valu that have been process and we therefor know their valu .
the past refer to spacial or tempor or spacial tempor past .
and of cours it also relat to the direct the imag is process , that is left to right and top down .
so as an exampl here's an imag from predict the valu of the pixel here .
if i us these neighbor in assum a left to right and a top down scan direct , then the os here , these neighbor refer to the past of the pixel text .
these ar valu that i have alreadi comput .
the predict model can be the result of an optim problem .
such as minim the predict error , as we'll see next week .
or it can result from heurist and extens experiment .
of cours , everi time we do a predict we ar bound to make an error .
sometim a small on and other time a larg on .
therefor , the reconstruct valu equal the predict valu plu the predict error .
now in compress as mention earlier we code and send to the decod the predict error .
thi is the unpredict part .
or the correct term .
sinc the decod can carri out the predict assum that thi model is a , is avail to the decod .
onli thi predict error term is need to form the reconstruct .
when we deal with lossless compress , thi correct part .
here , the correct , the predict error need to be encod , error free .
us some of the techniqu we cover so far that is huffman and arithmet code .
as you'll see when we discuss lossless compress next week , thi predict error is first quantiz befor be encod .
an algorithm for lossless imag compress base on a heurist predict model is calic , context adapt lossless imag compress .
also jpeg , the joint photograph expert group , ha produc lossless imag compress standard .
and the , that's what the ls stand for .
we will discuss lossless jpeg next week .
thi is probabl what most peopl ar familiar with .
but i will briefli , here , discuss a version of jpeg ls .
but befor we proce , let's look at the question of why encod the predict error versu the origin valu save us bit .
we will show an exampl here of thi simpl predict model and try to argu why thi more effici to encod the predict error than the origin signal .
so we're go to work with thi imag .
and we're go to us an on dimension predict model .
so each line of thi imag is go to be process separ .
so let's assum that here is how on of these line in the imag look like .
noth particular about the valu here .
so , the predict model is that the predict valu at n equal the valu of the signal at n minu <num> .
so , if thi , if we assum thi is n , thi is n minu <num> , therefor thi is x n minu <num> .
thi is x of n .
accord to thi predict model the predict valu at n , is equal to x over minu <num> .
and therefor the error that result is just x of n minu the predict valu , so the valu here .
so if we appli thi model to thi imag , here's how the error look like .
sinc the origin imag is an eight bit imag , here's <num> valu .
the error ha twice the dynam rang , therefor the valu rang from <num> , minu <num> to plu <num> .
and for displai purpos we have linearli map thi rang to the <num> to <num> rang .
therefor the valu here in the middl of <num> repres zero .
so as expect the , a lot of 127s , a lot of zero in the error imag .
becaus thi model is quit accur in the flat region of the imag .
divert fail or the predict error is larg at the edg of the imag , and thi is what you see here if you have a close look at real reactor and exit detector in some sens .
larg valu ar you know close to <num> and close to zero , ar observ at the edg of the imag .
so , it is thi predict error thi imag at the center of the decod instead of the origin on .
in try to see why thi more effici to encod the predict error than the origin on , let's look at the histogram of these two imag .
so , here's the histogram of the origin imag .
if you recal actual thi wa an imag that we us when we cover enhanc to demonstr histogram equal .
so , thi is the histogram which is the close and equal histogram and , and wa the result of the histogram equal algorithm .
if we look at the histogram of the error , as expect it's pointi , point around zero .
and zero again is repres by the valu <num> .
if we look at the entropi of the origin imag .
let's call it h1 , and the entropi of the error imag call it h2 .
if you recal from our discuss , the entropi of a discret sourc is maxim when the symbol emit by the sourc ar equal probabl , or in other word the histogram is flat .
so base on thi , h1 is greater than h2 .
and assum that i have a mean to achiev entropi .
i have an earth medicod for exampl that can come close to entropi .
then base on these i need more beat to encod the orign imag than the result predict error .
we look at the first version of the jpeg lossless standard .
there ar eight predictor us , and thei ar given by these express .
so , predictor zero is where no predict is take place , so the actual valu ar encod .
then there ar three on dimension predictor , and four two dimension predictor .
so if we look at some of them , as an exampl .
so , let's look , for exampl , at predictor number on .
then the predict valu at thi locat ij , equal the valu of the pixel to the left .
thi is exactli the on dimension predictor we us in the previou exampl , to find the error and argu about the reason for encod the error .
if you look at predictor number six , then the pixel valu at thi locat is equal to the pixel valu on the left .
with weight on , the on involv with weight on half .
and the on diagon involv with weight minu a half .
so thi is also linear predictor , a two dimension on that us the three neighbor shown here .
so the predict error clearli is the actual valu of the imag at locat ij , minu the predict valu at locat ij .
so for lossless compress thi error is encod losslessli .
and for jpeg ls , it's encod us adopt arithmet code .
the user ha a choic of ani on of the eight predictor at each pixel locat .
if an , of the line process is take place .
then in principl , on could try all eight , eight predictor at each pixel locat .
and choos the on that provid the smallest predict error .
of cours , the decod need to be signal as to which of the eight predictor ar us .
so , three bit need to be alloc to indic , again , the choic of the predictor .
altern is , some other heurist can be us to make adapt us of on of the eight predictor .
and of cours , on can just pick on of the eight and us it throughout the imag .
thi predictor did not result of on specif optim , but nevertheless , thei're all reason predictor and actual each each on of them can be deriv as a result of an optim as we will show next week .
we show here some exampl by appli jpeg ls to four differ imag , the result ar actual out of thi book on of the standard textbook on data compress .
so , there ar four imag , and all eight predict mode ar util .
so , here actual if you recal there is no predict , when code the intens valu of the imag directli us arithmet code .
so , on observ is that , in all case predict provid a benefit .
so no matter which of the other seven predict mode ar us , the number of bit need is smaller than when we ar directli encod the intens valu .
what is shown in bold is the best encod achiev in each case .
and clearli which predict method perform best depend on the type of the imag .
so with thi imag sena , the fifth predict mode gave the best perform .
and we see that thi about <num> or so fewer bit than when the intens were directli encod us , encod us eric's method , encod .
we also show here a comparison between the best jpeg ls and gif .
g i f , which wa if you recal a , techniqu to compress graphic imag util implement of a dictionari techniqu , in more specif the lzw techniqu .
as i mention when we cover dictionari techniqu .
we said that in all case jpeg ls is perform better than gif .
howev , in thi case the perform is compar and thi imag is closer to you might sai a graphic imag , and therefor thi justifi the semi equival perform .
so we've reach the end of week eight , <num> 3rd of the cours is complet .
congratul to all of you .
you should all feel veri good and proud about it .
dure thi week , the first week out of three week dedic to compress , we talk about lossless compress .
thi an import topic on it own , but it's also veri import becaus a lossless compress step is part of ani lossi compress scheme as you'll see in the next two week .
in address some of the import question , such as how effici can we losslessli compress a signal , we'll light on element from inform theori .
we cover some of these intrigu notion and result , such as entropi and the sourc code theorem .
we discuss wai to gener variabl length code , such as the celebr and wide us huffman and arithmet code .
we'll be make us of them in the next two week as well .
we saw how these two code found applic in the fact standard .
we've also discuss dictionari techniqu for encod signal with recur pattern such as text .
dictionari techniqu ar us , for exampl , in the unix compress command .
in compress signal sent over a modem and in gif or compress graphic imag .
final , we talk about the principl of predict , which is util in mani signal process task , such as the compress task we're discuss here .
in lossless compress , the predict error is encod without error and sent to the decod .
while in lossi compress it is first quantiz and then encod error free , as we'll see in the next two week .
so , we alreadi have a good understand of the concept of compress , and more specif lossless compress .
all we need to do now is util what we've learn but includ a quantiz step in the process , which is not a revers process .
due to quantiz , error will be introduc but higher compress ratio will be achiev .
and thi is all we'll be do in the next two week .
so i hope you found the materi of thi week interest .
i'm look forward to continu with the materi of the next two week .
so , i'll see you next week .
